"use strict";var H=require("vscode");function El(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(n){if(n!=="default"){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}}),e.default=t,Object.freeze(e)}var ae=El(H);let Fo;function Ci(){return Fo||(Fo=ae.window.createOutputChannel("Even Better TOML")),Fo}async function Ol(t,e){let n;switch(t.kind){case"info":n=await ae.window.showInformationMessage(t.message,"Show Details");case"warn":n=await ae.window.showWarningMessage(t.message,"Show Details");case"error":n=await ae.window.showErrorMessage(t.message,"Show Details")}n&&e.outputChannel.show()}function ql(t,e){t.subscriptions.push(ae.commands.registerTextEditorCommand("evenBetterToml.copyAsJson",async n=>{const i=n?.document;if(!i||n.selection.isEmpty)return;const r=i.getText(n.selection);if(r.trim().length===0)return;const o=await e.sendRequest("taplo/convertToJson",{text:r}),s=Ci();if(o.error?.length??!1){s.appendLine(`Failed to convert TOML to JSON: ${o.error}`),await ae.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}try{if(!o.text){s.appendLine("The response shouldn't be empty, but it is."),await ae.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}await ae.env.clipboard.writeText(o.text)}catch(a){s.appendLine(`Couldn't write to clipboard: ${a}`),await ae.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}await ae.window.showInformationMessage("JSON copied!")}),ae.commands.registerTextEditorCommand("evenBetterToml.copyAsToml",async n=>{const i=n?.document;if(!i||n.selection.isEmpty)return;const r=i.getText(n.selection);if(r.trim().length===0)return;const o=await e.sendRequest("taplo/convertToToml",{text:r}),s=Ci();if(o.error?.length??!1){s.appendLine(`Failed to convert JSON to TOML: ${o.error}`),await ae.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}try{if(!o.text){s.appendLine("The response shouldn't be empty, but it is."),await ae.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}await ae.env.clipboard.writeText(o.text)}catch(a){s.appendLine(`Couldn't write to clipboard: ${a}`),await ae.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}await ae.window.showInformationMessage("TOML copied!")}),ae.commands.registerTextEditorCommand("evenBetterToml.pasteAsJson",async n=>{const i=Ci();let r;try{r=await ae.env.clipboard.readText()}catch(s){i.appendLine(`Failed to read from clipboard:${s}`),await ae.window.showErrorMessage("Paste from clipboard has failed!","Show Details")&&i.show();return}const o=await e.sendRequest("taplo/convertToJson",{text:r});if(o.error?.length??!1){i.appendLine(`Failed to convert to JSON: ${o.error}`),await ae.window.showErrorMessage("Pasting JSON has failed!","Show Details")&&i.show();return}n.edit(s=>{s.replace(n.selection,o.text)})}),ae.commands.registerTextEditorCommand("evenBetterToml.pasteAsToml",async n=>{const i=Ci();let r;try{r=await ae.env.clipboard.readText()}catch(s){i.appendLine(`Failed to read from clipboard:${s}`),await ae.window.showErrorMessage("Paste from clipboard has failed!","Show Details")&&i.show();return}const o=await e.sendRequest("taplo/convertToToml",{text:r});if(o.error?.length??!1){i.appendLine(`Failed to convert to TOML: ${o.error}`),await ae.window.showErrorMessage("Paste from clipboard has failed!","Show Details")&&i.show();return}n.edit(s=>{s.replace(n.selection,o.text)})}))}function Ml(t,e){t.subscriptions.push(ae.commands.registerTextEditorCommand("evenBetterToml.selectSchema",async n=>{if(!n)return;const i=await e.sendRequest("taplo/listSchemas",{documentUri:n.document.uri.toString()}),r=await e.sendRequest("taplo/associatedSchema",{documentUri:n.document.uri.toString()}),o=await ae.window.showQuickPick(i.schemas.map(s=>({label:s.meta?.name??s.url,description:Il(s.meta),detail:xl(s.url),picked:r.schema?.url===s.url,url:s.url,meta:s.meta})));o&&e.sendNotification("taplo/associateSchema",{documentUri:n.document.uri.toString(),schemaUri:o.url,rule:{url:n.document.uri.toString()},meta:o.meta})}))}function Il(t){if(typeof t?.description=="string")return t.description}function xl(t,e){return`${t}`}function Nl(t,e){ql(t,e),Ml(t,e)}var Ie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ll(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var fe={};Object.defineProperty(fe,"__esModule",{value:!0}),fe.asPromise=fe.thenable=fe.typedArray=fe.stringArray=fe.array=fe.func=fe.error=fe.number=fe.string=fe.boolean=void 0;function jl(t){return t===!0||t===!1}fe.boolean=jl;function Ba(t){return typeof t=="string"||t instanceof String}fe.string=Ba;function Al(t){return typeof t=="number"||t instanceof Number}fe.number=Al;function $l(t){return t instanceof Error}fe.error=$l;function Va(t){return typeof t=="function"}fe.func=Va;function Ja(t){return Array.isArray(t)}fe.array=Ja;function Hl(t){return Ja(t)&&t.every(e=>Ba(e))}fe.stringArray=Hl;function Wl(t,e){return Array.isArray(t)&&t.every(e)}fe.typedArray=Wl;function Qa(t){return t&&Va(t.then)}fe.thenable=Qa;function Kl(t){return t instanceof Promise?t:Qa(t)?new Promise((e,n)=>{t.then(i=>e(i),i=>n(i))}):Promise.resolve(t)}fe.asPromise=Kl;var We={},U={},On={},Eo={},Yi={},N={},xe={};Object.defineProperty(xe,"__esModule",{value:!0}),xe.stringArray=xe.array=xe.func=xe.error=xe.number=xe.string=xe.boolean=void 0;function Ul(t){return t===!0||t===!1}xe.boolean=Ul;function Ga(t){return typeof t=="string"||t instanceof String}xe.string=Ga;function zl(t){return typeof t=="number"||t instanceof Number}xe.number=zl;function Bl(t){return t instanceof Error}xe.error=Bl;function Vl(t){return typeof t=="function"}xe.func=Vl;function Xa(t){return Array.isArray(t)}xe.array=Xa;function Jl(t){return Xa(t)&&t.every(e=>Ga(e))}xe.stringArray=Jl,Object.defineProperty(N,"__esModule",{value:!0}),N.Message=N.NotificationType9=N.NotificationType8=N.NotificationType7=N.NotificationType6=N.NotificationType5=N.NotificationType4=N.NotificationType3=N.NotificationType2=N.NotificationType1=N.NotificationType0=N.NotificationType=N.RequestType9=N.RequestType8=N.RequestType7=N.RequestType6=N.RequestType5=N.RequestType4=N.RequestType3=N.RequestType2=N.RequestType1=N.RequestType=N.RequestType0=N.AbstractMessageSignature=N.ParameterStructures=N.ResponseError=N.ErrorCodes=void 0;const qn=xe;var Oo;(function(t){t.ParseError=-32700,t.InvalidRequest=-32600,t.MethodNotFound=-32601,t.InvalidParams=-32602,t.InternalError=-32603,t.jsonrpcReservedErrorRangeStart=-32099,t.serverErrorStart=-32099,t.MessageWriteError=-32099,t.MessageReadError=-32098,t.PendingResponseRejected=-32097,t.ConnectionInactive=-32096,t.ServerNotInitialized=-32002,t.UnknownErrorCode=-32001,t.jsonrpcReservedErrorRangeEnd=-32e3,t.serverErrorEnd=-32e3})(Oo||(N.ErrorCodes=Oo={}));class Wa extends Error{constructor(e,n,i){super(n),this.code=qn.number(e)?e:Oo.UnknownErrorCode,this.data=i,Object.setPrototypeOf(this,Wa.prototype)}toJson(){const e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}}N.ResponseError=Wa;class tt{constructor(e){this.kind=e}static is(e){return e===tt.auto||e===tt.byName||e===tt.byPosition}toString(){return this.kind}}N.ParameterStructures=tt,tt.auto=new tt("auto"),tt.byPosition=new tt("byPosition"),tt.byName=new tt("byName");class ke{constructor(e,n){this.method=e,this.numberOfParams=n}get parameterStructures(){return tt.auto}}N.AbstractMessageSignature=ke;class Ql extends ke{constructor(e){super(e,0)}}N.RequestType0=Ql;class Gl extends ke{constructor(e,n=tt.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}}N.RequestType=Gl;class Xl extends ke{constructor(e,n=tt.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}}N.RequestType1=Xl;class Yl extends ke{constructor(e){super(e,2)}}N.RequestType2=Yl;class Zl extends ke{constructor(e){super(e,3)}}N.RequestType3=Zl;class ed extends ke{constructor(e){super(e,4)}}N.RequestType4=ed;class td extends ke{constructor(e){super(e,5)}}N.RequestType5=td;class nd extends ke{constructor(e){super(e,6)}}N.RequestType6=nd;class id extends ke{constructor(e){super(e,7)}}N.RequestType7=id;class rd extends ke{constructor(e){super(e,8)}}N.RequestType8=rd;class od extends ke{constructor(e){super(e,9)}}N.RequestType9=od;class sd extends ke{constructor(e,n=tt.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}}N.NotificationType=sd;class ad extends ke{constructor(e){super(e,0)}}N.NotificationType0=ad;class cd extends ke{constructor(e,n=tt.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}}N.NotificationType1=cd;class ud extends ke{constructor(e){super(e,2)}}N.NotificationType2=ud;class ld extends ke{constructor(e){super(e,3)}}N.NotificationType3=ld;class dd extends ke{constructor(e){super(e,4)}}N.NotificationType4=dd;class fd extends ke{constructor(e){super(e,5)}}N.NotificationType5=fd;class gd extends ke{constructor(e){super(e,6)}}N.NotificationType6=gd;class hd extends ke{constructor(e){super(e,7)}}N.NotificationType7=hd;class pd extends ke{constructor(e){super(e,8)}}N.NotificationType8=pd;class md extends ke{constructor(e){super(e,9)}}N.NotificationType9=md;var Ya;(function(t){function e(r){const o=r;return o&&qn.string(o.method)&&(qn.string(o.id)||qn.number(o.id))}t.isRequest=e;function n(r){const o=r;return o&&qn.string(o.method)&&r.id===void 0}t.isNotification=n;function i(r){const o=r;return o&&(o.result!==void 0||!!o.error)&&(qn.string(o.id)||qn.number(o.id)||o.id===null)}t.isResponse=i})(Ya||(N.Message=Ya={}));var nn={},Za;Object.defineProperty(nn,"__esModule",{value:!0}),nn.LRUCache=nn.LinkedMap=nn.Touch=void 0;var Xe;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(Xe||(nn.Touch=Xe={}));class ec{constructor(){this[Za]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,n=Xe.None){const i=this._map.get(e);if(i)return n!==Xe.None&&this.touch(i,n),i.value}set(e,n,i=Xe.None){let r=this._map.get(e);if(r)r.value=n,i!==Xe.None&&this.touch(r,i);else{switch(r={key:e,value:n,next:void 0,previous:void 0},i){case Xe.None:this.addItemLast(r);break;case Xe.First:this.addItemFirst(r);break;case Xe.Last:this.addItemLast(r);break;default:this.addItemLast(r);break}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const n=this._map.get(e);if(n)return this._map.delete(e),this.removeItem(n),this._size--,n.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,n){const i=this._state;let r=this._head;for(;r;){if(n?e.bind(n)(r.value,r.key,this):e(r.value,r.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){const e=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){const r={value:n.key,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}values(){const e=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){const r={value:n.value,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}entries(){const e=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){const r={value:[n.key,n.value],done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}[(Za=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let n=this._head,i=this.size;for(;n&&i>e;)this._map.delete(n.key),n=n.next,i--;this._head=n,this._size=i,n&&(n.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const n=e.next,i=e.previous;if(!n||!i)throw new Error("Invalid list");n.previous=i,i.next=n}e.next=void 0,e.previous=void 0,this._state++}touch(e,n){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(n!==Xe.First&&n!==Xe.Last)){if(n===Xe.First){if(e===this._head)return;const i=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(i.previous=r,r.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(n===Xe.Last){if(e===this._tail)return;const i=e.next,r=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=r,r.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((n,i)=>{e.push([i,n])}),e}fromJSON(e){this.clear();for(const[n,i]of e)this.set(n,i)}}nn.LinkedMap=ec;class yd extends ec{constructor(e,n=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,n),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,n=Xe.AsNew){return super.get(e,n)}peek(e){return super.get(e,Xe.None)}set(e,n){return super.set(e,n,Xe.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}nn.LRUCache=yd;var Zi={};Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.Disposable=void 0;var tc;(function(t){function e(n){return{dispose:n}}t.create=e})(tc||(Zi.Disposable=tc={}));var Wt={},rn={};Object.defineProperty(rn,"__esModule",{value:!0});let qo;function Mo(){if(qo===void 0)throw new Error("No runtime abstraction layer installed");return qo}(function(t){function e(n){if(n===void 0)throw new Error("No runtime abstraction layer provided");qo=n}t.install=e})(Mo||(Mo={})),rn.default=Mo,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.Emitter=Wt.Event=void 0;const vd=rn;var nc;(function(t){const e={dispose(){}};t.None=function(){return e}})(nc||(Wt.Event=nc={}));class Cd{add(e,n=null,i){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(n),Array.isArray(i)&&i.push({dispose:()=>this.remove(e,n)})}remove(e,n=null){if(!this._callbacks)return;let i=!1;for(let r=0,o=this._callbacks.length;r<o;r++)if(this._callbacks[r]===e)if(this._contexts[r]===n){this._callbacks.splice(r,1),this._contexts.splice(r,1);return}else i=!0;if(i)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const n=[],i=this._callbacks.slice(0),r=this._contexts.slice(0);for(let o=0,s=i.length;o<s;o++)try{n.push(i[o].apply(r[o],e))}catch(a){(0,vd.default)().console.error(a)}return n}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class To{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,n,i)=>{this._callbacks||(this._callbacks=new Cd),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,n);const r={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,n),r.dispose=To._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(i)&&i.push(r),r}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}Wt.Emitter=To,To._noop=function(){};var vn={};Object.defineProperty(vn,"__esModule",{value:!0}),vn.CancellationTokenSource=vn.CancellationToken=void 0;const _d=rn,Dd=xe,Io=Wt;var er;(function(t){t.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Io.Event.None}),t.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Io.Event.None});function e(n){const i=n;return i&&(i===t.None||i===t.Cancelled||Dd.boolean(i.isCancellationRequested)&&!!i.onCancellationRequested)}t.is=e})(er||(vn.CancellationToken=er={}));const bd=Object.freeze(function(t,e){const n=(0,_d.default)().timer.setTimeout(t.bind(e),0);return{dispose(){n.dispose()}}});class ic{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?bd:(this._emitter||(this._emitter=new Io.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class wd{get token(){return this._token||(this._token=new ic),this._token}cancel(){this._token?this._token.cancel():this._token=er.Cancelled}dispose(){this._token?this._token instanceof ic&&this._token.dispose():this._token=er.None}}vn.CancellationTokenSource=wd;var Jn={};Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.SharedArrayReceiverStrategy=Jn.SharedArraySenderStrategy=void 0;const Sd=vn;var _i;(function(t){t.Continue=0,t.Cancelled=1})(_i||(_i={}));class Rd{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;const n=new SharedArrayBuffer(4),i=new Int32Array(n,0,1);i[0]=_i.Continue,this.buffers.set(e.id,n),e.$cancellationData=n}async sendCancellation(e,n){const i=this.buffers.get(n);if(i===void 0)return;const r=new Int32Array(i,0,1);Atomics.store(r,0,_i.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}}Jn.SharedArraySenderStrategy=Rd;class Td{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===_i.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class Pd{constructor(e){this.token=new Td(e)}cancel(){}dispose(){}}class kd{constructor(){this.kind="request"}createCancellationTokenSource(e){const n=e.$cancellationData;return n===void 0?new Sd.CancellationTokenSource:new Pd(n)}}Jn.SharedArrayReceiverStrategy=kd;var Cn={},Di={};Object.defineProperty(Di,"__esModule",{value:!0}),Di.Semaphore=void 0;const Fd=rn;let Ed=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((n,i)=>{this._waiting.push({thunk:e,resolve:n,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Fd.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const n=e.thunk();n instanceof Promise?n.then(i=>{this._active--,e.resolve(i),this.runNext()},i=>{this._active--,e.reject(i),this.runNext()}):(this._active--,e.resolve(n),this.runNext())}catch(n){this._active--,e.reject(n),this.runNext()}}};Di.Semaphore=Ed,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.ReadableStreamMessageReader=Cn.AbstractMessageReader=Cn.MessageReader=void 0;const xo=rn,Qn=xe,No=Wt,Od=Di;var rc;(function(t){function e(n){let i=n;return i&&Qn.func(i.listen)&&Qn.func(i.dispose)&&Qn.func(i.onError)&&Qn.func(i.onClose)&&Qn.func(i.onPartialMessage)}t.is=e})(rc||(Cn.MessageReader=rc={}));class oc{constructor(){this.errorEmitter=new No.Emitter,this.closeEmitter=new No.Emitter,this.partialMessageEmitter=new No.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${Qn.string(e.message)?e.message:"unknown"}`)}}Cn.AbstractMessageReader=oc;var Lo;(function(t){function e(n){let i,r;const o=new Map;let s;const a=new Map;if(n===void 0||typeof n=="string")i=n??"utf-8";else{if(i=n.charset??"utf-8",n.contentDecoder!==void 0&&(r=n.contentDecoder,o.set(r.name,r)),n.contentDecoders!==void 0)for(const u of n.contentDecoders)o.set(u.name,u);if(n.contentTypeDecoder!==void 0&&(s=n.contentTypeDecoder,a.set(s.name,s)),n.contentTypeDecoders!==void 0)for(const u of n.contentTypeDecoders)a.set(u.name,u)}return s===void 0&&(s=(0,xo.default)().applicationJson.decoder,a.set(s.name,s)),{charset:i,contentDecoder:r,contentDecoders:o,contentTypeDecoder:s,contentTypeDecoders:a}}t.fromOptions=e})(Lo||(Lo={}));class qd extends oc{constructor(e,n){super(),this.readable=e,this.options=Lo.fromOptions(n),this.buffer=(0,xo.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new Od.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const n=this.readable.onData(i=>{this.onData(i)});return this.readable.onError(i=>this.fireError(i)),this.readable.onClose(()=>this.fireClose()),n}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){const i=this.buffer.tryReadHeaders(!0);if(!i)return;const r=i.get("content-length");if(!r){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(i))}`));return}const o=parseInt(r);if(isNaN(o)){this.fireError(new Error(`Content-Length value must be a number. Got ${r}`));return}this.nextMessageLength=o}const n=this.buffer.tryReadBody(this.nextMessageLength);if(n===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const i=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(n):n,r=await this.options.contentTypeDecoder.decode(i,this.options);this.callback(r)}).catch(i=>{this.fireError(i)})}}catch(n){this.fireError(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,xo.default)().timer.setTimeout((e,n)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:n}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}Cn.ReadableStreamMessageReader=qd;var _n={};Object.defineProperty(_n,"__esModule",{value:!0}),_n.WriteableStreamMessageWriter=_n.AbstractMessageWriter=_n.MessageWriter=void 0;const sc=rn,bi=xe,Md=Di,ac=Wt,Id="Content-Length: ",cc=`\r
`;var uc;(function(t){function e(n){let i=n;return i&&bi.func(i.dispose)&&bi.func(i.onClose)&&bi.func(i.onError)&&bi.func(i.write)}t.is=e})(uc||(_n.MessageWriter=uc={}));class lc{constructor(){this.errorEmitter=new ac.Emitter,this.closeEmitter=new ac.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,n,i){this.errorEmitter.fire([this.asError(e),n,i])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${bi.string(e.message)?e.message:"unknown"}`)}}_n.AbstractMessageWriter=lc;var jo;(function(t){function e(n){return n===void 0||typeof n=="string"?{charset:n??"utf-8",contentTypeEncoder:(0,sc.default)().applicationJson.encoder}:{charset:n.charset??"utf-8",contentEncoder:n.contentEncoder,contentTypeEncoder:n.contentTypeEncoder??(0,sc.default)().applicationJson.encoder}}t.fromOptions=e})(jo||(jo={}));class xd extends lc{constructor(e,n){super(),this.writable=e,this.options=jo.fromOptions(n),this.errorCount=0,this.writeSemaphore=new Md.Semaphore(1),this.writable.onError(i=>this.fireError(i)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(i=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(i):i).then(i=>{const r=[];return r.push(Id,i.byteLength.toString(),cc),r.push(cc),this.doWrite(e,r,i)},i=>{throw this.fireError(i),i}))}async doWrite(e,n,i){try{return await this.writable.write(n.join(""),"ascii"),this.writable.write(i)}catch(r){return this.handleError(r,e),Promise.reject(r)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){this.writable.end()}}_n.WriteableStreamMessageWriter=xd;var tr={};Object.defineProperty(tr,"__esModule",{value:!0}),tr.AbstractMessageBuffer=void 0;const Nd=13,Ld=10,jd=`\r
`;class Ad{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const n=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(n),this._totalLength+=n.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let n=0,i=0,r=0,o=0;e:for(;i<this._chunks.length;){const l=this._chunks[i];for(r=0;r<l.length;){switch(l[r]){case Nd:switch(n){case 0:n=1;break;case 2:n=3;break;default:n=0}break;case Ld:switch(n){case 1:n=2;break;case 3:n=4,r++;break e;default:n=0}break;default:n=0}r++}o+=l.byteLength,i++}if(n!==4)return;const s=this._read(o+r),a=new Map,u=this.toString(s,"ascii").split(jd);if(u.length<2)return a;for(let l=0;l<u.length-2;l++){const f=u[l],m=f.indexOf(":");if(m===-1)throw new Error(`Message header must separate key and value using ':'
${f}`);const p=f.substr(0,m),C=f.substr(m+1).trim();a.set(e?p.toLowerCase():p,C)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const o=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(o)}if(this._chunks[0].byteLength>e){const o=this._chunks[0],s=this.asNative(o,e);return this._chunks[0]=o.slice(e),this._totalLength-=e,s}const n=this.allocNative(e);let i=0,r=0;for(;e>0;){const o=this._chunks[r];if(o.byteLength>e){const s=o.slice(0,e);n.set(s,i),i+=e,this._chunks[r]=o.slice(e),this._totalLength-=e,e-=e}else n.set(o,i),i+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,e-=o.byteLength}return n}}tr.AbstractMessageBuffer=Ad;var dc={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.RequestCancellationReceiverStrategy=t.IdCancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=t.NullLogger=t.ProgressType=t.ProgressToken=void 0;const e=rn,n=xe,i=N,r=nn,o=Wt,s=vn;var a;(function(T){T.type=new i.NotificationType("$/cancelRequest")})(a||(a={}));var u;(function(T){function A(L){return typeof L=="string"||typeof L=="number"}T.is=A})(u||(t.ProgressToken=u={}));var l;(function(T){T.type=new i.NotificationType("$/progress")})(l||(l={}));class f{constructor(){}}t.ProgressType=f;var m;(function(T){function A(L){return n.func(L)}T.is=A})(m||(m={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var p;(function(T){T[T.Off=0]="Off",T[T.Messages=1]="Messages",T[T.Compact=2]="Compact",T[T.Verbose=3]="Verbose"})(p||(t.Trace=p={}));var C;(function(T){T.Off="off",T.Messages="messages",T.Compact="compact",T.Verbose="verbose"})(C||(t.TraceValues=C={})),function(T){function A(q){if(!n.string(q))return T.Off;switch(q=q.toLowerCase(),q){case"off":return T.Off;case"messages":return T.Messages;case"compact":return T.Compact;case"verbose":return T.Verbose;default:return T.Off}}T.fromString=A;function L(q){switch(q){case T.Off:return"off";case T.Messages:return"messages";case T.Compact:return"compact";case T.Verbose:return"verbose";default:return"off"}}T.toString=L}(p||(t.Trace=p={}));var h;(function(T){T.Text="text",T.JSON="json"})(h||(t.TraceFormat=h={})),function(T){function A(L){return n.string(L)?(L=L.toLowerCase(),L==="json"?T.JSON:T.Text):T.Text}T.fromString=A}(h||(t.TraceFormat=h={}));var w;(function(T){T.type=new i.NotificationType("$/setTrace")})(w||(t.SetTraceNotification=w={}));var R;(function(T){T.type=new i.NotificationType("$/logTrace")})(R||(t.LogTraceNotification=R={}));var M;(function(T){T[T.Closed=1]="Closed",T[T.Disposed=2]="Disposed",T[T.AlreadyListening=3]="AlreadyListening"})(M||(t.ConnectionErrors=M={}));class K extends Error{constructor(A,L){super(L),this.code=A,Object.setPrototypeOf(this,K.prototype)}}t.ConnectionError=K;var ne;(function(T){function A(L){const q=L;return q&&n.func(q.cancelUndispatched)}T.is=A})(ne||(t.ConnectionStrategy=ne={}));var ve;(function(T){function A(L){const q=L;return q&&(q.kind===void 0||q.kind==="id")&&n.func(q.createCancellationTokenSource)&&(q.dispose===void 0||n.func(q.dispose))}T.is=A})(ve||(t.IdCancellationReceiverStrategy=ve={}));var se;(function(T){function A(L){const q=L;return q&&q.kind==="request"&&n.func(q.createCancellationTokenSource)&&(q.dispose===void 0||n.func(q.dispose))}T.is=A})(se||(t.RequestCancellationReceiverStrategy=se={}));var de;(function(T){T.Message=Object.freeze({createCancellationTokenSource(L){return new s.CancellationTokenSource}});function A(L){return ve.is(L)||se.is(L)}T.is=A})(de||(t.CancellationReceiverStrategy=de={}));var x;(function(T){T.Message=Object.freeze({sendCancellation(L,q){return L.sendNotification(a.type,{id:q})},cleanup(L){}});function A(L){const q=L;return q&&n.func(q.sendCancellation)&&n.func(q.cleanup)}T.is=A})(x||(t.CancellationSenderStrategy=x={}));var V;(function(T){T.Message=Object.freeze({receiver:de.Message,sender:x.Message});function A(L){const q=L;return q&&de.is(q.receiver)&&x.is(q.sender)}T.is=A})(V||(t.CancellationStrategy=V={}));var G;(function(T){function A(L){const q=L;return q&&n.func(q.handleMessage)}T.is=A})(G||(t.MessageStrategy=G={}));var Le;(function(T){function A(L){const q=L;return q&&(V.is(q.cancellationStrategy)||ne.is(q.connectionStrategy)||G.is(q.messageStrategy))}T.is=A})(Le||(t.ConnectionOptions=Le={}));var pe;(function(T){T[T.New=1]="New",T[T.Listening=2]="Listening",T[T.Closed=3]="Closed",T[T.Disposed=4]="Disposed"})(pe||(pe={}));function Pt(T,A,L,q){const ge=L!==void 0?L:t.NullLogger;let Bt=0,Re=0,Vt=0;const Ue="2.0";let $e;const kt=new Map;let ft;const vt=new Map,Ct=new Map;let Lt,Je=new r.LinkedMap,ze=new Map,ot=new Set,Qe=new Map,ee=p.Off,nt=h.Text,me,Ge=pe.New;const jt=new o.Emitter,Ft=new o.Emitter,Et=new o.Emitter,Be=new o.Emitter,gt=new o.Emitter,we=q&&q.cancellationStrategy?q.cancellationStrategy:V.Message;function st(y){if(y===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+y.toString()}function fn(y){return y===null?"res-unknown-"+(++Vt).toString():"res-"+y.toString()}function Jt(){return"not-"+(++Re).toString()}function gn(y,S){i.Message.isRequest(S)?y.set(st(S.id),S):i.Message.isResponse(S)?y.set(fn(S.id),S):y.set(Jt(),S)}function Qt(y){}function Gt(){return Ge===pe.Listening}function Ot(){return Ge===pe.Closed}function at(){return Ge===pe.Disposed}function At(){(Ge===pe.New||Ge===pe.Listening)&&(Ge=pe.Closed,Ft.fire(void 0))}function hn(y){jt.fire([y,void 0,void 0])}function ct(y){jt.fire(y)}T.onClose(At),T.onError(hn),A.onClose(At),A.onError(ct);function $t(){Lt||Je.size===0||(Lt=(0,e.default)().timer.setImmediate(()=>{Lt=void 0,Yt()}))}function Xt(y){i.Message.isRequest(y)?Zt(y):i.Message.isNotification(y)?mn(y):i.Message.isResponse(y)?en(y):Ht(y)}function Yt(){if(Je.size===0)return;const y=Je.shift();try{const S=q?.messageStrategy;G.is(S)?S.handleMessage(y,Xt):Xt(y)}finally{$t()}}const pn=y=>{try{if(i.Message.isNotification(y)&&y.method===a.type.method){const S=y.params.id,F=st(S),I=Je.get(F);if(i.Message.isRequest(I)){const ye=q?.connectionStrategy,be=ye&&ye.cancelUndispatched?ye.cancelUndispatched(I,Qt):void 0;if(be&&(be.error!==void 0||be.result!==void 0)){Je.delete(F),Qe.delete(S),be.id=I.id,ht(be,y.method,Date.now()),A.write(be).catch(()=>ge.error("Sending response for canceled message failed."));return}}const Ce=Qe.get(S);if(Ce!==void 0){Ce.cancel(),D(y);return}else ot.add(S)}gn(Je,y)}finally{$t()}};function Zt(y){if(at())return;function S(v,b,P){const X={jsonrpc:Ue,id:y.id};v instanceof i.ResponseError?X.error=v.toJson():X.result=v===void 0?null:v,ht(X,b,P),A.write(X).catch(()=>ge.error("Sending response failed."))}function F(v,b,P){const X={jsonrpc:Ue,id:y.id,error:v.toJson()};ht(X,b,P),A.write(X).catch(()=>ge.error("Sending response failed."))}function I(v,b,P){v===void 0&&(v=null);const X={jsonrpc:Ue,id:y.id,result:v};ht(X,b,P),A.write(X).catch(()=>ge.error("Sending response failed."))}d(y);const Ce=kt.get(y.method);let ye,be;Ce&&(ye=Ce.type,be=Ce.handler);const c=Date.now();if(be||$e){const v=y.id??String(Date.now()),b=ve.is(we.receiver)?we.receiver.createCancellationTokenSource(v):we.receiver.createCancellationTokenSource(y);y.id!==null&&ot.has(y.id)&&b.cancel(),y.id!==null&&Qe.set(v,b);try{let P;if(be)if(y.params===void 0){if(ye!==void 0&&ye.numberOfParams!==0){F(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${y.method} defines ${ye.numberOfParams} params but received none.`),y.method,c);return}P=be(b.token)}else if(Array.isArray(y.params)){if(ye!==void 0&&ye.parameterStructures===i.ParameterStructures.byName){F(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${y.method} defines parameters by name but received parameters by position`),y.method,c);return}P=be(...y.params,b.token)}else{if(ye!==void 0&&ye.parameterStructures===i.ParameterStructures.byPosition){F(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${y.method} defines parameters by position but received parameters by name`),y.method,c);return}P=be(y.params,b.token)}else $e&&(P=$e(y.method,y.params,b.token));const X=P;P?X.then?X.then(ue=>{Qe.delete(v),S(ue,y.method,c)},ue=>{Qe.delete(v),ue instanceof i.ResponseError?F(ue,y.method,c):ue&&n.string(ue.message)?F(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${y.method} failed with message: ${ue.message}`),y.method,c):F(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${y.method} failed unexpectedly without providing any details.`),y.method,c)}):(Qe.delete(v),S(P,y.method,c)):(Qe.delete(v),I(P,y.method,c))}catch(P){Qe.delete(v),P instanceof i.ResponseError?S(P,y.method,c):P&&n.string(P.message)?F(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${y.method} failed with message: ${P.message}`),y.method,c):F(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${y.method} failed unexpectedly without providing any details.`),y.method,c)}}else F(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${y.method}`),y.method,c)}function en(y){if(!at())if(y.id===null)y.error?ge.error(`Received response message without id: Error is: 
${JSON.stringify(y.error,void 0,4)}`):ge.error("Received response message without id. No further error information provided.");else{const S=y.id,F=ze.get(S);if(O(y,F),F!==void 0){ze.delete(S);try{if(y.error){const I=y.error;F.reject(new i.ResponseError(I.code,I.message,I.data))}else if(y.result!==void 0)F.resolve(y.result);else throw new Error("Should never happen.")}catch(I){I.message?ge.error(`Response handler '${F.method}' failed with message: ${I.message}`):ge.error(`Response handler '${F.method}' failed unexpectedly.`)}}}}function mn(y){if(at())return;let S,F;if(y.method===a.type.method){const I=y.params.id;ot.delete(I),D(y);return}else{const I=vt.get(y.method);I&&(F=I.handler,S=I.type)}if(F||ft)try{if(D(y),F)if(y.params===void 0)S!==void 0&&S.numberOfParams!==0&&S.parameterStructures!==i.ParameterStructures.byName&&ge.error(`Notification ${y.method} defines ${S.numberOfParams} params but received none.`),F();else if(Array.isArray(y.params)){const I=y.params;y.method===l.type.method&&I.length===2&&u.is(I[0])?F({token:I[0],value:I[1]}):(S!==void 0&&(S.parameterStructures===i.ParameterStructures.byName&&ge.error(`Notification ${y.method} defines parameters by name but received parameters by position`),S.numberOfParams!==y.params.length&&ge.error(`Notification ${y.method} defines ${S.numberOfParams} params but received ${I.length} arguments`)),F(...I))}else S!==void 0&&S.parameterStructures===i.ParameterStructures.byPosition&&ge.error(`Notification ${y.method} defines parameters by position but received parameters by name`),F(y.params);else ft&&ft(y.method,y.params)}catch(I){I.message?ge.error(`Notification handler '${y.method}' failed with message: ${I.message}`):ge.error(`Notification handler '${y.method}' failed unexpectedly.`)}else Et.fire(y)}function Ht(y){if(!y){ge.error("Received empty message.");return}ge.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(y,null,4)}`);const S=y;if(n.string(S.id)||n.number(S.id)){const F=S.id,I=ze.get(F);I&&I.reject(new Error("The received response has neither a result nor an error property."))}}function it(y){if(y!=null)switch(ee){case p.Verbose:return JSON.stringify(y,null,4);case p.Compact:return JSON.stringify(y);default:return}}function tn(y){if(!(ee===p.Off||!me))if(nt===h.Text){let S;(ee===p.Verbose||ee===p.Compact)&&y.params&&(S=`Params: ${it(y.params)}

`),me.log(`Sending request '${y.method} - (${y.id})'.`,S)}else J("send-request",y)}function yn(y){if(!(ee===p.Off||!me))if(nt===h.Text){let S;(ee===p.Verbose||ee===p.Compact)&&(y.params?S=`Params: ${it(y.params)}

`:S=`No parameters provided.

`),me.log(`Sending notification '${y.method}'.`,S)}else J("send-notification",y)}function ht(y,S,F){if(!(ee===p.Off||!me))if(nt===h.Text){let I;(ee===p.Verbose||ee===p.Compact)&&(y.error&&y.error.data?I=`Error data: ${it(y.error.data)}

`:y.result?I=`Result: ${it(y.result)}

`:y.error===void 0&&(I=`No result returned.

`)),me.log(`Sending response '${S} - (${y.id})'. Processing request took ${Date.now()-F}ms`,I)}else J("send-response",y)}function d(y){if(!(ee===p.Off||!me))if(nt===h.Text){let S;(ee===p.Verbose||ee===p.Compact)&&y.params&&(S=`Params: ${it(y.params)}

`),me.log(`Received request '${y.method} - (${y.id})'.`,S)}else J("receive-request",y)}function D(y){if(!(ee===p.Off||!me||y.method===R.type.method))if(nt===h.Text){let S;(ee===p.Verbose||ee===p.Compact)&&(y.params?S=`Params: ${it(y.params)}

`:S=`No parameters provided.

`),me.log(`Received notification '${y.method}'.`,S)}else J("receive-notification",y)}function O(y,S){if(!(ee===p.Off||!me))if(nt===h.Text){let F;if((ee===p.Verbose||ee===p.Compact)&&(y.error&&y.error.data?F=`Error data: ${it(y.error.data)}

`:y.result?F=`Result: ${it(y.result)}

`:y.error===void 0&&(F=`No result returned.

`)),S){const I=y.error?` Request failed: ${y.error.message} (${y.error.code}).`:"";me.log(`Received response '${S.method} - (${y.id})' in ${Date.now()-S.timerStart}ms.${I}`,F)}else me.log(`Received response ${y.id} without active response promise.`,F)}else J("receive-response",y)}function J(y,S){if(!me||ee===p.Off)return;const F={isLSPMessage:!0,type:y,message:S,timestamp:Date.now()};me.log(F)}function te(){if(Ot())throw new K(M.Closed,"Connection is closed.");if(at())throw new K(M.Disposed,"Connection is disposed.")}function Te(){if(Gt())throw new K(M.AlreadyListening,"Connection is already listening")}function He(){if(!Gt())throw new Error("Call listen() first.")}function je(y){return y===void 0?null:y}function En(y){if(y!==null)return y}function g(y){return y!=null&&!Array.isArray(y)&&typeof y=="object"}function Se(y,S){switch(y){case i.ParameterStructures.auto:return g(S)?En(S):[je(S)];case i.ParameterStructures.byName:if(!g(S))throw new Error("Received parameters by name but param is not an object literal.");return En(S);case i.ParameterStructures.byPosition:return[je(S)];default:throw new Error(`Unknown parameter structure ${y.toString()}`)}}function Pe(y,S){let F;const I=y.numberOfParams;switch(I){case 0:F=void 0;break;case 1:F=Se(y.parameterStructures,S[0]);break;default:F=[];for(let Ce=0;Ce<S.length&&Ce<I;Ce++)F.push(je(S[Ce]));if(S.length<I)for(let Ce=S.length;Ce<I;Ce++)F.push(null);break}return F}const $={sendNotification:(y,...S)=>{te();let F,I;if(n.string(y)){F=y;const ye=S[0];let be=0,c=i.ParameterStructures.auto;i.ParameterStructures.is(ye)&&(be=1,c=ye);let v=S.length;const b=v-be;switch(b){case 0:I=void 0;break;case 1:I=Se(c,S[be]);break;default:if(c===i.ParameterStructures.byName)throw new Error(`Received ${b} parameters for 'by Name' notification parameter structure.`);I=S.slice(be,v).map(P=>je(P));break}}else{const ye=S;F=y.method,I=Pe(y,ye)}const Ce={jsonrpc:Ue,method:F,params:I};return yn(Ce),A.write(Ce).catch(ye=>{throw ge.error("Sending notification failed."),ye})},onNotification:(y,S)=>{te();let F;return n.func(y)?ft=y:S&&(n.string(y)?(F=y,vt.set(y,{type:void 0,handler:S})):(F=y.method,vt.set(y.method,{type:y,handler:S}))),{dispose:()=>{F!==void 0?vt.delete(F):ft=void 0}}},onProgress:(y,S,F)=>{if(Ct.has(S))throw new Error(`Progress handler for token ${S} already registered`);return Ct.set(S,F),{dispose:()=>{Ct.delete(S)}}},sendProgress:(y,S,F)=>$.sendNotification(l.type,{token:S,value:F}),onUnhandledProgress:Be.event,sendRequest:(y,...S)=>{te(),He();let F,I,Ce;if(n.string(y)){F=y;const v=S[0],b=S[S.length-1];let P=0,X=i.ParameterStructures.auto;i.ParameterStructures.is(v)&&(P=1,X=v);let ue=S.length;s.CancellationToken.is(b)&&(ue=ue-1,Ce=b);const Q=ue-P;switch(Q){case 0:I=void 0;break;case 1:I=Se(X,S[P]);break;default:if(X===i.ParameterStructures.byName)throw new Error(`Received ${Q} parameters for 'by Name' request parameter structure.`);I=S.slice(P,ue).map(_t=>je(_t));break}}else{const v=S;F=y.method,I=Pe(y,v);const b=y.numberOfParams;Ce=s.CancellationToken.is(v[b])?v[b]:void 0}const ye=Bt++;let be;Ce&&(be=Ce.onCancellationRequested(()=>{const v=we.sender.sendCancellation($,ye);return v===void 0?(ge.log(`Received no promise from cancellation strategy when cancelling id ${ye}`),Promise.resolve()):v.catch(()=>{ge.log(`Sending cancellation messages for id ${ye} failed`)})}));const c={jsonrpc:Ue,id:ye,method:F,params:I};return tn(c),typeof we.sender.enableCancellation=="function"&&we.sender.enableCancellation(c),new Promise(async(v,b)=>{const P=Q=>{v(Q),we.sender.cleanup(ye),be?.dispose()},X=Q=>{b(Q),we.sender.cleanup(ye),be?.dispose()},ue={method:F,timerStart:Date.now(),resolve:P,reject:X};try{await A.write(c),ze.set(ye,ue)}catch(Q){throw ge.error("Sending request failed."),ue.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,Q.message?Q.message:"Unknown reason")),Q}})},onRequest:(y,S)=>{te();let F=null;return m.is(y)?(F=void 0,$e=y):n.string(y)?(F=null,S!==void 0&&(F=y,kt.set(y,{handler:S,type:void 0}))):S!==void 0&&(F=y.method,kt.set(y.method,{type:y,handler:S})),{dispose:()=>{F!==null&&(F!==void 0?kt.delete(F):$e=void 0)}}},hasPendingResponse:()=>ze.size>0,trace:async(y,S,F)=>{let I=!1,Ce=h.Text;F!==void 0&&(n.boolean(F)?I=F:(I=F.sendNotification||!1,Ce=F.traceFormat||h.Text)),ee=y,nt=Ce,ee===p.Off?me=void 0:me=S,I&&!Ot()&&!at()&&await $.sendNotification(w.type,{value:p.toString(y)})},onError:jt.event,onClose:Ft.event,onUnhandledNotification:Et.event,onDispose:gt.event,end:()=>{A.end()},dispose:()=>{if(at())return;Ge=pe.Disposed,gt.fire(void 0);const y=new i.ResponseError(i.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const S of ze.values())S.reject(y);ze=new Map,Qe=new Map,ot=new Set,Je=new r.LinkedMap,n.func(A.dispose)&&A.dispose(),n.func(T.dispose)&&T.dispose()},listen:()=>{te(),Te(),Ge=pe.Listening,T.listen(pn)},inspect:()=>{(0,e.default)().console.log("inspect")}};return $.onNotification(R.type,y=>{if(ee===p.Off||!me)return;const S=ee===p.Verbose||ee===p.Compact;me.log(y.message,S?y.verbose:void 0)}),$.onNotification(l.type,y=>{const S=Ct.get(y.token);S?S(y.value):Be.fire(y)}),$}t.createMessageConnection=Pt})(dc),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressType=t.ProgressToken=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.AbstractMessageBuffer=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.LRUCache=t.Touch=t.LinkedMap=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.Message=t.RAL=void 0,t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=void 0;const e=N;Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return e.Message}}),Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return e.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return e.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return e.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return e.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return e.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return e.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return e.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return e.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return e.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return e.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return e.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return e.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return e.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return e.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return e.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return e.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return e.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return e.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return e.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return e.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return e.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return e.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return e.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return e.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return e.ParameterStructures}});const n=nn;Object.defineProperty(t,"LinkedMap",{enumerable:!0,get:function(){return n.LinkedMap}}),Object.defineProperty(t,"LRUCache",{enumerable:!0,get:function(){return n.LRUCache}}),Object.defineProperty(t,"Touch",{enumerable:!0,get:function(){return n.Touch}});const i=Zi;Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return i.Disposable}});const r=Wt;Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return r.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return r.Emitter}});const o=vn;Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return o.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return o.CancellationToken}});const s=Jn;Object.defineProperty(t,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return s.SharedArraySenderStrategy}}),Object.defineProperty(t,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return s.SharedArrayReceiverStrategy}});const a=Cn;Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return a.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return a.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return a.ReadableStreamMessageReader}});const u=_n;Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return u.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return u.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return u.WriteableStreamMessageWriter}});const l=tr;Object.defineProperty(t,"AbstractMessageBuffer",{enumerable:!0,get:function(){return l.AbstractMessageBuffer}});const f=dc;Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return f.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return f.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return f.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return f.createMessageConnection}}),Object.defineProperty(t,"ProgressToken",{enumerable:!0,get:function(){return f.ProgressToken}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return f.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return f.Trace}}),Object.defineProperty(t,"TraceValues",{enumerable:!0,get:function(){return f.TraceValues}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return f.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return f.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return f.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return f.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return f.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return f.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return f.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return f.CancellationStrategy}}),Object.defineProperty(t,"MessageStrategy",{enumerable:!0,get:function(){return f.MessageStrategy}});const m=rn;t.RAL=m.default}(Yi),Object.defineProperty(Eo,"__esModule",{value:!0});const Kt=Yi;class Po extends Kt.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return Po.emptyBuffer}fromString(e,n){return new TextEncoder().encode(e)}toString(e,n){return n==="ascii"?this.asciiDecoder.decode(e):new TextDecoder(n).decode(e)}asNative(e,n){return n===void 0?e:e.slice(0,n)}allocNative(e){return new Uint8Array(e)}}Po.emptyBuffer=new Uint8Array(0);class $d{constructor(e){this.socket=e,this._onData=new Kt.Emitter,this._messageListener=n=>{n.data.arrayBuffer().then(r=>{this._onData.fire(new Uint8Array(r))},()=>{(0,Kt.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),Kt.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),Kt.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),Kt.Disposable.create(()=>this.socket.removeEventListener("end",e))}onData(e){return this._onData.event(e)}}class Hd{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),Kt.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),Kt.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),Kt.Disposable.create(()=>this.socket.removeEventListener("end",e))}write(e,n){if(typeof e=="string"){if(n!==void 0&&n!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${n}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const Wd=new TextEncoder,fc=Object.freeze({messageBuffer:Object.freeze({create:t=>new Po(t)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(t,e)=>{if(e.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${e.charset}`);return Promise.resolve(Wd.encode(JSON.stringify(t,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(t,e)=>{if(!(t instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(e.charset).decode(t)))}})}),stream:Object.freeze({asReadableStream:t=>new $d(t),asWritableStream:t=>new Hd(t)}),console,timer:Object.freeze({setTimeout(t,e,...n){const i=setTimeout(t,e,...n);return{dispose:()=>clearTimeout(i)}},setImmediate(t,...e){const n=setTimeout(t,0,...e);return{dispose:()=>clearTimeout(n)}},setInterval(t,e,...n){const i=setInterval(t,e,...n);return{dispose:()=>clearInterval(i)}}})});function Ao(){return fc}(function(t){function e(){Kt.RAL.install(fc)}t.install=e})(Ao||(Ao={})),Eo.default=Ao,function(t){var e=Ie&&Ie.__createBinding||(Object.create?function(u,l,f,m){m===void 0&&(m=f);var p=Object.getOwnPropertyDescriptor(l,f);(!p||("get"in p?!l.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return l[f]}}),Object.defineProperty(u,m,p)}:function(u,l,f,m){m===void 0&&(m=f),u[m]=l[f]}),n=Ie&&Ie.__exportStar||function(u,l){for(var f in u)f!=="default"&&!Object.prototype.hasOwnProperty.call(l,f)&&e(l,u,f)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.BrowserMessageWriter=t.BrowserMessageReader=void 0,Eo.default.install();const r=Yi;n(Yi,t);class o extends r.AbstractMessageReader{constructor(l){super(),this._onData=new r.Emitter,this._messageListener=f=>{this._onData.fire(f.data)},l.addEventListener("error",f=>this.fireError(f)),l.onmessage=this._messageListener}listen(l){return this._onData.event(l)}}t.BrowserMessageReader=o;class s extends r.AbstractMessageWriter{constructor(l){super(),this.port=l,this.errorCount=0,l.addEventListener("error",f=>this.fireError(f))}write(l){try{return this.port.postMessage(l),Promise.resolve()}catch(f){return this.handleError(f,l),Promise.reject(f)}}handleError(l,f){this.errorCount++,this.fireError(l,f,this.errorCount)}end(){}}t.BrowserMessageWriter=s;function a(u,l,f,m){return f===void 0&&(f=r.NullLogger),r.ConnectionStrategy.is(m)&&(m={connectionStrategy:m}),(0,r.createMessageConnection)(u,l,f,m)}t.createMessageConnection=a}(On);var gc=On,hc={},$o;(function(t){function e(n){return typeof n=="string"}t.is=e})($o||($o={}));var nr;(function(t){function e(n){return typeof n=="string"}t.is=e})(nr||(nr={}));var Ho;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})(Ho||(Ho={}));var wi;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})(wi||(wi={}));var Dt;(function(t){function e(i,r){return i===Number.MAX_VALUE&&(i=wi.MAX_VALUE),r===Number.MAX_VALUE&&(r=wi.MAX_VALUE),{line:i,character:r}}t.create=e;function n(i){let r=i;return _.objectLiteral(r)&&_.uinteger(r.line)&&_.uinteger(r.character)}t.is=n})(Dt||(Dt={}));var Ee;(function(t){function e(i,r,o,s){if(_.uinteger(i)&&_.uinteger(r)&&_.uinteger(o)&&_.uinteger(s))return{start:Dt.create(i,r),end:Dt.create(o,s)};if(Dt.is(i)&&Dt.is(r))return{start:i,end:r};throw new Error(`Range#create called with invalid arguments[${i}, ${r}, ${o}, ${s}]`)}t.create=e;function n(i){let r=i;return _.objectLiteral(r)&&Dt.is(r.start)&&Dt.is(r.end)}t.is=n})(Ee||(Ee={}));var Si;(function(t){function e(i,r){return{uri:i,range:r}}t.create=e;function n(i){let r=i;return _.objectLiteral(r)&&Ee.is(r.range)&&(_.string(r.uri)||_.undefined(r.uri))}t.is=n})(Si||(Si={}));var Wo;(function(t){function e(i,r,o,s){return{targetUri:i,targetRange:r,targetSelectionRange:o,originSelectionRange:s}}t.create=e;function n(i){let r=i;return _.objectLiteral(r)&&Ee.is(r.targetRange)&&_.string(r.targetUri)&&Ee.is(r.targetSelectionRange)&&(Ee.is(r.originSelectionRange)||_.undefined(r.originSelectionRange))}t.is=n})(Wo||(Wo={}));var ir;(function(t){function e(i,r,o,s){return{red:i,green:r,blue:o,alpha:s}}t.create=e;function n(i){const r=i;return _.objectLiteral(r)&&_.numberRange(r.red,0,1)&&_.numberRange(r.green,0,1)&&_.numberRange(r.blue,0,1)&&_.numberRange(r.alpha,0,1)}t.is=n})(ir||(ir={}));var Ko;(function(t){function e(i,r){return{range:i,color:r}}t.create=e;function n(i){const r=i;return _.objectLiteral(r)&&Ee.is(r.range)&&ir.is(r.color)}t.is=n})(Ko||(Ko={}));var Uo;(function(t){function e(i,r,o){return{label:i,textEdit:r,additionalTextEdits:o}}t.create=e;function n(i){const r=i;return _.objectLiteral(r)&&_.string(r.label)&&(_.undefined(r.textEdit)||Ut.is(r))&&(_.undefined(r.additionalTextEdits)||_.typedArray(r.additionalTextEdits,Ut.is))}t.is=n})(Uo||(Uo={}));var zo;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(zo||(zo={}));var Bo;(function(t){function e(i,r,o,s,a,u){const l={startLine:i,endLine:r};return _.defined(o)&&(l.startCharacter=o),_.defined(s)&&(l.endCharacter=s),_.defined(a)&&(l.kind=a),_.defined(u)&&(l.collapsedText=u),l}t.create=e;function n(i){const r=i;return _.objectLiteral(r)&&_.uinteger(r.startLine)&&_.uinteger(r.startLine)&&(_.undefined(r.startCharacter)||_.uinteger(r.startCharacter))&&(_.undefined(r.endCharacter)||_.uinteger(r.endCharacter))&&(_.undefined(r.kind)||_.string(r.kind))}t.is=n})(Bo||(Bo={}));var rr;(function(t){function e(i,r){return{location:i,message:r}}t.create=e;function n(i){let r=i;return _.defined(r)&&Si.is(r.location)&&_.string(r.message)}t.is=n})(rr||(rr={}));var Vo;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(Vo||(Vo={}));var Jo;(function(t){t.Unnecessary=1,t.Deprecated=2})(Jo||(Jo={}));var Qo;(function(t){function e(n){const i=n;return _.objectLiteral(i)&&_.string(i.href)}t.is=e})(Qo||(Qo={}));var Ri;(function(t){function e(i,r,o,s,a,u){let l={range:i,message:r};return _.defined(o)&&(l.severity=o),_.defined(s)&&(l.code=s),_.defined(a)&&(l.source=a),_.defined(u)&&(l.relatedInformation=u),l}t.create=e;function n(i){var r;let o=i;return _.defined(o)&&Ee.is(o.range)&&_.string(o.message)&&(_.number(o.severity)||_.undefined(o.severity))&&(_.integer(o.code)||_.string(o.code)||_.undefined(o.code))&&(_.undefined(o.codeDescription)||_.string((r=o.codeDescription)===null||r===void 0?void 0:r.href))&&(_.string(o.source)||_.undefined(o.source))&&(_.undefined(o.relatedInformation)||_.typedArray(o.relatedInformation,rr.is))}t.is=n})(Ri||(Ri={}));var Mn;(function(t){function e(i,r,...o){let s={title:i,command:r};return _.defined(o)&&o.length>0&&(s.arguments=o),s}t.create=e;function n(i){let r=i;return _.defined(r)&&_.string(r.title)&&_.string(r.command)}t.is=n})(Mn||(Mn={}));var Ut;(function(t){function e(o,s){return{range:o,newText:s}}t.replace=e;function n(o,s){return{range:{start:o,end:o},newText:s}}t.insert=n;function i(o){return{range:o,newText:""}}t.del=i;function r(o){const s=o;return _.objectLiteral(s)&&_.string(s.newText)&&Ee.is(s.range)}t.is=r})(Ut||(Ut={}));var In;(function(t){function e(i,r,o){const s={label:i};return r!==void 0&&(s.needsConfirmation=r),o!==void 0&&(s.description=o),s}t.create=e;function n(i){const r=i;return _.objectLiteral(r)&&_.string(r.label)&&(_.boolean(r.needsConfirmation)||r.needsConfirmation===void 0)&&(_.string(r.description)||r.description===void 0)}t.is=n})(In||(In={}));var Ve;(function(t){function e(n){const i=n;return _.string(i)}t.is=e})(Ve||(Ve={}));var on;(function(t){function e(o,s,a){return{range:o,newText:s,annotationId:a}}t.replace=e;function n(o,s,a){return{range:{start:o,end:o},newText:s,annotationId:a}}t.insert=n;function i(o,s){return{range:o,newText:"",annotationId:s}}t.del=i;function r(o){const s=o;return Ut.is(s)&&(In.is(s.annotationId)||Ve.is(s.annotationId))}t.is=r})(on||(on={}));var Ti;(function(t){function e(i,r){return{textDocument:i,edits:r}}t.create=e;function n(i){let r=i;return _.defined(r)&&Pi.is(r.textDocument)&&Array.isArray(r.edits)}t.is=n})(Ti||(Ti={}));var Gn;(function(t){function e(i,r,o){let s={kind:"create",uri:i};return r!==void 0&&(r.overwrite!==void 0||r.ignoreIfExists!==void 0)&&(s.options=r),o!==void 0&&(s.annotationId=o),s}t.create=e;function n(i){let r=i;return r&&r.kind==="create"&&_.string(r.uri)&&(r.options===void 0||(r.options.overwrite===void 0||_.boolean(r.options.overwrite))&&(r.options.ignoreIfExists===void 0||_.boolean(r.options.ignoreIfExists)))&&(r.annotationId===void 0||Ve.is(r.annotationId))}t.is=n})(Gn||(Gn={}));var Xn;(function(t){function e(i,r,o,s){let a={kind:"rename",oldUri:i,newUri:r};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(a.options=o),s!==void 0&&(a.annotationId=s),a}t.create=e;function n(i){let r=i;return r&&r.kind==="rename"&&_.string(r.oldUri)&&_.string(r.newUri)&&(r.options===void 0||(r.options.overwrite===void 0||_.boolean(r.options.overwrite))&&(r.options.ignoreIfExists===void 0||_.boolean(r.options.ignoreIfExists)))&&(r.annotationId===void 0||Ve.is(r.annotationId))}t.is=n})(Xn||(Xn={}));var Yn;(function(t){function e(i,r,o){let s={kind:"delete",uri:i};return r!==void 0&&(r.recursive!==void 0||r.ignoreIfNotExists!==void 0)&&(s.options=r),o!==void 0&&(s.annotationId=o),s}t.create=e;function n(i){let r=i;return r&&r.kind==="delete"&&_.string(r.uri)&&(r.options===void 0||(r.options.recursive===void 0||_.boolean(r.options.recursive))&&(r.options.ignoreIfNotExists===void 0||_.boolean(r.options.ignoreIfNotExists)))&&(r.annotationId===void 0||Ve.is(r.annotationId))}t.is=n})(Yn||(Yn={}));var or;(function(t){function e(n){let i=n;return i&&(i.changes!==void 0||i.documentChanges!==void 0)&&(i.documentChanges===void 0||i.documentChanges.every(r=>_.string(r.kind)?Gn.is(r)||Xn.is(r)||Yn.is(r):Ti.is(r)))}t.is=e})(or||(or={}));class sr{constructor(e,n){this.edits=e,this.changeAnnotations=n}insert(e,n,i){let r,o;if(i===void 0?r=Ut.insert(e,n):Ve.is(i)?(o=i,r=on.insert(e,n,i)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(i),r=on.insert(e,n,o)),this.edits.push(r),o!==void 0)return o}replace(e,n,i){let r,o;if(i===void 0?r=Ut.replace(e,n):Ve.is(i)?(o=i,r=on.replace(e,n,i)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(i),r=on.replace(e,n,o)),this.edits.push(r),o!==void 0)return o}delete(e,n){let i,r;if(n===void 0?i=Ut.del(e):Ve.is(n)?(r=n,i=on.del(e,n)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(n),i=on.del(e,r)),this.edits.push(i),r!==void 0)return r}add(e){this.edits.push(e)}all(){return this.edits}clear(){this.edits.splice(0,this.edits.length)}assertChangeAnnotations(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")}}class pc{constructor(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}all(){return this._annotations}get size(){return this._size}manage(e,n){let i;if(Ve.is(e)?i=e:(i=this.nextId(),n=e),this._annotations[i]!==void 0)throw new Error(`Id ${i} is already in use.`);if(n===void 0)throw new Error(`No annotation provided for id ${i}`);return this._annotations[i]=n,this._size++,i}nextId(){return this._counter++,this._counter.toString()}}class Kd{constructor(e){this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new pc(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(n=>{if(Ti.is(n)){const i=new sr(n.edits,this._changeAnnotations);this._textEditChanges[n.textDocument.uri]=i}})):e.changes&&Object.keys(e.changes).forEach(n=>{const i=new sr(e.changes[n]);this._textEditChanges[n]=i})):this._workspaceEdit={}}get edit(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit}getTextEditChange(e){if(Pi.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");const n={uri:e.uri,version:e.version};let i=this._textEditChanges[n.uri];if(!i){const r=[],o={textDocument:n,edits:r};this._workspaceEdit.documentChanges.push(o),i=new sr(r,this._changeAnnotations),this._textEditChanges[n.uri]=i}return i}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");let n=this._textEditChanges[e];if(!n){let i=[];this._workspaceEdit.changes[e]=i,n=new sr(i),this._textEditChanges[e]=n}return n}}initDocumentChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new pc,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())}initChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))}createFile(e,n,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let r;In.is(n)||Ve.is(n)?r=n:i=n;let o,s;if(r===void 0?o=Gn.create(e,i):(s=Ve.is(r)?r:this._changeAnnotations.manage(r),o=Gn.create(e,i,s)),this._workspaceEdit.documentChanges.push(o),s!==void 0)return s}renameFile(e,n,i,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let o;In.is(i)||Ve.is(i)?o=i:r=i;let s,a;if(o===void 0?s=Xn.create(e,n,r):(a=Ve.is(o)?o:this._changeAnnotations.manage(o),s=Xn.create(e,n,r,a)),this._workspaceEdit.documentChanges.push(s),a!==void 0)return a}deleteFile(e,n,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let r;In.is(n)||Ve.is(n)?r=n:i=n;let o,s;if(r===void 0?o=Yn.create(e,i):(s=Ve.is(r)?r:this._changeAnnotations.manage(r),o=Yn.create(e,i,s)),this._workspaceEdit.documentChanges.push(o),s!==void 0)return s}}var Go;(function(t){function e(i){return{uri:i}}t.create=e;function n(i){let r=i;return _.defined(r)&&_.string(r.uri)}t.is=n})(Go||(Go={}));var Xo;(function(t){function e(i,r){return{uri:i,version:r}}t.create=e;function n(i){let r=i;return _.defined(r)&&_.string(r.uri)&&_.integer(r.version)}t.is=n})(Xo||(Xo={}));var Pi;(function(t){function e(i,r){return{uri:i,version:r}}t.create=e;function n(i){let r=i;return _.defined(r)&&_.string(r.uri)&&(r.version===null||_.integer(r.version))}t.is=n})(Pi||(Pi={}));var Yo;(function(t){function e(i,r,o,s){return{uri:i,languageId:r,version:o,text:s}}t.create=e;function n(i){let r=i;return _.defined(r)&&_.string(r.uri)&&_.string(r.languageId)&&_.integer(r.version)&&_.string(r.text)}t.is=n})(Yo||(Yo={}));var ar;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function e(n){const i=n;return i===t.PlainText||i===t.Markdown}t.is=e})(ar||(ar={}));var Zn;(function(t){function e(n){const i=n;return _.objectLiteral(n)&&ar.is(i.kind)&&_.string(i.value)}t.is=e})(Zn||(Zn={}));var Zo;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Zo||(Zo={}));var es;(function(t){t.PlainText=1,t.Snippet=2})(es||(es={}));var ts;(function(t){t.Deprecated=1})(ts||(ts={}));var ns;(function(t){function e(i,r,o){return{newText:i,insert:r,replace:o}}t.create=e;function n(i){const r=i;return r&&_.string(r.newText)&&Ee.is(r.insert)&&Ee.is(r.replace)}t.is=n})(ns||(ns={}));var is;(function(t){t.asIs=1,t.adjustIndentation=2})(is||(is={}));var rs;(function(t){function e(n){const i=n;return i&&(_.string(i.detail)||i.detail===void 0)&&(_.string(i.description)||i.description===void 0)}t.is=e})(rs||(rs={}));var os;(function(t){function e(n){return{label:n}}t.create=e})(os||(os={}));var ss;(function(t){function e(n,i){return{items:n||[],isIncomplete:!!i}}t.create=e})(ss||(ss={}));var ki;(function(t){function e(i){return i.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=e;function n(i){const r=i;return _.string(r)||_.objectLiteral(r)&&_.string(r.language)&&_.string(r.value)}t.is=n})(ki||(ki={}));var as;(function(t){function e(n){let i=n;return!!i&&_.objectLiteral(i)&&(Zn.is(i.contents)||ki.is(i.contents)||_.typedArray(i.contents,ki.is))&&(n.range===void 0||Ee.is(n.range))}t.is=e})(as||(as={}));var cs;(function(t){function e(n,i){return i?{label:n,documentation:i}:{label:n}}t.create=e})(cs||(cs={}));var us;(function(t){function e(n,i,...r){let o={label:n};return _.defined(i)&&(o.documentation=i),_.defined(r)?o.parameters=r:o.parameters=[],o}t.create=e})(us||(us={}));var ls;(function(t){t.Text=1,t.Read=2,t.Write=3})(ls||(ls={}));var ds;(function(t){function e(n,i){let r={range:n};return _.number(i)&&(r.kind=i),r}t.create=e})(ds||(ds={}));var fs;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(fs||(fs={}));var gs;(function(t){t.Deprecated=1})(gs||(gs={}));var hs;(function(t){function e(n,i,r,o,s){let a={name:n,kind:i,location:{uri:o,range:r}};return s&&(a.containerName=s),a}t.create=e})(hs||(hs={}));var ps;(function(t){function e(n,i,r,o){return o!==void 0?{name:n,kind:i,location:{uri:r,range:o}}:{name:n,kind:i,location:{uri:r}}}t.create=e})(ps||(ps={}));var ms;(function(t){function e(i,r,o,s,a,u){let l={name:i,detail:r,kind:o,range:s,selectionRange:a};return u!==void 0&&(l.children=u),l}t.create=e;function n(i){let r=i;return r&&_.string(r.name)&&_.number(r.kind)&&Ee.is(r.range)&&Ee.is(r.selectionRange)&&(r.detail===void 0||_.string(r.detail))&&(r.deprecated===void 0||_.boolean(r.deprecated))&&(r.children===void 0||Array.isArray(r.children))&&(r.tags===void 0||Array.isArray(r.tags))}t.is=n})(ms||(ms={}));var ys;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(ys||(ys={}));var Fi;(function(t){t.Invoked=1,t.Automatic=2})(Fi||(Fi={}));var vs;(function(t){function e(i,r,o){let s={diagnostics:i};return r!=null&&(s.only=r),o!=null&&(s.triggerKind=o),s}t.create=e;function n(i){let r=i;return _.defined(r)&&_.typedArray(r.diagnostics,Ri.is)&&(r.only===void 0||_.typedArray(r.only,_.string))&&(r.triggerKind===void 0||r.triggerKind===Fi.Invoked||r.triggerKind===Fi.Automatic)}t.is=n})(vs||(vs={}));var Cs;(function(t){function e(i,r,o){let s={title:i},a=!0;return typeof r=="string"?(a=!1,s.kind=r):Mn.is(r)?s.command=r:s.edit=r,a&&o!==void 0&&(s.kind=o),s}t.create=e;function n(i){let r=i;return r&&_.string(r.title)&&(r.diagnostics===void 0||_.typedArray(r.diagnostics,Ri.is))&&(r.kind===void 0||_.string(r.kind))&&(r.edit!==void 0||r.command!==void 0)&&(r.command===void 0||Mn.is(r.command))&&(r.isPreferred===void 0||_.boolean(r.isPreferred))&&(r.edit===void 0||or.is(r.edit))}t.is=n})(Cs||(Cs={}));var _s;(function(t){function e(i,r){let o={range:i};return _.defined(r)&&(o.data=r),o}t.create=e;function n(i){let r=i;return _.defined(r)&&Ee.is(r.range)&&(_.undefined(r.command)||Mn.is(r.command))}t.is=n})(_s||(_s={}));var Ds;(function(t){function e(i,r){return{tabSize:i,insertSpaces:r}}t.create=e;function n(i){let r=i;return _.defined(r)&&_.uinteger(r.tabSize)&&_.boolean(r.insertSpaces)}t.is=n})(Ds||(Ds={}));var bs;(function(t){function e(i,r,o){return{range:i,target:r,data:o}}t.create=e;function n(i){let r=i;return _.defined(r)&&Ee.is(r.range)&&(_.undefined(r.target)||_.string(r.target))}t.is=n})(bs||(bs={}));var ws;(function(t){function e(i,r){return{range:i,parent:r}}t.create=e;function n(i){let r=i;return _.objectLiteral(r)&&Ee.is(r.range)&&(r.parent===void 0||t.is(r.parent))}t.is=n})(ws||(ws={}));var Ss;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="keyword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(Ss||(Ss={}));var Rs;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(Rs||(Rs={}));var Ts;(function(t){function e(n){const i=n;return _.objectLiteral(i)&&(i.resultId===void 0||typeof i.resultId=="string")&&Array.isArray(i.data)&&(i.data.length===0||typeof i.data[0]=="number")}t.is=e})(Ts||(Ts={}));var Ps;(function(t){function e(i,r){return{range:i,text:r}}t.create=e;function n(i){const r=i;return r!=null&&Ee.is(r.range)&&_.string(r.text)}t.is=n})(Ps||(Ps={}));var ks;(function(t){function e(i,r,o){return{range:i,variableName:r,caseSensitiveLookup:o}}t.create=e;function n(i){const r=i;return r!=null&&Ee.is(r.range)&&_.boolean(r.caseSensitiveLookup)&&(_.string(r.variableName)||r.variableName===void 0)}t.is=n})(ks||(ks={}));var Fs;(function(t){function e(i,r){return{range:i,expression:r}}t.create=e;function n(i){const r=i;return r!=null&&Ee.is(r.range)&&(_.string(r.expression)||r.expression===void 0)}t.is=n})(Fs||(Fs={}));var Es;(function(t){function e(i,r){return{frameId:i,stoppedLocation:r}}t.create=e;function n(i){const r=i;return _.defined(r)&&Ee.is(i.stoppedLocation)}t.is=n})(Es||(Es={}));var cr;(function(t){t.Type=1,t.Parameter=2;function e(n){return n===1||n===2}t.is=e})(cr||(cr={}));var ur;(function(t){function e(i){return{value:i}}t.create=e;function n(i){const r=i;return _.objectLiteral(r)&&(r.tooltip===void 0||_.string(r.tooltip)||Zn.is(r.tooltip))&&(r.location===void 0||Si.is(r.location))&&(r.command===void 0||Mn.is(r.command))}t.is=n})(ur||(ur={}));var Os;(function(t){function e(i,r,o){const s={position:i,label:r};return o!==void 0&&(s.kind=o),s}t.create=e;function n(i){const r=i;return _.objectLiteral(r)&&Dt.is(r.position)&&(_.string(r.label)||_.typedArray(r.label,ur.is))&&(r.kind===void 0||cr.is(r.kind))&&r.textEdits===void 0||_.typedArray(r.textEdits,Ut.is)&&(r.tooltip===void 0||_.string(r.tooltip)||Zn.is(r.tooltip))&&(r.paddingLeft===void 0||_.boolean(r.paddingLeft))&&(r.paddingRight===void 0||_.boolean(r.paddingRight))}t.is=n})(Os||(Os={}));var qs;(function(t){function e(n){return{kind:"snippet",value:n}}t.createSnippet=e})(qs||(qs={}));var Ms;(function(t){function e(n,i,r,o){return{insertText:n,filterText:i,range:r,command:o}}t.create=e})(Ms||(Ms={}));var Is;(function(t){function e(n){return{items:n}}t.create=e})(Is||(Is={}));var xs;(function(t){t.Invoked=0,t.Automatic=1})(xs||(xs={}));var Ns;(function(t){function e(n,i){return{range:n,text:i}}t.create=e})(Ns||(Ns={}));var Ls;(function(t){function e(n,i){return{triggerKind:n,selectedCompletionInfo:i}}t.create=e})(Ls||(Ls={}));var js;(function(t){function e(n){const i=n;return _.objectLiteral(i)&&nr.is(i.uri)&&_.string(i.name)}t.is=e})(js||(js={}));const Ud=[`
`,`\r
`,"\r"];var As;(function(t){function e(o,s,a,u){return new zd(o,s,a,u)}t.create=e;function n(o){let s=o;return!!(_.defined(s)&&_.string(s.uri)&&(_.undefined(s.languageId)||_.string(s.languageId))&&_.uinteger(s.lineCount)&&_.func(s.getText)&&_.func(s.positionAt)&&_.func(s.offsetAt))}t.is=n;function i(o,s){let a=o.getText(),u=r(s,(f,m)=>{let p=f.range.start.line-m.range.start.line;return p===0?f.range.start.character-m.range.start.character:p}),l=a.length;for(let f=u.length-1;f>=0;f--){let m=u[f],p=o.offsetAt(m.range.start),C=o.offsetAt(m.range.end);if(C<=l)a=a.substring(0,p)+m.newText+a.substring(C,a.length);else throw new Error("Overlapping edit");l=p}return a}t.applyEdits=i;function r(o,s){if(o.length<=1)return o;const a=o.length/2|0,u=o.slice(0,a),l=o.slice(a);r(u,s),r(l,s);let f=0,m=0,p=0;for(;f<u.length&&m<l.length;)s(u[f],l[m])<=0?o[p++]=u[f++]:o[p++]=l[m++];for(;f<u.length;)o[p++]=u[f++];for(;m<l.length;)o[p++]=l[m++];return o}})(As||(As={}));class zd{constructor(e,n,i,r){this._uri=e,this._languageId=n,this._version=i,this._content=r,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let n=this.offsetAt(e.start),i=this.offsetAt(e.end);return this._content.substring(n,i)}return this._content}update(e,n){this._content=e.text,this._version=n,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let e=[],n=this._content,i=!0;for(let r=0;r<n.length;r++){i&&(e.push(r),i=!1);let o=n.charAt(r);i=o==="\r"||o===`
`,o==="\r"&&r+1<n.length&&n.charAt(r+1)===`
`&&r++}i&&n.length>0&&e.push(n.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let n=this.getLineOffsets(),i=0,r=n.length;if(r===0)return Dt.create(0,e);for(;i<r;){let s=Math.floor((i+r)/2);n[s]>e?r=s:i=s+1}let o=i-1;return Dt.create(o,e-n[o])}offsetAt(e){let n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;let i=n[e.line],r=e.line+1<n.length?n[e.line+1]:this._content.length;return Math.max(Math.min(i+e.character,r),i)}get lineCount(){return this.getLineOffsets().length}}var _;(function(t){const e=Object.prototype.toString;function n(C){return typeof C<"u"}t.defined=n;function i(C){return typeof C>"u"}t.undefined=i;function r(C){return C===!0||C===!1}t.boolean=r;function o(C){return e.call(C)==="[object String]"}t.string=o;function s(C){return e.call(C)==="[object Number]"}t.number=s;function a(C,h,w){return e.call(C)==="[object Number]"&&h<=C&&C<=w}t.numberRange=a;function u(C){return e.call(C)==="[object Number]"&&-2147483648<=C&&C<=2147483647}t.integer=u;function l(C){return e.call(C)==="[object Number]"&&0<=C&&C<=2147483647}t.uinteger=l;function f(C){return e.call(C)==="[object Function]"}t.func=f;function m(C){return C!==null&&typeof C=="object"}t.objectLiteral=m;function p(C,h){return Array.isArray(C)&&C.every(h)}t.typedArray=p})(_||(_={}));var Bd=Object.freeze({__proto__:null,get AnnotatedTextEdit(){return on},get ChangeAnnotation(){return In},get ChangeAnnotationIdentifier(){return Ve},get CodeAction(){return Cs},get CodeActionContext(){return vs},get CodeActionKind(){return ys},get CodeActionTriggerKind(){return Fi},get CodeDescription(){return Qo},get CodeLens(){return _s},get Color(){return ir},get ColorInformation(){return Ko},get ColorPresentation(){return Uo},get Command(){return Mn},get CompletionItem(){return os},get CompletionItemKind(){return Zo},get CompletionItemLabelDetails(){return rs},get CompletionItemTag(){return ts},get CompletionList(){return ss},get CreateFile(){return Gn},get DeleteFile(){return Yn},get Diagnostic(){return Ri},get DiagnosticRelatedInformation(){return rr},get DiagnosticSeverity(){return Vo},get DiagnosticTag(){return Jo},get DocumentHighlight(){return ds},get DocumentHighlightKind(){return ls},get DocumentLink(){return bs},get DocumentSymbol(){return ms},get DocumentUri(){return $o},EOL:Ud,get FoldingRange(){return Bo},get FoldingRangeKind(){return zo},get FormattingOptions(){return Ds},get Hover(){return as},get InlayHint(){return Os},get InlayHintKind(){return cr},get InlayHintLabelPart(){return ur},get InlineCompletionContext(){return Ls},get InlineCompletionItem(){return Ms},get InlineCompletionList(){return Is},get InlineCompletionTriggerKind(){return xs},get InlineValueContext(){return Es},get InlineValueEvaluatableExpression(){return Fs},get InlineValueText(){return Ps},get InlineValueVariableLookup(){return ks},get InsertReplaceEdit(){return ns},get InsertTextFormat(){return es},get InsertTextMode(){return is},get Location(){return Si},get LocationLink(){return Wo},get MarkedString(){return ki},get MarkupContent(){return Zn},get MarkupKind(){return ar},get OptionalVersionedTextDocumentIdentifier(){return Pi},get ParameterInformation(){return cs},get Position(){return Dt},get Range(){return Ee},get RenameFile(){return Xn},get SelectedCompletionInfo(){return Ns},get SelectionRange(){return ws},get SemanticTokenModifiers(){return Rs},get SemanticTokenTypes(){return Ss},get SemanticTokens(){return Ts},get SignatureInformation(){return us},get StringValue(){return qs},get SymbolInformation(){return hs},get SymbolKind(){return fs},get SymbolTag(){return gs},get TextDocument(){return As},get TextDocumentEdit(){return Ti},get TextDocumentIdentifier(){return Go},get TextDocumentItem(){return Yo},get TextEdit(){return Ut},get URI(){return nr},get VersionedTextDocumentIdentifier(){return Xo},WorkspaceChange:Kd,get WorkspaceEdit(){return or},get WorkspaceFolder(){return js},get WorkspaceSymbol(){return ps},get integer(){return Ho},get uinteger(){return wi}}),$s=Ll(Bd),ie={};Object.defineProperty(ie,"__esModule",{value:!0}),ie.ProtocolNotificationType=ie.ProtocolNotificationType0=ie.ProtocolRequestType=ie.ProtocolRequestType0=ie.RegistrationType=ie.MessageDirection=void 0;const ei=On;var mc;(function(t){t.clientToServer="clientToServer",t.serverToClient="serverToClient",t.both="both"})(mc||(ie.MessageDirection=mc={}));class Vd{constructor(e){this.method=e}}ie.RegistrationType=Vd;class Jd extends ei.RequestType0{constructor(e){super(e)}}ie.ProtocolRequestType0=Jd;class Qd extends ei.RequestType{constructor(e){super(e,ei.ParameterStructures.byName)}}ie.ProtocolRequestType=Qd;class Gd extends ei.NotificationType0{constructor(e){super(e)}}ie.ProtocolNotificationType0=Gd;class Xd extends ei.NotificationType{constructor(e){super(e,ei.ParameterStructures.byName)}}ie.ProtocolNotificationType=Xd;var yc={},Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.objectLiteral=Oe.typedArray=Oe.stringArray=Oe.array=Oe.func=Oe.error=Oe.number=Oe.string=Oe.boolean=void 0;function Yd(t){return t===!0||t===!1}Oe.boolean=Yd;function vc(t){return typeof t=="string"||t instanceof String}Oe.string=vc;function Zd(t){return typeof t=="number"||t instanceof Number}Oe.number=Zd;function ef(t){return t instanceof Error}Oe.error=ef;function tf(t){return typeof t=="function"}Oe.func=tf;function Cc(t){return Array.isArray(t)}Oe.array=Cc;function nf(t){return Cc(t)&&t.every(e=>vc(e))}Oe.stringArray=nf;function rf(t,e){return Array.isArray(t)&&t.every(e)}Oe.typedArray=rf;function of(t){return t!==null&&typeof t=="object"}Oe.objectLiteral=of;var lr={};Object.defineProperty(lr,"__esModule",{value:!0}),lr.ImplementationRequest=void 0;const _c=ie;var Dc;(function(t){t.method="textDocument/implementation",t.messageDirection=_c.MessageDirection.clientToServer,t.type=new _c.ProtocolRequestType(t.method)})(Dc||(lr.ImplementationRequest=Dc={}));var dr={};Object.defineProperty(dr,"__esModule",{value:!0}),dr.TypeDefinitionRequest=void 0;const bc=ie;var wc;(function(t){t.method="textDocument/typeDefinition",t.messageDirection=bc.MessageDirection.clientToServer,t.type=new bc.ProtocolRequestType(t.method)})(wc||(dr.TypeDefinitionRequest=wc={}));var ti={};Object.defineProperty(ti,"__esModule",{value:!0}),ti.DidChangeWorkspaceFoldersNotification=ti.WorkspaceFoldersRequest=void 0;const fr=ie;var Sc;(function(t){t.method="workspace/workspaceFolders",t.messageDirection=fr.MessageDirection.serverToClient,t.type=new fr.ProtocolRequestType0(t.method)})(Sc||(ti.WorkspaceFoldersRequest=Sc={}));var Rc;(function(t){t.method="workspace/didChangeWorkspaceFolders",t.messageDirection=fr.MessageDirection.clientToServer,t.type=new fr.ProtocolNotificationType(t.method)})(Rc||(ti.DidChangeWorkspaceFoldersNotification=Rc={}));var gr={};Object.defineProperty(gr,"__esModule",{value:!0}),gr.ConfigurationRequest=void 0;const Tc=ie;var Pc;(function(t){t.method="workspace/configuration",t.messageDirection=Tc.MessageDirection.serverToClient,t.type=new Tc.ProtocolRequestType(t.method)})(Pc||(gr.ConfigurationRequest=Pc={}));var ni={};Object.defineProperty(ni,"__esModule",{value:!0}),ni.ColorPresentationRequest=ni.DocumentColorRequest=void 0;const hr=ie;var kc;(function(t){t.method="textDocument/documentColor",t.messageDirection=hr.MessageDirection.clientToServer,t.type=new hr.ProtocolRequestType(t.method)})(kc||(ni.DocumentColorRequest=kc={}));var Fc;(function(t){t.method="textDocument/colorPresentation",t.messageDirection=hr.MessageDirection.clientToServer,t.type=new hr.ProtocolRequestType(t.method)})(Fc||(ni.ColorPresentationRequest=Fc={}));var ii={};Object.defineProperty(ii,"__esModule",{value:!0}),ii.FoldingRangeRefreshRequest=ii.FoldingRangeRequest=void 0;const pr=ie;var Ec;(function(t){t.method="textDocument/foldingRange",t.messageDirection=pr.MessageDirection.clientToServer,t.type=new pr.ProtocolRequestType(t.method)})(Ec||(ii.FoldingRangeRequest=Ec={}));var Oc;(function(t){t.method="workspace/foldingRange/refresh",t.messageDirection=pr.MessageDirection.serverToClient,t.type=new pr.ProtocolRequestType0(t.method)})(Oc||(ii.FoldingRangeRefreshRequest=Oc={}));var mr={};Object.defineProperty(mr,"__esModule",{value:!0}),mr.DeclarationRequest=void 0;const qc=ie;var Mc;(function(t){t.method="textDocument/declaration",t.messageDirection=qc.MessageDirection.clientToServer,t.type=new qc.ProtocolRequestType(t.method)})(Mc||(mr.DeclarationRequest=Mc={}));var yr={};Object.defineProperty(yr,"__esModule",{value:!0}),yr.SelectionRangeRequest=void 0;const Ic=ie;var xc;(function(t){t.method="textDocument/selectionRange",t.messageDirection=Ic.MessageDirection.clientToServer,t.type=new Ic.ProtocolRequestType(t.method)})(xc||(yr.SelectionRangeRequest=xc={}));var Dn={};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.WorkDoneProgressCancelNotification=Dn.WorkDoneProgressCreateRequest=Dn.WorkDoneProgress=void 0;const sf=On,vr=ie;var Nc;(function(t){t.type=new sf.ProgressType;function e(n){return n===t.type}t.is=e})(Nc||(Dn.WorkDoneProgress=Nc={}));var Lc;(function(t){t.method="window/workDoneProgress/create",t.messageDirection=vr.MessageDirection.serverToClient,t.type=new vr.ProtocolRequestType(t.method)})(Lc||(Dn.WorkDoneProgressCreateRequest=Lc={}));var jc;(function(t){t.method="window/workDoneProgress/cancel",t.messageDirection=vr.MessageDirection.clientToServer,t.type=new vr.ProtocolNotificationType(t.method)})(jc||(Dn.WorkDoneProgressCancelNotification=jc={}));var bn={};Object.defineProperty(bn,"__esModule",{value:!0}),bn.CallHierarchyOutgoingCallsRequest=bn.CallHierarchyIncomingCallsRequest=bn.CallHierarchyPrepareRequest=void 0;const ri=ie;var Ac;(function(t){t.method="textDocument/prepareCallHierarchy",t.messageDirection=ri.MessageDirection.clientToServer,t.type=new ri.ProtocolRequestType(t.method)})(Ac||(bn.CallHierarchyPrepareRequest=Ac={}));var $c;(function(t){t.method="callHierarchy/incomingCalls",t.messageDirection=ri.MessageDirection.clientToServer,t.type=new ri.ProtocolRequestType(t.method)})($c||(bn.CallHierarchyIncomingCallsRequest=$c={}));var Hc;(function(t){t.method="callHierarchy/outgoingCalls",t.messageDirection=ri.MessageDirection.clientToServer,t.type=new ri.ProtocolRequestType(t.method)})(Hc||(bn.CallHierarchyOutgoingCallsRequest=Hc={}));var ut={};Object.defineProperty(ut,"__esModule",{value:!0}),ut.SemanticTokensRefreshRequest=ut.SemanticTokensRangeRequest=ut.SemanticTokensDeltaRequest=ut.SemanticTokensRequest=ut.SemanticTokensRegistrationType=ut.TokenFormat=void 0;const sn=ie;var Wc;(function(t){t.Relative="relative"})(Wc||(ut.TokenFormat=Wc={}));var Ei;(function(t){t.method="textDocument/semanticTokens",t.type=new sn.RegistrationType(t.method)})(Ei||(ut.SemanticTokensRegistrationType=Ei={}));var Kc;(function(t){t.method="textDocument/semanticTokens/full",t.messageDirection=sn.MessageDirection.clientToServer,t.type=new sn.ProtocolRequestType(t.method),t.registrationMethod=Ei.method})(Kc||(ut.SemanticTokensRequest=Kc={}));var Uc;(function(t){t.method="textDocument/semanticTokens/full/delta",t.messageDirection=sn.MessageDirection.clientToServer,t.type=new sn.ProtocolRequestType(t.method),t.registrationMethod=Ei.method})(Uc||(ut.SemanticTokensDeltaRequest=Uc={}));var zc;(function(t){t.method="textDocument/semanticTokens/range",t.messageDirection=sn.MessageDirection.clientToServer,t.type=new sn.ProtocolRequestType(t.method),t.registrationMethod=Ei.method})(zc||(ut.SemanticTokensRangeRequest=zc={}));var Bc;(function(t){t.method="workspace/semanticTokens/refresh",t.messageDirection=sn.MessageDirection.serverToClient,t.type=new sn.ProtocolRequestType0(t.method)})(Bc||(ut.SemanticTokensRefreshRequest=Bc={}));var Cr={};Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.ShowDocumentRequest=void 0;const Vc=ie;var Jc;(function(t){t.method="window/showDocument",t.messageDirection=Vc.MessageDirection.serverToClient,t.type=new Vc.ProtocolRequestType(t.method)})(Jc||(Cr.ShowDocumentRequest=Jc={}));var _r={};Object.defineProperty(_r,"__esModule",{value:!0}),_r.LinkedEditingRangeRequest=void 0;const Qc=ie;var Gc;(function(t){t.method="textDocument/linkedEditingRange",t.messageDirection=Qc.MessageDirection.clientToServer,t.type=new Qc.ProtocolRequestType(t.method)})(Gc||(_r.LinkedEditingRangeRequest=Gc={}));var Ye={};Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.WillDeleteFilesRequest=Ye.DidDeleteFilesNotification=Ye.DidRenameFilesNotification=Ye.WillRenameFilesRequest=Ye.DidCreateFilesNotification=Ye.WillCreateFilesRequest=Ye.FileOperationPatternKind=void 0;const bt=ie;var Xc;(function(t){t.file="file",t.folder="folder"})(Xc||(Ye.FileOperationPatternKind=Xc={}));var Yc;(function(t){t.method="workspace/willCreateFiles",t.messageDirection=bt.MessageDirection.clientToServer,t.type=new bt.ProtocolRequestType(t.method)})(Yc||(Ye.WillCreateFilesRequest=Yc={}));var Zc;(function(t){t.method="workspace/didCreateFiles",t.messageDirection=bt.MessageDirection.clientToServer,t.type=new bt.ProtocolNotificationType(t.method)})(Zc||(Ye.DidCreateFilesNotification=Zc={}));var eu;(function(t){t.method="workspace/willRenameFiles",t.messageDirection=bt.MessageDirection.clientToServer,t.type=new bt.ProtocolRequestType(t.method)})(eu||(Ye.WillRenameFilesRequest=eu={}));var tu;(function(t){t.method="workspace/didRenameFiles",t.messageDirection=bt.MessageDirection.clientToServer,t.type=new bt.ProtocolNotificationType(t.method)})(tu||(Ye.DidRenameFilesNotification=tu={}));var nu;(function(t){t.method="workspace/didDeleteFiles",t.messageDirection=bt.MessageDirection.clientToServer,t.type=new bt.ProtocolNotificationType(t.method)})(nu||(Ye.DidDeleteFilesNotification=nu={}));var iu;(function(t){t.method="workspace/willDeleteFiles",t.messageDirection=bt.MessageDirection.clientToServer,t.type=new bt.ProtocolRequestType(t.method)})(iu||(Ye.WillDeleteFilesRequest=iu={}));var wn={};Object.defineProperty(wn,"__esModule",{value:!0}),wn.MonikerRequest=wn.MonikerKind=wn.UniquenessLevel=void 0;const ru=ie;var ou;(function(t){t.document="document",t.project="project",t.group="group",t.scheme="scheme",t.global="global"})(ou||(wn.UniquenessLevel=ou={}));var su;(function(t){t.$import="import",t.$export="export",t.local="local"})(su||(wn.MonikerKind=su={}));var au;(function(t){t.method="textDocument/moniker",t.messageDirection=ru.MessageDirection.clientToServer,t.type=new ru.ProtocolRequestType(t.method)})(au||(wn.MonikerRequest=au={}));var Sn={};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.TypeHierarchySubtypesRequest=Sn.TypeHierarchySupertypesRequest=Sn.TypeHierarchyPrepareRequest=void 0;const oi=ie;var cu;(function(t){t.method="textDocument/prepareTypeHierarchy",t.messageDirection=oi.MessageDirection.clientToServer,t.type=new oi.ProtocolRequestType(t.method)})(cu||(Sn.TypeHierarchyPrepareRequest=cu={}));var uu;(function(t){t.method="typeHierarchy/supertypes",t.messageDirection=oi.MessageDirection.clientToServer,t.type=new oi.ProtocolRequestType(t.method)})(uu||(Sn.TypeHierarchySupertypesRequest=uu={}));var lu;(function(t){t.method="typeHierarchy/subtypes",t.messageDirection=oi.MessageDirection.clientToServer,t.type=new oi.ProtocolRequestType(t.method)})(lu||(Sn.TypeHierarchySubtypesRequest=lu={}));var si={};Object.defineProperty(si,"__esModule",{value:!0}),si.InlineValueRefreshRequest=si.InlineValueRequest=void 0;const Dr=ie;var du;(function(t){t.method="textDocument/inlineValue",t.messageDirection=Dr.MessageDirection.clientToServer,t.type=new Dr.ProtocolRequestType(t.method)})(du||(si.InlineValueRequest=du={}));var fu;(function(t){t.method="workspace/inlineValue/refresh",t.messageDirection=Dr.MessageDirection.serverToClient,t.type=new Dr.ProtocolRequestType0(t.method)})(fu||(si.InlineValueRefreshRequest=fu={}));var Rn={};Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.InlayHintRefreshRequest=Rn.InlayHintResolveRequest=Rn.InlayHintRequest=void 0;const ai=ie;var gu;(function(t){t.method="textDocument/inlayHint",t.messageDirection=ai.MessageDirection.clientToServer,t.type=new ai.ProtocolRequestType(t.method)})(gu||(Rn.InlayHintRequest=gu={}));var hu;(function(t){t.method="inlayHint/resolve",t.messageDirection=ai.MessageDirection.clientToServer,t.type=new ai.ProtocolRequestType(t.method)})(hu||(Rn.InlayHintResolveRequest=hu={}));var pu;(function(t){t.method="workspace/inlayHint/refresh",t.messageDirection=ai.MessageDirection.serverToClient,t.type=new ai.ProtocolRequestType0(t.method)})(pu||(Rn.InlayHintRefreshRequest=pu={}));var wt={};Object.defineProperty(wt,"__esModule",{value:!0}),wt.DiagnosticRefreshRequest=wt.WorkspaceDiagnosticRequest=wt.DocumentDiagnosticRequest=wt.DocumentDiagnosticReportKind=wt.DiagnosticServerCancellationData=void 0;const mu=On,af=Oe,ci=ie;var yu;(function(t){function e(n){const i=n;return i&&af.boolean(i.retriggerRequest)}t.is=e})(yu||(wt.DiagnosticServerCancellationData=yu={}));var vu;(function(t){t.Full="full",t.Unchanged="unchanged"})(vu||(wt.DocumentDiagnosticReportKind=vu={}));var Cu;(function(t){t.method="textDocument/diagnostic",t.messageDirection=ci.MessageDirection.clientToServer,t.type=new ci.ProtocolRequestType(t.method),t.partialResult=new mu.ProgressType})(Cu||(wt.DocumentDiagnosticRequest=Cu={}));var _u;(function(t){t.method="workspace/diagnostic",t.messageDirection=ci.MessageDirection.clientToServer,t.type=new ci.ProtocolRequestType(t.method),t.partialResult=new mu.ProgressType})(_u||(wt.WorkspaceDiagnosticRequest=_u={}));var Du;(function(t){t.method="workspace/diagnostic/refresh",t.messageDirection=ci.MessageDirection.serverToClient,t.type=new ci.ProtocolRequestType0(t.method)})(Du||(wt.DiagnosticRefreshRequest=Du={}));var qe={};Object.defineProperty(qe,"__esModule",{value:!0}),qe.DidCloseNotebookDocumentNotification=qe.DidSaveNotebookDocumentNotification=qe.DidChangeNotebookDocumentNotification=qe.NotebookCellArrayChange=qe.DidOpenNotebookDocumentNotification=qe.NotebookDocumentSyncRegistrationType=qe.NotebookDocument=qe.NotebookCell=qe.ExecutionSummary=qe.NotebookCellKind=void 0;const Oi=$s,qt=Oe,zt=ie;var Hs;(function(t){t.Markup=1,t.Code=2;function e(n){return n===1||n===2}t.is=e})(Hs||(qe.NotebookCellKind=Hs={}));var Ws;(function(t){function e(r,o){const s={executionOrder:r};return(o===!0||o===!1)&&(s.success=o),s}t.create=e;function n(r){const o=r;return qt.objectLiteral(o)&&Oi.uinteger.is(o.executionOrder)&&(o.success===void 0||qt.boolean(o.success))}t.is=n;function i(r,o){return r===o?!0:r==null||o===null||o===void 0?!1:r.executionOrder===o.executionOrder&&r.success===o.success}t.equals=i})(Ws||(qe.ExecutionSummary=Ws={}));var br;(function(t){function e(o,s){return{kind:o,document:s}}t.create=e;function n(o){const s=o;return qt.objectLiteral(s)&&Hs.is(s.kind)&&Oi.DocumentUri.is(s.document)&&(s.metadata===void 0||qt.objectLiteral(s.metadata))}t.is=n;function i(o,s){const a=new Set;return o.document!==s.document&&a.add("document"),o.kind!==s.kind&&a.add("kind"),o.executionSummary!==s.executionSummary&&a.add("executionSummary"),(o.metadata!==void 0||s.metadata!==void 0)&&!r(o.metadata,s.metadata)&&a.add("metadata"),(o.executionSummary!==void 0||s.executionSummary!==void 0)&&!Ws.equals(o.executionSummary,s.executionSummary)&&a.add("executionSummary"),a}t.diff=i;function r(o,s){if(o===s)return!0;if(o==null||s===null||s===void 0||typeof o!=typeof s||typeof o!="object")return!1;const a=Array.isArray(o),u=Array.isArray(s);if(a!==u)return!1;if(a&&u){if(o.length!==s.length)return!1;for(let l=0;l<o.length;l++)if(!r(o[l],s[l]))return!1}if(qt.objectLiteral(o)&&qt.objectLiteral(s)){const l=Object.keys(o),f=Object.keys(s);if(l.length!==f.length||(l.sort(),f.sort(),!r(l,f)))return!1;for(let m=0;m<l.length;m++){const p=l[m];if(!r(o[p],s[p]))return!1}}return!0}})(br||(qe.NotebookCell=br={}));var bu;(function(t){function e(i,r,o,s){return{uri:i,notebookType:r,version:o,cells:s}}t.create=e;function n(i){const r=i;return qt.objectLiteral(r)&&qt.string(r.uri)&&Oi.integer.is(r.version)&&qt.typedArray(r.cells,br.is)}t.is=n})(bu||(qe.NotebookDocument=bu={}));var ui;(function(t){t.method="notebookDocument/sync",t.messageDirection=zt.MessageDirection.clientToServer,t.type=new zt.RegistrationType(t.method)})(ui||(qe.NotebookDocumentSyncRegistrationType=ui={}));var wu;(function(t){t.method="notebookDocument/didOpen",t.messageDirection=zt.MessageDirection.clientToServer,t.type=new zt.ProtocolNotificationType(t.method),t.registrationMethod=ui.method})(wu||(qe.DidOpenNotebookDocumentNotification=wu={}));var Su;(function(t){function e(i){const r=i;return qt.objectLiteral(r)&&Oi.uinteger.is(r.start)&&Oi.uinteger.is(r.deleteCount)&&(r.cells===void 0||qt.typedArray(r.cells,br.is))}t.is=e;function n(i,r,o){const s={start:i,deleteCount:r};return o!==void 0&&(s.cells=o),s}t.create=n})(Su||(qe.NotebookCellArrayChange=Su={}));var Ru;(function(t){t.method="notebookDocument/didChange",t.messageDirection=zt.MessageDirection.clientToServer,t.type=new zt.ProtocolNotificationType(t.method),t.registrationMethod=ui.method})(Ru||(qe.DidChangeNotebookDocumentNotification=Ru={}));var Tu;(function(t){t.method="notebookDocument/didSave",t.messageDirection=zt.MessageDirection.clientToServer,t.type=new zt.ProtocolNotificationType(t.method),t.registrationMethod=ui.method})(Tu||(qe.DidSaveNotebookDocumentNotification=Tu={}));var Pu;(function(t){t.method="notebookDocument/didClose",t.messageDirection=zt.MessageDirection.clientToServer,t.type=new zt.ProtocolNotificationType(t.method),t.registrationMethod=ui.method})(Pu||(qe.DidCloseNotebookDocumentNotification=Pu={}));var wr={};Object.defineProperty(wr,"__esModule",{value:!0}),wr.InlineCompletionRequest=void 0;const ku=ie;var Fu;(function(t){t.method="textDocument/inlineCompletion",t.messageDirection=ku.MessageDirection.clientToServer,t.type=new ku.ProtocolRequestType(t.method)})(Fu||(wr.InlineCompletionRequest=Fu={})),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.RelativePattern=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeErrorCodes=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.PositionEncodingKind=t.FailureHandlingKind=t.ResourceOperationKind=t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.NotebookCellTextDocumentFilter=t.NotebookDocumentFilter=t.TextDocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangesFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolResolveRequest=void 0,t.InlineCompletionRequest=t.DidCloseNotebookDocumentNotification=t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=t.InlineValueRefreshRequest=t.InlineValueRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchySubtypesRequest=t.TypeHierarchyPrepareRequest=void 0;const e=ie,n=$s,i=Oe,r=lr;Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return r.ImplementationRequest}});const o=dr;Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return o.TypeDefinitionRequest}});const s=ti;Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return s.WorkspaceFoldersRequest}}),Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return s.DidChangeWorkspaceFoldersNotification}});const a=gr;Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return a.ConfigurationRequest}});const u=ni;Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return u.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return u.ColorPresentationRequest}});const l=ii;Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return l.FoldingRangeRequest}}),Object.defineProperty(t,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return l.FoldingRangeRefreshRequest}});const f=mr;Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return f.DeclarationRequest}});const m=yr;Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return m.SelectionRangeRequest}});const p=Dn;Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return p.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return p.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return p.WorkDoneProgressCancelNotification}});const C=bn;Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return C.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return C.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return C.CallHierarchyPrepareRequest}});const h=ut;Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return h.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return h.SemanticTokensRequest}}),Object.defineProperty(t,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return h.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return h.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return h.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return h.SemanticTokensRegistrationType}});const w=Cr;Object.defineProperty(t,"ShowDocumentRequest",{enumerable:!0,get:function(){return w.ShowDocumentRequest}});const R=_r;Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return R.LinkedEditingRangeRequest}});const M=Ye;Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return M.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return M.DidCreateFilesNotification}}),Object.defineProperty(t,"WillCreateFilesRequest",{enumerable:!0,get:function(){return M.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return M.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return M.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return M.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return M.WillDeleteFilesRequest}});const K=wn;Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return K.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return K.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return K.MonikerRequest}});const ne=Sn;Object.defineProperty(t,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return ne.TypeHierarchyPrepareRequest}}),Object.defineProperty(t,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return ne.TypeHierarchySubtypesRequest}}),Object.defineProperty(t,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return ne.TypeHierarchySupertypesRequest}});const ve=si;Object.defineProperty(t,"InlineValueRequest",{enumerable:!0,get:function(){return ve.InlineValueRequest}}),Object.defineProperty(t,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return ve.InlineValueRefreshRequest}});const se=Rn;Object.defineProperty(t,"InlayHintRequest",{enumerable:!0,get:function(){return se.InlayHintRequest}}),Object.defineProperty(t,"InlayHintResolveRequest",{enumerable:!0,get:function(){return se.InlayHintResolveRequest}}),Object.defineProperty(t,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return se.InlayHintRefreshRequest}});const de=wt;Object.defineProperty(t,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return de.DiagnosticServerCancellationData}}),Object.defineProperty(t,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return de.DocumentDiagnosticReportKind}}),Object.defineProperty(t,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return de.DocumentDiagnosticRequest}}),Object.defineProperty(t,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return de.WorkspaceDiagnosticRequest}}),Object.defineProperty(t,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return de.DiagnosticRefreshRequest}});const x=qe;Object.defineProperty(t,"NotebookCellKind",{enumerable:!0,get:function(){return x.NotebookCellKind}}),Object.defineProperty(t,"ExecutionSummary",{enumerable:!0,get:function(){return x.ExecutionSummary}}),Object.defineProperty(t,"NotebookCell",{enumerable:!0,get:function(){return x.NotebookCell}}),Object.defineProperty(t,"NotebookDocument",{enumerable:!0,get:function(){return x.NotebookDocument}}),Object.defineProperty(t,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return x.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(t,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return x.DidOpenNotebookDocumentNotification}}),Object.defineProperty(t,"NotebookCellArrayChange",{enumerable:!0,get:function(){return x.NotebookCellArrayChange}}),Object.defineProperty(t,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return x.DidChangeNotebookDocumentNotification}}),Object.defineProperty(t,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return x.DidSaveNotebookDocumentNotification}}),Object.defineProperty(t,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return x.DidCloseNotebookDocumentNotification}});const V=wr;Object.defineProperty(t,"InlineCompletionRequest",{enumerable:!0,get:function(){return V.InlineCompletionRequest}});var G;(function(g){function Se(Pe){const $=Pe;return i.string($)||i.string($.language)||i.string($.scheme)||i.string($.pattern)}g.is=Se})(G||(t.TextDocumentFilter=G={}));var Le;(function(g){function Se(Pe){const $=Pe;return i.objectLiteral($)&&(i.string($.notebookType)||i.string($.scheme)||i.string($.pattern))}g.is=Se})(Le||(t.NotebookDocumentFilter=Le={}));var pe;(function(g){function Se(Pe){const $=Pe;return i.objectLiteral($)&&(i.string($.notebook)||Le.is($.notebook))&&($.language===void 0||i.string($.language))}g.is=Se})(pe||(t.NotebookCellTextDocumentFilter=pe={}));var Pt;(function(g){function Se(Pe){if(!Array.isArray(Pe))return!1;for(let $ of Pe)if(!i.string($)&&!G.is($)&&!pe.is($))return!1;return!0}g.is=Se})(Pt||(t.DocumentSelector=Pt={}));var T;(function(g){g.method="client/registerCapability",g.messageDirection=e.MessageDirection.serverToClient,g.type=new e.ProtocolRequestType(g.method)})(T||(t.RegistrationRequest=T={}));var A;(function(g){g.method="client/unregisterCapability",g.messageDirection=e.MessageDirection.serverToClient,g.type=new e.ProtocolRequestType(g.method)})(A||(t.UnregistrationRequest=A={}));var L;(function(g){g.Create="create",g.Rename="rename",g.Delete="delete"})(L||(t.ResourceOperationKind=L={}));var q;(function(g){g.Abort="abort",g.Transactional="transactional",g.TextOnlyTransactional="textOnlyTransactional",g.Undo="undo"})(q||(t.FailureHandlingKind=q={}));var ge;(function(g){g.UTF8="utf-8",g.UTF16="utf-16",g.UTF32="utf-32"})(ge||(t.PositionEncodingKind=ge={}));var Bt;(function(g){function Se(Pe){const $=Pe;return $&&i.string($.id)&&$.id.length>0}g.hasId=Se})(Bt||(t.StaticRegistrationOptions=Bt={}));var Re;(function(g){function Se(Pe){const $=Pe;return $&&($.documentSelector===null||Pt.is($.documentSelector))}g.is=Se})(Re||(t.TextDocumentRegistrationOptions=Re={}));var Vt;(function(g){function Se($){const y=$;return i.objectLiteral(y)&&(y.workDoneProgress===void 0||i.boolean(y.workDoneProgress))}g.is=Se;function Pe($){const y=$;return y&&i.boolean(y.workDoneProgress)}g.hasWorkDoneProgress=Pe})(Vt||(t.WorkDoneProgressOptions=Vt={}));var Ue;(function(g){g.method="initialize",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(Ue||(t.InitializeRequest=Ue={}));var $e;(function(g){g.unknownProtocolVersion=1})($e||(t.InitializeErrorCodes=$e={}));var kt;(function(g){g.method="initialized",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolNotificationType(g.method)})(kt||(t.InitializedNotification=kt={}));var ft;(function(g){g.method="shutdown",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType0(g.method)})(ft||(t.ShutdownRequest=ft={}));var vt;(function(g){g.method="exit",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolNotificationType0(g.method)})(vt||(t.ExitNotification=vt={}));var Ct;(function(g){g.method="workspace/didChangeConfiguration",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolNotificationType(g.method)})(Ct||(t.DidChangeConfigurationNotification=Ct={}));var Lt;(function(g){g.Error=1,g.Warning=2,g.Info=3,g.Log=4,g.Debug=5})(Lt||(t.MessageType=Lt={}));var Je;(function(g){g.method="window/showMessage",g.messageDirection=e.MessageDirection.serverToClient,g.type=new e.ProtocolNotificationType(g.method)})(Je||(t.ShowMessageNotification=Je={}));var ze;(function(g){g.method="window/showMessageRequest",g.messageDirection=e.MessageDirection.serverToClient,g.type=new e.ProtocolRequestType(g.method)})(ze||(t.ShowMessageRequest=ze={}));var ot;(function(g){g.method="window/logMessage",g.messageDirection=e.MessageDirection.serverToClient,g.type=new e.ProtocolNotificationType(g.method)})(ot||(t.LogMessageNotification=ot={}));var Qe;(function(g){g.method="telemetry/event",g.messageDirection=e.MessageDirection.serverToClient,g.type=new e.ProtocolNotificationType(g.method)})(Qe||(t.TelemetryEventNotification=Qe={}));var ee;(function(g){g.None=0,g.Full=1,g.Incremental=2})(ee||(t.TextDocumentSyncKind=ee={}));var nt;(function(g){g.method="textDocument/didOpen",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolNotificationType(g.method)})(nt||(t.DidOpenTextDocumentNotification=nt={}));var me;(function(g){function Se($){let y=$;return y!=null&&typeof y.text=="string"&&y.range!==void 0&&(y.rangeLength===void 0||typeof y.rangeLength=="number")}g.isIncremental=Se;function Pe($){let y=$;return y!=null&&typeof y.text=="string"&&y.range===void 0&&y.rangeLength===void 0}g.isFull=Pe})(me||(t.TextDocumentContentChangeEvent=me={}));var Ge;(function(g){g.method="textDocument/didChange",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolNotificationType(g.method)})(Ge||(t.DidChangeTextDocumentNotification=Ge={}));var jt;(function(g){g.method="textDocument/didClose",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolNotificationType(g.method)})(jt||(t.DidCloseTextDocumentNotification=jt={}));var Ft;(function(g){g.method="textDocument/didSave",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolNotificationType(g.method)})(Ft||(t.DidSaveTextDocumentNotification=Ft={}));var Et;(function(g){g.Manual=1,g.AfterDelay=2,g.FocusOut=3})(Et||(t.TextDocumentSaveReason=Et={}));var Be;(function(g){g.method="textDocument/willSave",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolNotificationType(g.method)})(Be||(t.WillSaveTextDocumentNotification=Be={}));var gt;(function(g){g.method="textDocument/willSaveWaitUntil",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(gt||(t.WillSaveTextDocumentWaitUntilRequest=gt={}));var we;(function(g){g.method="workspace/didChangeWatchedFiles",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolNotificationType(g.method)})(we||(t.DidChangeWatchedFilesNotification=we={}));var st;(function(g){g.Created=1,g.Changed=2,g.Deleted=3})(st||(t.FileChangeType=st={}));var fn;(function(g){function Se(Pe){const $=Pe;return i.objectLiteral($)&&(n.URI.is($.baseUri)||n.WorkspaceFolder.is($.baseUri))&&i.string($.pattern)}g.is=Se})(fn||(t.RelativePattern=fn={}));var Jt;(function(g){g.Create=1,g.Change=2,g.Delete=4})(Jt||(t.WatchKind=Jt={}));var gn;(function(g){g.method="textDocument/publishDiagnostics",g.messageDirection=e.MessageDirection.serverToClient,g.type=new e.ProtocolNotificationType(g.method)})(gn||(t.PublishDiagnosticsNotification=gn={}));var Qt;(function(g){g.Invoked=1,g.TriggerCharacter=2,g.TriggerForIncompleteCompletions=3})(Qt||(t.CompletionTriggerKind=Qt={}));var Gt;(function(g){g.method="textDocument/completion",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(Gt||(t.CompletionRequest=Gt={}));var Ot;(function(g){g.method="completionItem/resolve",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(Ot||(t.CompletionResolveRequest=Ot={}));var at;(function(g){g.method="textDocument/hover",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(at||(t.HoverRequest=at={}));var At;(function(g){g.Invoked=1,g.TriggerCharacter=2,g.ContentChange=3})(At||(t.SignatureHelpTriggerKind=At={}));var hn;(function(g){g.method="textDocument/signatureHelp",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(hn||(t.SignatureHelpRequest=hn={}));var ct;(function(g){g.method="textDocument/definition",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(ct||(t.DefinitionRequest=ct={}));var $t;(function(g){g.method="textDocument/references",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})($t||(t.ReferencesRequest=$t={}));var Xt;(function(g){g.method="textDocument/documentHighlight",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(Xt||(t.DocumentHighlightRequest=Xt={}));var Yt;(function(g){g.method="textDocument/documentSymbol",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(Yt||(t.DocumentSymbolRequest=Yt={}));var pn;(function(g){g.method="textDocument/codeAction",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(pn||(t.CodeActionRequest=pn={}));var Zt;(function(g){g.method="codeAction/resolve",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(Zt||(t.CodeActionResolveRequest=Zt={}));var en;(function(g){g.method="workspace/symbol",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(en||(t.WorkspaceSymbolRequest=en={}));var mn;(function(g){g.method="workspaceSymbol/resolve",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(mn||(t.WorkspaceSymbolResolveRequest=mn={}));var Ht;(function(g){g.method="textDocument/codeLens",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(Ht||(t.CodeLensRequest=Ht={}));var it;(function(g){g.method="codeLens/resolve",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(it||(t.CodeLensResolveRequest=it={}));var tn;(function(g){g.method="workspace/codeLens/refresh",g.messageDirection=e.MessageDirection.serverToClient,g.type=new e.ProtocolRequestType0(g.method)})(tn||(t.CodeLensRefreshRequest=tn={}));var yn;(function(g){g.method="textDocument/documentLink",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(yn||(t.DocumentLinkRequest=yn={}));var ht;(function(g){g.method="documentLink/resolve",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(ht||(t.DocumentLinkResolveRequest=ht={}));var d;(function(g){g.method="textDocument/formatting",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(d||(t.DocumentFormattingRequest=d={}));var D;(function(g){g.method="textDocument/rangeFormatting",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(D||(t.DocumentRangeFormattingRequest=D={}));var O;(function(g){g.method="textDocument/rangesFormatting",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(O||(t.DocumentRangesFormattingRequest=O={}));var J;(function(g){g.method="textDocument/onTypeFormatting",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(J||(t.DocumentOnTypeFormattingRequest=J={}));var te;(function(g){g.Identifier=1})(te||(t.PrepareSupportDefaultBehavior=te={}));var Te;(function(g){g.method="textDocument/rename",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(Te||(t.RenameRequest=Te={}));var He;(function(g){g.method="textDocument/prepareRename",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(He||(t.PrepareRenameRequest=He={}));var je;(function(g){g.method="workspace/executeCommand",g.messageDirection=e.MessageDirection.clientToServer,g.type=new e.ProtocolRequestType(g.method)})(je||(t.ExecuteCommandRequest=je={}));var En;(function(g){g.method="workspace/applyEdit",g.messageDirection=e.MessageDirection.serverToClient,g.type=new e.ProtocolRequestType("workspace/applyEdit")})(En||(t.ApplyWorkspaceEditRequest=En={}))}(yc);var Sr={};Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.createProtocolConnection=void 0;const Eu=On;function cf(t,e,n,i){return Eu.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,Eu.createMessageConnection)(t,e,n,i)}Sr.createProtocolConnection=cf,function(t){var e=Ie&&Ie.__createBinding||(Object.create?function(o,s,a,u){u===void 0&&(u=a);var l=Object.getOwnPropertyDescriptor(s,a);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(o,u,l)}:function(o,s,a,u){u===void 0&&(u=a),o[u]=s[a]}),n=Ie&&Ie.__exportStar||function(o,s){for(var a in o)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,o,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,n(On,t),n($s,t),n(ie,t),n(yc,t);var i=Sr;Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return i.createProtocolConnection}});var r;(function(o){o.lspReservedErrorRangeStart=-32899,o.RequestFailed=-32803,o.ServerCancelled=-32802,o.ContentModified=-32801,o.RequestCancelled=-32800,o.lspReservedErrorRangeEnd=-32800})(r||(t.LSPErrorCodes=r={}))}(hc),function(t){var e=Ie&&Ie.__createBinding||(Object.create?function(o,s,a,u){u===void 0&&(u=a);var l=Object.getOwnPropertyDescriptor(s,a);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(o,u,l)}:function(o,s,a,u){u===void 0&&(u=a),o[u]=s[a]}),n=Ie&&Ie.__exportStar||function(o,s){for(var a in o)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,o,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const i=gc;n(gc,t),n(hc,t);function r(o,s,a,u){return(0,i.createMessageConnection)(o,s,a,u)}t.createProtocolConnection=r}(U);var Rr={},Ke={};Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.forEach=Ke.mapAsync=Ke.map=Ke.clearTestMode=Ke.setTestMode=Ke.Semaphore=Ke.Delayer=void 0;const qi=U;class uf{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,n=this.defaultDelay){return this.task=e,n>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(i=>{this.onSuccess=i}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var i=this.task();return this.task=void 0,i})),(n>=0||this.timeout===void 0)&&(this.timeout=(0,qi.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},n>=0?n:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}}Ke.Delayer=uf;class lf{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((n,i)=>{this._waiting.push({thunk:e,resolve:n,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,qi.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const n=e.thunk();n instanceof Promise?n.then(i=>{this._active--,e.resolve(i),this.runNext()},i=>{this._active--,e.reject(i),this.runNext()}):(this._active--,e.resolve(n),this.runNext())}catch(n){this._active--,e.reject(n),this.runNext()}}}Ke.Semaphore=lf;let Ks=!1;function df(){Ks=!0}Ke.setTestMode=df;function ff(){Ks=!1}Ke.clearTestMode=ff;const Ou=15;class Us{constructor(e=Ou){this.yieldAfter=Ks===!0?Math.max(e,2):Math.max(e,Ou),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){const e=Date.now()-this.startTime,n=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||n<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}}async function gf(t,e,n,i){if(t.length===0)return[];const r=new Array(t.length),o=new Us(i?.yieldAfter);function s(u){o.start();for(let l=u;l<t.length;l++)if(r[l]=e(t[l]),o.shouldYield())return i?.yieldCallback&&i.yieldCallback(),l+1;return-1}let a=s(0);for(;a!==-1&&!(n!==void 0&&n.isCancellationRequested);)a=await new Promise(u=>{(0,qi.RAL)().timer.setImmediate(()=>{u(s(a))})});return r}Ke.map=gf;async function hf(t,e,n,i){if(t.length===0)return[];const r=new Array(t.length),o=new Us(i?.yieldAfter);async function s(u){o.start();for(let l=u;l<t.length;l++)if(r[l]=await e(t[l],n),o.shouldYield())return i?.yieldCallback&&i.yieldCallback(),l+1;return-1}let a=await s(0);for(;a!==-1&&!(n!==void 0&&n.isCancellationRequested);)a=await new Promise(u=>{(0,qi.RAL)().timer.setImmediate(()=>{u(s(a))})});return r}Ke.mapAsync=hf;async function pf(t,e,n,i){if(t.length===0)return;const r=new Us(i?.yieldAfter);function o(a){r.start();for(let u=a;u<t.length;u++)if(e(t[u]),r.shouldYield())return i?.yieldCallback&&i.yieldCallback(),u+1;return-1}let s=o(0);for(;s!==-1&&!(n!==void 0&&n.isCancellationRequested);)s=await new Promise(a=>{(0,qi.RAL)().timer.setImmediate(()=>{a(o(s))})})}Ke.forEach=pf;var Tr={};Object.defineProperty(Tr,"__esModule",{value:!0});const mf=H;class yf extends mf.CompletionItem{constructor(e){super(e)}}Tr.default=yf;var Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});const vf=H;class Cf extends vf.CodeLens{constructor(e){super(e)}}Pr.default=Cf;var kr={};Object.defineProperty(kr,"__esModule",{value:!0});const _f=H;class Df extends _f.DocumentLink{constructor(e,n){super(e,n)}}kr.default=Df;var Fr={};Object.defineProperty(Fr,"__esModule",{value:!0});const bf=H;class wf extends bf.CodeAction{constructor(e,n){super(e),this.data=n}}Fr.default=wf;var xn={};Object.defineProperty(xn,"__esModule",{value:!0}),xn.ProtocolDiagnostic=xn.DiagnosticCode=void 0;const Sf=H,zs=fe;var qu;(function(t){function e(n){const i=n;return i!=null&&(zs.number(i.value)||zs.string(i.value))&&zs.string(i.target)}t.is=e})(qu||(xn.DiagnosticCode=qu={}));class Rf extends Sf.Diagnostic{constructor(e,n,i,r){super(e,n,i),this.data=r,this.hasDiagnosticCode=!1}}xn.ProtocolDiagnostic=Rf;var Er={};Object.defineProperty(Er,"__esModule",{value:!0});const Tf=H;class Pf extends Tf.CallHierarchyItem{constructor(e,n,i,r,o,s,a){super(e,n,i,r,o,s),a!==void 0&&(this.data=a)}}Er.default=Pf;var Or={};Object.defineProperty(Or,"__esModule",{value:!0});const kf=H;class Ff extends kf.TypeHierarchyItem{constructor(e,n,i,r,o,s,a){super(e,n,i,r,o,s),a!==void 0&&(this.data=a)}}Or.default=Ff;var qr={};Object.defineProperty(qr,"__esModule",{value:!0});const Mr=H;class Ef extends Mr.SymbolInformation{constructor(e,n,i,r,o){const s=!(r instanceof Mr.Uri);super(e,n,i,s?r:new Mr.Location(r,new Mr.Range(0,0,0,0))),this.hasRange=s,o!==void 0&&(this.data=o)}}qr.default=Ef;var Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});const Of=H;class qf extends Of.InlayHint{constructor(e,n,i){super(e,n,i)}}Ir.default=qf,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.createConverter=void 0;const Ne=H,z=U,Nn=fe,Mu=Ke,Mf=Tr,If=Pr,xf=kr,Iu=Fr,xu=xn,Nf=Er,Lf=Or,jf=qr,Af=Ir;var Bs;(function(t){function e(n){const i=n;return i&&!!i.inserting&&!!i.replacing}t.is=e})(Bs||(Bs={}));function $f(t){const n=t||(d=>d.toString());function i(d){return n(d)}function r(d){return{uri:n(d.uri)}}function o(d){return{uri:n(d.uri),languageId:d.languageId,version:d.version,text:d.getText()}}function s(d){return{uri:n(d.uri),version:d.version}}function a(d){return{textDocument:o(d)}}function u(d){const D=d;return!!D.document&&!!D.contentChanges}function l(d){const D=d;return!!D.uri&&!!D.version}function f(d,D,O){if(l(d))return{textDocument:{uri:n(d.uri),version:d.version},contentChanges:[{text:d.getText()}]};if(u(d)){const J=D,te=O;return{textDocument:{uri:n(J),version:te},contentChanges:d.contentChanges.map(He=>{const je=He.range;return{range:{start:{line:je.start.line,character:je.start.character},end:{line:je.end.line,character:je.end.character}},rangeLength:He.rangeLength,text:He.text}})}}else throw Error("Unsupported text document change parameter")}function m(d){return{textDocument:r(d)}}function p(d,D=!1){let O={textDocument:r(d)};return D&&(O.text=d.getText()),O}function C(d){switch(d){case Ne.TextDocumentSaveReason.Manual:return z.TextDocumentSaveReason.Manual;case Ne.TextDocumentSaveReason.AfterDelay:return z.TextDocumentSaveReason.AfterDelay;case Ne.TextDocumentSaveReason.FocusOut:return z.TextDocumentSaveReason.FocusOut}return z.TextDocumentSaveReason.Manual}function h(d){return{textDocument:r(d.document),reason:C(d.reason)}}function w(d){return{files:d.files.map(D=>({uri:n(D)}))}}function R(d){return{files:d.files.map(D=>({oldUri:n(D.oldUri),newUri:n(D.newUri)}))}}function M(d){return{files:d.files.map(D=>({uri:n(D)}))}}function K(d){return{files:d.files.map(D=>({uri:n(D)}))}}function ne(d){return{files:d.files.map(D=>({oldUri:n(D.oldUri),newUri:n(D.newUri)}))}}function ve(d){return{files:d.files.map(D=>({uri:n(D)}))}}function se(d,D){return{textDocument:r(d),position:L(D)}}function de(d){switch(d){case Ne.CompletionTriggerKind.TriggerCharacter:return z.CompletionTriggerKind.TriggerCharacter;case Ne.CompletionTriggerKind.TriggerForIncompleteCompletions:return z.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return z.CompletionTriggerKind.Invoked}}function x(d,D,O){return{textDocument:r(d),position:L(D),context:{triggerKind:de(O.triggerKind),triggerCharacter:O.triggerCharacter}}}function V(d){switch(d){case Ne.SignatureHelpTriggerKind.Invoke:return z.SignatureHelpTriggerKind.Invoked;case Ne.SignatureHelpTriggerKind.TriggerCharacter:return z.SignatureHelpTriggerKind.TriggerCharacter;case Ne.SignatureHelpTriggerKind.ContentChange:return z.SignatureHelpTriggerKind.ContentChange}}function G(d){return{label:d.label}}function Le(d){return d.map(G)}function pe(d){return{label:d.label,parameters:Le(d.parameters)}}function Pt(d){return d.map(pe)}function T(d){return d===void 0?d:{signatures:Pt(d.signatures),activeSignature:d.activeSignature,activeParameter:d.activeParameter}}function A(d,D,O){return{textDocument:r(d),position:L(D),context:{isRetrigger:O.isRetrigger,triggerCharacter:O.triggerCharacter,triggerKind:V(O.triggerKind),activeSignatureHelp:T(O.activeSignatureHelp)}}}function L(d){return{line:d.line,character:d.character}}function q(d){return d==null?d:{line:d.line>z.uinteger.MAX_VALUE?z.uinteger.MAX_VALUE:d.line,character:d.character>z.uinteger.MAX_VALUE?z.uinteger.MAX_VALUE:d.character}}function ge(d,D){return Mu.map(d,q,D)}function Bt(d){return d.map(q)}function Re(d){return d==null?d:{start:q(d.start),end:q(d.end)}}function Vt(d){return d.map(Re)}function Ue(d){return d==null?d:z.Location.create(i(d.uri),Re(d.range))}function $e(d){switch(d){case Ne.DiagnosticSeverity.Error:return z.DiagnosticSeverity.Error;case Ne.DiagnosticSeverity.Warning:return z.DiagnosticSeverity.Warning;case Ne.DiagnosticSeverity.Information:return z.DiagnosticSeverity.Information;case Ne.DiagnosticSeverity.Hint:return z.DiagnosticSeverity.Hint}}function kt(d){if(!d)return;let D=[];for(let O of d){let J=ft(O);J!==void 0&&D.push(J)}return D.length>0?D:void 0}function ft(d){switch(d){case Ne.DiagnosticTag.Unnecessary:return z.DiagnosticTag.Unnecessary;case Ne.DiagnosticTag.Deprecated:return z.DiagnosticTag.Deprecated;default:return}}function vt(d){return{message:d.message,location:Ue(d.location)}}function Ct(d){return d.map(vt)}function Lt(d){if(d!=null)return Nn.number(d)||Nn.string(d)?d:{value:d.value,target:i(d.target)}}function Je(d){const D=z.Diagnostic.create(Re(d.range),d.message),O=d instanceof xu.ProtocolDiagnostic?d:void 0;O!==void 0&&O.data!==void 0&&(D.data=O.data);const J=Lt(d.code);return xu.DiagnosticCode.is(J)?O!==void 0&&O.hasDiagnosticCode?D.code=J:(D.code=J.value,D.codeDescription={href:J.target}):D.code=J,Nn.number(d.severity)&&(D.severity=$e(d.severity)),Array.isArray(d.tags)&&(D.tags=kt(d.tags)),d.relatedInformation&&(D.relatedInformation=Ct(d.relatedInformation)),d.source&&(D.source=d.source),D}function ze(d,D){return d==null?d:Mu.map(d,Je,D)}function ot(d){return d==null?d:d.map(Je)}function Qe(d,D){switch(d){case"$string":return D;case z.MarkupKind.PlainText:return{kind:d,value:D};case z.MarkupKind.Markdown:return{kind:d,value:D.value};default:return`Unsupported Markup content received. Kind is: ${d}`}}function ee(d){switch(d){case Ne.CompletionItemTag.Deprecated:return z.CompletionItemTag.Deprecated}}function nt(d){if(d===void 0)return d;const D=[];for(let O of d){const J=ee(O);J!==void 0&&D.push(J)}return D}function me(d,D){return D!==void 0?D:d+1}function Ge(d,D=!1){let O,J;Nn.string(d.label)?O=d.label:(O=d.label.label,D&&(d.label.detail!==void 0||d.label.description!==void 0)&&(J={detail:d.label.detail,description:d.label.description}));let te={label:O};J!==void 0&&(te.labelDetails=J);let Te=d instanceof Mf.default?d:void 0;d.detail&&(te.detail=d.detail),d.documentation&&(!Te||Te.documentationFormat==="$string"?te.documentation=d.documentation:te.documentation=Qe(Te.documentationFormat,d.documentation)),d.filterText&&(te.filterText=d.filterText),jt(te,d),Nn.number(d.kind)&&(te.kind=me(d.kind,Te&&Te.originalItemKind)),d.sortText&&(te.sortText=d.sortText),d.additionalTextEdits&&(te.additionalTextEdits=Be(d.additionalTextEdits)),d.commitCharacters&&(te.commitCharacters=d.commitCharacters.slice()),d.command&&(te.command=ct(d.command)),(d.preselect===!0||d.preselect===!1)&&(te.preselect=d.preselect);const He=nt(d.tags);if(Te){if(Te.data!==void 0&&(te.data=Te.data),Te.deprecated===!0||Te.deprecated===!1){if(Te.deprecated===!0&&He!==void 0&&He.length>0){const je=He.indexOf(Ne.CompletionItemTag.Deprecated);je!==-1&&He.splice(je,1)}te.deprecated=Te.deprecated}Te.insertTextMode!==void 0&&(te.insertTextMode=Te.insertTextMode)}return He!==void 0&&He.length>0&&(te.tags=He),te.insertTextMode===void 0&&d.keepWhitespace===!0&&(te.insertTextMode=z.InsertTextMode.adjustIndentation),te}function jt(d,D){let O=z.InsertTextFormat.PlainText,J,te;D.textEdit?(J=D.textEdit.newText,te=D.textEdit.range):D.insertText instanceof Ne.SnippetString?(O=z.InsertTextFormat.Snippet,J=D.insertText.value):J=D.insertText,D.range&&(te=D.range),d.insertTextFormat=O,D.fromEdit&&J!==void 0&&te!==void 0?d.textEdit=Ft(J,te):d.insertText=J}function Ft(d,D){return Bs.is(D)?z.InsertReplaceEdit.create(d,Re(D.inserting),Re(D.replacing)):{newText:d,range:Re(D)}}function Et(d){return{range:Re(d.range),newText:d.newText}}function Be(d){return d==null?d:d.map(Et)}function gt(d){return d<=Ne.SymbolKind.TypeParameter?d+1:z.SymbolKind.Property}function we(d){return d}function st(d){return d.map(we)}function fn(d,D,O){return{textDocument:r(d),position:L(D),context:{includeDeclaration:O.includeDeclaration}}}async function Jt(d,D){let O=z.CodeAction.create(d.title);if(d instanceof Iu.default&&d.data!==void 0&&(O.data=d.data),d.kind!==void 0&&(O.kind=at(d.kind)),d.diagnostics!==void 0&&(O.diagnostics=await ze(d.diagnostics,D)),d.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return d.command!==void 0&&(O.command=ct(d.command)),d.isPreferred!==void 0&&(O.isPreferred=d.isPreferred),d.disabled!==void 0&&(O.disabled={reason:d.disabled.reason}),O}function gn(d){let D=z.CodeAction.create(d.title);if(d instanceof Iu.default&&d.data!==void 0&&(D.data=d.data),d.kind!==void 0&&(D.kind=at(d.kind)),d.diagnostics!==void 0&&(D.diagnostics=ot(d.diagnostics)),d.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return d.command!==void 0&&(D.command=ct(d.command)),d.isPreferred!==void 0&&(D.isPreferred=d.isPreferred),d.disabled!==void 0&&(D.disabled={reason:d.disabled.reason}),D}async function Qt(d,D){if(d==null)return d;let O;return d.only&&Nn.string(d.only.value)&&(O=[d.only.value]),z.CodeActionContext.create(await ze(d.diagnostics,D),O,Ot(d.triggerKind))}function Gt(d){if(d==null)return d;let D;return d.only&&Nn.string(d.only.value)&&(D=[d.only.value]),z.CodeActionContext.create(ot(d.diagnostics),D,Ot(d.triggerKind))}function Ot(d){switch(d){case Ne.CodeActionTriggerKind.Invoke:return z.CodeActionTriggerKind.Invoked;case Ne.CodeActionTriggerKind.Automatic:return z.CodeActionTriggerKind.Automatic;default:return}}function at(d){if(d!=null)return d.value}function At(d){return d==null?d:z.InlineValueContext.create(d.frameId,Re(d.stoppedLocation))}function hn(d,D,O){return{context:z.InlineCompletionContext.create(O.triggerKind,O.selectedCompletionInfo),textDocument:r(d),position:q(D)}}function ct(d){let D=z.Command.create(d.title,d.command);return d.arguments&&(D.arguments=d.arguments),D}function $t(d){let D=z.CodeLens.create(Re(d.range));return d.command&&(D.command=ct(d.command)),d instanceof If.default&&d.data&&(D.data=d.data),D}function Xt(d,D){const O={tabSize:d.tabSize,insertSpaces:d.insertSpaces};return D.trimTrailingWhitespace&&(O.trimTrailingWhitespace=!0),D.trimFinalNewlines&&(O.trimFinalNewlines=!0),D.insertFinalNewline&&(O.insertFinalNewline=!0),O}function Yt(d){return{textDocument:r(d)}}function pn(d){return{textDocument:r(d)}}function Zt(d){let D=z.DocumentLink.create(Re(d.range));d.target&&(D.target=i(d.target)),d.tooltip!==void 0&&(D.tooltip=d.tooltip);let O=d instanceof xf.default?d:void 0;return O&&O.data&&(D.data=O.data),D}function en(d){return{textDocument:r(d)}}function mn(d){const D={name:d.name,kind:gt(d.kind),uri:i(d.uri),range:Re(d.range),selectionRange:Re(d.selectionRange)};return d.detail!==void 0&&d.detail.length>0&&(D.detail=d.detail),d.tags!==void 0&&(D.tags=st(d.tags)),d instanceof Nf.default&&d.data!==void 0&&(D.data=d.data),D}function Ht(d){const D={name:d.name,kind:gt(d.kind),uri:i(d.uri),range:Re(d.range),selectionRange:Re(d.selectionRange)};return d.detail!==void 0&&d.detail.length>0&&(D.detail=d.detail),d.tags!==void 0&&(D.tags=st(d.tags)),d instanceof Lf.default&&d.data!==void 0&&(D.data=d.data),D}function it(d){const D=d instanceof jf.default?{name:d.name,kind:gt(d.kind),location:d.hasRange?Ue(d.location):{uri:n(d.location.uri)},data:d.data}:{name:d.name,kind:gt(d.kind),location:Ue(d.location)};return d.tags!==void 0&&(D.tags=st(d.tags)),d.containerName!==""&&(D.containerName=d.containerName),D}function tn(d){const D=typeof d.label=="string"?d.label:d.label.map(yn),O=z.InlayHint.create(q(d.position),D);return d.kind!==void 0&&(O.kind=d.kind),d.textEdits!==void 0&&(O.textEdits=Be(d.textEdits)),d.tooltip!==void 0&&(O.tooltip=ht(d.tooltip)),d.paddingLeft!==void 0&&(O.paddingLeft=d.paddingLeft),d.paddingRight!==void 0&&(O.paddingRight=d.paddingRight),d instanceof Af.default&&d.data!==void 0&&(O.data=d.data),O}function yn(d){const D=z.InlayHintLabelPart.create(d.value);return d.location!==void 0&&(D.location=Ue(d.location)),d.command!==void 0&&(D.command=ct(d.command)),d.tooltip!==void 0&&(D.tooltip=ht(d.tooltip)),D}function ht(d){return typeof d=="string"?d:{kind:z.MarkupKind.Markdown,value:d.value}}return{asUri:i,asTextDocumentIdentifier:r,asTextDocumentItem:o,asVersionedTextDocumentIdentifier:s,asOpenTextDocumentParams:a,asChangeTextDocumentParams:f,asCloseTextDocumentParams:m,asSaveTextDocumentParams:p,asWillSaveTextDocumentParams:h,asDidCreateFilesParams:w,asDidRenameFilesParams:R,asDidDeleteFilesParams:M,asWillCreateFilesParams:K,asWillRenameFilesParams:ne,asWillDeleteFilesParams:ve,asTextDocumentPositionParams:se,asCompletionParams:x,asSignatureHelpParams:A,asWorkerPosition:L,asRange:Re,asRanges:Vt,asPosition:q,asPositions:ge,asPositionsSync:Bt,asLocation:Ue,asDiagnosticSeverity:$e,asDiagnosticTag:ft,asDiagnostic:Je,asDiagnostics:ze,asDiagnosticsSync:ot,asCompletionItem:Ge,asTextEdit:Et,asSymbolKind:gt,asSymbolTag:we,asSymbolTags:st,asReferenceParams:fn,asCodeAction:Jt,asCodeActionSync:gn,asCodeActionContext:Qt,asCodeActionContextSync:Gt,asInlineValueContext:At,asCommand:ct,asCodeLens:$t,asFormattingOptions:Xt,asDocumentSymbolParams:Yt,asCodeLensParams:pn,asDocumentLink:Zt,asDocumentLinkParams:en,asCallHierarchyItem:mn,asTypeHierarchyItem:Ht,asInlayHint:tn,asWorkspaceSymbol:it,asInlineCompletionParams:hn}}Rr.createConverter=$f;var xr={};Object.defineProperty(xr,"__esModule",{value:!0}),xr.createConverter=void 0;const E=H,W=U,St=fe,le=Ke,Hf=Tr,Wf=Pr,Kf=kr,Uf=Fr,Nu=xn,zf=Er,Bf=Or,Vf=qr,Jf=Ir,Lu=U;var Nr;(function(t){function e(n){let i=n;return i&&St.string(i.language)&&St.string(i.value)}t.is=e})(Nr||(Nr={}));function Qf(t,e,n){const r=t||(c=>E.Uri.parse(c));function o(c){return r(c)}function s(c){const v=[];for(const b of c)if(typeof b=="string")v.push(b);else if(Lu.NotebookCellTextDocumentFilter.is(b))if(typeof b.notebook=="string")v.push({notebookType:b.notebook,language:b.language});else{const P=b.notebook.notebookType??"*";v.push({notebookType:P,scheme:b.notebook.scheme,pattern:b.notebook.pattern,language:b.language})}else Lu.TextDocumentFilter.is(b)&&v.push({language:b.language,scheme:b.scheme,pattern:b.pattern});return v}async function a(c,v){return le.map(c,l,v)}function u(c){const v=new Array(c.length);for(let b=0;b<c.length;b++)v[b]=l(c[b]);return v}function l(c){let v=new Nu.ProtocolDiagnostic(h(c.range),c.message,R(c.severity),c.data);if(c.code!==void 0){if(typeof c.code=="string"||typeof c.code=="number")W.CodeDescription.is(c.codeDescription)?v.code={value:c.code,target:o(c.codeDescription.href)}:v.code=c.code;else if(Nu.DiagnosticCode.is(c.code)){v.hasDiagnosticCode=!0;const b=c.code;v.code={value:b.value,target:o(b.target)}}}return c.source&&(v.source=c.source),c.relatedInformation&&(v.relatedInformation=f(c.relatedInformation)),Array.isArray(c.tags)&&(v.tags=m(c.tags)),v}function f(c){const v=new Array(c.length);for(let b=0;b<c.length;b++){const P=c[b];v[b]=new E.DiagnosticRelatedInformation($e(P.location),P.message)}return v}function m(c){if(!c)return;let v=[];for(let b of c){let P=p(b);P!==void 0&&v.push(P)}return v.length>0?v:void 0}function p(c){switch(c){case W.DiagnosticTag.Unnecessary:return E.DiagnosticTag.Unnecessary;case W.DiagnosticTag.Deprecated:return E.DiagnosticTag.Deprecated;default:return}}function C(c){return c?new E.Position(c.line,c.character):void 0}function h(c){return c?new E.Range(c.start.line,c.start.character,c.end.line,c.end.character):void 0}async function w(c,v){return le.map(c,b=>new E.Range(b.start.line,b.start.character,b.end.line,b.end.character),v)}function R(c){if(c==null)return E.DiagnosticSeverity.Error;switch(c){case W.DiagnosticSeverity.Error:return E.DiagnosticSeverity.Error;case W.DiagnosticSeverity.Warning:return E.DiagnosticSeverity.Warning;case W.DiagnosticSeverity.Information:return E.DiagnosticSeverity.Information;case W.DiagnosticSeverity.Hint:return E.DiagnosticSeverity.Hint}return E.DiagnosticSeverity.Error}function M(c){if(St.string(c))return ne(c);if(Nr.is(c))return ne().appendCodeblock(c.value,c.language);if(Array.isArray(c)){let v=[];for(let b of c){let P=ne();Nr.is(b)?P.appendCodeblock(b.value,b.language):P.appendMarkdown(b),v.push(P)}return v}else return ne(c)}function K(c){if(St.string(c))return c;switch(c.kind){case W.MarkupKind.Markdown:return ne(c.value);case W.MarkupKind.PlainText:return c.value;default:return`Unsupported Markup content received. Kind is: ${c.kind}`}}function ne(c){let v;if(c===void 0||typeof c=="string")v=new E.MarkdownString(c);else switch(c.kind){case W.MarkupKind.Markdown:v=new E.MarkdownString(c.value);break;case W.MarkupKind.PlainText:v=new E.MarkdownString,v.appendText(c.value);break;default:v=new E.MarkdownString,v.appendText(`Unsupported Markup content received. Kind is: ${c.kind}`);break}return v.isTrusted=e,v.supportHtml=n,v}function ve(c){if(c)return new E.Hover(M(c.contents),h(c.range))}async function se(c,v,b){if(!c)return;if(Array.isArray(c))return le.map(c,_t=>Le(_t,v),b);const P=c,{defaultRange:X,commitCharacters:ue}=de(P,v),Q=await le.map(P.items,_t=>Le(_t,ue,X,P.itemDefaults?.insertTextMode,P.itemDefaults?.insertTextFormat,P.itemDefaults?.data),b);return new E.CompletionList(Q,P.isIncomplete)}function de(c,v){const b=c.itemDefaults?.editRange,P=c.itemDefaults?.commitCharacters??v;return W.Range.is(b)?{defaultRange:h(b),commitCharacters:P}:b!==void 0?{defaultRange:{inserting:h(b.insert),replacing:h(b.replace)},commitCharacters:P}:{defaultRange:void 0,commitCharacters:P}}function x(c){return W.CompletionItemKind.Text<=c&&c<=W.CompletionItemKind.TypeParameter?[c-1,void 0]:[E.CompletionItemKind.Text,c]}function V(c){switch(c){case W.CompletionItemTag.Deprecated:return E.CompletionItemTag.Deprecated}}function G(c){if(c==null)return[];const v=[];for(const b of c){const P=V(b);P!==void 0&&v.push(P)}return v}function Le(c,v,b,P,X,ue){const Q=G(c.tags),_t=pe(c),_e=new Hf.default(_t);c.detail&&(_e.detail=c.detail),c.documentation&&(_e.documentation=K(c.documentation),_e.documentationFormat=St.string(c.documentation)?"$string":c.documentation.kind),c.filterText&&(_e.filterText=c.filterText);const Xi=Pt(c,b,X);if(Xi&&(_e.insertText=Xi.text,_e.range=Xi.range,_e.fromEdit=Xi.fromEdit),St.number(c.kind)){let[Fl,za]=x(c.kind);_e.kind=Fl,za&&(_e.originalItemKind=za)}c.sortText&&(_e.sortText=c.sortText),c.additionalTextEdits&&(_e.additionalTextEdits=q(c.additionalTextEdits));const Ka=c.commitCharacters!==void 0?St.stringArray(c.commitCharacters)?c.commitCharacters:void 0:v;Ka&&(_e.commitCharacters=Ka.slice()),c.command&&(_e.command=Be(c.command)),(c.deprecated===!0||c.deprecated===!1)&&(_e.deprecated=c.deprecated,c.deprecated===!0&&Q.push(E.CompletionItemTag.Deprecated)),(c.preselect===!0||c.preselect===!1)&&(_e.preselect=c.preselect);const Ua=c.data??ue;Ua!==void 0&&(_e.data=Ua),Q.length>0&&(_e.tags=Q);const ko=c.insertTextMode??P;return ko!==void 0&&(_e.insertTextMode=ko,ko===W.InsertTextMode.asIs&&(_e.keepWhitespace=!0)),_e}function pe(c){return W.CompletionItemLabelDetails.is(c.labelDetails)?{label:c.label,detail:c.labelDetails.detail,description:c.labelDetails.description}:c.label}function Pt(c,v,b){const P=c.insertTextFormat??b;if(c.textEdit!==void 0||v!==void 0){const[X,ue]=c.textEdit!==void 0?T(c.textEdit):[v,c.textEditText??c.label];return P===W.InsertTextFormat.Snippet?{text:new E.SnippetString(ue),range:X,fromEdit:!0}:{text:ue,range:X,fromEdit:!0}}else return c.insertText?P===W.InsertTextFormat.Snippet?{text:new E.SnippetString(c.insertText),fromEdit:!1}:{text:c.insertText,fromEdit:!1}:void 0}function T(c){return W.InsertReplaceEdit.is(c)?[{inserting:h(c.insert),replacing:h(c.replace)},c.newText]:[h(c.range),c.newText]}function A(c){if(c)return new E.TextEdit(h(c.range),c.newText)}async function L(c,v){if(c)return le.map(c,A,v)}function q(c){if(!c)return;const v=new Array(c.length);for(let b=0;b<c.length;b++)v[b]=A(c[b]);return v}async function ge(c,v){if(!c)return;let b=new E.SignatureHelp;return St.number(c.activeSignature)?b.activeSignature=c.activeSignature:b.activeSignature=0,St.number(c.activeParameter)?b.activeParameter=c.activeParameter:b.activeParameter=0,c.signatures&&(b.signatures=await Bt(c.signatures,v)),b}async function Bt(c,v){return le.mapAsync(c,Re,v)}async function Re(c,v){let b=new E.SignatureInformation(c.label);return c.documentation!==void 0&&(b.documentation=K(c.documentation)),c.parameters!==void 0&&(b.parameters=await Vt(c.parameters,v)),c.activeParameter!==void 0&&(b.activeParameter=c.activeParameter),b}function Vt(c,v){return le.map(c,Ue,v)}function Ue(c){let v=new E.ParameterInformation(c.label);return c.documentation&&(v.documentation=K(c.documentation)),v}function $e(c){return c?new E.Location(r(c.uri),h(c.range)):void 0}async function kt(c,v){if(c)return Ct(c,v)}async function ft(c,v){if(c)return Ct(c,v)}function vt(c){if(!c)return;let v={targetUri:r(c.targetUri),targetRange:h(c.targetRange),originSelectionRange:h(c.originSelectionRange),targetSelectionRange:h(c.targetSelectionRange)};if(!v.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return v}async function Ct(c,v){if(c)if(St.array(c)){if(c.length===0)return[];if(W.LocationLink.is(c[0])){const b=c;return le.map(b,vt,v)}else{const b=c;return le.map(b,$e,v)}}else return W.LocationLink.is(c)?[vt(c)]:$e(c)}async function Lt(c,v){if(c)return le.map(c,$e,v)}async function Je(c,v){if(c)return le.map(c,ze,v)}function ze(c){let v=new E.DocumentHighlight(h(c.range));return St.number(c.kind)&&(v.kind=ot(c.kind)),v}function ot(c){switch(c){case W.DocumentHighlightKind.Text:return E.DocumentHighlightKind.Text;case W.DocumentHighlightKind.Read:return E.DocumentHighlightKind.Read;case W.DocumentHighlightKind.Write:return E.DocumentHighlightKind.Write}return E.DocumentHighlightKind.Text}async function Qe(c,v){if(c)return le.map(c,Ge,v)}function ee(c){return c<=W.SymbolKind.TypeParameter?c-1:E.SymbolKind.Property}function nt(c){switch(c){case W.SymbolTag.Deprecated:return E.SymbolTag.Deprecated;default:return}}function me(c){if(c==null)return;const v=[];for(const b of c){const P=nt(b);P!==void 0&&v.push(P)}return v.length===0?void 0:v}function Ge(c){const v=c.data,b=c.location,P=b.range===void 0||v!==void 0?new Vf.default(c.name,ee(c.kind),c.containerName??"",b.range===void 0?r(b.uri):new E.Location(r(c.location.uri),h(b.range)),v):new E.SymbolInformation(c.name,ee(c.kind),c.containerName??"",new E.Location(r(c.location.uri),h(b.range)));return Et(P,c),P}async function jt(c,v){if(c!=null)return le.map(c,Ft,v)}function Ft(c){let v=new E.DocumentSymbol(c.name,c.detail||"",ee(c.kind),h(c.range),h(c.selectionRange));if(Et(v,c),c.children!==void 0&&c.children.length>0){let b=[];for(let P of c.children)b.push(Ft(P));v.children=b}return v}function Et(c,v){c.tags=me(v.tags),v.deprecated&&(c.tags?c.tags.includes(E.SymbolTag.Deprecated)||(c.tags=c.tags.concat(E.SymbolTag.Deprecated)):c.tags=[E.SymbolTag.Deprecated])}function Be(c){let v={title:c.title,command:c.command};return c.arguments&&(v.arguments=c.arguments),v}async function gt(c,v){if(c)return le.map(c,Be,v)}const we=new Map;we.set(W.CodeActionKind.Empty,E.CodeActionKind.Empty),we.set(W.CodeActionKind.QuickFix,E.CodeActionKind.QuickFix),we.set(W.CodeActionKind.Refactor,E.CodeActionKind.Refactor),we.set(W.CodeActionKind.RefactorExtract,E.CodeActionKind.RefactorExtract),we.set(W.CodeActionKind.RefactorInline,E.CodeActionKind.RefactorInline),we.set(W.CodeActionKind.RefactorRewrite,E.CodeActionKind.RefactorRewrite),we.set(W.CodeActionKind.Source,E.CodeActionKind.Source),we.set(W.CodeActionKind.SourceOrganizeImports,E.CodeActionKind.SourceOrganizeImports);function st(c){if(c==null)return;let v=we.get(c);if(v)return v;let b=c.split(".");v=E.CodeActionKind.Empty;for(let P of b)v=v.append(P);return v}function fn(c){if(c!=null)return c.map(v=>st(v))}async function Jt(c,v){if(c==null)return;let b=new Uf.default(c.title,c.data);return c.kind!==void 0&&(b.kind=st(c.kind)),c.diagnostics!==void 0&&(b.diagnostics=u(c.diagnostics)),c.edit!==void 0&&(b.edit=await Ot(c.edit,v)),c.command!==void 0&&(b.command=Be(c.command)),c.isPreferred!==void 0&&(b.isPreferred=c.isPreferred),c.disabled!==void 0&&(b.disabled={reason:c.disabled.reason}),b}function gn(c,v){return le.mapAsync(c,async b=>W.Command.is(b)?Be(b):Jt(b,v),v)}function Qt(c){if(!c)return;let v=new Wf.default(h(c.range));return c.command&&(v.command=Be(c.command)),c.data!==void 0&&c.data!==null&&(v.data=c.data),v}async function Gt(c,v){if(c)return le.map(c,Qt,v)}async function Ot(c,v){if(!c)return;const b=new Map;if(c.changeAnnotations!==void 0){const ue=c.changeAnnotations;await le.forEach(Object.keys(ue),Q=>{const _t=at(ue[Q]);b.set(Q,_t)},v)}const P=ue=>{if(ue!==void 0)return b.get(ue)},X=new E.WorkspaceEdit;if(c.documentChanges){const ue=c.documentChanges;await le.forEach(ue,Q=>{if(W.CreateFile.is(Q))X.createFile(r(Q.uri),Q.options,P(Q.annotationId));else if(W.RenameFile.is(Q))X.renameFile(r(Q.oldUri),r(Q.newUri),Q.options,P(Q.annotationId));else if(W.DeleteFile.is(Q))X.deleteFile(r(Q.uri),Q.options,P(Q.annotationId));else if(W.TextDocumentEdit.is(Q)){const _t=r(Q.textDocument.uri);for(const _e of Q.edits)W.AnnotatedTextEdit.is(_e)?X.replace(_t,h(_e.range),_e.newText,P(_e.annotationId)):X.replace(_t,h(_e.range),_e.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Q,void 0,4)}`)},v)}else if(c.changes){const ue=c.changes;await le.forEach(Object.keys(ue),Q=>{X.set(r(Q),q(ue[Q]))},v)}return X}function at(c){if(c!==void 0)return{label:c.label,needsConfirmation:!!c.needsConfirmation,description:c.description}}function At(c){let v=h(c.range),b=c.target?o(c.target):void 0,P=new Kf.default(v,b);return c.tooltip!==void 0&&(P.tooltip=c.tooltip),c.data!==void 0&&c.data!==null&&(P.data=c.data),P}async function hn(c,v){if(c)return le.map(c,At,v)}function ct(c){return new E.Color(c.red,c.green,c.blue,c.alpha)}function $t(c){return new E.ColorInformation(h(c.range),ct(c.color))}async function Xt(c,v){if(c)return le.map(c,$t,v)}function Yt(c){let v=new E.ColorPresentation(c.label);return v.additionalTextEdits=q(c.additionalTextEdits),c.textEdit&&(v.textEdit=A(c.textEdit)),v}async function pn(c,v){if(c)return le.map(c,Yt,v)}function Zt(c){if(c)switch(c){case W.FoldingRangeKind.Comment:return E.FoldingRangeKind.Comment;case W.FoldingRangeKind.Imports:return E.FoldingRangeKind.Imports;case W.FoldingRangeKind.Region:return E.FoldingRangeKind.Region}}function en(c){return new E.FoldingRange(c.startLine,c.endLine,Zt(c.kind))}async function mn(c,v){if(c)return le.map(c,en,v)}function Ht(c){return new E.SelectionRange(h(c.range),c.parent?Ht(c.parent):void 0)}async function it(c,v){return Array.isArray(c)?le.map(c,Ht,v):[]}function tn(c){return W.InlineValueText.is(c)?new E.InlineValueText(h(c.range),c.text):W.InlineValueVariableLookup.is(c)?new E.InlineValueVariableLookup(h(c.range),c.variableName,c.caseSensitiveLookup):new E.InlineValueEvaluatableExpression(h(c.range),c.expression)}async function yn(c,v){return Array.isArray(c)?le.map(c,tn,v):[]}async function ht(c,v){const b=typeof c.label=="string"?c.label:await le.map(c.label,d,v),P=new Jf.default(C(c.position),b);return c.kind!==void 0&&(P.kind=c.kind),c.textEdits!==void 0&&(P.textEdits=await L(c.textEdits,v)),c.tooltip!==void 0&&(P.tooltip=D(c.tooltip)),c.paddingLeft!==void 0&&(P.paddingLeft=c.paddingLeft),c.paddingRight!==void 0&&(P.paddingRight=c.paddingRight),c.data!==void 0&&(P.data=c.data),P}function d(c){const v=new E.InlayHintLabelPart(c.value);return c.location!==void 0&&(v.location=$e(c.location)),c.tooltip!==void 0&&(v.tooltip=D(c.tooltip)),c.command!==void 0&&(v.command=Be(c.command)),v}function D(c){return typeof c=="string"?c:ne(c)}async function O(c,v){if(Array.isArray(c))return le.mapAsync(c,ht,v)}function J(c){if(c===null)return;const v=new zf.default(ee(c.kind),c.name,c.detail||"",o(c.uri),h(c.range),h(c.selectionRange),c.data);return c.tags!==void 0&&(v.tags=me(c.tags)),v}async function te(c,v){if(c!==null)return le.map(c,J,v)}async function Te(c,v){return new E.CallHierarchyIncomingCall(J(c.from),await w(c.fromRanges,v))}async function He(c,v){if(c!==null)return le.mapAsync(c,Te,v)}async function je(c,v){return new E.CallHierarchyOutgoingCall(J(c.to),await w(c.fromRanges,v))}async function En(c,v){if(c!==null)return le.mapAsync(c,je,v)}async function g(c,v){if(c!=null)return new E.SemanticTokens(new Uint32Array(c.data),c.resultId)}function Se(c){return new E.SemanticTokensEdit(c.start,c.deleteCount,c.data!==void 0?new Uint32Array(c.data):void 0)}async function Pe(c,v){if(c!=null)return new E.SemanticTokensEdits(c.edits.map(Se),c.resultId)}function $(c){return c}async function y(c,v){if(c!=null)return new E.LinkedEditingRanges(await w(c.ranges,v),S(c.wordPattern))}function S(c){if(c!=null)return new RegExp(c)}function F(c){if(c===null)return;let v=new Bf.default(ee(c.kind),c.name,c.detail||"",o(c.uri),h(c.range),h(c.selectionRange),c.data);return c.tags!==void 0&&(v.tags=me(c.tags)),v}async function I(c,v){if(c!==null)return le.map(c,F,v)}function Ce(c){if(St.string(c))return c;if(W.RelativePattern.is(c)){if(W.URI.is(c.baseUri))return new E.RelativePattern(o(c.baseUri),c.pattern);if(W.WorkspaceFolder.is(c.baseUri)){const v=E.workspace.getWorkspaceFolder(o(c.baseUri.uri));return v!==void 0?new E.RelativePattern(v,c.pattern):void 0}}}async function ye(c,v){if(!c)return;if(Array.isArray(c))return le.map(c,X=>be(X),v);const b=c,P=await le.map(b.items,X=>be(X),v);return new E.InlineCompletionList(P)}function be(c){let v;typeof c.insertText=="string"?v=c.insertText:v=new E.SnippetString(c.insertText.value);let b;c.command&&(b=Be(c.command));const P=new E.InlineCompletionItem(v,h(c.range),b);return c.filterText&&(P.filterText=c.filterText),P}return{asUri:o,asDocumentSelector:s,asDiagnostics:a,asDiagnostic:l,asRange:h,asRanges:w,asPosition:C,asDiagnosticSeverity:R,asDiagnosticTag:p,asHover:ve,asCompletionResult:se,asCompletionItem:Le,asTextEdit:A,asTextEdits:L,asSignatureHelp:ge,asSignatureInformations:Bt,asSignatureInformation:Re,asParameterInformations:Vt,asParameterInformation:Ue,asDeclarationResult:kt,asDefinitionResult:ft,asLocation:$e,asReferences:Lt,asDocumentHighlights:Je,asDocumentHighlight:ze,asDocumentHighlightKind:ot,asSymbolKind:ee,asSymbolTag:nt,asSymbolTags:me,asSymbolInformations:Qe,asSymbolInformation:Ge,asDocumentSymbols:jt,asDocumentSymbol:Ft,asCommand:Be,asCommands:gt,asCodeAction:Jt,asCodeActionKind:st,asCodeActionKinds:fn,asCodeActionResult:gn,asCodeLens:Qt,asCodeLenses:Gt,asWorkspaceEdit:Ot,asDocumentLink:At,asDocumentLinks:hn,asFoldingRangeKind:Zt,asFoldingRange:en,asFoldingRanges:mn,asColor:ct,asColorInformation:$t,asColorInformations:Xt,asColorPresentation:Yt,asColorPresentations:pn,asSelectionRange:Ht,asSelectionRanges:it,asInlineValue:tn,asInlineValues:yn,asInlayHint:ht,asInlayHints:O,asSemanticTokensLegend:$,asSemanticTokens:g,asSemanticTokensEdit:Se,asSemanticTokensEdits:Pe,asCallHierarchyItem:J,asCallHierarchyItems:te,asCallHierarchyIncomingCall:Te,asCallHierarchyIncomingCalls:He,asCallHierarchyOutgoingCall:je,asCallHierarchyOutgoingCalls:En,asLinkedEditingRanges:y,asTypeHierarchyItem:F,asTypeHierarchyItems:I,asGlobPattern:Ce,asInlineCompletionResult:ye,asInlineCompletionItem:be}}xr.createConverter=Qf;var ce={};Object.defineProperty(ce,"__esModule",{value:!0}),ce.generateUuid=ce.parse=ce.isUUID=ce.v4=ce.empty=void 0;class Vs{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class Z extends Vs{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return Z._oneOf(Z._chars)}constructor(){super([Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),"-",Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),"-","4",Z._randomHex(),Z._randomHex(),Z._randomHex(),"-",Z._oneOf(Z._timeHighBits),Z._randomHex(),Z._randomHex(),Z._randomHex(),"-",Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex(),Z._randomHex()].join(""))}}Z._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],Z._timeHighBits=["8","9","a","b"],ce.empty=new Vs("00000000-0000-0000-0000-000000000000");function ju(){return new Z}ce.v4=ju;const Gf=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Au(t){return Gf.test(t)}ce.isUUID=Au;function Xf(t){if(!Au(t))throw new Error("invalid uuid");return new Vs(t)}ce.parse=Xf;function Yf(){return ju().asHex()}ce.generateUuid=Yf;var Mi={};Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.ProgressPart=void 0;const $u=H,Hu=U,Wu=fe;class Zf{constructor(e,n,i){this._client=e,this._token=n,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(Hu.WorkDoneProgress.type,this._token,r=>{switch(r.kind){case"begin":this.begin(r);break;case"report":this.report(r);break;case"end":this.done(),i&&i(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&$u.window.withProgress({location:$u.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(n,i)=>{if(this._lspProgressDisposable!==void 0)return this._progress=n,this._cancellationToken=i,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(Hu.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((r,o)=>{this._resolve=r,this._reject=o})})}report(e){if(this._infinite&&Wu.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(Wu.number(e.percentage)){const n=Math.max(0,Math.min(e.percentage,100)),i=Math.max(0,n-this._reported);this._reported+=i,this._progress!==void 0&&this._progress.report({message:e.message,increment:i})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}}Mi.ProgressPart=Zf;var j={};Object.defineProperty(j,"__esModule",{value:!0}),j.WorkspaceFeature=j.TextDocumentLanguageFeature=j.TextDocumentEventFeature=j.DynamicDocumentFeature=j.DynamicFeature=j.StaticFeature=j.ensure=j.LSPCancellationError=void 0;const Ln=H,Js=U,rt=fe,Ku=ce;class eg extends Ln.CancellationError{constructor(e){super(),this.data=e}}j.LSPCancellationError=eg;function tg(t,e){return t[e]===void 0&&(t[e]={}),t[e]}j.ensure=tg;var Uu;(function(t){function e(n){const i=n;return i!=null&&rt.func(i.fillClientCapabilities)&&rt.func(i.initialize)&&rt.func(i.getState)&&rt.func(i.clear)&&(i.fillInitializeParams===void 0||rt.func(i.fillInitializeParams))}t.is=e})(Uu||(j.StaticFeature=Uu={}));var zu;(function(t){function e(n){const i=n;return i!=null&&rt.func(i.fillClientCapabilities)&&rt.func(i.initialize)&&rt.func(i.getState)&&rt.func(i.clear)&&(i.fillInitializeParams===void 0||rt.func(i.fillInitializeParams))&&rt.func(i.register)&&rt.func(i.unregister)&&i.registrationType!==void 0}t.is=e})(zu||(j.DynamicFeature=zu={}));class Qs{constructor(e){this._client=e}getState(){const e=this.getDocumentSelectors();let n=0;for(const r of e){n++;for(const o of Ln.workspace.textDocuments)if(Ln.languages.match(r,o)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}const i=n>0;return{kind:"document",id:this.registrationType.method,registrations:i,matches:!1}}}j.DynamicDocumentFeature=Qs;class ng extends Qs{static textDocumentFilter(e,n){for(const i of e)if(Ln.languages.match(i,n)>0)return!0;return!1}constructor(e,n,i,r,o,s,a){super(e),this._event=n,this._type=i,this._middleware=r,this._createParams=o,this._textDocument=s,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new Ln.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(n=>{this.callback(n).catch(i=>{this._client.error(`Sending document notification ${this._type.method} failed.`,i)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){const n=async i=>{const r=this._createParams(i);await this._client.sendNotification(this._type,r),this.notificationSent(this.getTextDocument(i),this._type,r)};if(this.matches(e)){const i=this._middleware();return i?i(e,r=>n(r)):n(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,n,i){this._onNotificationSent.fire({textDocument:e,type:n,params:i})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(const n of this._selectors.values())if(Ln.languages.match(n,e)>0)return{send:i=>this.callback(i)}}}j.TextDocumentEventFeature=ng;class ig extends Qs{constructor(e,n){super(e),this._registrationType=n,this._registrations=new Map}*getDocumentSelectors(){for(const e of this._registrations.values()){const n=e.data.registerOptions.documentSelector;n!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(n))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let n=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:n[0],data:e,provider:n[1]})}unregister(e){let n=this._registrations.get(e);n!==void 0&&n.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,n){if(n){if(Js.TextDocumentRegistrationOptions.is(n)){const i=Js.StaticRegistrationOptions.hasId(n)?n.id:Ku.generateUuid(),r=n.documentSelector??e;if(r)return[i,Object.assign({},n,{documentSelector:r})]}else if(rt.boolean(n)&&n===!0||Js.WorkDoneProgressOptions.is(n)){if(!e)return[void 0,void 0];const i=rt.boolean(n)&&n===!0?{documentSelector:e}:Object.assign({},n,{documentSelector:e});return[Ku.generateUuid(),i]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,n){if(!(!e||!n))return rt.boolean(n)&&n===!0?{documentSelector:e}:Object.assign({},n,{documentSelector:e})}getProvider(e){for(const n of this._registrations.values()){let i=n.data.registerOptions.documentSelector;if(i!==null&&Ln.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(i),e)>0)return n.provider}}getAllProviders(){const e=[];for(const n of this._registrations.values())e.push(n.provider);return e}}j.TextDocumentLanguageFeature=ig;class rg{constructor(e,n){this._client=e,this._registrationType=n,this._registrations=new Map}getState(){const e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){const n=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:n[0],provider:n[1]})}unregister(e){let n=this._registrations.get(e);n!==void 0&&n.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){const e=[];for(const n of this._registrations.values())e.push(n.provider);return e}}j.WorkspaceFeature=rg;var an={};const og=typeof process=="object"&&process&&process.platform==="win32";var sg=og?{sep:"\\"}:{sep:"/"},ag=Bu;function Bu(t,e,n){t instanceof RegExp&&(t=Vu(t,n)),e instanceof RegExp&&(e=Vu(e,n));var i=Ju(t,e,n);return i&&{start:i[0],end:i[1],pre:n.slice(0,i[0]),body:n.slice(i[0]+t.length,i[1]),post:n.slice(i[1]+e.length)}}function Vu(t,e){var n=e.match(t);return n?n[0]:null}Bu.range=Ju;function Ju(t,e,n){var i,r,o,s,a,u=n.indexOf(t),l=n.indexOf(e,u+1),f=u;if(u>=0&&l>0){if(t===e)return[u,l];for(i=[],o=n.length;f>=0&&!a;)f==u?(i.push(f),u=n.indexOf(t,f+1)):i.length==1?a=[i.pop(),l]:(r=i.pop(),r<o&&(o=r,s=l),l=n.indexOf(e,f+1)),f=u<l&&u>=0?u:l;i.length&&(a=[o,s])}return a}var Qu=ag,cg=dg,Gu="\0SLASH"+Math.random()+"\0",Xu="\0OPEN"+Math.random()+"\0",Gs="\0CLOSE"+Math.random()+"\0",Yu="\0COMMA"+Math.random()+"\0",Zu="\0PERIOD"+Math.random()+"\0";function Xs(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function ug(t){return t.split("\\\\").join(Gu).split("\\{").join(Xu).split("\\}").join(Gs).split("\\,").join(Yu).split("\\.").join(Zu)}function lg(t){return t.split(Gu).join("\\").split(Xu).join("{").split(Gs).join("}").split(Yu).join(",").split(Zu).join(".")}function el(t){if(!t)return[""];var e=[],n=Qu("{","}",t);if(!n)return t.split(",");var i=n.pre,r=n.body,o=n.post,s=i.split(",");s[s.length-1]+="{"+r+"}";var a=el(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),e.push.apply(e,s),e}function dg(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),Ii(ug(t),!0).map(lg)):[]}function fg(t){return"{"+t+"}"}function gg(t){return/^-?0\d/.test(t)}function hg(t,e){return t<=e}function pg(t,e){return t>=e}function Ii(t,e){var n=[],i=Qu("{","}",t);if(!i)return[t];var r=i.pre,o=i.post.length?Ii(i.post,!1):[""];if(/\$$/.test(i.pre))for(var s=0;s<o.length;s++){var a=r+"{"+i.body+"}"+o[s];n.push(a)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),f=u||l,m=i.body.indexOf(",")>=0;if(!f&&!m)return i.post.match(/,.*\}/)?(t=i.pre+"{"+i.body+Gs+i.post,Ii(t)):[t];var p;if(f)p=i.body.split(/\.\./);else if(p=el(i.body),p.length===1&&(p=Ii(p[0],!1).map(fg),p.length===1))return o.map(function(Le){return i.pre+p[0]+Le});var C;if(f){var h=Xs(p[0]),w=Xs(p[1]),R=Math.max(p[0].length,p[1].length),M=p.length==3?Math.abs(Xs(p[2])):1,K=hg,ne=w<h;ne&&(M*=-1,K=pg);var ve=p.some(gg);C=[];for(var se=h;K(se,w);se+=M){var de;if(l)de=String.fromCharCode(se),de==="\\"&&(de="");else if(de=String(se),ve){var x=R-de.length;if(x>0){var V=new Array(x+1).join("0");se<0?de="-"+V+de.slice(1):de=V+de}}C.push(de)}}else{C=[];for(var G=0;G<p.length;G++)C.push.apply(C,Ii(p[G],!1))}for(var G=0;G<C.length;G++)for(var s=0;s<o.length;s++){var a=r+C[G]+o[s];(!e||f||a)&&n.push(a)}}return n}const pt=Lr=(t,e,n={})=>(jr(e),!n.nocomment&&e.charAt(0)==="#"?!1:new Ar(e,n).match(t));var Lr=pt;const Ys=sg;pt.sep=Ys.sep;const Mt=Symbol("globstar **");pt.GLOBSTAR=Mt;const mg=cg,tl={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Zs="[^/]",ea=Zs+"*?",yg="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",vg="(?:(?!(?:\\/|^)\\.).)*?",nl=t=>t.split("").reduce((e,n)=>(e[n]=!0,e),{}),il=nl("().*{}+?[]^$\\!"),Cg=nl("[.("),rl=/\/+/;pt.filter=(t,e={})=>(n,i,r)=>pt(n,t,e);const Tn=(t,e={})=>{const n={};return Object.keys(t).forEach(i=>n[i]=t[i]),Object.keys(e).forEach(i=>n[i]=e[i]),n};pt.defaults=t=>{if(!t||typeof t!="object"||!Object.keys(t).length)return pt;const e=pt,n=(i,r,o)=>e(i,r,Tn(t,o));return n.Minimatch=class extends e.Minimatch{constructor(r,o){super(r,Tn(t,o))}},n.Minimatch.defaults=i=>e.defaults(Tn(t,i)).Minimatch,n.filter=(i,r)=>e.filter(i,Tn(t,r)),n.defaults=i=>e.defaults(Tn(t,i)),n.makeRe=(i,r)=>e.makeRe(i,Tn(t,r)),n.braceExpand=(i,r)=>e.braceExpand(i,Tn(t,r)),n.match=(i,r,o)=>e.match(i,r,Tn(t,o)),n},pt.braceExpand=(t,e)=>ol(t,e);const ol=(t,e={})=>(jr(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:mg(t)),_g=1024*64,jr=t=>{if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>_g)throw new TypeError("pattern is too long")},ta=Symbol("subparse");pt.makeRe=(t,e)=>new Ar(t,e||{}).makeRe(),pt.match=(t,e,n={})=>{const i=new Ar(e,n);return t=t.filter(r=>i.match(r)),i.options.nonull&&!t.length&&t.push(e),t};const Dg=t=>t.replace(/\\(.)/g,"$1"),bg=t=>t.replace(/\\([^-\]])/g,"$1"),wg=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Sg=t=>t.replace(/[[\]\\]/g,"\\$&");class Ar{constructor(e,n){jr(e),n||(n={}),this.options=n,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!n.windowsPathsNoEscape||n.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!n.partial,this.make()}debug(){}make(){const e=this.pattern,n=this.options;if(!n.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let i=this.globSet=this.braceExpand();n.debug&&(this.debug=(...r)=>console.error(...r)),this.debug(this.pattern,i),i=this.globParts=i.map(r=>r.split(rl)),this.debug(this.pattern,i),i=i.map((r,o,s)=>r.map(this.parse,this)),this.debug(this.pattern,i),i=i.filter(r=>r.indexOf(!1)===-1),this.debug(this.pattern,i),this.set=i}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let n=!1,i=0;for(let r=0;r<e.length&&e.charAt(r)==="!";r++)n=!n,i++;i&&(this.pattern=e.slice(i)),this.negate=n}matchOne(e,n,i){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:n}),this.debug("matchOne",e.length,n.length);for(var o=0,s=0,a=e.length,u=n.length;o<a&&s<u;o++,s++){this.debug("matchOne loop");var l=n[s],f=e[o];if(this.debug(n,l,f),l===!1)return!1;if(l===Mt){this.debug("GLOBSTAR",[n,l,f]);var m=o,p=s+1;if(p===u){for(this.debug("** at the end");o<a;o++)if(e[o]==="."||e[o]===".."||!r.dot&&e[o].charAt(0)===".")return!1;return!0}for(;m<a;){var C=e[m];if(this.debug(`
globstar while`,e,m,n,p,C),this.matchOne(e.slice(m),n.slice(p),i))return this.debug("globstar found match!",m,a,C),!0;if(C==="."||C===".."||!r.dot&&C.charAt(0)==="."){this.debug("dot detected!",e,m,n,p);break}this.debug("globstar swallow a segment, and continue"),m++}return!!(i&&(this.debug(`
>>> no match, partial?`,e,m,n,p),m===a))}var h;if(typeof l=="string"?(h=f===l,this.debug("string match",l,f,h)):(h=f.match(l),this.debug("pattern match",l,f,h)),!h)return!1}if(o===a&&s===u)return!0;if(o===a)return i;if(s===u)return o===a-1&&e[o]==="";throw new Error("wtf?")}braceExpand(){return ol(this.pattern,this.options)}parse(e,n){jr(e);const i=this.options;if(e==="**")if(i.noglobstar)e="*";else return Mt;if(e==="")return"";let r="",o=!1,s=!1;const a=[],u=[];let l,f=!1,m=-1,p=-1,C,h,w,R=e.charAt(0)===".",M=i.dot||R;const K=()=>R?"":M?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",ne=x=>x.charAt(0)==="."?"":i.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",ve=()=>{if(l){switch(l){case"*":r+=ea,o=!0;break;case"?":r+=Zs,o=!0;break;default:r+="\\"+l;break}this.debug("clearStateChar %j %j",l,r),l=!1}};for(let x=0,V;x<e.length&&(V=e.charAt(x));x++){if(this.debug("%s	%s %s %j",e,x,r,V),s){if(V==="/")return!1;il[V]&&(r+="\\"),r+=V,s=!1;continue}switch(V){case"/":return!1;case"\\":if(f&&e.charAt(x+1)==="-"){r+=V;continue}ve(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,x,r,V),f){this.debug("  in class"),V==="!"&&x===p+1&&(V="^"),r+=V;continue}this.debug("call clearStateChar %j",l),ve(),l=V,i.noext&&ve();continue;case"(":{if(f){r+="(";continue}if(!l){r+="\\(";continue}const G={type:l,start:x-1,reStart:r.length,open:tl[l].open,close:tl[l].close};this.debug(this.pattern,"	",G),a.push(G),r+=G.open,G.start===0&&G.type!=="!"&&(R=!0,r+=ne(e.slice(x+1))),this.debug("plType %j %j",l,r),l=!1;continue}case")":{const G=a[a.length-1];if(f||!G){r+="\\)";continue}a.pop(),ve(),o=!0,h=G,r+=h.close,h.type==="!"&&u.push(Object.assign(h,{reEnd:r.length}));continue}case"|":{const G=a[a.length-1];if(f||!G){r+="\\|";continue}ve(),r+="|",G.start===0&&G.type!=="!"&&(R=!0,r+=ne(e.slice(x+1)));continue}case"[":if(ve(),f){r+="\\"+V;continue}f=!0,p=x,m=r.length,r+=V;continue;case"]":if(x===p+1||!f){r+="\\"+V;continue}C=e.substring(p+1,x);try{RegExp("["+Sg(bg(C))+"]"),r+=V}catch{r=r.substring(0,m)+"(?:$.)"}o=!0,f=!1;continue;default:ve(),il[V]&&!(V==="^"&&f)&&(r+="\\"),r+=V;break}}for(f&&(C=e.slice(p+1),w=this.parse(C,ta),r=r.substring(0,m)+"\\["+w[0],o=o||w[1]),h=a.pop();h;h=a.pop()){let x;x=r.slice(h.reStart+h.open.length),this.debug("setting tail",r,h),x=x.replace(/((?:\\{2}){0,64})(\\?)\|/g,(G,Le,pe)=>(pe||(pe="\\"),Le+Le+pe+"|")),this.debug(`tail=%j
   %s`,x,x,h,r);const V=h.type==="*"?ea:h.type==="?"?Zs:"\\"+h.type;o=!0,r=r.slice(0,h.reStart)+V+"\\("+x}ve(),s&&(r+="\\\\");const se=Cg[r.charAt(0)];for(let x=u.length-1;x>-1;x--){const V=u[x],G=r.slice(0,V.reStart),Le=r.slice(V.reStart,V.reEnd-8);let pe=r.slice(V.reEnd);const Pt=r.slice(V.reEnd-8,V.reEnd)+pe,T=G.split(")").length,A=G.split("(").length-T;let L=pe;for(let ge=0;ge<A;ge++)L=L.replace(/\)[+*?]?/,"");pe=L;const q=pe===""&&n!==ta?"(?:$|\\/)":"";r=G+Le+pe+q+Pt}if(r!==""&&o&&(r="(?=.)"+r),se&&(r=K()+r),n===ta)return[r,o];if(i.nocase&&!o&&(o=e.toUpperCase()!==e.toLowerCase()),!o)return Dg(e);const de=i.nocase?"i":"";try{return Object.assign(new RegExp("^"+r+"$",de),{_glob:e,_src:r})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const n=this.options,i=n.noglobstar?ea:n.dot?yg:vg,r=n.nocase?"i":"";let o=e.map(s=>(s=s.map(a=>typeof a=="string"?wg(a):a===Mt?Mt:a._src).reduce((a,u)=>(a[a.length-1]===Mt&&u===Mt||a.push(u),a),[]),s.forEach((a,u)=>{a!==Mt||s[u-1]===Mt||(u===0?s.length>1?s[u+1]="(?:\\/|"+i+"\\/)?"+s[u+1]:s[u]=i:u===s.length-1?s[u-1]+="(?:\\/|"+i+")?":(s[u-1]+="(?:\\/|\\/"+i+"\\/)"+s[u+1],s[u+1]=Mt))}),s.filter(a=>a!==Mt).join("/"))).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,r)}catch{this.regexp=!1}return this.regexp}match(e,n=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&n)return!0;const i=this.options;Ys.sep!=="/"&&(e=e.split(Ys.sep).join("/")),e=e.split(rl),this.debug(this.pattern,"split",e);const r=this.set;this.debug(this.pattern,"set",r);let o;for(let s=e.length-1;s>=0&&(o=e[s],!o);s--);for(let s=0;s<r.length;s++){const a=r[s];let u=e;if(i.matchBase&&a.length===1&&(u=[o]),this.matchOne(u,a,n))return i.flipNegate?!0:!this.negate}return i.flipNegate?!1:this.negate}static defaults(e){return pt.defaults(e).Minimatch}}pt.Minimatch=Ar,Object.defineProperty(an,"__esModule",{value:!0}),an.DiagnosticFeature=an.DiagnosticPullMode=an.vsdiag=void 0;const Rg=Lr,re=H,Me=U,Tg=ce,na=j;function $r(t,e){return t[e]===void 0&&(t[e]={}),t[e]}var Rt;(function(t){(function(e){e.full="full",e.unChanged="unChanged"})(t.DocumentDiagnosticReportKind||(t.DocumentDiagnosticReportKind={}))})(Rt||(an.vsdiag=Rt={}));var Hr;(function(t){t.onType="onType",t.onSave="onSave"})(Hr||(an.DiagnosticPullMode=Hr={}));var Ze;(function(t){t.active="open",t.reschedule="reschedule",t.outDated="drop"})(Ze||(Ze={}));class Gi{constructor(){this.open=new Set,this._onOpen=new re.EventEmitter,this._onClose=new re.EventEmitter,Gi.fillTabResources(this.open);const e=n=>{if(n.closed.length===0&&n.opened.length===0)return;const i=this.open,r=new Set;Gi.fillTabResources(r);const o=new Set,s=new Set(r);for(const a of i.values())r.has(a)?s.delete(a):o.add(a);if(this.open=r,o.size>0){const a=new Set;for(const u of o)a.add(re.Uri.parse(u));this._onClose.fire(a)}if(s.size>0){const a=new Set;for(const u of s)a.add(re.Uri.parse(u));this._onOpen.fire(a)}};re.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=re.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof re.Uri?re.window.activeTextEditor?.document.uri===e:re.window.activeTextEditor?.document===e}isVisible(e){const n=e instanceof re.Uri?e:e.uri;return this.open.has(n.toString())}getTabResources(){const e=new Set;return Gi.fillTabResources(new Set,e),e}static fillTabResources(e,n){const i=e??new Set;for(const r of re.window.tabGroups.all)for(const o of r.tabs){const s=o.input;let a;s instanceof re.TabInputText?a=s.uri:s instanceof re.TabInputTextDiff?a=s.modified:s instanceof re.TabInputCustom&&(a=s.uri),a!==void 0&&!i.has(a.toString())&&(i.add(a.toString()),n!==void 0&&n.add(a))}}}var Ae;(function(t){t[t.document=1]="document",t[t.workspace=2]="workspace"})(Ae||(Ae={}));var cn;(function(t){function e(n){return n instanceof re.Uri?n.toString():n.uri.toString()}t.asKey=e})(cn||(cn={}));class Pg{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,n,i){const r=e===Ae.document?this.documentPullStates:this.workspacePullStates,[o,s,a]=n instanceof re.Uri?[n.toString(),n,i]:[n.uri.toString(),n.uri,n.version];let u=r.get(o);return u===void 0&&(u={document:s,pulledVersion:a,resultId:void 0},r.set(o,u)),u}update(e,n,i,r){const o=e===Ae.document?this.documentPullStates:this.workspacePullStates,[s,a,u,l]=n instanceof re.Uri?[n.toString(),n,i,r]:[n.uri.toString(),n.uri,n.version,i];let f=o.get(s);f===void 0?(f={document:a,pulledVersion:u,resultId:l},o.set(s,f)):(f.pulledVersion=u,f.resultId=l)}unTrack(e,n){const i=cn.asKey(n);(e===Ae.document?this.documentPullStates:this.workspacePullStates).delete(i)}tracks(e,n){const i=cn.asKey(n);return(e===Ae.document?this.documentPullStates:this.workspacePullStates).has(i)}getResultId(e,n){const i=cn.asKey(n);return(e===Ae.document?this.documentPullStates:this.workspacePullStates).get(i)?.resultId}getAllResultIds(){const e=[];for(let[n,i]of this.workspacePullStates)this.documentPullStates.has(n)&&(i=this.documentPullStates.get(n)),i.resultId!==void 0&&e.push({uri:n,value:i.resultId});return e}}class kg{constructor(e,n,i){this.client=e,this.tabs=n,this.options=i,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new re.EventEmitter,this.provider=this.createProvider(),this.diagnostics=re.languages.createDiagnosticCollection(i.identifier),this.openRequests=new Map,this.documentStates=new Pg,this.workspaceErrorCounter=0}knows(e,n){const i=n instanceof re.Uri?n:n.uri;return this.documentStates.tracks(e,n)||this.openRequests.has(i.toString())}forget(e,n){this.documentStates.unTrack(e,n)}pull(e,n){if(this.isDisposed)return;const i=e instanceof re.Uri?e:e.uri;this.pullAsync(e).then(()=>{n&&n()},r=>{this.client.error(`Document pull failed for text document ${i.toString()}`,r,!1)})}async pullAsync(e,n){if(this.isDisposed)return;const i=e instanceof re.Uri,r=i?e:e.uri,o=r.toString();n=i?n:e.version;const s=this.openRequests.get(o),a=i?this.documentStates.track(Ae.document,e,n):this.documentStates.track(Ae.document,e);if(s===void 0){const u=new re.CancellationTokenSource;this.openRequests.set(o,{state:Ze.active,document:e,version:n,tokenSource:u});let l,f;try{l=await this.provider.provideDiagnostics(e,a.resultId,u.token)??{kind:Rt.DocumentDiagnosticReportKind.full,items:[]}}catch(m){if(m instanceof na.LSPCancellationError&&Me.DiagnosticServerCancellationData.is(m.data)&&m.data.retriggerRequest===!1&&(f={state:Ze.outDated,document:e}),f===void 0&&m instanceof re.CancellationError)f={state:Ze.reschedule,document:e};else throw m}if(f=f??this.openRequests.get(o),f===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${o}`),this.diagnostics.delete(r);return}if(this.openRequests.delete(o),!this.tabs.isVisible(e)){this.documentStates.unTrack(Ae.document,e);return}if(f.state===Ze.outDated)return;l!==void 0&&(l.kind===Rt.DocumentDiagnosticReportKind.full&&this.diagnostics.set(r,l.items),a.pulledVersion=n,a.resultId=l.resultId),f.state===Ze.reschedule&&this.pull(e)}else s.state===Ze.active?(s.tokenSource.cancel(),this.openRequests.set(o,{state:Ze.reschedule,document:s.document})):s.state===Ze.outDated&&this.openRequests.set(o,{state:Ze.reschedule,document:s.document})}forgetDocument(e){const n=e instanceof re.Uri?e:e.uri,i=n.toString(),r=this.openRequests.get(i);this.options.workspaceDiagnostics?r!==void 0?this.openRequests.set(i,{state:Ze.reschedule,document:e}):this.pull(e,()=>{this.forget(Ae.document,e)}):(r!==void 0&&(r.state===Ze.active&&r.tokenSource.cancel(),this.openRequests.set(i,{state:Ze.outDated,document:e})),this.diagnostics.delete(n),this.forget(Ae.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,Me.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof na.LSPCancellationError)&&!Me.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,Me.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new re.CancellationTokenSource;const e=this.documentStates.getAllResultIds().map(n=>({uri:this.client.protocol2CodeConverter.asUri(n.uri),value:n.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,n=>{if(!(!n||this.isDisposed))for(const i of n.items)i.kind===Rt.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(Ae.document,i.uri)||this.diagnostics.set(i.uri,i.items)),this.documentStates.update(Ae.workspace,i.uri,i.version??void 0,i.resultId)})}createProvider(){const e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(n,i,r)=>{const o=(a,u,l)=>{const f={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof re.Uri?a:a.uri)},previousResultId:u};return this.isDisposed===!0||!this.client.isRunning()?{kind:Rt.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(Me.DocumentDiagnosticRequest.type,f,l).then(async m=>m==null||this.isDisposed||l.isCancellationRequested?{kind:Rt.DocumentDiagnosticReportKind.full,items:[]}:m.kind===Me.DocumentDiagnosticReportKind.Full?{kind:Rt.DocumentDiagnosticReportKind.full,resultId:m.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(m.items,l)}:{kind:Rt.DocumentDiagnosticReportKind.unChanged,resultId:m.resultId},m=>this.client.handleFailedRequest(Me.DocumentDiagnosticRequest.type,l,m,{kind:Rt.DocumentDiagnosticReportKind.full,items:[]}))},s=this.client.middleware;return s.provideDiagnostics?s.provideDiagnostics(n,i,r,o):o(n,i,r)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(n,i,r)=>{const o=async l=>l.kind===Me.DocumentDiagnosticReportKind.Full?{kind:Rt.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version,items:await this.client.protocol2CodeConverter.asDiagnostics(l.items,i)}:{kind:Rt.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version},s=l=>{const f=[];for(const m of l)f.push({uri:this.client.code2ProtocolConverter.asUri(m.uri),value:m.value});return f},a=(l,f)=>{const m=(0,Tg.generateUuid)(),p=this.client.onProgress(Me.WorkspaceDiagnosticRequest.partialResult,m,async h=>{if(h==null){r(null);return}const w={items:[]};for(const R of h.items)try{w.items.push(await o(R))}catch(M){this.client.error("Converting workspace diagnostics failed.",M)}r(w)}),C={identifier:this.options.identifier,previousResultIds:s(l),partialResultToken:m};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(Me.WorkspaceDiagnosticRequest.type,C,f).then(async h=>{if(f.isCancellationRequested)return{items:[]};const w={items:[]};for(const R of h.items)w.items.push(await o(R));return p.dispose(),r(w),{items:[]}},h=>(p.dispose(),this.client.handleFailedRequest(Me.DocumentDiagnosticRequest.type,f,h,{items:[]})))},u=this.client.middleware;return u.provideWorkspaceDiagnostics?u.provideWorkspaceDiagnostics(n,i,r,a):a(n,i)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(const[e,n]of this.openRequests)n.state===Ze.active&&n.tokenSource.cancel(),this.openRequests.set(e,{state:Ze.outDated,document:n.document});this.diagnostics.dispose()}}class Fg{constructor(e){this.diagnosticRequestor=e,this.documents=new Me.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;const n=cn.asKey(e);this.documents.has(n)||(this.documents.set(n,e,Me.Touch.Last),this.trigger())}remove(e){const n=cn.asKey(e);this.documents.delete(n),this.documents.size===0?this.stop():n===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,Me.RAL)().timer.setInterval(()=>{const e=this.documents.first;if(e!==void 0){const n=cn.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(n,e,Me.Touch.Last),n===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?cn.asKey(this.endDocument):void 0}}class Eg{constructor(e,n,i){const r=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},o=e.protocol2CodeConverter.asDocumentSelector(i.documentSelector),s=[],a=h=>{const w=i.documentSelector;if(r.match!==void 0)return r.match(w,h);for(const R of w)if(Me.TextDocumentFilter.is(R)){if(typeof R=="string"||R.language!==void 0&&R.language!=="*"||R.scheme!==void 0&&R.scheme!=="*"&&R.scheme!==h.scheme)return!1;if(R.pattern!==void 0){const M=new Rg.Minimatch(R.pattern,{noext:!0});if(!M.makeRe()||!M.match(h.fsPath))return!1}}return!0},u=h=>h instanceof re.Uri?a(h):re.languages.match(o,h)>0&&n.isVisible(h),l=h=>h instanceof re.Uri?this.activeTextDocument?.uri.toString()===h.toString():this.activeTextDocument===h;this.diagnosticRequestor=new kg(e,n,i),this.backgroundScheduler=new Fg(this.diagnosticRequestor);const f=h=>{!u(h)||!i.interFileDependencies||l(h)||this.backgroundScheduler.add(h)};this.activeTextDocument=re.window.activeTextEditor?.document,re.window.onDidChangeActiveTextEditor(h=>{const w=this.activeTextDocument;this.activeTextDocument=h?.document,w!==void 0&&f(w),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});const m=e.getFeature(Me.DidOpenTextDocumentNotification.method);s.push(m.onNotificationSent(h=>{const w=h.textDocument;this.diagnosticRequestor.knows(Ae.document,w)||u(w)&&this.diagnosticRequestor.pull(w,()=>{f(w)})})),s.push(n.onOpen(h=>{for(const w of h){if(this.diagnosticRequestor.knows(Ae.document,w))continue;const R=w.toString();let M;for(const K of re.workspace.textDocuments)if(R===K.uri.toString()){M=K;break}M!==void 0&&u(M)&&this.diagnosticRequestor.pull(M,()=>{f(M)})}}));const p=new Set;for(const h of re.workspace.textDocuments)u(h)&&(this.diagnosticRequestor.pull(h,()=>{f(h)}),p.add(h.uri.toString()));if(r.onTabs===!0)for(const h of n.getTabResources())!p.has(h.toString())&&u(h)&&this.diagnosticRequestor.pull(h,()=>{f(h)});if(r.onChange===!0){const h=e.getFeature(Me.DidChangeTextDocumentNotification.method);s.push(h.onNotificationSent(async w=>{const R=w.textDocument;(r.filter===void 0||!r.filter(R,Hr.onType))&&this.diagnosticRequestor.knows(Ae.document,R)&&this.diagnosticRequestor.pull(R,()=>{this.backgroundScheduler.trigger()})}))}if(r.onSave===!0){const h=e.getFeature(Me.DidSaveTextDocumentNotification.method);s.push(h.onNotificationSent(w=>{const R=w.textDocument;(r.filter===void 0||!r.filter(R,Hr.onSave))&&this.diagnosticRequestor.knows(Ae.document,R)&&this.diagnosticRequestor.pull(w.textDocument,()=>{this.backgroundScheduler.trigger()})}))}const C=e.getFeature(Me.DidCloseTextDocumentNotification.method);s.push(C.onNotificationSent(h=>{this.cleanUpDocument(h.textDocument)})),n.onClose(h=>{for(const w of h)this.cleanUpDocument(w)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(const h of re.workspace.textDocuments)u(h)&&this.diagnosticRequestor.pull(h)}),i.workspaceDiagnostics===!0&&i.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=re.Disposable.from(...s,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(Ae.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}}class Og extends na.TextDocumentLanguageFeature{constructor(e){super(e,Me.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let n=$r($r(e,"textDocument"),"diagnostic");n.dynamicRegistration=!0,n.relatedDocumentSupport=!1,$r($r(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,n){this._client.onRequest(Me.DiagnosticRefreshRequest.type,async()=>{for(const s of this.getAllProviders())s.onDidChangeDiagnosticsEmitter.fire()});let[r,o]=this.getRegistration(n,e.diagnosticProvider);!r||!o||this.register({id:r,registerOptions:o})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new Gi);const n=new Eg(this._client,this.tabs,e);return[n.disposable,n]}}an.DiagnosticFeature=Og;var Wr={};Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.NotebookDocumentSyncFeature=void 0;const et=H,qg=Lr,un=U,Mg=ce,sl=fe;function al(t,e){return t[e]===void 0&&(t[e]={}),t[e]}var li;(function(t){(function(e){function n(m,p){return{version:m.version,uri:p.asUri(m.uri)}}e.asVersionedNotebookDocumentIdentifier=n;function i(m,p,C){const h=un.NotebookDocument.create(C.asUri(m.uri),m.notebookType,m.version,r(p,C));return Object.keys(m.metadata).length>0&&(h.metadata=o(m.metadata)),h}e.asNotebookDocument=i;function r(m,p){return m.map(C=>s(C,p))}e.asNotebookCells=r;function o(m){return u(new Set,m)}e.asMetadata=o;function s(m,p){const C=un.NotebookCell.create(a(m.kind),p.asUri(m.document.uri));return Object.keys(m.metadata).length>0&&(C.metadata=o(m.metadata)),m.executionSummary!==void 0&&sl.number(m.executionSummary.executionOrder)&&sl.boolean(m.executionSummary.success)&&(C.executionSummary={executionOrder:m.executionSummary.executionOrder,success:m.executionSummary.success}),C}e.asNotebookCell=s;function a(m){switch(m){case et.NotebookCellKind.Markup:return un.NotebookCellKind.Markup;case et.NotebookCellKind.Code:return un.NotebookCellKind.Code}}function u(m,p){if(m.has(p))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(p)){const C=[];for(const h of p)if(h!==null&&typeof h=="object"||Array.isArray(h))C.push(u(m,h));else{if(h instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");C.push(h)}return C}else{const C=Object.keys(p),h=Object.create(null);for(const w of C){const R=p[w];if(R!==null&&typeof R=="object"||Array.isArray(R))h[w]=u(m,R);else{if(R instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");h[w]=R}}return h}}function l(m,p){const C=p.asChangeTextDocumentParams(m,m.document.uri,m.document.version);return{document:C.textDocument,changes:C.contentChanges}}e.asTextContentChange=l;function f(m,p){const C=Object.create(null);if(m.metadata&&(C.metadata=t.c2p.asMetadata(m.metadata)),m.cells!==void 0){const h=Object.create(null),w=m.cells;w.structure&&(h.structure={array:{start:w.structure.array.start,deleteCount:w.structure.array.deleteCount,cells:w.structure.array.cells!==void 0?w.structure.array.cells.map(R=>t.c2p.asNotebookCell(R,p)):void 0},didOpen:w.structure.didOpen!==void 0?w.structure.didOpen.map(R=>p.asOpenTextDocumentParams(R.document).textDocument):void 0,didClose:w.structure.didClose!==void 0?w.structure.didClose.map(R=>p.asCloseTextDocumentParams(R.document).textDocument):void 0}),w.data!==void 0&&(h.data=w.data.map(R=>t.c2p.asNotebookCell(R,p))),w.textContent!==void 0&&(h.textContent=w.textContent.map(R=>t.c2p.asTextContentChange(R,p))),Object.keys(h).length>0&&(C.cells=h)}return C}e.asNotebookDocumentChangeEvent=f})(t.c2p||(t.c2p={}))})(li||(li={}));var ia;(function(t){function e(a,u,l){const f=a.length,m=u.length;let p=0;for(;p<m&&p<f&&n(a[p],u[p],l);)p++;if(p<m&&p<f){let C=f-1,h=m-1;for(;C>=0&&h>=0&&n(a[C],u[h],l);)C--,h--;const w=C+1-p,R=p===h+1?void 0:u.slice(p,h+1);return R!==void 0?{start:p,deleteCount:w,cells:R}:{start:p,deleteCount:w}}else return p<m?{start:p,deleteCount:0,cells:u.slice(p)}:p<f?{start:p,deleteCount:f-p}:void 0}t.computeDiff=e;function n(a,u,l=!0){return a.kind!==u.kind||a.document.uri.toString()!==u.document.uri.toString()||a.document.languageId!==u.document.languageId||!i(a.executionSummary,u.executionSummary)?!1:!l||l&&o(a.metadata,u.metadata)}function i(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.executionOrder===u.executionOrder&&a.success===u.success&&r(a.timing,u.timing)}function r(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.startTime===u.startTime&&a.endTime===u.endTime}function o(a,u){if(a===u)return!0;if(a==null||u===null||u===void 0||typeof a!=typeof u||typeof a!="object")return!1;const l=Array.isArray(a),f=Array.isArray(u);if(l!==f)return!1;if(l&&f){if(a.length!==u.length)return!1;for(let m=0;m<a.length;m++)if(!o(a[m],u[m]))return!1}if(s(a)&&s(u)){const m=Object.keys(a),p=Object.keys(u);if(m.length!==p.length||(m.sort(),p.sort(),!o(m,p)))return!1;for(let C=0;C<m.length;C++){const h=m[C];if(!o(a[h],u[h]))return!1}return!0}return!1}function s(a){return a!==null&&typeof a=="object"}t.isObjectLiteral=s})(ia||(ia={}));var ra;(function(t){function e(n,i){if(typeof n=="string")return n==="*"||i.notebookType===n;if(n.notebookType!==void 0&&n.notebookType!=="*"&&i.notebookType!==n.notebookType)return!1;const r=i.uri;if(n.scheme!==void 0&&n.scheme!=="*"&&r.scheme!==n.scheme)return!1;if(n.pattern!==void 0){const o=new qg.Minimatch(n.pattern,{noext:!0});if(!o.makeRe()||!o.match(r.fsPath))return!1}return!0}t.matchNotebook=e})(ra||(ra={}));var Kr;(function(t){function e(i){const r=i.notebookSelector,o=[];for(const s of r){const a=(typeof s.notebook=="string"?s.notebook:s.notebook?.notebookType)??"*",u=typeof s.notebook=="string"?void 0:s.notebook?.scheme,l=typeof s.notebook=="string"?void 0:s.notebook?.pattern;if(s.cells!==void 0)for(const f of s.cells)o.push(n(a,u,l,f.language));else o.push(n(a,u,l,void 0))}return o}t.asDocumentSelector=e;function n(i,r,o,s){return r===void 0&&o===void 0?{notebook:i,language:s}:{notebook:{notebookType:i,scheme:r,pattern:o},language:s}}})(Kr||(Kr={}));var Ur;(function(t){function e(n){return{cells:n,uris:new Set(n.map(i=>i.document.uri.toString()))}}t.create=e})(Ur||(Ur={}));class zr{constructor(e,n){this.client=e,this.options=n,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(Kr.asDocumentSelector(n)),et.workspace.onDidOpenNotebookDocument(i=>{this.notebookDidOpen.add(i.uri.toString()),this.didOpen(i)},void 0,this.disposables);for(const i of et.workspace.notebookDocuments)this.notebookDidOpen.add(i.uri.toString()),this.didOpen(i);et.workspace.onDidChangeNotebookDocument(i=>this.didChangeNotebookDocument(i),void 0,this.disposables),this.options.save===!0&&et.workspace.onDidSaveNotebookDocument(i=>this.didSave(i),void 0,this.disposables),et.workspace.onDidCloseNotebookDocument(i=>{this.didClose(i),this.notebookDidOpen.delete(i.uri.toString())},void 0,this.disposables)}getState(){for(const e of et.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return et.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,n){if(et.languages.match(this.selector,n.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;const i=this.notebookSyncInfo.get(e.uri.toString()),r=this.cellMatches(e,n);if(i!==void 0){const o=i.uris.has(n.document.uri.toString());if(r&&o||!r&&!o)return;if(r){const s=this.getMatchingCells(e);if(s!==void 0){const a=this.asNotebookDocumentChangeEvent(e,void 0,i,s);a!==void 0&&this.doSendChange(a,s).catch(()=>{})}}}else r&&this.doSendOpen(e,[n]).catch(()=>{})}didChangeNotebookCellTextDocument(e,n){et.languages.match(this.selector,n.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[n]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,n){const i=this.notebookSyncInfo.get(e.uri.toString());if(i===void 0)return;const r=n.document.uri,o=i.cells.findIndex(s=>s.document.uri.toString()===r.toString());if(o!==-1)if(o===0&&i.cells.length===1)this.doSendClose(e,i.cells).catch(()=>{});else{const s=i.cells.slice(),a=s.splice(o,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:o,deleteCount:1},didClose:a}}},s).catch(()=>{})}}dispose(){for(const e of this.disposables)e.dispose()}didOpen(e,n=this.getMatchingCells(e),i=this.notebookSyncInfo.get(e.uri.toString())){if(i!==void 0)if(n!==void 0){const r=this.asNotebookDocumentChangeEvent(e,void 0,i,n);r!==void 0&&this.doSendChange(r,n).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(n===void 0)return;this.doSendOpen(e,n).catch(()=>{})}}didChangeNotebookDocument(e){const n=e.notebook,i=this.notebookSyncInfo.get(n.uri.toString());if(i===void 0){if(e.contentChanges.length===0)return;const r=this.getMatchingCells(n);if(r===void 0)return;this.didOpen(n,r,i)}else{const r=this.getMatchingCells(n);if(r===void 0){this.didClose(n,i);return}const o=this.asNotebookDocumentChangeEvent(e.notebook,e,i,r);o!==void 0&&this.doSendChange(o,r).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,n=this.notebookSyncInfo.get(e.uri.toString())){if(n===void 0)return;const i=e.getCells().filter(r=>n.uris.has(r.document.uri.toString()));this.doSendClose(e,i).catch(()=>{})}async sendDidOpenNotebookDocument(e){const n=this.getMatchingCells(e);if(n!==void 0)return this.doSendOpen(e,n)}async doSendOpen(e,n){const i=async(o,s)=>{const a=li.c2p.asNotebookDocument(o,s,this.client.code2ProtocolConverter),u=s.map(l=>this.client.code2ProtocolConverter.asTextDocumentItem(l.document));try{await this.client.sendNotification(un.DidOpenNotebookDocumentNotification.type,{notebookDocument:a,cellTextDocuments:u})}catch(l){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",l),l}},r=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),Ur.create(n)),r?.didOpen!==void 0?r.didOpen(e,n,i):i(e,n)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,n=this.getMatchingCells(e.notebook)){const i=async o=>{try{await this.client.sendNotification(un.DidChangeNotebookDocumentNotification.type,{notebookDocument:li.c2p.asVersionedNotebookDocumentIdentifier(o.notebook,this.client.code2ProtocolConverter),change:li.c2p.asNotebookDocumentChangeEvent(o,this.client.code2ProtocolConverter)})}catch(s){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",s),s}},r=this.client.middleware?.notebooks;return e.cells?.structure!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),Ur.create(n??[])),r?.didChange!==void 0?r?.didChange(e,i):i(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){const n=async r=>{try{await this.client.sendNotification(un.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(r.uri)}})}catch(o){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",o),o}},i=this.client.middleware?.notebooks;return i?.didSave!==void 0?i.didSave(e,n):n(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,n){const i=async(o,s)=>{try{await this.client.sendNotification(un.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)},cellTextDocuments:s.map(a=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(a.document))})}catch(a){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",a),a}},r=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),r?.didClose!==void 0?r.didClose(e,n,i):i(e,n)}asNotebookDocumentChangeEvent(e,n,i,r){if(n!==void 0&&n.notebook!==e)throw new Error("Notebook must be identical");const o={notebook:e};n?.metadata!==void 0&&(o.metadata=li.c2p.asMetadata(n.metadata));let s;if(n?.cellChanges!==void 0&&n.cellChanges.length>0){const a=[];s=new Set(r.map(u=>u.document.uri.toString()));for(const u of n.cellChanges)s.has(u.cell.document.uri.toString())&&(u.executionSummary!==void 0||u.metadata!==void 0)&&a.push(u.cell);a.length>0&&(o.cells=o.cells??{},o.cells.data=a)}if((n?.contentChanges!==void 0&&n.contentChanges.length>0||n===void 0)&&i!==void 0&&r!==void 0){const a=i.cells,u=r,l=ia.computeDiff(a,u,!1);let f,m;if(l!==void 0){f=l.cells===void 0?new Map:new Map(l.cells.map(h=>[h.document.uri.toString(),h])),m=l.deleteCount===0?new Map:new Map(a.slice(l.start,l.start+l.deleteCount).map(h=>[h.document.uri.toString(),h]));for(const h of Array.from(m.keys()))f.has(h)&&(m.delete(h),f.delete(h));o.cells=o.cells??{};const p=[],C=[];if(f.size>0||m.size>0){for(const h of f.values())p.push(h);for(const h of m.values())C.push(h)}o.cells.structure={array:l,didOpen:p,didClose:C}}}return Object.keys(o).length>1?o:void 0}getMatchingCells(e,n=e.getCells()){if(this.options.notebookSelector!==void 0){for(const i of this.options.notebookSelector)if(i.notebook===void 0||ra.matchNotebook(i.notebook,e)){const r=this.filterCells(e,n,i.cells);return r.length===0?void 0:r}}}cellMatches(e,n){const i=this.getMatchingCells(e,[n]);return i!==void 0&&i[0]===n}filterCells(e,n,i){const r=i!==void 0?n.filter(o=>{const s=o.document.languageId;return i.some(a=>a.language==="*"||s===a.language)}):n;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,r):r}}class zn{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=un.NotebookDocumentSyncRegistrationType.type,et.workspace.onDidOpenTextDocument(n=>{if(n.uri.scheme!==zn.CellScheme)return;const[i,r]=this.findNotebookDocumentAndCell(n);if(!(i===void 0||r===void 0))for(const o of this.registrations.values())o instanceof zr&&o.didOpenNotebookCellTextDocument(i,r)}),et.workspace.onDidChangeTextDocument(n=>{if(n.contentChanges.length===0)return;const i=n.document;if(i.uri.scheme!==zn.CellScheme)return;const[r]=this.findNotebookDocumentAndCell(i);if(r!==void 0)for(const o of this.registrations.values())o instanceof zr&&o.didChangeNotebookCellTextDocument(r,n)}),et.workspace.onDidCloseTextDocument(n=>{if(n.uri.scheme!==zn.CellScheme)return;const[i,r]=this.findNotebookDocumentAndCell(n);if(!(i===void 0||r===void 0))for(const o of this.registrations.values())o instanceof zr&&o.didCloseNotebookCellTextDocument(i,r)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(const e of this.registrations.values()){const n=e.getState();if(n.kind==="document"&&n.registrations===!0&&n.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){const n=al(al(e,"notebookDocument"),"synchronization");n.dynamicRegistration=!0,n.executionSummarySupport=!0}preInitialize(e){const n=e.notebookDocumentSync;n!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(Kr.asDocumentSelector(n)))}initialize(e){const n=e.notebookDocumentSync;if(n===void 0)return;const i=n.id??Mg.generateUuid();this.register({id:i,registerOptions:n})}register(e){const n=new zr(this.client,e.registerOptions);this.registrations.set(e.id,n)}unregister(e){const n=this.registrations.get(e);n&&n.dispose()}clear(){for(const e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==zn.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&et.languages.match(this.dedicatedChannel,e)>0)return!0;for(const n of this.registrations.values())if(n.handles(e))return!0;return!1}getProvider(e){for(const n of this.registrations.values())if(n.handles(e.document))return n}findNotebookDocumentAndCell(e){const n=e.uri.toString();for(const i of et.workspace.notebookDocuments)for(const r of i.getCells())if(r.document.uri.toString()===n)return[i,r];return[void 0,void 0]}}Wr.NotebookDocumentSyncFeature=zn,zn.CellScheme="vscode-notebook-cell";var Pn={};Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.SyncConfigurationFeature=Pn.toJSONObject=Pn.ConfigurationFeature=void 0;const di=H,xi=U,Ig=fe,xg=ce,cl=j;class Ng{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(xi.ConfigurationRequest.type,(n,i)=>{let r=s=>{let a=[];for(let u of s.items){let l=u.scopeUri!==void 0&&u.scopeUri!==null?this._client.protocol2CodeConverter.asUri(u.scopeUri):void 0;a.push(this.getConfiguration(l,u.section!==null?u.section:void 0))}return a},o=e.middleware.workspace;return o&&o.configuration?o.configuration(n,i,r):r(n)})}getConfiguration(e,n){let i=null;if(n){let r=n.lastIndexOf(".");if(r===-1)i=jn(di.workspace.getConfiguration(void 0,e).get(n));else{let o=di.workspace.getConfiguration(n.substr(0,r),e);o&&(i=jn(o.get(n.substr(r+1))))}}else{let r=di.workspace.getConfiguration(void 0,e);i={};for(let o of Object.keys(r))r.has(o)&&(i[o]=jn(r.get(o)))}return i===void 0&&(i=null),i}clear(){}}Pn.ConfigurationFeature=Ng;function jn(t){if(t){if(Array.isArray(t))return t.map(jn);if(typeof t=="object"){const e=Object.create(null);for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=jn(t[n]));return e}}return t}Pn.toJSONObject=jn;class Lg{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return xi.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,cl.ensure)((0,cl.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;e!==void 0&&this.register({id:xg.generateUuid(),registerOptions:{section:e}})}register(e){let n=di.workspace.onDidChangeConfiguration(i=>{this.onDidChangeConfiguration(e.registerOptions.section,i)});this._listeners.set(e.id,n),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let n=this._listeners.get(e);n&&(this._listeners.delete(e),n.dispose())}clear(){for(const e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,n){if(this.isCleared)return;let i;if(Ig.string(e)?i=[e]:i=e,i!==void 0&&n!==void 0&&!i.some(a=>n.affectsConfiguration(a)))return;const r=async s=>s===void 0?this._client.sendNotification(xi.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(xi.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(s)});let o=this._client.middleware.workspace?.didChangeConfiguration;(o?o(i,r):r(i)).catch(s=>{this._client.error(`Sending notification ${xi.DidChangeConfigurationNotification.type.method} failed`,s)})}extractSettingsInformation(e){function n(o,s){let a=o;for(let u=0;u<s.length-1;u++){let l=a[s[u]];l||(l=Object.create(null),a[s[u]]=l),a=l}return a}let i=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,r=Object.create(null);for(let o=0;o<e.length;o++){let s=e[o],a=s.indexOf("."),u=null;if(a>=0?u=di.workspace.getConfiguration(s.substr(0,a),i).get(s.substr(a+1)):u=di.workspace.getConfiguration(void 0,i).get(s),u){let l=e[o].split(".");n(r,l)[l[l.length-1]]=jn(u)}}return r}}Pn.SyncConfigurationFeature=Lg;var lt={};Object.defineProperty(lt,"__esModule",{value:!0}),lt.DidSaveTextDocumentFeature=lt.WillSaveWaitUntilFeature=lt.WillSaveFeature=lt.DidChangeTextDocumentFeature=lt.DidCloseTextDocumentFeature=lt.DidOpenTextDocumentFeature=void 0;const mt=H,De=U,Fe=j,fi=ce;class jg extends Fe.TextDocumentEventFeature{constructor(e,n){super(e,mt.workspace.onDidOpenTextDocument,De.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,i=>e.code2ProtocolConverter.asOpenTextDocumentParams(i),i=>i,Fe.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=n}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,n){const i=e.resolvedTextDocumentSync;n&&i&&i.openClose&&this.register({id:fi.generateUuid(),registerOptions:{documentSelector:n}})}get registrationType(){return De.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;const n=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);mt.workspace.textDocuments.forEach(i=>{const r=i.uri.toString();if(!this._syncedDocuments.has(r)&&mt.languages.match(n,i)>0&&!this._client.hasDedicatedTextSynchronizationFeature(i)){const o=this._client.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));(o.didOpen?o.didOpen(i,s):s(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(r,i)}})}getTextDocument(e){return e}notificationSent(e,n,i){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,n,i)}}lt.DidOpenTextDocumentFeature=jg;class Ag extends Fe.TextDocumentEventFeature{constructor(e,n,i){super(e,mt.workspace.onDidCloseTextDocument,De.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,r=>e.code2ProtocolConverter.asCloseTextDocumentParams(r),r=>r,Fe.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=n,this._pendingTextDocumentChanges=i}get registrationType(){return De.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,n){let i=e.resolvedTextDocumentSync;n&&i&&i.openClose&&this.register({id:fi.generateUuid(),registerOptions:{documentSelector:n}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,n,i){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,n,i)}unregister(e){const n=this._selectors.get(e);super.unregister(e);const i=this._selectors.values();this._syncedDocuments.forEach(r=>{if(mt.languages.match(n,r)>0&&!this._selectorFilter(i,r)&&!this._client.hasDedicatedTextSynchronizationFeature(r)){let o=this._client.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(r.uri.toString()),(o.didClose?o.didClose(r,s):s(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}}lt.DidCloseTextDocumentFeature=Ag;class $g extends Fe.DynamicDocumentFeature{constructor(e,n){super(e),this._changeData=new Map,this._onNotificationSent=new mt.EventEmitter,this._onPendingChangeAdded=new mt.EventEmitter,this._pendingTextDocumentChanges=n,this._syncKind=De.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return De.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,n){let i=e.resolvedTextDocumentSync;n&&i&&i.change!==void 0&&i.change!==De.TextDocumentSyncKind.None&&this.register({id:fi.generateUuid(),registerOptions:Object.assign({},{documentSelector:n},{syncKind:i.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=mt.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(const e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;const n=e.document.uri,i=e.document.version,r=[];for(const o of this._changeData.values())if(mt.languages.match(o.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){const s=this._client.middleware;if(o.syncKind===De.TextDocumentSyncKind.Incremental){const a=async u=>{const l=this._client.code2ProtocolConverter.asChangeTextDocumentParams(u,n,i);await this._client.sendNotification(De.DidChangeTextDocumentNotification.type,l),this.notificationSent(u.document,De.DidChangeTextDocumentNotification.type,l)};r.push(s.didChange?s.didChange(e,u=>a(u)):a(e))}else if(o.syncKind===De.TextDocumentSyncKind.Full){const a=async u=>{const l=u.document.uri.toString();this._pendingTextDocumentChanges.set(l,u.document),this._onPendingChangeAdded.fire()};r.push(s.didChange?s.didChange(e,u=>a(u)):a(e))}}return Promise.all(r).then(void 0,o=>{throw this._client.error(`Sending document notification ${De.DidChangeTextDocumentNotification.type.method} failed`,o),o})}notificationSent(e,n,i){this._onNotificationSent.fire({textDocument:e,type:n,params:i})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=De.TextDocumentSyncKind.None;else{this._syncKind=De.TextDocumentSyncKind.None;for(const n of this._changeData.values())if(this.updateSyncKind(n.syncKind),this._syncKind===De.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=De.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let n;if(e.size===0)n=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{n=[];for(const i of this._pendingTextDocumentChanges)e.has(i[0])||(n.push(i[1]),this._pendingTextDocumentChanges.delete(i[0]))}return n}getProvider(e){for(const n of this._changeData.values())if(mt.languages.match(n.documentSelector,e)>0)return{send:i=>this.callback(i)}}updateSyncKind(e){if(this._syncKind!==De.TextDocumentSyncKind.Full)switch(e){case De.TextDocumentSyncKind.Full:this._syncKind=e;break;case De.TextDocumentSyncKind.Incremental:this._syncKind===De.TextDocumentSyncKind.None&&(this._syncKind=De.TextDocumentSyncKind.Incremental);break}}}lt.DidChangeTextDocumentFeature=$g;class Hg extends Fe.TextDocumentEventFeature{constructor(e){super(e,mt.workspace.onWillSaveTextDocument,De.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,n=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(n),n=>n.document,(n,i)=>Fe.TextDocumentEventFeature.textDocumentFilter(n,i.document))}get registrationType(){return De.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let n=(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization");n.willSave=!0}initialize(e,n){let i=e.resolvedTextDocumentSync;n&&i&&i.willSave&&this.register({id:fi.generateUuid(),registerOptions:{documentSelector:n}})}getTextDocument(e){return e.document}}lt.WillSaveFeature=Hg;class Wg extends Fe.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return De.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let n=(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization");n.willSaveWaitUntil=!0}initialize(e,n){let i=e.resolvedTextDocumentSync;n&&i&&i.willSaveWaitUntil&&this.register({id:fi.generateUuid(),registerOptions:{documentSelector:n}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=mt.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Fe.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let n=this._client.middleware,i=r=>this._client.sendRequest(De.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(r)).then(async o=>{let s=await this._client.protocol2CodeConverter.asTextEdits(o);return s===void 0?[]:s});e.waitUntil(n.willSaveWaitUntil?n.willSaveWaitUntil(e,i):i(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}}lt.WillSaveWaitUntilFeature=Wg;class Kg extends Fe.TextDocumentEventFeature{constructor(e){super(e,mt.workspace.onDidSaveTextDocument,De.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,n=>e.code2ProtocolConverter.asSaveTextDocumentParams(n,this._includeText),n=>n,Fe.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return De.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,n){const i=e.resolvedTextDocumentSync;if(n&&i&&i.save){const r=typeof i.save=="boolean"?{includeText:!1}:{includeText:!!i.save.includeText};this.register({id:fi.generateUuid(),registerOptions:Object.assign({},{documentSelector:n},r)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}}lt.DidSaveTextDocumentFeature=Kg;var Br={};Object.defineProperty(Br,"__esModule",{value:!0}),Br.CompletionItemFeature=void 0;const Ug=H,oe=U,oa=j,zg=ce,Bg=[oe.CompletionItemKind.Text,oe.CompletionItemKind.Method,oe.CompletionItemKind.Function,oe.CompletionItemKind.Constructor,oe.CompletionItemKind.Field,oe.CompletionItemKind.Variable,oe.CompletionItemKind.Class,oe.CompletionItemKind.Interface,oe.CompletionItemKind.Module,oe.CompletionItemKind.Property,oe.CompletionItemKind.Unit,oe.CompletionItemKind.Value,oe.CompletionItemKind.Enum,oe.CompletionItemKind.Keyword,oe.CompletionItemKind.Snippet,oe.CompletionItemKind.Color,oe.CompletionItemKind.File,oe.CompletionItemKind.Reference,oe.CompletionItemKind.Folder,oe.CompletionItemKind.EnumMember,oe.CompletionItemKind.Constant,oe.CompletionItemKind.Struct,oe.CompletionItemKind.Event,oe.CompletionItemKind.Operator,oe.CompletionItemKind.TypeParameter];class Vg extends oa.TextDocumentLanguageFeature{constructor(e){super(e,oe.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let n=(0,oa.ensure)((0,oa.ensure)(e,"textDocument"),"completion");n.dynamicRegistration=!0,n.contextSupport=!0,n.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[oe.MarkupKind.Markdown,oe.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[oe.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[oe.InsertTextMode.asIs,oe.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},n.insertTextMode=oe.InsertTextMode.adjustIndentation,n.completionItemKind={valueSet:Bg},n.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,n){const i=this.getRegistrationOptions(n,e.completionProvider);i&&this.register({id:zg.generateUuid(),registerOptions:i})}registerLanguageProvider(e,n){this.labelDetailsSupport.set(n,!!e.completionItem?.labelDetailsSupport);const i=e.triggerCharacters??[],r=e.allCommitCharacters,o=e.documentSelector,s={provideCompletionItems:(a,u,l,f)=>{const m=this._client,p=this._client.middleware,C=(h,w,R,M)=>m.sendRequest(oe.CompletionRequest.type,m.code2ProtocolConverter.asCompletionParams(h,w,R),M).then(K=>M.isCancellationRequested?null:m.protocol2CodeConverter.asCompletionResult(K,r,M),K=>m.handleFailedRequest(oe.CompletionRequest.type,M,K,null));return p.provideCompletionItem?p.provideCompletionItem(a,u,f,l,C):C(a,u,f,l)},resolveCompletionItem:e.resolveProvider?(a,u)=>{const l=this._client,f=this._client.middleware,m=(p,C)=>l.sendRequest(oe.CompletionResolveRequest.type,l.code2ProtocolConverter.asCompletionItem(p,!!this.labelDetailsSupport.get(n)),C).then(h=>C.isCancellationRequested?null:l.protocol2CodeConverter.asCompletionItem(h),h=>l.handleFailedRequest(oe.CompletionResolveRequest.type,C,h,p));return f.resolveCompletionItem?f.resolveCompletionItem(a,u,m):m(a,u)}:void 0};return[Ug.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(o),s,...i),s]}}Br.CompletionItemFeature=Vg;var Vr={};Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.HoverFeature=void 0;const Jg=H,Ni=U,sa=j,Qg=ce;class Gg extends sa.TextDocumentLanguageFeature{constructor(e){super(e,Ni.HoverRequest.type)}fillClientCapabilities(e){const n=(0,sa.ensure)((0,sa.ensure)(e,"textDocument"),"hover");n.dynamicRegistration=!0,n.contentFormat=[Ni.MarkupKind.Markdown,Ni.MarkupKind.PlainText]}initialize(e,n){const i=this.getRegistrationOptions(n,e.hoverProvider);i&&this.register({id:Qg.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n=e.documentSelector,i={provideHover:(r,o,s)=>{const a=this._client,u=(f,m,p)=>a.sendRequest(Ni.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,m),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asHover(C),C=>a.handleFailedRequest(Ni.HoverRequest.type,p,C,null)),l=a.middleware;return l.provideHover?l.provideHover(r,o,s,u):u(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(e,n){return Jg.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}}Vr.HoverFeature=Gg;var Jr={};Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.DefinitionFeature=void 0;const Xg=H,aa=U,ca=j,Yg=ce;class Zg extends ca.TextDocumentLanguageFeature{constructor(e){super(e,aa.DefinitionRequest.type)}fillClientCapabilities(e){let n=(0,ca.ensure)((0,ca.ensure)(e,"textDocument"),"definition");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(e,n){const i=this.getRegistrationOptions(n,e.definitionProvider);i&&this.register({id:Yg.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n=e.documentSelector,i={provideDefinition:(r,o,s)=>{const a=this._client,u=(f,m,p)=>a.sendRequest(aa.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,m),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,p),C=>a.handleFailedRequest(aa.DefinitionRequest.type,p,C,null)),l=a.middleware;return l.provideDefinition?l.provideDefinition(r,o,s,u):u(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(e,n){return Xg.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}}Jr.DefinitionFeature=Zg;var Qr={};Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.SignatureHelpFeature=void 0;const ul=H,Li=U,ua=j,eh=ce;class th extends ua.TextDocumentLanguageFeature{constructor(e){super(e,Li.SignatureHelpRequest.type)}fillClientCapabilities(e){let n=(0,ua.ensure)((0,ua.ensure)(e,"textDocument"),"signatureHelp");n.dynamicRegistration=!0,n.signatureInformation={documentationFormat:[Li.MarkupKind.Markdown,Li.MarkupKind.PlainText]},n.signatureInformation.parameterInformation={labelOffsetSupport:!0},n.signatureInformation.activeParameterSupport=!0,n.contextSupport=!0}initialize(e,n){const i=this.getRegistrationOptions(n,e.signatureHelpProvider);i&&this.register({id:eh.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideSignatureHelp:(i,r,o,s)=>{const a=this._client,u=(f,m,p,C)=>a.sendRequest(Li.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(f,m,p),C).then(h=>C.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(h,C),h=>a.handleFailedRequest(Li.SignatureHelpRequest.type,C,h,null)),l=a.middleware;return l.provideSignatureHelp?l.provideSignatureHelp(i,r,s,o,u):u(i,r,s,o)}};return[this.registerProvider(e,n),n]}registerProvider(e,n){const i=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){const r=e.triggerCharacters||[];return ul.languages.registerSignatureHelpProvider(i,n,...r)}else{const r={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return ul.languages.registerSignatureHelpProvider(i,n,r)}}}Qr.SignatureHelpFeature=th;var Gr={};Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.DocumentHighlightFeature=void 0;const nh=H,la=U,da=j,ih=ce;class rh extends da.TextDocumentLanguageFeature{constructor(e){super(e,la.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,da.ensure)((0,da.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,n){const i=this.getRegistrationOptions(n,e.documentHighlightProvider);i&&this.register({id:ih.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n=e.documentSelector,i={provideDocumentHighlights:(r,o,s)=>{const a=this._client,u=(f,m,p)=>a.sendRequest(la.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,m),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(C,p),C=>a.handleFailedRequest(la.DocumentHighlightRequest.type,p,C,null)),l=a.middleware;return l.provideDocumentHighlights?l.provideDocumentHighlights(r,o,s,u):u(r,o,s)}};return[nh.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}Gr.DocumentHighlightFeature=rh;var fa={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentSymbolFeature=t.SupportedSymbolTags=t.SupportedSymbolKinds=void 0;const e=H,n=U,i=j,r=ce;t.SupportedSymbolKinds=[n.SymbolKind.File,n.SymbolKind.Module,n.SymbolKind.Namespace,n.SymbolKind.Package,n.SymbolKind.Class,n.SymbolKind.Method,n.SymbolKind.Property,n.SymbolKind.Field,n.SymbolKind.Constructor,n.SymbolKind.Enum,n.SymbolKind.Interface,n.SymbolKind.Function,n.SymbolKind.Variable,n.SymbolKind.Constant,n.SymbolKind.String,n.SymbolKind.Number,n.SymbolKind.Boolean,n.SymbolKind.Array,n.SymbolKind.Object,n.SymbolKind.Key,n.SymbolKind.Null,n.SymbolKind.EnumMember,n.SymbolKind.Struct,n.SymbolKind.Event,n.SymbolKind.Operator,n.SymbolKind.TypeParameter],t.SupportedSymbolTags=[n.SymbolTag.Deprecated];class o extends i.TextDocumentLanguageFeature{constructor(a){super(a,n.DocumentSymbolRequest.type)}fillClientCapabilities(a){let u=(0,i.ensure)((0,i.ensure)(a,"textDocument"),"documentSymbol");u.dynamicRegistration=!0,u.symbolKind={valueSet:t.SupportedSymbolKinds},u.hierarchicalDocumentSymbolSupport=!0,u.tagSupport={valueSet:t.SupportedSymbolTags},u.labelSupport=!0}initialize(a,u){const l=this.getRegistrationOptions(u,a.documentSymbolProvider);l&&this.register({id:r.generateUuid(),registerOptions:l})}registerLanguageProvider(a){const u=a.documentSelector,l={provideDocumentSymbols:(m,p)=>{const C=this._client,h=async(R,M)=>{try{const K=await C.sendRequest(n.DocumentSymbolRequest.type,C.code2ProtocolConverter.asDocumentSymbolParams(R),M);if(M.isCancellationRequested||K===void 0||K===null)return null;if(K.length===0)return[];{const ne=K[0];return n.DocumentSymbol.is(ne)?await C.protocol2CodeConverter.asDocumentSymbols(K,M):await C.protocol2CodeConverter.asSymbolInformations(K,M)}}catch(K){return C.handleFailedRequest(n.DocumentSymbolRequest.type,M,K,null)}},w=C.middleware;return w.provideDocumentSymbols?w.provideDocumentSymbols(m,p,h):h(m,p)}},f=a.label!==void 0?{label:a.label}:void 0;return[e.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(u),l,f),l]}}t.DocumentSymbolFeature=o})(fa);var Xr={};Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.WorkspaceSymbolFeature=void 0;const oh=H,ji=U,ga=j,ll=fa,sh=ce;class ah extends ga.WorkspaceFeature{constructor(e){super(e,ji.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let n=(0,ga.ensure)((0,ga.ensure)(e,"workspace"),"symbol");n.dynamicRegistration=!0,n.symbolKind={valueSet:ll.SupportedSymbolKinds},n.tagSupport={valueSet:ll.SupportedSymbolTags},n.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:sh.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){const n={provideWorkspaceSymbols:(i,r)=>{const o=this._client,s=(u,l)=>o.sendRequest(ji.WorkspaceSymbolRequest.type,{query:u},l).then(f=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformations(f,l),f=>o.handleFailedRequest(ji.WorkspaceSymbolRequest.type,l,f,null)),a=o.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(i,r,s):s(i,r)},resolveWorkspaceSymbol:e.resolveProvider===!0?(i,r)=>{const o=this._client,s=(u,l)=>o.sendRequest(ji.WorkspaceSymbolResolveRequest.type,o.code2ProtocolConverter.asWorkspaceSymbol(u),l).then(f=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformation(f),f=>o.handleFailedRequest(ji.WorkspaceSymbolResolveRequest.type,l,f,null)),a=o.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(i,r,s):s(i,r)}:void 0};return[oh.languages.registerWorkspaceSymbolProvider(n),n]}}Xr.WorkspaceSymbolFeature=ah;var Yr={};Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.ReferencesFeature=void 0;const ch=H,ha=U,pa=j,uh=ce;class lh extends pa.TextDocumentLanguageFeature{constructor(e){super(e,ha.ReferencesRequest.type)}fillClientCapabilities(e){(0,pa.ensure)((0,pa.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,n){const i=this.getRegistrationOptions(n,e.referencesProvider);i&&this.register({id:uh.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n=e.documentSelector,i={provideReferences:(r,o,s,a)=>{const u=this._client,l=(m,p,C,h)=>u.sendRequest(ha.ReferencesRequest.type,u.code2ProtocolConverter.asReferenceParams(m,p,C),h).then(w=>h.isCancellationRequested?null:u.protocol2CodeConverter.asReferences(w,h),w=>u.handleFailedRequest(ha.ReferencesRequest.type,h,w,null)),f=u.middleware;return f.provideReferences?f.provideReferences(r,o,s,a,l):l(r,o,s,a)}};return[this.registerProvider(n,i),i]}registerProvider(e,n){return ch.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}}Yr.ReferencesFeature=lh;var Zr={};Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.CodeActionFeature=void 0;const dh=H,yt=U,fh=ce,ma=j;class gh extends ma.TextDocumentLanguageFeature{constructor(e){super(e,yt.CodeActionRequest.type)}fillClientCapabilities(e){const n=(0,ma.ensure)((0,ma.ensure)(e,"textDocument"),"codeAction");n.dynamicRegistration=!0,n.isPreferredSupport=!0,n.disabledSupport=!0,n.dataSupport=!0,n.resolveSupport={properties:["edit"]},n.codeActionLiteralSupport={codeActionKind:{valueSet:[yt.CodeActionKind.Empty,yt.CodeActionKind.QuickFix,yt.CodeActionKind.Refactor,yt.CodeActionKind.RefactorExtract,yt.CodeActionKind.RefactorInline,yt.CodeActionKind.RefactorRewrite,yt.CodeActionKind.Source,yt.CodeActionKind.SourceOrganizeImports]}},n.honorsChangeAnnotations=!0}initialize(e,n){const i=this.getRegistrationOptions(n,e.codeActionProvider);i&&this.register({id:fh.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n=e.documentSelector,i={provideCodeActions:(r,o,s,a)=>{const u=this._client,l=async(m,p,C,h)=>{const w={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m),range:u.code2ProtocolConverter.asRange(p),context:u.code2ProtocolConverter.asCodeActionContextSync(C)};return u.sendRequest(yt.CodeActionRequest.type,w,h).then(R=>h.isCancellationRequested||R===null||R===void 0?null:u.protocol2CodeConverter.asCodeActionResult(R,h),R=>u.handleFailedRequest(yt.CodeActionRequest.type,h,R,null))},f=u.middleware;return f.provideCodeActions?f.provideCodeActions(r,o,s,a,l):l(r,o,s,a)},resolveCodeAction:e.resolveProvider?(r,o)=>{const s=this._client,a=this._client.middleware,u=async(l,f)=>s.sendRequest(yt.CodeActionResolveRequest.type,s.code2ProtocolConverter.asCodeActionSync(l),f).then(m=>f.isCancellationRequested?l:s.protocol2CodeConverter.asCodeAction(m,f),m=>s.handleFailedRequest(yt.CodeActionResolveRequest.type,f,m,l));return a.resolveCodeAction?a.resolveCodeAction(r,o,u):u(r,o)}:void 0};return[dh.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),i]}}Zr.CodeActionFeature=gh;var eo={};Object.defineProperty(eo,"__esModule",{value:!0}),eo.CodeLensFeature=void 0;const dl=H,gi=U,hh=ce,Ai=j;class ph extends Ai.TextDocumentLanguageFeature{constructor(e){super(e,gi.CodeLensRequest.type)}fillClientCapabilities(e){(0,Ai.ensure)((0,Ai.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,Ai.ensure)((0,Ai.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,n){this._client.onRequest(gi.CodeLensRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeCodeLensEmitter.fire()});const r=this.getRegistrationOptions(n,e.codeLensProvider);r&&this.register({id:hh.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const n=e.documentSelector,i=new dl.EventEmitter,r={onDidChangeCodeLenses:i.event,provideCodeLenses:(o,s)=>{const a=this._client,u=(f,m)=>a.sendRequest(gi.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(f),m).then(p=>m.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(p,m),p=>a.handleFailedRequest(gi.CodeLensRequest.type,m,p,null)),l=a.middleware;return l.provideCodeLenses?l.provideCodeLenses(o,s,u):u(o,s)},resolveCodeLens:e.resolveProvider?(o,s)=>{const a=this._client,u=(f,m)=>a.sendRequest(gi.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(f),m).then(p=>m.isCancellationRequested?f:a.protocol2CodeConverter.asCodeLens(p),p=>a.handleFailedRequest(gi.CodeLensResolveRequest.type,m,p,f)),l=a.middleware;return l.resolveCodeLens?l.resolveCodeLens(o,s,u):u(o,s)}:void 0};return[dl.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r),{provider:r,onDidChangeCodeLensEmitter:i}]}}eo.CodeLensFeature=ph;var kn={};Object.defineProperty(kn,"__esModule",{value:!0}),kn.DocumentOnTypeFormattingFeature=kn.DocumentRangeFormattingFeature=kn.DocumentFormattingFeature=void 0;const to=H,It=U,ya=ce,ln=j;var hi;(function(t){function e(n){const i=to.workspace.getConfiguration("files",n);return{trimTrailingWhitespace:i.get("trimTrailingWhitespace"),trimFinalNewlines:i.get("trimFinalNewlines"),insertFinalNewline:i.get("insertFinalNewline")}}t.fromConfiguration=e})(hi||(hi={}));class mh extends ln.TextDocumentLanguageFeature{constructor(e){super(e,It.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,ln.ensure)((0,ln.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,n){const i=this.getRegistrationOptions(n,e.documentFormattingProvider);i&&this.register({id:ya.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n=e.documentSelector,i={provideDocumentFormattingEdits:(r,o,s)=>{const a=this._client,u=(f,m,p)=>{const C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(f),options:a.code2ProtocolConverter.asFormattingOptions(m,hi.fromConfiguration(f))};return a.sendRequest(It.DocumentFormattingRequest.type,C,p).then(h=>p.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(h,p),h=>a.handleFailedRequest(It.DocumentFormattingRequest.type,p,h,null))},l=a.middleware;return l.provideDocumentFormattingEdits?l.provideDocumentFormattingEdits(r,o,s,u):u(r,o,s)}};return[to.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}kn.DocumentFormattingFeature=mh;class yh extends ln.TextDocumentLanguageFeature{constructor(e){super(e,It.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){const n=(0,ln.ensure)((0,ln.ensure)(e,"textDocument"),"rangeFormatting");n.dynamicRegistration=!0,n.rangesSupport=!0}initialize(e,n){const i=this.getRegistrationOptions(n,e.documentRangeFormattingProvider);i&&this.register({id:ya.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n=e.documentSelector,i={provideDocumentRangeFormattingEdits:(r,o,s,a)=>{const u=this._client,l=(m,p,C,h)=>{const w={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m),range:u.code2ProtocolConverter.asRange(p),options:u.code2ProtocolConverter.asFormattingOptions(C,hi.fromConfiguration(m))};return u.sendRequest(It.DocumentRangeFormattingRequest.type,w,h).then(R=>h.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(R,h),R=>u.handleFailedRequest(It.DocumentRangeFormattingRequest.type,h,R,null))},f=u.middleware;return f.provideDocumentRangeFormattingEdits?f.provideDocumentRangeFormattingEdits(r,o,s,a,l):l(r,o,s,a)}};return e.rangesSupport&&(i.provideDocumentRangesFormattingEdits=(r,o,s,a)=>{const u=this._client,l=(m,p,C,h)=>{const w={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m),ranges:u.code2ProtocolConverter.asRanges(p),options:u.code2ProtocolConverter.asFormattingOptions(C,hi.fromConfiguration(m))};return u.sendRequest(It.DocumentRangesFormattingRequest.type,w,h).then(R=>h.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(R,h),R=>u.handleFailedRequest(It.DocumentRangesFormattingRequest.type,h,R,null))},f=u.middleware;return f.provideDocumentRangesFormattingEdits?f.provideDocumentRangesFormattingEdits(r,o,s,a,l):l(r,o,s,a)}),[to.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}kn.DocumentRangeFormattingFeature=yh;class vh extends ln.TextDocumentLanguageFeature{constructor(e){super(e,It.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,ln.ensure)((0,ln.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,n){const i=this.getRegistrationOptions(n,e.documentOnTypeFormattingProvider);i&&this.register({id:ya.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n=e.documentSelector,i={provideOnTypeFormattingEdits:(o,s,a,u,l)=>{const f=this._client,m=(C,h,w,R,M)=>{let K={textDocument:f.code2ProtocolConverter.asTextDocumentIdentifier(C),position:f.code2ProtocolConverter.asPosition(h),ch:w,options:f.code2ProtocolConverter.asFormattingOptions(R,hi.fromConfiguration(C))};return f.sendRequest(It.DocumentOnTypeFormattingRequest.type,K,M).then(ne=>M.isCancellationRequested?null:f.protocol2CodeConverter.asTextEdits(ne,M),ne=>f.handleFailedRequest(It.DocumentOnTypeFormattingRequest.type,M,ne,null))},p=f.middleware;return p.provideOnTypeFormattingEdits?p.provideOnTypeFormattingEdits(o,s,a,u,l,m):m(o,s,a,u,l)}},r=e.moreTriggerCharacter||[];return[to.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i,e.firstTriggerCharacter,...r),i]}}kn.DocumentOnTypeFormattingFeature=vh;var no={};Object.defineProperty(no,"__esModule",{value:!0}),no.RenameFeature=void 0;const Ch=H,An=U,_h=ce,fl=fe,va=j;class Dh extends va.TextDocumentLanguageFeature{constructor(e){super(e,An.RenameRequest.type)}fillClientCapabilities(e){let n=(0,va.ensure)((0,va.ensure)(e,"textDocument"),"rename");n.dynamicRegistration=!0,n.prepareSupport=!0,n.prepareSupportDefaultBehavior=An.PrepareSupportDefaultBehavior.Identifier,n.honorsChangeAnnotations=!0}initialize(e,n){const i=this.getRegistrationOptions(n,e.renameProvider);i&&(fl.boolean(e.renameProvider)&&(i.prepareProvider=!1),this.register({id:_h.generateUuid(),registerOptions:i}))}registerLanguageProvider(e){const n=e.documentSelector,i={provideRenameEdits:(r,o,s,a)=>{const u=this._client,l=(m,p,C,h)=>{let w={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m),position:u.code2ProtocolConverter.asPosition(p),newName:C};return u.sendRequest(An.RenameRequest.type,w,h).then(R=>h.isCancellationRequested?null:u.protocol2CodeConverter.asWorkspaceEdit(R,h),R=>u.handleFailedRequest(An.RenameRequest.type,h,R,null,!1))},f=u.middleware;return f.provideRenameEdits?f.provideRenameEdits(r,o,s,a,l):l(r,o,s,a)},prepareRename:e.prepareProvider?(r,o,s)=>{const a=this._client,u=(f,m,p)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(f),position:a.code2ProtocolConverter.asPosition(m)};return a.sendRequest(An.PrepareRenameRequest.type,C,p).then(h=>p.isCancellationRequested?null:An.Range.is(h)?a.protocol2CodeConverter.asRange(h):this.isDefaultBehavior(h)?h.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):h&&An.Range.is(h.range)?{range:a.protocol2CodeConverter.asRange(h.range),placeholder:h.placeholder}:Promise.reject(new Error("The element can't be renamed.")),h=>{throw typeof h.message=="string"?new Error(h.message):new Error("The element can't be renamed.")})},l=a.middleware;return l.prepareRename?l.prepareRename(r,o,s,u):u(r,o,s)}:void 0};return[this.registerProvider(n,i),i]}registerProvider(e,n){return Ch.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}isDefaultBehavior(e){const n=e;return n&&fl.boolean(n.defaultBehavior)}}no.RenameFeature=Dh;var io={};Object.defineProperty(io,"__esModule",{value:!0}),io.DocumentLinkFeature=void 0;const bh=H,$i=U,Ca=j,wh=ce;class Sh extends Ca.TextDocumentLanguageFeature{constructor(e){super(e,$i.DocumentLinkRequest.type)}fillClientCapabilities(e){const n=(0,Ca.ensure)((0,Ca.ensure)(e,"textDocument"),"documentLink");n.dynamicRegistration=!0,n.tooltipSupport=!0}initialize(e,n){const i=this.getRegistrationOptions(n,e.documentLinkProvider);i&&this.register({id:wh.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n=e.documentSelector,i={provideDocumentLinks:(r,o)=>{const s=this._client,a=(l,f)=>s.sendRequest($i.DocumentLinkRequest.type,s.code2ProtocolConverter.asDocumentLinkParams(l),f).then(m=>f.isCancellationRequested?null:s.protocol2CodeConverter.asDocumentLinks(m,f),m=>s.handleFailedRequest($i.DocumentLinkRequest.type,f,m,null)),u=s.middleware;return u.provideDocumentLinks?u.provideDocumentLinks(r,o,a):a(r,o)},resolveDocumentLink:e.resolveProvider?(r,o)=>{const s=this._client;let a=(l,f)=>s.sendRequest($i.DocumentLinkResolveRequest.type,s.code2ProtocolConverter.asDocumentLink(l),f).then(m=>f.isCancellationRequested?l:s.protocol2CodeConverter.asDocumentLink(m),m=>s.handleFailedRequest($i.DocumentLinkResolveRequest.type,f,m,l));const u=s.middleware;return u.resolveDocumentLink?u.resolveDocumentLink(r,o,a):a(r,o)}:void 0};return[bh.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}io.DocumentLinkFeature=Sh;var ro={};Object.defineProperty(ro,"__esModule",{value:!0}),ro.ExecuteCommandFeature=void 0;const Rh=H,_a=U,Th=ce,gl=j;class Ph{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return _a.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,gl.ensure)((0,gl.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:Th.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){const n=this._client,i=n.middleware,r=(o,s)=>{let a={command:o,arguments:s};return n.sendRequest(_a.ExecuteCommandRequest.type,a).then(void 0,u=>n.handleFailedRequest(_a.ExecuteCommandRequest.type,void 0,u,void 0))};if(e.registerOptions.commands){const o=[];for(const s of e.registerOptions.commands)o.push(Rh.commands.registerCommand(s,(...a)=>i.executeCommand?i.executeCommand(s,a,r):r(s,a)));this._commands.set(e.id,o)}}unregister(e){let n=this._commands.get(e);n&&n.forEach(i=>i.dispose())}clear(){this._commands.forEach(e=>{e.forEach(n=>n.dispose())}),this._commands.clear()}}ro.ExecuteCommandFeature=Ph;var oo={};Object.defineProperty(oo,"__esModule",{value:!0}),oo.FileSystemWatcherFeature=void 0;const kh=H,$n=U,so=j;class Fh{constructor(e,n){this._client=e,this._notifyFileEvent=n,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return $n.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,so.ensure)((0,so.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,so.ensure)((0,so.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,n){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;const n=[];for(const i of e.registerOptions.watchers){const r=this._client.protocol2CodeConverter.asGlobPattern(i.globPattern);if(r===void 0)continue;let o=!0,s=!0,a=!0;i.kind!==void 0&&i.kind!==null&&(o=(i.kind&$n.WatchKind.Create)!==0,s=(i.kind&$n.WatchKind.Change)!==0,a=(i.kind&$n.WatchKind.Delete)!==0);const u=kh.workspace.createFileSystemWatcher(r,!o,!s,!a);this.hookListeners(u,o,s,a,n),n.push(u)}this._watchers.set(e.id,n)}registerRaw(e,n){let i=[];for(let r of n)this.hookListeners(r,!0,!0,!0,i);this._watchers.set(e,i)}hookListeners(e,n,i,r,o){n&&e.onDidCreate(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:$n.FileChangeType.Created}),null,o),i&&e.onDidChange(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:$n.FileChangeType.Changed}),null,o),r&&e.onDidDelete(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:$n.FileChangeType.Deleted}),null,o)}unregister(e){let n=this._watchers.get(e);if(n)for(let i of n)i.dispose()}clear(){this._watchers.forEach(e=>{for(let n of e)n.dispose()}),this._watchers.clear()}}oo.FileSystemWatcherFeature=Fh;var ao={};Object.defineProperty(ao,"__esModule",{value:!0}),ao.ColorProviderFeature=void 0;const Eh=H,Hi=U,Da=j;class Oh extends Da.TextDocumentLanguageFeature{constructor(e){super(e,Hi.DocumentColorRequest.type)}fillClientCapabilities(e){(0,Da.ensure)((0,Da.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,n){let[i,r]=this.getRegistration(n,e.colorProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(e){const n=e.documentSelector,i={provideColorPresentations:(r,o,s)=>{const a=this._client,u=(f,m,p)=>{const C={color:f,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(m.document),range:a.code2ProtocolConverter.asRange(m.range)};return a.sendRequest(Hi.ColorPresentationRequest.type,C,p).then(h=>p.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(h,p),h=>a.handleFailedRequest(Hi.ColorPresentationRequest.type,p,h,null))},l=a.middleware;return l.provideColorPresentations?l.provideColorPresentations(r,o,s,u):u(r,o,s)},provideDocumentColors:(r,o)=>{const s=this._client,a=(l,f)=>{const m={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(l)};return s.sendRequest(Hi.DocumentColorRequest.type,m,f).then(p=>f.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(p,f),p=>s.handleFailedRequest(Hi.DocumentColorRequest.type,f,p,null))},u=s.middleware;return u.provideDocumentColors?u.provideDocumentColors(r,o,a):a(r,o)}};return[Eh.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}ao.ColorProviderFeature=Oh;var co={};Object.defineProperty(co,"__esModule",{value:!0}),co.ImplementationFeature=void 0;const qh=H,ba=U,wa=j;class Mh extends wa.TextDocumentLanguageFeature{constructor(e){super(e,ba.ImplementationRequest.type)}fillClientCapabilities(e){let n=(0,wa.ensure)((0,wa.ensure)(e,"textDocument"),"implementation");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(e,n){let[i,r]=this.getRegistration(n,e.implementationProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(e){const n=e.documentSelector,i={provideImplementation:(r,o,s)=>{const a=this._client,u=(f,m,p)=>a.sendRequest(ba.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,m),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,p),C=>a.handleFailedRequest(ba.ImplementationRequest.type,p,C,null)),l=a.middleware;return l.provideImplementation?l.provideImplementation(r,o,s,u):u(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(e,n){return qh.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}}co.ImplementationFeature=Mh;var uo={};Object.defineProperty(uo,"__esModule",{value:!0}),uo.TypeDefinitionFeature=void 0;const Ih=H,Sa=U,Wi=j;class xh extends Wi.TextDocumentLanguageFeature{constructor(e){super(e,Sa.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,Wi.ensure)((0,Wi.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let n=(0,Wi.ensure)((0,Wi.ensure)(e,"textDocument"),"typeDefinition");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(e,n){let[i,r]=this.getRegistration(n,e.typeDefinitionProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(e){const n=e.documentSelector,i={provideTypeDefinition:(r,o,s)=>{const a=this._client,u=(f,m,p)=>a.sendRequest(Sa.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,m),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,p),C=>a.handleFailedRequest(Sa.TypeDefinitionRequest.type,p,C,null)),l=a.middleware;return l.provideTypeDefinition?l.provideTypeDefinition(r,o,s,u):u(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(e,n){return Ih.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}}uo.TypeDefinitionFeature=xh;var pi={};Object.defineProperty(pi,"__esModule",{value:!0}),pi.WorkspaceFoldersFeature=pi.arrayDiff=void 0;const Nh=ce,lo=H,Ki=U;function Ra(t,e){if(t!=null)return t[e]}function Ta(t,e){return t.filter(n=>e.indexOf(n)<0)}pi.arrayDiff=Ta;class Lh{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Ki.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){const n=lo.workspace.workspaceFolders;this.initializeWithFolders(n),n===void 0?e.workspaceFolders=null:e.workspaceFolders=n.map(i=>this.asProtocol(i))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){const n=this._client;n.onRequest(Ki.WorkspaceFoldersRequest.type,o=>{const s=()=>{const u=lo.workspace.workspaceFolders;return u===void 0?null:u.map(f=>this.asProtocol(f))},a=n.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(o,s):s()});const i=Ra(Ra(Ra(e,"workspace"),"workspaceFolders"),"changeNotifications");let r;typeof i=="string"?r=i:i===!0&&(r=Nh.generateUuid()),r&&this.register({id:r,registerOptions:void 0})}sendInitialEvent(e){let n;if(this._initialFolders&&e){const i=Ta(this._initialFolders,e),r=Ta(e,this._initialFolders);(r.length>0||i.length>0)&&(n=this.doSendEvent(r,i))}else this._initialFolders?n=this.doSendEvent([],this._initialFolders):e&&(n=this.doSendEvent(e,[]));n!==void 0&&n.catch(i=>{this._client.error(`Sending notification ${Ki.DidChangeWorkspaceFoldersNotification.type.method} failed`,i)})}doSendEvent(e,n){let i={event:{added:e.map(r=>this.asProtocol(r)),removed:n.map(r=>this.asProtocol(r))}};return this._client.sendNotification(Ki.DidChangeWorkspaceFoldersNotification.type,i)}register(e){let n=e.id,i=this._client,r=lo.workspace.onDidChangeWorkspaceFolders(o=>{let s=l=>this.doSendEvent(l.added,l.removed),a=i.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(o,s):s(o)).catch(l=>{this._client.error(`Sending notification ${Ki.DidChangeWorkspaceFoldersNotification.type.method} failed`,l)})});this._listeners.set(n,r),this.sendInitialEvent(lo.workspace.workspaceFolders)}unregister(e){let n=this._listeners.get(e);n!==void 0&&(this._listeners.delete(e),n.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}}pi.WorkspaceFoldersFeature=Lh;var fo={};Object.defineProperty(fo,"__esModule",{value:!0}),fo.FoldingRangeFeature=void 0;const hl=H,Hn=U,Ui=j;class jh extends Ui.TextDocumentLanguageFeature{constructor(e){super(e,Hn.FoldingRangeRequest.type)}fillClientCapabilities(e){let n=(0,Ui.ensure)((0,Ui.ensure)(e,"textDocument"),"foldingRange");n.dynamicRegistration=!0,n.rangeLimit=5e3,n.lineFoldingOnly=!0,n.foldingRangeKind={valueSet:[Hn.FoldingRangeKind.Comment,Hn.FoldingRangeKind.Imports,Hn.FoldingRangeKind.Region]},n.foldingRange={collapsedText:!1},(0,Ui.ensure)((0,Ui.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,n){this._client.onRequest(Hn.FoldingRangeRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeFoldingRange.fire()});let[i,r]=this.getRegistration(n,e.foldingRangeProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(e){const n=e.documentSelector,i=new hl.EventEmitter,r={onDidChangeFoldingRanges:i.event,provideFoldingRanges:(o,s,a)=>{const u=this._client,l=(m,p,C)=>{const h={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m)};return u.sendRequest(Hn.FoldingRangeRequest.type,h,C).then(w=>C.isCancellationRequested?null:u.protocol2CodeConverter.asFoldingRanges(w,C),w=>u.handleFailedRequest(Hn.FoldingRangeRequest.type,C,w,null))},f=u.middleware;return f.provideFoldingRanges?f.provideFoldingRanges(o,s,a,l):l(o,s,a)}};return[hl.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r),{provider:r,onDidChangeFoldingRange:i}]}}fo.FoldingRangeFeature=jh;var go={};Object.defineProperty(go,"__esModule",{value:!0}),go.DeclarationFeature=void 0;const Ah=H,Pa=U,ka=j;class $h extends ka.TextDocumentLanguageFeature{constructor(e){super(e,Pa.DeclarationRequest.type)}fillClientCapabilities(e){const n=(0,ka.ensure)((0,ka.ensure)(e,"textDocument"),"declaration");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(e,n){const[i,r]=this.getRegistration(n,e.declarationProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(e){const n=e.documentSelector,i={provideDeclaration:(r,o,s)=>{const a=this._client,u=(f,m,p)=>a.sendRequest(Pa.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,m),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(C,p),C=>a.handleFailedRequest(Pa.DeclarationRequest.type,p,C,null)),l=a.middleware;return l.provideDeclaration?l.provideDeclaration(r,o,s,u):u(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(e,n){return Ah.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}}go.DeclarationFeature=$h;var ho={};Object.defineProperty(ho,"__esModule",{value:!0}),ho.SelectionRangeFeature=void 0;const Hh=H,Fa=U,Ea=j;class Wh extends Ea.TextDocumentLanguageFeature{constructor(e){super(e,Fa.SelectionRangeRequest.type)}fillClientCapabilities(e){const n=(0,Ea.ensure)((0,Ea.ensure)(e,"textDocument"),"selectionRange");n.dynamicRegistration=!0}initialize(e,n){const[i,r]=this.getRegistration(n,e.selectionRangeProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(e){const n=e.documentSelector,i={provideSelectionRanges:(r,o,s)=>{const a=this._client,u=async(f,m,p)=>{const C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(f),positions:a.code2ProtocolConverter.asPositionsSync(m,p)};return a.sendRequest(Fa.SelectionRangeRequest.type,C,p).then(h=>p.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(h,p),h=>a.handleFailedRequest(Fa.SelectionRangeRequest.type,p,h,null))},l=a.middleware;return l.provideSelectionRanges?l.provideSelectionRanges(r,o,s,u):u(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(e,n){return Hh.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}}ho.SelectionRangeFeature=Wh;var po={};Object.defineProperty(po,"__esModule",{value:!0}),po.ProgressFeature=void 0;const pl=U,Kh=Mi;function Uh(t,e){return t[e]===void 0&&(t[e]=Object.create(null)),t[e]}class zh{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:pl.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){Uh(e,"window").workDoneProgress=!0}initialize(){const e=this._client,n=r=>{this.activeParts.delete(r)},i=r=>{this.activeParts.add(new Kh.ProgressPart(this._client,r.token,n))};e.onRequest(pl.WorkDoneProgressCreateRequest.type,i)}clear(){for(const e of this.activeParts)e.done();this.activeParts.clear()}}po.ProgressFeature=zh;var mo={};Object.defineProperty(mo,"__esModule",{value:!0}),mo.CallHierarchyFeature=void 0;const Bh=H,Wn=U,Oa=j;class Vh{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,n,i){const r=this.client,o=this.middleware,s=(a,u,l)=>{const f=r.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return r.sendRequest(Wn.CallHierarchyPrepareRequest.type,f,l).then(m=>l.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyItems(m,l),m=>r.handleFailedRequest(Wn.CallHierarchyPrepareRequest.type,l,m,null))};return o.prepareCallHierarchy?o.prepareCallHierarchy(e,n,i,s):s(e,n,i)}provideCallHierarchyIncomingCalls(e,n){const i=this.client,r=this.middleware,o=(s,a)=>{const u={item:i.code2ProtocolConverter.asCallHierarchyItem(s)};return i.sendRequest(Wn.CallHierarchyIncomingCallsRequest.type,u,a).then(l=>a.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyIncomingCalls(l,a),l=>i.handleFailedRequest(Wn.CallHierarchyIncomingCallsRequest.type,a,l,null))};return r.provideCallHierarchyIncomingCalls?r.provideCallHierarchyIncomingCalls(e,n,o):o(e,n)}provideCallHierarchyOutgoingCalls(e,n){const i=this.client,r=this.middleware,o=(s,a)=>{const u={item:i.code2ProtocolConverter.asCallHierarchyItem(s)};return i.sendRequest(Wn.CallHierarchyOutgoingCallsRequest.type,u,a).then(l=>a.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyOutgoingCalls(l,a),l=>i.handleFailedRequest(Wn.CallHierarchyOutgoingCallsRequest.type,a,l,null))};return r.provideCallHierarchyOutgoingCalls?r.provideCallHierarchyOutgoingCalls(e,n,o):o(e,n)}}class Jh extends Oa.TextDocumentLanguageFeature{constructor(e){super(e,Wn.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){const n=e,i=(0,Oa.ensure)((0,Oa.ensure)(n,"textDocument"),"callHierarchy");i.dynamicRegistration=!0}initialize(e,n){const[i,r]=this.getRegistration(n,e.callHierarchyProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(e){const n=this._client,i=new Vh(n);return[Bh.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),i),i]}}mo.CallHierarchyFeature=Jh;var yo={};Object.defineProperty(yo,"__esModule",{value:!0}),yo.SemanticTokensFeature=void 0;const vo=H,B=U,zi=j,Qh=fe;class Gh extends zi.TextDocumentLanguageFeature{constructor(e){super(e,B.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){const n=(0,zi.ensure)((0,zi.ensure)(e,"textDocument"),"semanticTokens");n.dynamicRegistration=!0,n.tokenTypes=[B.SemanticTokenTypes.namespace,B.SemanticTokenTypes.type,B.SemanticTokenTypes.class,B.SemanticTokenTypes.enum,B.SemanticTokenTypes.interface,B.SemanticTokenTypes.struct,B.SemanticTokenTypes.typeParameter,B.SemanticTokenTypes.parameter,B.SemanticTokenTypes.variable,B.SemanticTokenTypes.property,B.SemanticTokenTypes.enumMember,B.SemanticTokenTypes.event,B.SemanticTokenTypes.function,B.SemanticTokenTypes.method,B.SemanticTokenTypes.macro,B.SemanticTokenTypes.keyword,B.SemanticTokenTypes.modifier,B.SemanticTokenTypes.comment,B.SemanticTokenTypes.string,B.SemanticTokenTypes.number,B.SemanticTokenTypes.regexp,B.SemanticTokenTypes.operator,B.SemanticTokenTypes.decorator],n.tokenModifiers=[B.SemanticTokenModifiers.declaration,B.SemanticTokenModifiers.definition,B.SemanticTokenModifiers.readonly,B.SemanticTokenModifiers.static,B.SemanticTokenModifiers.deprecated,B.SemanticTokenModifiers.abstract,B.SemanticTokenModifiers.async,B.SemanticTokenModifiers.modification,B.SemanticTokenModifiers.documentation,B.SemanticTokenModifiers.defaultLibrary],n.formats=[B.TokenFormat.Relative],n.requests={range:!0,full:{delta:!0}},n.multilineTokenSupport=!1,n.overlappingTokenSupport=!1,n.serverCancelSupport=!0,n.augmentsSyntaxTokens=!0,(0,zi.ensure)((0,zi.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,n){this._client.onRequest(B.SemanticTokensRefreshRequest.type,async()=>{for(const s of this.getAllProviders())s.onDidChangeSemanticTokensEmitter.fire()});const[r,o]=this.getRegistration(n,e.semanticTokensProvider);!r||!o||this.register({id:r,registerOptions:o})}registerLanguageProvider(e){const n=e.documentSelector,i=Qh.boolean(e.full)?e.full:e.full!==void 0,r=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,o=new vo.EventEmitter,s=i?{onDidChangeSemanticTokens:o.event,provideDocumentSemanticTokens:(C,h)=>{const w=this._client,R=w.middleware,M=(K,ne)=>{const ve={textDocument:w.code2ProtocolConverter.asTextDocumentIdentifier(K)};return w.sendRequest(B.SemanticTokensRequest.type,ve,ne).then(se=>ne.isCancellationRequested?null:w.protocol2CodeConverter.asSemanticTokens(se,ne),se=>w.handleFailedRequest(B.SemanticTokensRequest.type,ne,se,null))};return R.provideDocumentSemanticTokens?R.provideDocumentSemanticTokens(C,h,M):M(C,h)},provideDocumentSemanticTokensEdits:r?(C,h,w)=>{const R=this._client,M=R.middleware,K=(ne,ve,se)=>{const de={textDocument:R.code2ProtocolConverter.asTextDocumentIdentifier(ne),previousResultId:ve};return R.sendRequest(B.SemanticTokensDeltaRequest.type,de,se).then(async x=>se.isCancellationRequested?null:B.SemanticTokens.is(x)?await R.protocol2CodeConverter.asSemanticTokens(x,se):await R.protocol2CodeConverter.asSemanticTokensEdits(x,se),x=>R.handleFailedRequest(B.SemanticTokensDeltaRequest.type,se,x,null))};return M.provideDocumentSemanticTokensEdits?M.provideDocumentSemanticTokensEdits(C,h,w,K):K(C,h,w)}:void 0}:void 0,u=e.range===!0?{provideDocumentRangeSemanticTokens:(C,h,w)=>{const R=this._client,M=R.middleware,K=(ne,ve,se)=>{const de={textDocument:R.code2ProtocolConverter.asTextDocumentIdentifier(ne),range:R.code2ProtocolConverter.asRange(ve)};return R.sendRequest(B.SemanticTokensRangeRequest.type,de,se).then(x=>se.isCancellationRequested?null:R.protocol2CodeConverter.asSemanticTokens(x,se),x=>R.handleFailedRequest(B.SemanticTokensRangeRequest.type,se,x,null))};return M.provideDocumentRangeSemanticTokens?M.provideDocumentRangeSemanticTokens(C,h,w,K):K(C,h,w)}}:void 0,l=[],f=this._client,m=f.protocol2CodeConverter.asSemanticTokensLegend(e.legend),p=f.protocol2CodeConverter.asDocumentSelector(n);return s!==void 0&&l.push(vo.languages.registerDocumentSemanticTokensProvider(p,s,m)),u!==void 0&&l.push(vo.languages.registerDocumentRangeSemanticTokensProvider(p,u,m)),[new vo.Disposable(()=>l.forEach(C=>C.dispose())),{range:u,full:s,onDidChangeSemanticTokensEmitter:o}]}}yo.SemanticTokensFeature=Gh;var dt={};Object.defineProperty(dt,"__esModule",{value:!0}),dt.WillDeleteFilesFeature=dt.WillRenameFilesFeature=dt.WillCreateFilesFeature=dt.DidDeleteFilesFeature=dt.DidRenameFilesFeature=dt.DidCreateFilesFeature=void 0;const Tt=H,Xh=Lr,dn=U,Yh=ce;function ml(t,e){return t[e]===void 0&&(t[e]={}),t[e]}function Zh(t,e){return t[e]}function yl(t,e,n){t[e]=n}class Bn{constructor(e,n,i,r,o){this._client=e,this._event=n,this._registrationType=i,this._clientCapability=r,this._serverCapability=o,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){const n=ml(ml(e,"workspace"),"fileOperations");yl(n,"dynamicRegistration",!0),yl(n,this._clientCapability,!0)}initialize(e){const n=e.workspace?.fileOperations,i=n!==void 0?Zh(n,this._serverCapability):void 0;if(i?.filters!==void 0)try{this.register({id:Yh.generateUuid(),registerOptions:{filters:i.filters}})}catch(r){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${r}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));const n=e.registerOptions.filters.map(i=>{const r=new Xh.Minimatch(i.pattern.glob,Bn.asMinimatchOptions(i.pattern.options));if(!r.makeRe())throw new Error(`Invalid pattern ${i.pattern.glob}!`);return{scheme:i.scheme,matcher:r,kind:i.pattern.matches}});this._filters.set(e.id,n)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return Bn.getFileType(e)}async filter(e,n){const i=await Promise.all(e.files.map(async o=>{const s=n(o),a=s.fsPath.replace(/\\/g,"/");for(const u of this._filters.values())for(const l of u)if(!(l.scheme!==void 0&&l.scheme!==s.scheme)){if(l.matcher.match(a)){if(l.kind===void 0)return!0;const f=await this.getFileType(s);if(f===void 0)return this._client.error(`Failed to determine file type for ${s.toString()}.`),!0;if(f===Tt.FileType.File&&l.kind===dn.FileOperationPatternKind.file||f===Tt.FileType.Directory&&l.kind===dn.FileOperationPatternKind.folder)return!0}else if(l.kind===dn.FileOperationPatternKind.folder&&await Bn.getFileType(s)===Tt.FileType.Directory&&l.matcher.match(`${a}/`))return!0}return!1})),r=e.files.filter((o,s)=>i[s]);return{...e,files:r}}static async getFileType(e){try{return(await Tt.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){const n={dot:!0};return e?.ignoreCase===!0&&(n.nocase=!0),n}}class vl extends Bn{constructor(e,n,i,r,o,s,a){super(e,n,i,r,o),this._notificationType=i,this._accessUri=s,this._createParams=a}async send(e){const n=await this.filter(e,this._accessUri);if(n.files.length){const i=async r=>this._client.sendNotification(this._notificationType,this._createParams(r));return this.doSend(n,i)}}}class Cl extends vl{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){const n=e.fsPath;if(this._fsPathFileTypes.has(n))return this._fsPathFileTypes.get(n);const i=await Bn.getFileType(e);return i&&this._fsPathFileTypes.set(n,i),i}async cacheFileTypes(e,n){await this.filter(e,n)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}}class ep extends vl{constructor(e){super(e,Tt.workspace.onDidCreateFiles,dn.DidCreateFilesNotification.type,"didCreate","didCreate",n=>n,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,n){const i=this._client.middleware.workspace;return i?.didCreateFiles?i.didCreateFiles(e,n):n(e)}}dt.DidCreateFilesFeature=ep;class tp extends Cl{constructor(e){super(e,Tt.workspace.onDidRenameFiles,dn.DidRenameFilesNotification.type,"didRename","didRename",n=>n.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=Tt.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,n=>n.oldUri))}doSend(e,n){this.clearFileTypeCache();const i=this._client.middleware.workspace;return i?.didRenameFiles?i.didRenameFiles(e,n):n(e)}}dt.DidRenameFilesFeature=tp;class np extends Cl{constructor(e){super(e,Tt.workspace.onDidDeleteFiles,dn.DidDeleteFilesNotification.type,"didDelete","didDelete",n=>n,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=Tt.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,n=>n))}doSend(e,n){this.clearFileTypeCache();const i=this._client.middleware.workspace;return i?.didDeleteFiles?i.didDeleteFiles(e,n):n(e)}}dt.DidDeleteFilesFeature=np;class qa extends Bn{constructor(e,n,i,r,o,s,a){super(e,n,i,r,o),this._requestType=i,this._accessUri=s,this._createParams=a}async send(e){const n=this.waitUntil(e);e.waitUntil(n)}async waitUntil(e){const n=await this.filter(e,this._accessUri);if(n.files.length){const i=r=>this._client.sendRequest(this._requestType,this._createParams(r),r.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(n,i)}else return}}class ip extends qa{constructor(e){super(e,Tt.workspace.onWillCreateFiles,dn.WillCreateFilesRequest.type,"willCreate","willCreate",n=>n,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,n){const i=this._client.middleware.workspace;return i?.willCreateFiles?i.willCreateFiles(e,n):n(e)}}dt.WillCreateFilesFeature=ip;class rp extends qa{constructor(e){super(e,Tt.workspace.onWillRenameFiles,dn.WillRenameFilesRequest.type,"willRename","willRename",n=>n.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,n){const i=this._client.middleware.workspace;return i?.willRenameFiles?i.willRenameFiles(e,n):n(e)}}dt.WillRenameFilesFeature=rp;class op extends qa{constructor(e){super(e,Tt.workspace.onWillDeleteFiles,dn.WillDeleteFilesRequest.type,"willDelete","willDelete",n=>n,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,n){const i=this._client.middleware.workspace;return i?.willDeleteFiles?i.willDeleteFiles(e,n):n(e)}}dt.WillDeleteFilesFeature=op;var Co={};Object.defineProperty(Co,"__esModule",{value:!0}),Co.LinkedEditingFeature=void 0;const sp=H,Ma=U,Ia=j;class ap extends Ia.TextDocumentLanguageFeature{constructor(e){super(e,Ma.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){const n=(0,Ia.ensure)((0,Ia.ensure)(e,"textDocument"),"linkedEditingRange");n.dynamicRegistration=!0}initialize(e,n){let[i,r]=this.getRegistration(n,e.linkedEditingRangeProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(e){const n=e.documentSelector,i={provideLinkedEditingRanges:(r,o,s)=>{const a=this._client,u=(f,m,p)=>a.sendRequest(Ma.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,m),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(C,p),C=>a.handleFailedRequest(Ma.LinkedEditingRangeRequest.type,p,C,null)),l=a.middleware;return l.provideLinkedEditingRange?l.provideLinkedEditingRange(r,o,s,u):u(r,o,s)}};return[this.registerProvider(n,i),i]}registerProvider(e,n){return sp.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}}Co.LinkedEditingFeature=ap;var _o={};Object.defineProperty(_o,"__esModule",{value:!0}),_o.TypeHierarchyFeature=void 0;const cp=H,Kn=U,xa=j;class up{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,n,i){const r=this.client,o=this.middleware,s=(a,u,l)=>{const f=r.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return r.sendRequest(Kn.TypeHierarchyPrepareRequest.type,f,l).then(m=>l.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(m,l),m=>r.handleFailedRequest(Kn.TypeHierarchyPrepareRequest.type,l,m,null))};return o.prepareTypeHierarchy?o.prepareTypeHierarchy(e,n,i,s):s(e,n,i)}provideTypeHierarchySupertypes(e,n){const i=this.client,r=this.middleware,o=(s,a)=>{const u={item:i.code2ProtocolConverter.asTypeHierarchyItem(s)};return i.sendRequest(Kn.TypeHierarchySupertypesRequest.type,u,a).then(l=>a.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>i.handleFailedRequest(Kn.TypeHierarchySupertypesRequest.type,a,l,null))};return r.provideTypeHierarchySupertypes?r.provideTypeHierarchySupertypes(e,n,o):o(e,n)}provideTypeHierarchySubtypes(e,n){const i=this.client,r=this.middleware,o=(s,a)=>{const u={item:i.code2ProtocolConverter.asTypeHierarchyItem(s)};return i.sendRequest(Kn.TypeHierarchySubtypesRequest.type,u,a).then(l=>a.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>i.handleFailedRequest(Kn.TypeHierarchySubtypesRequest.type,a,l,null))};return r.provideTypeHierarchySubtypes?r.provideTypeHierarchySubtypes(e,n,o):o(e,n)}}class lp extends xa.TextDocumentLanguageFeature{constructor(e){super(e,Kn.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){const n=(0,xa.ensure)((0,xa.ensure)(e,"textDocument"),"typeHierarchy");n.dynamicRegistration=!0}initialize(e,n){const[i,r]=this.getRegistration(n,e.typeHierarchyProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(e){const n=this._client,i=new up(n);return[cp.languages.registerTypeHierarchyProvider(n.protocol2CodeConverter.asDocumentSelector(e.documentSelector),i),i]}}_o.TypeHierarchyFeature=lp;var Do={};Object.defineProperty(Do,"__esModule",{value:!0}),Do.InlineValueFeature=void 0;const _l=H,bo=U,Bi=j;class dp extends Bi.TextDocumentLanguageFeature{constructor(e){super(e,bo.InlineValueRequest.type)}fillClientCapabilities(e){(0,Bi.ensure)((0,Bi.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,Bi.ensure)((0,Bi.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,n){this._client.onRequest(bo.InlineValueRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeInlineValues.fire()});const[i,r]=this.getRegistration(n,e.inlineValueProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(e){const n=e.documentSelector,i=new _l.EventEmitter,r={onDidChangeInlineValues:i.event,provideInlineValues:(o,s,a,u)=>{const l=this._client,f=(p,C,h,w)=>{const R={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(p),range:l.code2ProtocolConverter.asRange(C),context:l.code2ProtocolConverter.asInlineValueContext(h)};return l.sendRequest(bo.InlineValueRequest.type,R,w).then(M=>w.isCancellationRequested?null:l.protocol2CodeConverter.asInlineValues(M,w),M=>l.handleFailedRequest(bo.InlineValueRequest.type,w,M,null))},m=l.middleware;return m.provideInlineValues?m.provideInlineValues(o,s,a,u,f):f(o,s,a,u)}};return[this.registerProvider(n,r),{provider:r,onDidChangeInlineValues:i}]}registerProvider(e,n){return _l.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}}Do.InlineValueFeature=dp;var wo={};Object.defineProperty(wo,"__esModule",{value:!0}),wo.InlayHintsFeature=void 0;const Dl=H,mi=U,Vi=j;class fp extends Vi.TextDocumentLanguageFeature{constructor(e){super(e,mi.InlayHintRequest.type)}fillClientCapabilities(e){const n=(0,Vi.ensure)((0,Vi.ensure)(e,"textDocument"),"inlayHint");n.dynamicRegistration=!0,n.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,Vi.ensure)((0,Vi.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,n){this._client.onRequest(mi.InlayHintRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeInlayHints.fire()});const[i,r]=this.getRegistration(n,e.inlayHintProvider);!i||!r||this.register({id:i,registerOptions:r})}registerLanguageProvider(e){const n=e.documentSelector,i=new Dl.EventEmitter,r={onDidChangeInlayHints:i.event,provideInlayHints:(o,s,a)=>{const u=this._client,l=async(m,p,C)=>{const h={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m),range:u.code2ProtocolConverter.asRange(p)};try{const w=await u.sendRequest(mi.InlayHintRequest.type,h,C);return C.isCancellationRequested?null:u.protocol2CodeConverter.asInlayHints(w,C)}catch(w){return u.handleFailedRequest(mi.InlayHintRequest.type,C,w,null)}},f=u.middleware;return f.provideInlayHints?f.provideInlayHints(o,s,a,l):l(o,s,a)}};return r.resolveInlayHint=e.resolveProvider===!0?(o,s)=>{const a=this._client,u=async(f,m)=>{try{const p=await a.sendRequest(mi.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(f),m);if(m.isCancellationRequested)return null;const C=a.protocol2CodeConverter.asInlayHint(p,m);return m.isCancellationRequested?null:C}catch(p){return a.handleFailedRequest(mi.InlayHintResolveRequest.type,m,p,null)}},l=a.middleware;return l.resolveInlayHint?l.resolveInlayHint(o,s,u):u(o,s)}:void 0,[this.registerProvider(n,r),{provider:r,onDidChangeInlayHints:i}]}registerProvider(e,n){return Dl.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}}wo.InlayHintsFeature=fp;var So={};Object.defineProperty(So,"__esModule",{value:!0}),So.InlineCompletionItemFeature=void 0;const gp=H,Na=U,La=j,hp=ce;class pp extends La.TextDocumentLanguageFeature{constructor(e){super(e,Na.InlineCompletionRequest.type)}fillClientCapabilities(e){let n=(0,La.ensure)((0,La.ensure)(e,"textDocument"),"inlineCompletion");n.dynamicRegistration=!0}initialize(e,n){const i=this.getRegistrationOptions(n,e.inlineCompletionProvider);i&&this.register({id:hp.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n=e.documentSelector,i={provideInlineCompletionItems:(r,o,s,a)=>{const u=this._client,l=this._client.middleware,f=(m,p,C,h)=>u.sendRequest(Na.InlineCompletionRequest.type,u.code2ProtocolConverter.asInlineCompletionParams(m,p,C),h).then(w=>h.isCancellationRequested?null:u.protocol2CodeConverter.asInlineCompletionResult(w,h),w=>u.handleFailedRequest(Na.InlineCompletionRequest.type,h,w,null));return l.provideInlineCompletionItems?l.provideInlineCompletionItems(r,o,s,a,f):f(r,o,s,a)}};return[gp.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),i),i]}}So.InlineCompletionItemFeature=pp,Object.defineProperty(We,"__esModule",{value:!0}),We.ProposedFeatures=We.BaseLanguageClient=We.MessageTransports=We.SuspendMode=We.State=We.CloseAction=We.ErrorAction=We.RevealOutputChannelOn=void 0;const he=H,k=U,mp=Rr,yp=xr,xt=fe,Ro=Ke,bl=ce,vp=Mi,Nt=j,Cp=an,wl=Wr,Sl=Pn,yi=lt,_p=Br,Dp=Vr,bp=Jr,wp=Qr,Sp=Gr,Rp=fa,Tp=Xr,Pp=Yr,kp=Zr,Fp=eo,ja=kn,Ep=no,Op=io,qp=ro,Mp=oo,Ip=ao,xp=co,Np=uo,Lp=pi,jp=fo,Ap=go,$p=ho,Hp=po,Wp=mo,Kp=yo,vi=dt,Up=Co,zp=_o,Bp=Do,Vp=wo,Jp=So;var Un;(function(t){t[t.Debug=0]="Debug",t[t.Info=1]="Info",t[t.Warn=2]="Warn",t[t.Error=3]="Error",t[t.Never=4]="Never"})(Un||(We.RevealOutputChannelOn=Un={}));var Ji;(function(t){t[t.Continue=1]="Continue",t[t.Shutdown=2]="Shutdown"})(Ji||(We.ErrorAction=Ji={}));var Fn;(function(t){t[t.DoNotRestart=1]="DoNotRestart",t[t.Restart=2]="Restart"})(Fn||(We.CloseAction=Fn={}));var Qi;(function(t){t[t.Stopped=1]="Stopped",t[t.Starting=3]="Starting",t[t.Running=2]="Running"})(Qi||(We.State=Qi={}));var Rl;(function(t){t.off="off",t.on="on"})(Rl||(We.SuspendMode=Rl={}));var Aa;(function(t){function e(n){return n==null?!1:typeof n=="boolean"||typeof n=="object"&&n!==null&&xt.stringArray(n.enabledCommands)?n:!1}t.sanitizeIsTrusted=e})(Aa||(Aa={}));class Qp{constructor(e,n){this.client=e,this.maxRestartCount=n,this.restarts=[]}error(e,n,i){return i&&i<=3?{action:Ji.Continue}:{action:Ji.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:Fn.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:Fn.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:Fn.Restart})}}var Y;(function(t){t.Initial="initial",t.Starting="starting",t.StartFailed="startFailed",t.Running="running",t.Stopping="stopping",t.Stopped="stopped"})(Y||(Y={}));var Tl;(function(t){function e(n){return n&&k.MessageReader.is(n.reader)&&k.MessageWriter.is(n.writer)}t.is=e})(Tl||(We.MessageTransports=Tl={}));class Vn{constructor(e,n,i){this._traceFormat=k.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new Ro.Semaphore(1),this._id=e,this._name=n,i=i||{};const r={isTrusted:!1,supportHtml:!1};i.markdown!==void 0&&(r.isTrusted=Aa.sanitizeIsTrusted(i.markdown.isTrusted),r.supportHtml=i.markdown.supportHtml===!0),this._clientOptions={documentSelector:i.documentSelector??[],synchronize:i.synchronize??{},diagnosticCollectionName:i.diagnosticCollectionName,outputChannelName:i.outputChannelName??this._name,revealOutputChannelOn:i.revealOutputChannelOn??Un.Error,stdioEncoding:i.stdioEncoding??"utf8",initializationOptions:i.initializationOptions,initializationFailedHandler:i.initializationFailedHandler,progressOnInitialization:!!i.progressOnInitialization,errorHandler:i.errorHandler??this.createDefaultErrorHandler(i.connectionOptions?.maxRestartCount),middleware:i.middleware??{},uriConverters:i.uriConverters,workspaceFolder:i.workspaceFolder,connectionOptions:i.connectionOptions,markdown:r,diagnosticPullOptions:i.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:i.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=Y.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,i.outputChannel?(this._outputChannel=i.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=i.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new Ro.Semaphore(1),this._pendingChangeDelayer=new Ro.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new Ro.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new k.Emitter,this._stateChangeEmitter=new k.Emitter,this._trace=k.Trace.Off,this._tracer={log:(o,s)=>{xt.string(o)?this.logTrace(o,s):this.logObjectTrace(o)}},this._c2p=mp.createConverter(i.uriConverters?i.uriConverters.code2Protocol:void 0),this._p2c=yp.createConverter(i.uriConverters?i.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=he.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let n=this.getPublicState();this._state=e;let i=this.getPublicState();i!==n&&this._stateChangeEmitter.fire({oldState:n,newState:i})}getPublicState(){switch(this.$state){case Y.Starting:return Qi.Starting;case Y.Running:return Qi.Running;default:return Qi.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...n){if(this.$state===Y.StartFailed||this.$state===Y.Stopping||this.$state===Y.Stopped)return Promise.reject(new k.ResponseError(k.ErrorCodes.ConnectionInactive,"Client is not running"));const i=await this.$start();this._didChangeTextDocumentFeature.syncKind===k.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(i);const r=this._clientOptions.middleware?.sendRequest;if(r!==void 0){let o,s;return n.length===1?k.CancellationToken.is(n[0])?s=n[0]:o=n[0]:n.length===2&&(o=n[0],s=n[1]),r(e,o,s,(a,u,l)=>{const f=[];return u!==void 0&&f.push(u),l!==void 0&&f.push(l),i.sendRequest(a,...f)})}else return i.sendRequest(e,...n)}onRequest(e,n){const i=typeof e=="string"?e:e.method;this._requestHandlers.set(i,n);const r=this.activeConnection();let o;return r!==void 0?(this._requestDisposables.set(i,r.onRequest(e,n)),o={dispose:()=>{const s=this._requestDisposables.get(i);s!==void 0&&(s.dispose(),this._requestDisposables.delete(i))}}):(this._pendingRequestHandlers.set(i,n),o={dispose:()=>{this._pendingRequestHandlers.delete(i);const s=this._requestDisposables.get(i);s!==void 0&&(s.dispose(),this._requestDisposables.delete(i))}}),{dispose:()=>{this._requestHandlers.delete(i),o.dispose()}}}async sendNotification(e,n){if(this.$state===Y.StartFailed||this.$state===Y.Stopping||this.$state===Y.Stopped)return Promise.reject(new k.ResponseError(k.ErrorCodes.ConnectionInactive,"Client is not running"));const i=this._didChangeTextDocumentFeature.syncKind===k.TextDocumentSyncKind.Full;let r;i&&typeof e!="string"&&e.method===k.DidOpenTextDocumentNotification.method&&(r=n?.textDocument.uri,this._pendingOpenNotifications.add(r));const o=await this.$start();i&&await this.sendPendingFullTextDocumentChanges(o),r!==void 0&&this._pendingOpenNotifications.delete(r);const s=this._clientOptions.middleware?.sendNotification;return s?s(e,o.sendNotification.bind(o),n):o.sendNotification(e,n)}onNotification(e,n){const i=typeof e=="string"?e:e.method;this._notificationHandlers.set(i,n);const r=this.activeConnection();let o;return r!==void 0?(this._notificationDisposables.set(i,r.onNotification(e,n)),o={dispose:()=>{const s=this._notificationDisposables.get(i);s!==void 0&&(s.dispose(),this._notificationDisposables.delete(i))}}):(this._pendingNotificationHandlers.set(i,n),o={dispose:()=>{this._pendingNotificationHandlers.delete(i);const s=this._notificationDisposables.get(i);s!==void 0&&(s.dispose(),this._notificationDisposables.delete(i))}}),{dispose:()=>{this._notificationHandlers.delete(i),o.dispose()}}}async sendProgress(e,n,i){if(this.$state===Y.StartFailed||this.$state===Y.Stopping||this.$state===Y.Stopped)return Promise.reject(new k.ResponseError(k.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,n,i)}catch(r){throw this.error(`Sending progress for token ${n} failed.`,r),r}}onProgress(e,n,i){this._progressHandlers.set(n,{type:e,handler:i});const r=this.activeConnection();let o;const s=this._clientOptions.middleware?.handleWorkDoneProgress,a=k.WorkDoneProgress.is(e)&&s!==void 0?u=>{s(n,u,()=>i(u))}:i;return r!==void 0?(this._progressDisposables.set(n,r.onProgress(e,n,a)),o={dispose:()=>{const u=this._progressDisposables.get(n);u!==void 0&&(u.dispose(),this._progressDisposables.delete(n))}}):(this._pendingProgressHandlers.set(n,{type:e,handler:i}),o={dispose:()=>{this._pendingProgressHandlers.delete(n);const u=this._progressDisposables.get(n);u!==void 0&&(u.dispose(),this._progressDisposables.delete(n))}}),{dispose:()=>{this._progressHandlers.delete(n),o.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new Qp(this,e??4)}async setTrace(e){this._trace=e;const n=this.activeConnection();n!==void 0&&await n.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof k.ResponseError){const n=e;return`  Message: ${n.message}
  Code: ${n.code} ${n.data?`
`+n.data.toString():""}`}return e instanceof Error?xt.string(e.stack)?e.stack:e.message:xt.string(e)?e:e.toString()}debug(e,n,i=!0){this.logOutputMessage(k.MessageType.Debug,Un.Debug,"Debug",e,n,i)}info(e,n,i=!0){this.logOutputMessage(k.MessageType.Info,Un.Info,"Info",e,n,i)}warn(e,n,i=!0){this.logOutputMessage(k.MessageType.Warning,Un.Warn,"Warn",e,n,i)}error(e,n,i=!0){this.logOutputMessage(k.MessageType.Error,Un.Error,"Error",e,n,i)}logOutputMessage(e,n,i,r,o,s){this.outputChannel.appendLine(`[${i.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${r}`),o!=null&&this.outputChannel.appendLine(this.data2String(o)),(s==="force"||s&&this._clientOptions.revealOutputChannelOn<=n)&&this.showNotificationMessage(e,r)}showNotificationMessage(e,n){n=n??"A request has failed. See the output for more information.",(e===k.MessageType.Error?he.window.showErrorMessage:e===k.MessageType.Warning?he.window.showWarningMessage:he.window.showInformationMessage)(n,"Go to output").then(r=>{r!==void 0&&this.outputChannel.show(!0)})}logTrace(e,n){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),n&&this.traceOutputChannel.appendLine(this.data2String(n))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===Y.Initial||this.$state===Y.Stopping||this.$state===Y.Stopped}needsStop(){return this.$state===Y.Starting||this.$state===Y.Running}activeConnection(){return this.$state===Y.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===Y.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===Y.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;const[e,n,i]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?he.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):he.languages.createDiagnosticCollection());for(const[r,o]of this._notificationHandlers)this._pendingNotificationHandlers.has(r)||this._pendingNotificationHandlers.set(r,o);for(const[r,o]of this._requestHandlers)this._pendingRequestHandlers.has(r)||this._pendingRequestHandlers.set(r,o);for(const[r,o]of this._progressHandlers)this._pendingProgressHandlers.has(r)||this._pendingProgressHandlers.set(r,o);this.$state=Y.Starting;try{const r=await this.createConnection();r.onNotification(k.LogMessageNotification.type,o=>{switch(o.type){case k.MessageType.Error:this.error(o.message,void 0,!1);break;case k.MessageType.Warning:this.warn(o.message,void 0,!1);break;case k.MessageType.Info:this.info(o.message,void 0,!1);break;case k.MessageType.Debug:this.debug(o.message,void 0,!1);break;default:this.outputChannel.appendLine(o.message)}}),r.onNotification(k.ShowMessageNotification.type,o=>{switch(o.type){case k.MessageType.Error:he.window.showErrorMessage(o.message);break;case k.MessageType.Warning:he.window.showWarningMessage(o.message);break;case k.MessageType.Info:he.window.showInformationMessage(o.message);break;default:he.window.showInformationMessage(o.message)}}),r.onRequest(k.ShowMessageRequest.type,o=>{let s;switch(o.type){case k.MessageType.Error:s=he.window.showErrorMessage;break;case k.MessageType.Warning:s=he.window.showWarningMessage;break;case k.MessageType.Info:s=he.window.showInformationMessage;break;default:s=he.window.showInformationMessage}let a=o.actions||[];return s(o.message,...a)}),r.onNotification(k.TelemetryEventNotification.type,o=>{this._telemetryEmitter.fire(o)}),r.onRequest(k.ShowDocumentRequest.type,async o=>{const s=async u=>{const l=this.protocol2CodeConverter.asUri(u.uri);try{if(u.external===!0)return{success:await he.env.openExternal(l)};{const f={};return u.selection!==void 0&&(f.selection=this.protocol2CodeConverter.asRange(u.selection)),u.takeFocus===void 0||u.takeFocus===!1?f.preserveFocus=!0:u.takeFocus===!0&&(f.preserveFocus=!1),await he.window.showTextDocument(l,f),{success:!0}}}catch{return{success:!1}}},a=this._clientOptions.middleware.window?.showDocument;return a!==void 0?a(o,s):s(o)}),r.listen(),await this.initialize(r),n()}catch(r){this.$state=Y.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,r,"force"),i(r)}return this._onStart}createOnStartPromise(){let e,n;return[new Promise((r,o)=>{e=r,n=o}),e,n]}async initialize(e){this.refreshTrace(e,!1);const n=this._clientOptions.initializationOptions,[i,r]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],o={processId:null,clientInfo:{name:he.env.appName,version:he.version},locale:this.getLocale(),rootPath:i||null,rootUri:i?this._c2p.asUri(he.Uri.file(i)):null,capabilities:this.computeClientCapabilities(),initializationOptions:xt.func(n)?n():n,trace:k.Trace.toString(this._trace),workspaceFolders:r};if(this.fillInitializeParams(o),this._clientOptions.progressOnInitialization){const s=bl.generateUuid(),a=new vp.ProgressPart(e,s);o.workDoneToken=s;try{const u=await this.doInitialize(e,o);return a.done(),u}catch(u){throw a.cancel(),u}}else return this.doInitialize(e,o)}async doInitialize(e,n){try{const i=await e.initialize(n);if(i.capabilities.positionEncoding!==void 0&&i.capabilities.positionEncoding!==k.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${i.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=i,this.$state=Y.Running;let r;xt.number(i.capabilities.textDocumentSync)?i.capabilities.textDocumentSync===k.TextDocumentSyncKind.None?r={openClose:!1,change:k.TextDocumentSyncKind.None,save:void 0}:r={openClose:!0,change:i.capabilities.textDocumentSync,save:{includeText:!1}}:i.capabilities.textDocumentSync!==void 0&&i.capabilities.textDocumentSync!==null&&(r=i.capabilities.textDocumentSync),this._capabilities=Object.assign({},i.capabilities,{resolvedTextDocumentSync:r}),e.onNotification(k.PublishDiagnosticsNotification.type,o=>this.handleDiagnostics(o)),e.onRequest(k.RegistrationRequest.type,o=>this.handleRegistrationRequest(o)),e.onRequest("client/registerFeature",o=>this.handleRegistrationRequest(o)),e.onRequest(k.UnregistrationRequest.type,o=>this.handleUnregistrationRequest(o)),e.onRequest("client/unregisterFeature",o=>this.handleUnregistrationRequest(o)),e.onRequest(k.ApplyWorkspaceEditRequest.type,o=>this.handleApplyWorkspaceEdit(o));for(const[o,s]of this._pendingNotificationHandlers)this._notificationDisposables.set(o,e.onNotification(o,s));this._pendingNotificationHandlers.clear();for(const[o,s]of this._pendingRequestHandlers)this._requestDisposables.set(o,e.onRequest(o,s));this._pendingRequestHandlers.clear();for(const[o,s]of this._pendingProgressHandlers)this._progressDisposables.set(o,e.onProgress(s.type,o,s.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(k.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),i}catch(i){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(i)?this.initialize(e):this.stop():i instanceof k.ResponseError&&i.data&&i.data.retry?he.window.showErrorMessage(i.message,{title:"Retry",id:"retry"}).then(r=>{r&&r.id==="retry"?this.initialize(e):this.stop()}):(i&&i.message&&he.window.showErrorMessage(i.message),this.error("Server initialization failed.",i),this.stop()),i}}_clientGetRootPath(){let e=he.workspace.workspaceFolders;if(!e||e.length===0)return;let n=e[0];if(n.uri.scheme==="file")return n.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,n){if(this.$state===Y.Stopped||this.$state===Y.Initial)return;if(this.$state===Y.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}const i=this.activeConnection();if(i===void 0||this.$state!==Y.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=Y.Stopping,this.cleanUp(e);const r=new Promise(s=>{(0,k.RAL)().timer.setTimeout(s,n)}),o=(async s=>(await s.shutdown(),await s.exit(),s))(i);return this._onStop=Promise.race([r,o]).then(s=>{if(s!==void 0)s.end(),s.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},s=>{throw this.error("Stopping server failed",s,!1),s}).finally(()=>{this.$state=Y.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();const n=this._listeners.splice(0,this._listeners.length);for(const i of n)i.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(const i of Array.from(this._features.entries()).map(r=>r[1]).reverse())i.clear();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){const n=this;async function i(o){return n._fileEvents.push(o),n._fileEventDelayer.trigger(async()=>{await n.sendNotification(k.DidChangeWatchedFilesNotification.type,{changes:n._fileEvents}),n._fileEvents=[]})}const r=this.clientOptions.middleware?.workspace;(r?.didChangeWatchedFile?r.didChangeWatchedFile(e,i):i(e)).catch(o=>{n.error("Notify file events failed.",o)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{const n=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(n.length===0)return;for(const i of n){const r=this.code2ProtocolConverter.asChangeTextDocumentParams(i);await e.sendNotification(k.DidChangeTextDocumentNotification.type,r),this._didChangeTextDocumentFeature.notificationSent(i,k.DidChangeTextDocumentNotification.type,r)}}catch(n){throw this.error("Sending pending changes failed",n,!1),n}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{const e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;const n=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===n&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,k.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;const e=this._diagnosticQueue.entries().next();if(e.done===!0)return;const[n,i]=e.value;this._diagnosticQueue.delete(n);const r=new he.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:n,tokenSource:r},this._p2c.asDiagnostics(i,r.token).then(o=>{if(!r.token.isCancellationRequested){const s=this._p2c.asUri(n),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(s,o,(u,l)=>this.setDiagnostics(u,l)):this.setDiagnostics(s,o)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,n){this._diagnostics&&this._diagnostics.set(e,n)}getLocale(){return he.env.language}async $start(){if(this.$state===Y.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();const e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(r,o,s)=>{this.handleConnectionError(r,o,s).catch(a=>this.error("Handling connection error failed",a))},n=()=>{this.handleConnectionClosed().catch(r=>this.error("Handling connection close failed",r))};const i=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=Xp(i.reader,i.writer,e,n,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===Y.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:Fn.DoNotRestart};if(this.$state!==Y.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===Fn.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===Y.Starting?this.$state=Y.StartFailed:this.$state=Y.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===Fn.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=Y.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(n=>this.error("Restarting server failed",n,"force")))}async handleConnectionError(e,n,i){const r=await this._clientOptions.errorHandler.error(e,n,i);r.action===Ji.Shutdown?(this.error(r.message??`Client ${this._name}: connection to server is erroring.
${e.message}
Shutting down server.`,void 0,r.handled===!0?!1:"force"),this.stop().catch(o=>{this.error("Stopping server failed",o,!1)})):this.error(r.message??`Client ${this._name}: connection to server is erroring.
${e.message}`,void 0,r.handled===!0?!1:"force")}hookConfigurationChanged(e){this._listeners.push(he.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,n=!1){const i=he.workspace.getConfiguration(this._id);let r=k.Trace.Off,o=k.TraceFormat.Text;if(i){const s=i.get("trace.server","off");typeof s=="string"?r=k.Trace.fromString(s):(r=k.Trace.fromString(i.get("trace.server.verbosity","off")),o=k.TraceFormat.fromString(i.get("trace.server.format","text")))}this._trace=r,this._traceFormat=o,e.trace(this._trace,this._tracer,{sendNotification:n,traceFormat:this._traceFormat}).catch(s=>{this.error("Updating trace failed with error",s,!1)})}hookFileEvents(e){let n=this._clientOptions.synchronize.fileEvents;if(!n)return;let i;xt.array(n)?i=n:i=[n],i&&this._dynamicFeatures.get(k.DidChangeWatchedFilesNotification.type.method).registerRaw(bl.generateUuid(),i)}registerFeatures(e){for(let n of e)this.registerFeature(n)}registerFeature(e){if(this._features.push(e),Nt.DynamicFeature.is(e)){const n=e.registrationType;this._dynamicFeatures.set(n.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){const n=this.getFeature(k.NotebookDocumentSyncRegistrationType.method);return n===void 0||!(n instanceof wl.NotebookDocumentSyncFeature)?!1:n.handles(e)}registerBuiltinFeatures(){const e=new Map;this.registerFeature(new Sl.ConfigurationFeature(this)),this.registerFeature(new yi.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new yi.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new yi.WillSaveFeature(this)),this.registerFeature(new yi.WillSaveWaitUntilFeature(this)),this.registerFeature(new yi.DidSaveTextDocumentFeature(this)),this.registerFeature(new yi.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new Mp.FileSystemWatcherFeature(this,n=>this.notifyFileEvent(n))),this.registerFeature(new _p.CompletionItemFeature(this)),this.registerFeature(new Dp.HoverFeature(this)),this.registerFeature(new wp.SignatureHelpFeature(this)),this.registerFeature(new bp.DefinitionFeature(this)),this.registerFeature(new Pp.ReferencesFeature(this)),this.registerFeature(new Sp.DocumentHighlightFeature(this)),this.registerFeature(new Rp.DocumentSymbolFeature(this)),this.registerFeature(new Tp.WorkspaceSymbolFeature(this)),this.registerFeature(new kp.CodeActionFeature(this)),this.registerFeature(new Fp.CodeLensFeature(this)),this.registerFeature(new ja.DocumentFormattingFeature(this)),this.registerFeature(new ja.DocumentRangeFormattingFeature(this)),this.registerFeature(new ja.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new Ep.RenameFeature(this)),this.registerFeature(new Op.DocumentLinkFeature(this)),this.registerFeature(new qp.ExecuteCommandFeature(this)),this.registerFeature(new Sl.SyncConfigurationFeature(this)),this.registerFeature(new Np.TypeDefinitionFeature(this)),this.registerFeature(new xp.ImplementationFeature(this)),this.registerFeature(new Ip.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new Lp.WorkspaceFoldersFeature(this)),this.registerFeature(new jp.FoldingRangeFeature(this)),this.registerFeature(new Ap.DeclarationFeature(this)),this.registerFeature(new $p.SelectionRangeFeature(this)),this.registerFeature(new Hp.ProgressFeature(this)),this.registerFeature(new Wp.CallHierarchyFeature(this)),this.registerFeature(new Kp.SemanticTokensFeature(this)),this.registerFeature(new Up.LinkedEditingFeature(this)),this.registerFeature(new vi.DidCreateFilesFeature(this)),this.registerFeature(new vi.DidRenameFilesFeature(this)),this.registerFeature(new vi.DidDeleteFilesFeature(this)),this.registerFeature(new vi.WillCreateFilesFeature(this)),this.registerFeature(new vi.WillRenameFilesFeature(this)),this.registerFeature(new vi.WillDeleteFilesFeature(this)),this.registerFeature(new zp.TypeHierarchyFeature(this)),this.registerFeature(new Bp.InlineValueFeature(this)),this.registerFeature(new Vp.InlayHintsFeature(this)),this.registerFeature(new Cp.DiagnosticFeature(this)),this.registerFeature(new wl.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures($a.createAll(this))}fillInitializeParams(e){for(let n of this._features)xt.func(n.fillInitializeParams)&&n.fillInitializeParams(e)}computeClientCapabilities(){const e={};(0,Nt.ensure)(e,"workspace").applyEdit=!0;const n=(0,Nt.ensure)((0,Nt.ensure)(e,"workspace"),"workspaceEdit");n.documentChanges=!0,n.resourceOperations=[k.ResourceOperationKind.Create,k.ResourceOperationKind.Rename,k.ResourceOperationKind.Delete],n.failureHandling=k.FailureHandlingKind.TextOnlyTransactional,n.normalizesLineEndings=!0,n.changeAnnotationSupport={groupsOnLabel:!0};const i=(0,Nt.ensure)((0,Nt.ensure)(e,"textDocument"),"publishDiagnostics");i.relatedInformation=!0,i.versionSupport=!1,i.tagSupport={valueSet:[k.DiagnosticTag.Unnecessary,k.DiagnosticTag.Deprecated]},i.codeDescriptionSupport=!0,i.dataSupport=!0;const r=(0,Nt.ensure)(e,"window"),o=(0,Nt.ensure)(r,"showMessage");o.messageActionItem={additionalPropertiesSupport:!0};const s=(0,Nt.ensure)(r,"showDocument");s.support=!0;const a=(0,Nt.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(Vn.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let u of this._features)u.fillClientCapabilities(e);return e}initializeFeatures(e){const n=this._clientOptions.documentSelector;for(const i of this._features)xt.func(i.preInitialize)&&i.preInitialize(this._capabilities,n);for(const i of this._features)i.initialize(this._capabilities,n)}async handleRegistrationRequest(e){const n=this.clientOptions.middleware?.handleRegisterCapability;return n?n(e,i=>this.doRegisterCapability(i)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(const n of e.registrations)this._ignoredRegistrations.add(n.id);return}for(const n of e.registrations){const i=this._dynamicFeatures.get(n.method);if(i===void 0)return Promise.reject(new Error(`No feature implementation for ${n.method} found. Registration failed.`));const r=n.registerOptions??{};r.documentSelector=r.documentSelector??this._clientOptions.documentSelector;const o={id:n.id,registerOptions:r};try{i.register(o)}catch(s){return Promise.reject(s)}}}async handleUnregistrationRequest(e){const n=this.clientOptions.middleware?.handleUnregisterCapability;return n?n(e,i=>this.doUnregisterCapability(i)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(const n of e.unregisterations){if(this._ignoredRegistrations.has(n.id))continue;const i=this._dynamicFeatures.get(n.method);if(!i)return Promise.reject(new Error(`No feature implementation for ${n.method} found. Unregistration failed.`));i.unregister(n.id)}}async handleApplyWorkspaceEdit(e){const n=e.edit,i=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(n)),r=new Map;he.workspace.textDocuments.forEach(s=>r.set(s.uri.toString(),s));let o=!1;if(n.documentChanges){for(const s of n.documentChanges)if(k.TextDocumentEdit.is(s)&&s.textDocument.version&&s.textDocument.version>=0){const a=this._p2c.asUri(s.textDocument.uri).toString(),u=r.get(a);if(u&&u.version!==s.textDocument.version){o=!0;break}}}return o?Promise.resolve({applied:!1}):xt.asPromise(he.workspace.applyEdit(i).then(s=>({applied:s})))}handleFailedRequest(e,n,i,r,o=!0){if(i instanceof k.ResponseError){if(i.code===k.ErrorCodes.PendingResponseRejected||i.code===k.ErrorCodes.ConnectionInactive)return r;if(i.code===k.LSPErrorCodes.RequestCancelled||i.code===k.LSPErrorCodes.ServerCancelled){if(n!==void 0&&n.isCancellationRequested)return r;throw i.data!==void 0?new Nt.LSPCancellationError(i.data):new he.CancellationError}else if(i.code===k.LSPErrorCodes.ContentModified){if(Vn.RequestsToCancelOnContentModified.has(e.method)||Vn.CancellableResolveCalls.has(e.method))throw new he.CancellationError;return r}}throw this.error(`Request ${e.method} failed.`,i,o),i}}We.BaseLanguageClient=Vn,Vn.RequestsToCancelOnContentModified=new Set([k.SemanticTokensRequest.method,k.SemanticTokensRangeRequest.method,k.SemanticTokensDeltaRequest.method]),Vn.CancellableResolveCalls=new Set([k.CompletionResolveRequest.method,k.CodeLensResolveRequest.method,k.CodeActionResolveRequest.method,k.InlayHintResolveRequest.method,k.DocumentLinkResolveRequest.method,k.WorkspaceSymbolResolveRequest.method]);class Gp{error(e){(0,k.RAL)().console.error(e)}warn(e){(0,k.RAL)().console.warn(e)}info(e){(0,k.RAL)().console.info(e)}log(e){(0,k.RAL)().console.log(e)}}function Xp(t,e,n,i,r){const o=new Gp,s=(0,k.createProtocolConnection)(t,e,o,r);return s.onError(u=>{n(u[0],u[1],u[2])}),s.onClose(i),{listen:()=>s.listen(),sendRequest:s.sendRequest,onRequest:s.onRequest,hasPendingResponse:s.hasPendingResponse,sendNotification:s.sendNotification,onNotification:s.onNotification,onProgress:s.onProgress,sendProgress:s.sendProgress,trace:(u,l,f)=>{const m={sendNotification:!1,traceFormat:k.TraceFormat.Text};return f===void 0?s.trace(u,l,m):(xt.boolean(f),s.trace(u,l,f))},initialize:u=>s.sendRequest(k.InitializeRequest.type,u),shutdown:()=>s.sendRequest(k.ShutdownRequest.type,void 0),exit:()=>s.sendNotification(k.ExitNotification.type),end:()=>s.end(),dispose:()=>s.dispose()}}var $a;(function(t){function e(n){return[new Jp.InlineCompletionItemFeature(n)]}t.createAll=e})($a||(We.ProposedFeatures=$a={}));var Ha={};(function(t){var e=Ie&&Ie.__createBinding||(Object.create?function(r,o,s,a){a===void 0&&(a=s);var u=Object.getOwnPropertyDescriptor(o,s);(!u||("get"in u?!o.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(r,a,u)}:function(r,o,s,a){a===void 0&&(a=s),r[a]=o[s]}),n=Ie&&Ie.__exportStar||function(r,o){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,r,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticPullMode=t.vsdiag=void 0,n(U,t),n(j,t);var i=an;Object.defineProperty(t,"vsdiag",{enumerable:!0,get:function(){return i.vsdiag}}),Object.defineProperty(t,"DiagnosticPullMode",{enumerable:!0,get:function(){return i.DiagnosticPullMode}}),n(We,t)})(Ha);var Pl={},kl=U;(function(t){var e=Ie&&Ie.__createBinding||(Object.create?function(s,a,u,l){l===void 0&&(l=u);var f=Object.getOwnPropertyDescriptor(a,u);(!f||("get"in f?!a.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return a[u]}}),Object.defineProperty(s,l,f)}:function(s,a,u,l){l===void 0&&(l=u),s[l]=a[u]}),n=Ie&&Ie.__exportStar||function(s,a){for(var u in s)u!=="default"&&!Object.prototype.hasOwnProperty.call(a,u)&&e(a,s,u)};Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageClient=void 0;const i=Ha,r=kl;n(kl,t),n(Ha,t);class o extends i.BaseLanguageClient{constructor(a,u,l,f){super(a,u,l),this.worker=f}createMessageTransports(a){const u=new r.BrowserMessageReader(this.worker),l=new r.BrowserMessageWriter(this.worker);return Promise.resolve({reader:u,writer:l})}}t.LanguageClient=o})(Pl);var Yp=Pl;async function Zp(t){return console.log(!0),await em(t)}async function em(t){const e=ae.Uri.joinPath(t.extensionUri,"dist/server-worker.js"),n=new Worker(e.toString(!0));return new Yp.LanguageClient("taplo-lsp","Taplo LSP",await tm(t),n)}async function tm(t){return await ae.workspace.fs.createDirectory(t.globalStorageUri),{documentSelector:[{scheme:"file",language:"toml"},{scheme:"file",language:"cargoLock"}],initializationOptions:{configurationSection:"evenBetterToml",cachePath:t.globalStorageUri.fsPath}}}function nm(t,e){for(const n of ae.extensions.all){const i=n.packageJSON?.contributes?.tomlValidation;if(Array.isArray(i))for(const r of i){if(typeof r!="object")continue;const o=r.url;if(typeof o!="string")continue;let s=r.fileMatch,a=r.regexMatch;Array.isArray(s)||(s=[s]);for(let u of s)typeof u=="string"&&(u.startsWith("/")||(u=`/${u}`),e.sendNotification("taplo/associateSchema",{schemaUri:o,priority:10,rule:{glob:`**${u}`},meta:{source:"extension",extensionId:n.id}}));Array.isArray(a)||(a=[a]);for(const u of a)typeof u=="string"&&e.sendNotification("taplo/associateSchema",{schemaUri:o,priority:10,rule:{regex:u},meta:{source:"extension",extensionId:n.id}})}}}async function im(t){const e=ae.window.createStatusBarItem(ae.StatusBarAlignment.Right,0);e.text="no schema selected",e.tooltip="TOML Schema",e.command="evenBetterToml.selectSchema";const n=await Zp(t);await n.start(),ae.window.activeTextEditor?.document.languageId==="toml"&&e.show(),Nl(t,n),nm(t,n),t.subscriptions.push(Ci(),e,n.onNotification("taplo/messageWithOutput",async i=>Ol(i,n)),ae.window.onDidChangeActiveTextEditor(i=>{i?.document.languageId==="toml"?e.show():e.hide()}),n.onNotification("taplo/didChangeSchemaAssociation",async i=>{const r=ae.window.activeTextEditor?.document.uri.toString();r&&i.documentUri===r&&(e.text=i.meta?.name??i.schemaUri??"no schema selected")}))}exports.activate=im;
