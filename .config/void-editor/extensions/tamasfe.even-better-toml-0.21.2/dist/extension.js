"use strict";var ce=require("vscode"),Me=require("./_commonjs-dynamic-modules.js"),Ls=require("child_process"),ho=require("fs"),Ar=require("path"),Xu=require("util"),Ju=require("os"),Qu=require("crypto"),Yu=require("net"),As=require("fs/promises");function Zu(n){var e=Object.create(null);return n&&Object.keys(n).forEach(function(t){if(t!=="default"){var r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:function(){return n[t]}})}}),e.default=n,Object.freeze(e)}var be=Zu(ce);let go;function Hn(){return go||(go=be.window.createOutputChannel("Even Better TOML")),go}async function el(n,e){let t;switch(n.kind){case"info":t=await be.window.showInformationMessage(n.message,"Show Details");case"warn":t=await be.window.showWarningMessage(n.message,"Show Details");case"error":t=await be.window.showErrorMessage(n.message,"Show Details")}t&&e.outputChannel.show()}function tl(n,e){n.subscriptions.push(be.commands.registerTextEditorCommand("evenBetterToml.copyAsJson",async t=>{const r=t?.document;if(!r||t.selection.isEmpty)return;const i=r.getText(t.selection);if(i.trim().length===0)return;const o=await e.sendRequest("taplo/convertToJson",{text:i}),s=Hn();if(o.error?.length??!1){s.appendLine(`Failed to convert TOML to JSON: ${o.error}`),await be.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}try{if(!o.text){s.appendLine("The response shouldn't be empty, but it is."),await be.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}await be.env.clipboard.writeText(o.text)}catch(c){s.appendLine(`Couldn't write to clipboard: ${c}`),await be.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}await be.window.showInformationMessage("JSON copied!")}),be.commands.registerTextEditorCommand("evenBetterToml.copyAsToml",async t=>{const r=t?.document;if(!r||t.selection.isEmpty)return;const i=r.getText(t.selection);if(i.trim().length===0)return;const o=await e.sendRequest("taplo/convertToToml",{text:i}),s=Hn();if(o.error?.length??!1){s.appendLine(`Failed to convert JSON to TOML: ${o.error}`),await be.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}try{if(!o.text){s.appendLine("The response shouldn't be empty, but it is."),await be.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}await be.env.clipboard.writeText(o.text)}catch(c){s.appendLine(`Couldn't write to clipboard: ${c}`),await be.window.showErrorMessage("Copying has failed!","Show Details")&&s.show();return}await be.window.showInformationMessage("TOML copied!")}),be.commands.registerTextEditorCommand("evenBetterToml.pasteAsJson",async t=>{const r=Hn();let i;try{i=await be.env.clipboard.readText()}catch(s){r.appendLine(`Failed to read from clipboard:${s}`),await be.window.showErrorMessage("Paste from clipboard has failed!","Show Details")&&r.show();return}const o=await e.sendRequest("taplo/convertToJson",{text:i});if(o.error?.length??!1){r.appendLine(`Failed to convert to JSON: ${o.error}`),await be.window.showErrorMessage("Pasting JSON has failed!","Show Details")&&r.show();return}t.edit(s=>{s.replace(t.selection,o.text)})}),be.commands.registerTextEditorCommand("evenBetterToml.pasteAsToml",async t=>{const r=Hn();let i;try{i=await be.env.clipboard.readText()}catch(s){r.appendLine(`Failed to read from clipboard:${s}`),await be.window.showErrorMessage("Paste from clipboard has failed!","Show Details")&&r.show();return}const o=await e.sendRequest("taplo/convertToToml",{text:i});if(o.error?.length??!1){r.appendLine(`Failed to convert to TOML: ${o.error}`),await be.window.showErrorMessage("Paste from clipboard has failed!","Show Details")&&r.show();return}t.edit(s=>{s.replace(t.selection,o.text)})}))}function nl(n,e){n.subscriptions.push(be.commands.registerTextEditorCommand("evenBetterToml.selectSchema",async t=>{if(!t)return;const r=await e.sendRequest("taplo/listSchemas",{documentUri:t.document.uri.toString()}),i=await e.sendRequest("taplo/associatedSchema",{documentUri:t.document.uri.toString()}),o=await be.window.showQuickPick(r.schemas.map(s=>({label:s.meta?.name??s.url,description:rl(s.meta),detail:il(s.url),picked:i.schema?.url===s.url,url:s.url,meta:s.meta})));o&&e.sendNotification("taplo/associateSchema",{documentUri:t.document.uri.toString(),schemaUri:o.url,rule:{url:t.document.uri.toString()},meta:o.meta})}))}function rl(n){if(typeof n?.description=="string")return n.description}function il(n,e){return`${n}`}function ol(n,e){tl(n,e),nl(n,e)}var js={},$e={};Object.defineProperty($e,"__esModule",{value:!0}),$e.asPromise=$e.thenable=$e.typedArray=$e.stringArray=$e.array=$e.func=$e.error=$e.number=$e.string=$e.boolean=void 0;function sl(n){return n===!0||n===!1}$e.boolean=sl;function xs(n){return typeof n=="string"||n instanceof String}$e.string=xs;function al(n){return typeof n=="number"||n instanceof Number}$e.number=al;function cl(n){return n instanceof Error}$e.error=cl;function Hs(n){return typeof n=="function"}$e.func=Hs;function Ws(n){return Array.isArray(n)}$e.array=Ws;function ul(n){return Ws(n)&&n.every(e=>xs(e))}$e.stringArray=ul;function ll(n,e){return Array.isArray(n)&&n.every(e)}$e.typedArray=ll;function Us(n){return n&&Hs(n.then)}$e.thenable=Us;function dl(n){return n instanceof Promise?n:Us(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}$e.asPromise=dl;var tt={},he={},Tn={},po={},jr={},ae={},Je={};Object.defineProperty(Je,"__esModule",{value:!0}),Je.stringArray=Je.array=Je.func=Je.error=Je.number=Je.string=Je.boolean=void 0;function fl(n){return n===!0||n===!1}Je.boolean=fl;function Ks(n){return typeof n=="string"||n instanceof String}Je.string=Ks;function hl(n){return typeof n=="number"||n instanceof Number}Je.number=hl;function gl(n){return n instanceof Error}Je.error=gl;function pl(n){return typeof n=="function"}Je.func=pl;function zs(n){return Array.isArray(n)}Je.array=zs;function ml(n){return zs(n)&&n.every(e=>Ks(e))}Je.stringArray=ml,Object.defineProperty(ae,"__esModule",{value:!0}),ae.Message=ae.NotificationType9=ae.NotificationType8=ae.NotificationType7=ae.NotificationType6=ae.NotificationType5=ae.NotificationType4=ae.NotificationType3=ae.NotificationType2=ae.NotificationType1=ae.NotificationType0=ae.NotificationType=ae.RequestType9=ae.RequestType8=ae.RequestType7=ae.RequestType6=ae.RequestType5=ae.RequestType4=ae.RequestType3=ae.RequestType2=ae.RequestType1=ae.RequestType=ae.RequestType0=ae.AbstractMessageSignature=ae.ParameterStructures=ae.ResponseError=ae.ErrorCodes=void 0;const Pn=Je;var mo;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(mo||(ae.ErrorCodes=mo={}));class Ns extends Error{constructor(e,t,r){super(t),this.code=Pn.number(e)?e:mo.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,Ns.prototype)}toJson(){const e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}}ae.ResponseError=Ns;class pt{constructor(e){this.kind=e}static is(e){return e===pt.auto||e===pt.byName||e===pt.byPosition}toString(){return this.kind}}ae.ParameterStructures=pt,pt.auto=new pt("auto"),pt.byPosition=new pt("byPosition"),pt.byName=new pt("byName");class We{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return pt.auto}}ae.AbstractMessageSignature=We;class yl extends We{constructor(e){super(e,0)}}ae.RequestType0=yl;class vl extends We{constructor(e,t=pt.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}ae.RequestType=vl;class Cl extends We{constructor(e,t=pt.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}ae.RequestType1=Cl;class _l extends We{constructor(e){super(e,2)}}ae.RequestType2=_l;class wl extends We{constructor(e){super(e,3)}}ae.RequestType3=wl;class bl extends We{constructor(e){super(e,4)}}ae.RequestType4=bl;class Dl extends We{constructor(e){super(e,5)}}ae.RequestType5=Dl;class Sl extends We{constructor(e){super(e,6)}}ae.RequestType6=Sl;class Rl extends We{constructor(e){super(e,7)}}ae.RequestType7=Rl;class Tl extends We{constructor(e){super(e,8)}}ae.RequestType8=Tl;class Pl extends We{constructor(e){super(e,9)}}ae.RequestType9=Pl;class El extends We{constructor(e,t=pt.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}ae.NotificationType=El;class kl extends We{constructor(e){super(e,0)}}ae.NotificationType0=kl;class Fl extends We{constructor(e,t=pt.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}ae.NotificationType1=Fl;class Il extends We{constructor(e){super(e,2)}}ae.NotificationType2=Il;class Ol extends We{constructor(e){super(e,3)}}ae.NotificationType3=Ol;class Nl extends We{constructor(e){super(e,4)}}ae.NotificationType4=Nl;class ql extends We{constructor(e){super(e,5)}}ae.NotificationType5=ql;class $l extends We{constructor(e){super(e,6)}}ae.NotificationType6=$l;class Ml extends We{constructor(e){super(e,7)}}ae.NotificationType7=Ml;class Ll extends We{constructor(e){super(e,8)}}ae.NotificationType8=Ll;class Al extends We{constructor(e){super(e,9)}}ae.NotificationType9=Al;var Gs;(function(n){function e(i){const o=i;return o&&Pn.string(o.method)&&(Pn.string(o.id)||Pn.number(o.id))}n.isRequest=e;function t(i){const o=i;return o&&Pn.string(o.method)&&i.id===void 0}n.isNotification=t;function r(i){const o=i;return o&&(o.result!==void 0||!!o.error)&&(Pn.string(o.id)||Pn.number(o.id)||o.id===null)}n.isResponse=r})(Gs||(ae.Message=Gs={}));var on={},Bs;Object.defineProperty(on,"__esModule",{value:!0}),on.LRUCache=on.LinkedMap=on.Touch=void 0;var dt;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(dt||(on.Touch=dt={}));class Vs{constructor(){this[Bs]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=dt.None){const r=this._map.get(e);if(r)return t!==dt.None&&this.touch(r,t),r.value}set(e,t,r=dt.None){let i=this._map.get(e);if(i)i.value=t,r!==dt.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case dt.None:this.addItemLast(i);break;case dt.First:this.addItemFirst(i);break;case dt.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const r=this._state;let i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(Bs=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==dt.First&&t!==dt.Last)){if(t===dt.First){if(e===this._head)return;const r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===dt.Last){if(e===this._tail)return;const r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(const[t,r]of e)this.set(t,r)}}on.LinkedMap=Vs;let jl=class extends Vs{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=dt.AsNew){return super.get(e,t)}peek(e){return super.get(e,dt.None)}set(e,t){return super.set(e,t,dt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};on.LRUCache=jl;var xr={};Object.defineProperty(xr,"__esModule",{value:!0}),xr.Disposable=void 0;var Xs;(function(n){function e(t){return{dispose:t}}n.create=e})(Xs||(xr.Disposable=Xs={}));var tn={},sn={};Object.defineProperty(sn,"__esModule",{value:!0});let yo;function vo(){if(yo===void 0)throw new Error("No runtime abstraction layer installed");return yo}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");yo=t}n.install=e})(vo||(vo={})),sn.default=vo,Object.defineProperty(tn,"__esModule",{value:!0}),tn.Emitter=tn.Event=void 0;const xl=sn;var Js;(function(n){const e={dispose(){}};n.None=function(){return e}})(Js||(tn.Event=Js={}));class Hl{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,s=r.length;o<s;o++)try{t.push(r[o].apply(i[o],e))}catch(c){(0,xl.default)().console.error(c)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class uo{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new Hl),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=uo._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}tn.Emitter=uo,uo._noop=function(){};var gn={};Object.defineProperty(gn,"__esModule",{value:!0}),gn.CancellationTokenSource=gn.CancellationToken=void 0;const Wl=sn,Ul=Je,Co=tn;var Hr;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Co.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Co.Event.None});function e(t){const r=t;return r&&(r===n.None||r===n.Cancelled||Ul.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(Hr||(gn.CancellationToken=Hr={}));const Kl=Object.freeze(function(n,e){const t=(0,Wl.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}});class Qs{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Kl:(this._emitter||(this._emitter=new Co.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class zl{get token(){return this._token||(this._token=new Qs),this._token}cancel(){this._token?this._token.cancel():this._token=Hr.Cancelled}dispose(){this._token?this._token instanceof Qs&&this._token.dispose():this._token=Hr.None}}gn.CancellationTokenSource=zl;var Wn={};Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.SharedArrayReceiverStrategy=Wn.SharedArraySenderStrategy=void 0;const Gl=gn;var hr;(function(n){n.Continue=0,n.Cancelled=1})(hr||(hr={}));class Bl{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;const t=new SharedArrayBuffer(4),r=new Int32Array(t,0,1);r[0]=hr.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){const r=this.buffers.get(t);if(r===void 0)return;const i=new Int32Array(r,0,1);Atomics.store(i,0,hr.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}}Wn.SharedArraySenderStrategy=Bl;class Vl{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===hr.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class Xl{constructor(e){this.token=new Vl(e)}cancel(){}dispose(){}}class Jl{constructor(){this.kind="request"}createCancellationTokenSource(e){const t=e.$cancellationData;return t===void 0?new Gl.CancellationTokenSource:new Xl(t)}}Wn.SharedArrayReceiverStrategy=Jl;var pn={},gr={};Object.defineProperty(gr,"__esModule",{value:!0}),gr.Semaphore=void 0;const Ql=sn;let Yl=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Ql.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};gr.Semaphore=Yl,Object.defineProperty(pn,"__esModule",{value:!0}),pn.ReadableStreamMessageReader=pn.AbstractMessageReader=pn.MessageReader=void 0;const _o=sn,Un=Je,wo=tn,Zl=gr;var Ys;(function(n){function e(t){let r=t;return r&&Un.func(r.listen)&&Un.func(r.dispose)&&Un.func(r.onError)&&Un.func(r.onClose)&&Un.func(r.onPartialMessage)}n.is=e})(Ys||(pn.MessageReader=Ys={}));class Zs{constructor(){this.errorEmitter=new wo.Emitter,this.closeEmitter=new wo.Emitter,this.partialMessageEmitter=new wo.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${Un.string(e.message)?e.message:"unknown"}`)}}pn.AbstractMessageReader=Zs;var bo;(function(n){function e(t){let r,i;const o=new Map;let s;const c=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(i=t.contentDecoder,o.set(i.name,i)),t.contentDecoders!==void 0)for(const u of t.contentDecoders)o.set(u.name,u);if(t.contentTypeDecoder!==void 0&&(s=t.contentTypeDecoder,c.set(s.name,s)),t.contentTypeDecoders!==void 0)for(const u of t.contentTypeDecoders)c.set(u.name,u)}return s===void 0&&(s=(0,_o.default)().applicationJson.decoder,c.set(s.name,s)),{charset:r,contentDecoder:i,contentDecoders:o,contentTypeDecoder:s,contentTypeDecoders:c}}n.fromOptions=e})(bo||(bo={}));class ed extends Zs{constructor(e,t){super(),this.readable=e,this.options=bo.fromOptions(t),this.buffer=(0,_o.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new Zl.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){const r=this.buffer.tryReadHeaders(!0);if(!r)return;const i=r.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}const o=parseInt(i);if(isNaN(o)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=o}const t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,_o.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}pn.ReadableStreamMessageReader=ed;var mn={};Object.defineProperty(mn,"__esModule",{value:!0}),mn.WriteableStreamMessageWriter=mn.AbstractMessageWriter=mn.MessageWriter=void 0;const ea=sn,pr=Je,td=gr,ta=tn,nd="Content-Length: ",na=`\r
`;var ra;(function(n){function e(t){let r=t;return r&&pr.func(r.dispose)&&pr.func(r.onClose)&&pr.func(r.onError)&&pr.func(r.write)}n.is=e})(ra||(mn.MessageWriter=ra={}));class ia{constructor(){this.errorEmitter=new ta.Emitter,this.closeEmitter=new ta.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${pr.string(e.message)?e.message:"unknown"}`)}}mn.AbstractMessageWriter=ia;var Do;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,ea.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,ea.default)().applicationJson.encoder}}n.fromOptions=e})(Do||(Do={}));class rd extends ia{constructor(e,t){super(),this.writable=e,this.options=Do.fromOptions(t),this.errorCount=0,this.writeSemaphore=new td.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{const i=[];return i.push(nd,r.byteLength.toString(),na),i.push(na),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}mn.WriteableStreamMessageWriter=rd;var Wr={};Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.AbstractMessageBuffer=void 0;const id=13,od=10,sd=`\r
`;class ad{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,r=0,i=0,o=0;e:for(;r<this._chunks.length;){const d=this._chunks[r];for(i=0;i<d.length;){switch(d[i]){case id:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case od:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}o+=d.byteLength,r++}if(t!==4)return;const s=this._read(o+i),c=new Map,u=this.toString(s,"ascii").split(sd);if(u.length<2)return c;for(let d=0;d<u.length-2;d++){const m=u[d],C=m.indexOf(":");if(C===-1)throw new Error(`Message header must separate key and value using ':'
${m}`);const _=m.substr(0,C),S=m.substr(C+1).trim();c.set(e?_.toLowerCase():_,S)}return c}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const o=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(o)}if(this._chunks[0].byteLength>e){const o=this._chunks[0],s=this.asNative(o,e);return this._chunks[0]=o.slice(e),this._totalLength-=e,s}const t=this.allocNative(e);let r=0,i=0;for(;e>0;){const o=this._chunks[i];if(o.byteLength>e){const s=o.slice(0,e);t.set(s,r),r+=e,this._chunks[i]=o.slice(e),this._totalLength-=e,e-=e}else t.set(o,r),r+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,e-=o.byteLength}return t}}Wr.AbstractMessageBuffer=ad;var oa={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.createMessageConnection=n.ConnectionOptions=n.MessageStrategy=n.CancellationStrategy=n.CancellationSenderStrategy=n.CancellationReceiverStrategy=n.RequestCancellationReceiverStrategy=n.IdCancellationReceiverStrategy=n.ConnectionStrategy=n.ConnectionError=n.ConnectionErrors=n.LogTraceNotification=n.SetTraceNotification=n.TraceFormat=n.TraceValues=n.Trace=n.NullLogger=n.ProgressType=n.ProgressToken=void 0;const e=sn,t=Je,r=ae,i=on,o=tn,s=gn;var c;(function(R){R.type=new r.NotificationType("$/cancelRequest")})(c||(c={}));var u;(function(R){function k(P){return typeof P=="string"||typeof P=="number"}R.is=k})(u||(n.ProgressToken=u={}));var d;(function(R){R.type=new r.NotificationType("$/progress")})(d||(d={}));class m{constructor(){}}n.ProgressType=m;var C;(function(R){function k(P){return t.func(P)}R.is=k})(C||(C={})),n.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var _;(function(R){R[R.Off=0]="Off",R[R.Messages=1]="Messages",R[R.Compact=2]="Compact",R[R.Verbose=3]="Verbose"})(_||(n.Trace=_={}));var S;(function(R){R.Off="off",R.Messages="messages",R.Compact="compact",R.Verbose="verbose"})(S||(n.TraceValues=S={})),function(R){function k(q){if(!t.string(q))return R.Off;switch(q=q.toLowerCase(),q){case"off":return R.Off;case"messages":return R.Messages;case"compact":return R.Compact;case"verbose":return R.Verbose;default:return R.Off}}R.fromString=k;function P(q){switch(q){case R.Off:return"off";case R.Messages:return"messages";case R.Compact:return"compact";case R.Verbose:return"verbose";default:return"off"}}R.toString=P}(_||(n.Trace=_={}));var y;(function(R){R.Text="text",R.JSON="json"})(y||(n.TraceFormat=y={})),function(R){function k(P){return t.string(P)?(P=P.toLowerCase(),P==="json"?R.JSON:R.Text):R.Text}R.fromString=k}(y||(n.TraceFormat=y={}));var O;(function(R){R.type=new r.NotificationType("$/setTrace")})(O||(n.SetTraceNotification=O={}));var M;(function(R){R.type=new r.NotificationType("$/logTrace")})(M||(n.LogTraceNotification=M={}));var V;(function(R){R[R.Closed=1]="Closed",R[R.Disposed=2]="Disposed",R[R.AlreadyListening=3]="AlreadyListening"})(V||(n.ConnectionErrors=V={}));class oe extends Error{constructor(k,P){super(P),this.code=k,Object.setPrototypeOf(this,oe.prototype)}}n.ConnectionError=oe;var te;(function(R){function k(P){const q=P;return q&&t.func(q.cancelUndispatched)}R.is=k})(te||(n.ConnectionStrategy=te={}));var Te;(function(R){function k(P){const q=P;return q&&(q.kind===void 0||q.kind==="id")&&t.func(q.createCancellationTokenSource)&&(q.dispose===void 0||t.func(q.dispose))}R.is=k})(Te||(n.IdCancellationReceiverStrategy=Te={}));var fe;(function(R){function k(P){const q=P;return q&&q.kind==="request"&&t.func(q.createCancellationTokenSource)&&(q.dispose===void 0||t.func(q.dispose))}R.is=k})(fe||(n.RequestCancellationReceiverStrategy=fe={}));var le;(function(R){R.Message=Object.freeze({createCancellationTokenSource(P){return new s.CancellationTokenSource}});function k(P){return Te.is(P)||fe.is(P)}R.is=k})(le||(n.CancellationReceiverStrategy=le={}));var x;(function(R){R.Message=Object.freeze({sendCancellation(P,q){return P.sendNotification(c.type,{id:q})},cleanup(P){}});function k(P){const q=P;return q&&t.func(q.sendCancellation)&&t.func(q.cleanup)}R.is=k})(x||(n.CancellationSenderStrategy=x={}));var N;(function(R){R.Message=Object.freeze({receiver:le.Message,sender:x.Message});function k(P){const q=P;return q&&le.is(q.receiver)&&x.is(q.sender)}R.is=k})(N||(n.CancellationStrategy=N={}));var A;(function(R){function k(P){const q=P;return q&&t.func(q.handleMessage)}R.is=k})(A||(n.MessageStrategy=A={}));var ee;(function(R){function k(P){const q=P;return q&&(N.is(q.cancellationStrategy)||te.is(q.connectionStrategy)||A.is(q.messageStrategy))}R.is=k})(ee||(n.ConnectionOptions=ee={}));var U;(function(R){R[R.New=1]="New",R[R.Listening=2]="Listening",R[R.Closed=3]="Closed",R[R.Disposed=4]="Disposed"})(U||(U={}));function W(R,k,P,q){const $=P!==void 0?P:n.NullLogger;let j=0,L=0,X=0;const Z="2.0";let J;const ne=new Map;let re;const G=new Map,ie=new Map;let se,Ye=new i.LinkedMap,Be=new Map,ot=new Set,Ze=new Map,ve=_.Off,Ve=y.Text,qe,et=U.New;const St=new o.Emitter,yt=new o.Emitter,vt=new o.Emitter,Xe=new o.Emitter,ut=new o.Emitter,Ae=q&&q.cancellationStrategy?q.cancellationStrategy:N.Message;function st(p){if(p===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+p.toString()}function Gt(p){return p===null?"res-unknown-"+(++X).toString():"res-"+p.toString()}function It(){return"not-"+(++L).toString()}function Rt(p,E){r.Message.isRequest(E)?p.set(st(E.id),E):r.Message.isResponse(E)?p.set(Gt(E.id),E):p.set(It(),E)}function Ot(p){}function Nt(){return et===U.Listening}function Ct(){return et===U.Closed}function at(){return et===U.Disposed}function Tt(){(et===U.New||et===U.Listening)&&(et=U.Closed,yt.fire(void 0))}function Bt(p){St.fire([p,void 0,void 0])}function ct(p){St.fire(p)}R.onClose(Tt),R.onError(Bt),k.onClose(Tt),k.onError(ct);function Pt(){se||Ye.size===0||(se=(0,e.default)().timer.setImmediate(()=>{se=void 0,$t()}))}function qt(p){r.Message.isRequest(p)?Mt(p):r.Message.isNotification(p)?At(p):r.Message.isResponse(p)?Lt(p):_t(p)}function $t(){if(Ye.size===0)return;const p=Ye.shift();try{const E=q?.messageStrategy;A.is(E)?E.handleMessage(p,qt):qt(p)}finally{Pt()}}const Vt=p=>{try{if(r.Message.isNotification(p)&&p.method===c.type.method){const E=p.params.id,H=st(E),B=Ye.get(H);if(r.Message.isRequest(B)){const ye=q?.connectionStrategy,Pe=ye&&ye.cancelUndispatched?ye.cancelUndispatched(B,Ot):void 0;if(Pe&&(Pe.error!==void 0||Pe.result!==void 0)){Ye.delete(H),Ze.delete(E),Pe.id=B.id,lt(Pe,p.method,Date.now()),k.write(Pe).catch(()=>$.error("Sending response for canceled message failed."));return}}const we=Ze.get(E);if(we!==void 0){we.cancel(),F(p);return}else ot.add(E)}Rt(Ye,p)}finally{Pt()}};function Mt(p){if(at())return;function E(w,I,K){const De={jsonrpc:Z,id:p.id};w instanceof r.ResponseError?De.error=w.toJson():De.result=w===void 0?null:w,lt(De,I,K),k.write(De).catch(()=>$.error("Sending response failed."))}function H(w,I,K){const De={jsonrpc:Z,id:p.id,error:w.toJson()};lt(De,I,K),k.write(De).catch(()=>$.error("Sending response failed."))}function B(w,I,K){w===void 0&&(w=null);const De={jsonrpc:Z,id:p.id,result:w};lt(De,I,K),k.write(De).catch(()=>$.error("Sending response failed."))}h(p);const we=ne.get(p.method);let ye,Pe;we&&(ye=we.type,Pe=we.handler);const a=Date.now();if(Pe||J){const w=p.id??String(Date.now()),I=Te.is(Ae.receiver)?Ae.receiver.createCancellationTokenSource(w):Ae.receiver.createCancellationTokenSource(p);p.id!==null&&ot.has(p.id)&&I.cancel(),p.id!==null&&Ze.set(w,I);try{let K;if(Pe)if(p.params===void 0){if(ye!==void 0&&ye.numberOfParams!==0){H(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${p.method} defines ${ye.numberOfParams} params but received none.`),p.method,a);return}K=Pe(I.token)}else if(Array.isArray(p.params)){if(ye!==void 0&&ye.parameterStructures===r.ParameterStructures.byName){H(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${p.method} defines parameters by name but received parameters by position`),p.method,a);return}K=Pe(...p.params,I.token)}else{if(ye!==void 0&&ye.parameterStructures===r.ParameterStructures.byPosition){H(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${p.method} defines parameters by position but received parameters by name`),p.method,a);return}K=Pe(p.params,I.token)}else J&&(K=J(p.method,p.params,I.token));const De=K;K?De.then?De.then(Oe=>{Ze.delete(w),E(Oe,p.method,a)},Oe=>{Ze.delete(w),Oe instanceof r.ResponseError?H(Oe,p.method,a):Oe&&t.string(Oe.message)?H(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${p.method} failed with message: ${Oe.message}`),p.method,a):H(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${p.method} failed unexpectedly without providing any details.`),p.method,a)}):(Ze.delete(w),E(K,p.method,a)):(Ze.delete(w),B(K,p.method,a))}catch(K){Ze.delete(w),K instanceof r.ResponseError?E(K,p.method,a):K&&t.string(K.message)?H(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${p.method} failed with message: ${K.message}`),p.method,a):H(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${p.method} failed unexpectedly without providing any details.`),p.method,a)}}else H(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${p.method}`),p.method,a)}function Lt(p){if(!at())if(p.id===null)p.error?$.error(`Received response message without id: Error is: 
${JSON.stringify(p.error,void 0,4)}`):$.error("Received response message without id. No further error information provided.");else{const E=p.id,H=Be.get(E);if(Y(p,H),H!==void 0){Be.delete(E);try{if(p.error){const B=p.error;H.reject(new r.ResponseError(B.code,B.message,B.data))}else if(p.result!==void 0)H.resolve(p.result);else throw new Error("Should never happen.")}catch(B){B.message?$.error(`Response handler '${H.method}' failed with message: ${B.message}`):$.error(`Response handler '${H.method}' failed unexpectedly.`)}}}}function At(p){if(at())return;let E,H;if(p.method===c.type.method){const B=p.params.id;ot.delete(B),F(p);return}else{const B=G.get(p.method);B&&(H=B.handler,E=B.type)}if(H||re)try{if(F(p),H)if(p.params===void 0)E!==void 0&&E.numberOfParams!==0&&E.parameterStructures!==r.ParameterStructures.byName&&$.error(`Notification ${p.method} defines ${E.numberOfParams} params but received none.`),H();else if(Array.isArray(p.params)){const B=p.params;p.method===d.type.method&&B.length===2&&u.is(B[0])?H({token:B[0],value:B[1]}):(E!==void 0&&(E.parameterStructures===r.ParameterStructures.byName&&$.error(`Notification ${p.method} defines parameters by name but received parameters by position`),E.numberOfParams!==p.params.length&&$.error(`Notification ${p.method} defines ${E.numberOfParams} params but received ${B.length} arguments`)),H(...B))}else E!==void 0&&E.parameterStructures===r.ParameterStructures.byPosition&&$.error(`Notification ${p.method} defines parameters by position but received parameters by name`),H(p.params);else re&&re(p.method,p.params)}catch(B){B.message?$.error(`Notification handler '${p.method}' failed with message: ${B.message}`):$.error(`Notification handler '${p.method}' failed unexpectedly.`)}else vt.fire(p)}function _t(p){if(!p){$.error("Received empty message.");return}$.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(p,null,4)}`);const E=p;if(t.string(E.id)||t.number(E.id)){const H=E.id,B=Be.get(H);B&&B.reject(new Error("The received response has neither a result nor an error property."))}}function rt(p){if(p!=null)switch(ve){case _.Verbose:return JSON.stringify(p,null,4);case _.Compact:return JSON.stringify(p);default:return}}function jt(p){if(!(ve===_.Off||!qe))if(Ve===y.Text){let E;(ve===_.Verbose||ve===_.Compact)&&p.params&&(E=`Params: ${rt(p.params)}

`),qe.log(`Sending request '${p.method} - (${p.id})'.`,E)}else pe("send-request",p)}function Xt(p){if(!(ve===_.Off||!qe))if(Ve===y.Text){let E;(ve===_.Verbose||ve===_.Compact)&&(p.params?E=`Params: ${rt(p.params)}

`:E=`No parameters provided.

`),qe.log(`Sending notification '${p.method}'.`,E)}else pe("send-notification",p)}function lt(p,E,H){if(!(ve===_.Off||!qe))if(Ve===y.Text){let B;(ve===_.Verbose||ve===_.Compact)&&(p.error&&p.error.data?B=`Error data: ${rt(p.error.data)}

`:p.result?B=`Result: ${rt(p.result)}

`:p.error===void 0&&(B=`No result returned.

`)),qe.log(`Sending response '${E} - (${p.id})'. Processing request took ${Date.now()-H}ms`,B)}else pe("send-response",p)}function h(p){if(!(ve===_.Off||!qe))if(Ve===y.Text){let E;(ve===_.Verbose||ve===_.Compact)&&p.params&&(E=`Params: ${rt(p.params)}

`),qe.log(`Received request '${p.method} - (${p.id})'.`,E)}else pe("receive-request",p)}function F(p){if(!(ve===_.Off||!qe||p.method===M.type.method))if(Ve===y.Text){let E;(ve===_.Verbose||ve===_.Compact)&&(p.params?E=`Params: ${rt(p.params)}

`:E=`No parameters provided.

`),qe.log(`Received notification '${p.method}'.`,E)}else pe("receive-notification",p)}function Y(p,E){if(!(ve===_.Off||!qe))if(Ve===y.Text){let H;if((ve===_.Verbose||ve===_.Compact)&&(p.error&&p.error.data?H=`Error data: ${rt(p.error.data)}

`:p.result?H=`Result: ${rt(p.result)}

`:p.error===void 0&&(H=`No result returned.

`)),E){const B=p.error?` Request failed: ${p.error.message} (${p.error.code}).`:"";qe.log(`Received response '${E.method} - (${p.id})' in ${Date.now()-E.timerStart}ms.${B}`,H)}else qe.log(`Received response ${p.id} without active response promise.`,H)}else pe("receive-response",p)}function pe(p,E){if(!qe||ve===_.Off)return;const H={isLSPMessage:!0,type:p,message:E,timestamp:Date.now()};qe.log(H)}function Ce(){if(Ct())throw new oe(V.Closed,"Connection is closed.");if(at())throw new oe(V.Disposed,"Connection is disposed.")}function He(){if(Nt())throw new oe(V.AlreadyListening,"Connection is already listening")}function T(){if(!Nt())throw new Error("Call listen() first.")}function g(p){return p===void 0?null:p}function b(p){if(p!==null)return p}function l(p){return p!=null&&!Array.isArray(p)&&typeof p=="object"}function v(p,E){switch(p){case r.ParameterStructures.auto:return l(E)?b(E):[g(E)];case r.ParameterStructures.byName:if(!l(E))throw new Error("Received parameters by name but param is not an object literal.");return b(E);case r.ParameterStructures.byPosition:return[g(E)];default:throw new Error(`Unknown parameter structure ${p.toString()}`)}}function f(p,E){let H;const B=p.numberOfParams;switch(B){case 0:H=void 0;break;case 1:H=v(p.parameterStructures,E[0]);break;default:H=[];for(let we=0;we<E.length&&we<B;we++)H.push(g(E[we]));if(E.length<B)for(let we=E.length;we<B;we++)H.push(null);break}return H}const D={sendNotification:(p,...E)=>{Ce();let H,B;if(t.string(p)){H=p;const ye=E[0];let Pe=0,a=r.ParameterStructures.auto;r.ParameterStructures.is(ye)&&(Pe=1,a=ye);let w=E.length;const I=w-Pe;switch(I){case 0:B=void 0;break;case 1:B=v(a,E[Pe]);break;default:if(a===r.ParameterStructures.byName)throw new Error(`Received ${I} parameters for 'by Name' notification parameter structure.`);B=E.slice(Pe,w).map(K=>g(K));break}}else{const ye=E;H=p.method,B=f(p,ye)}const we={jsonrpc:Z,method:H,params:B};return Xt(we),k.write(we).catch(ye=>{throw $.error("Sending notification failed."),ye})},onNotification:(p,E)=>{Ce();let H;return t.func(p)?re=p:E&&(t.string(p)?(H=p,G.set(p,{type:void 0,handler:E})):(H=p.method,G.set(p.method,{type:p,handler:E}))),{dispose:()=>{H!==void 0?G.delete(H):re=void 0}}},onProgress:(p,E,H)=>{if(ie.has(E))throw new Error(`Progress handler for token ${E} already registered`);return ie.set(E,H),{dispose:()=>{ie.delete(E)}}},sendProgress:(p,E,H)=>D.sendNotification(d.type,{token:E,value:H}),onUnhandledProgress:Xe.event,sendRequest:(p,...E)=>{Ce(),T();let H,B,we;if(t.string(p)){H=p;const w=E[0],I=E[E.length-1];let K=0,De=r.ParameterStructures.auto;r.ParameterStructures.is(w)&&(K=1,De=w);let Oe=E.length;s.CancellationToken.is(I)&&(Oe=Oe-1,we=I);const _e=Oe-K;switch(_e){case 0:B=void 0;break;case 1:B=v(De,E[K]);break;default:if(De===r.ParameterStructures.byName)throw new Error(`Received ${_e} parameters for 'by Name' request parameter structure.`);B=E.slice(K,Oe).map(xt=>g(xt));break}}else{const w=E;H=p.method,B=f(p,w);const I=p.numberOfParams;we=s.CancellationToken.is(w[I])?w[I]:void 0}const ye=j++;let Pe;we&&(Pe=we.onCancellationRequested(()=>{const w=Ae.sender.sendCancellation(D,ye);return w===void 0?($.log(`Received no promise from cancellation strategy when cancelling id ${ye}`),Promise.resolve()):w.catch(()=>{$.log(`Sending cancellation messages for id ${ye} failed`)})}));const a={jsonrpc:Z,id:ye,method:H,params:B};return jt(a),typeof Ae.sender.enableCancellation=="function"&&Ae.sender.enableCancellation(a),new Promise(async(w,I)=>{const K=_e=>{w(_e),Ae.sender.cleanup(ye),Pe?.dispose()},De=_e=>{I(_e),Ae.sender.cleanup(ye),Pe?.dispose()},Oe={method:H,timerStart:Date.now(),resolve:K,reject:De};try{await k.write(a),Be.set(ye,Oe)}catch(_e){throw $.error("Sending request failed."),Oe.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,_e.message?_e.message:"Unknown reason")),_e}})},onRequest:(p,E)=>{Ce();let H=null;return C.is(p)?(H=void 0,J=p):t.string(p)?(H=null,E!==void 0&&(H=p,ne.set(p,{handler:E,type:void 0}))):E!==void 0&&(H=p.method,ne.set(p.method,{type:p,handler:E})),{dispose:()=>{H!==null&&(H!==void 0?ne.delete(H):J=void 0)}}},hasPendingResponse:()=>Be.size>0,trace:async(p,E,H)=>{let B=!1,we=y.Text;H!==void 0&&(t.boolean(H)?B=H:(B=H.sendNotification||!1,we=H.traceFormat||y.Text)),ve=p,Ve=we,ve===_.Off?qe=void 0:qe=E,B&&!Ct()&&!at()&&await D.sendNotification(O.type,{value:_.toString(p)})},onError:St.event,onClose:yt.event,onUnhandledNotification:vt.event,onDispose:ut.event,end:()=>{k.end()},dispose:()=>{if(at())return;et=U.Disposed,ut.fire(void 0);const p=new r.ResponseError(r.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const E of Be.values())E.reject(p);Be=new Map,Ze=new Map,ot=new Set,Ye=new i.LinkedMap,t.func(k.dispose)&&k.dispose(),t.func(R.dispose)&&R.dispose()},listen:()=>{Ce(),He(),et=U.Listening,R.listen(Vt)},inspect:()=>{(0,e.default)().console.log("inspect")}};return D.onNotification(M.type,p=>{if(ve===_.Off||!qe)return;const E=ve===_.Verbose||ve===_.Compact;qe.log(p.message,E?p.verbose:void 0)}),D.onNotification(d.type,p=>{const E=ie.get(p.token);E?E(p.value):Xe.fire(p)}),D}n.createMessageConnection=W})(oa),function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ProgressType=n.ProgressToken=n.createMessageConnection=n.NullLogger=n.ConnectionOptions=n.ConnectionStrategy=n.AbstractMessageBuffer=n.WriteableStreamMessageWriter=n.AbstractMessageWriter=n.MessageWriter=n.ReadableStreamMessageReader=n.AbstractMessageReader=n.MessageReader=n.SharedArrayReceiverStrategy=n.SharedArraySenderStrategy=n.CancellationToken=n.CancellationTokenSource=n.Emitter=n.Event=n.Disposable=n.LRUCache=n.Touch=n.LinkedMap=n.ParameterStructures=n.NotificationType9=n.NotificationType8=n.NotificationType7=n.NotificationType6=n.NotificationType5=n.NotificationType4=n.NotificationType3=n.NotificationType2=n.NotificationType1=n.NotificationType0=n.NotificationType=n.ErrorCodes=n.ResponseError=n.RequestType9=n.RequestType8=n.RequestType7=n.RequestType6=n.RequestType5=n.RequestType4=n.RequestType3=n.RequestType2=n.RequestType1=n.RequestType0=n.RequestType=n.Message=n.RAL=void 0,n.MessageStrategy=n.CancellationStrategy=n.CancellationSenderStrategy=n.CancellationReceiverStrategy=n.ConnectionError=n.ConnectionErrors=n.LogTraceNotification=n.SetTraceNotification=n.TraceFormat=n.TraceValues=n.Trace=void 0;const e=ae;Object.defineProperty(n,"Message",{enumerable:!0,get:function(){return e.Message}}),Object.defineProperty(n,"RequestType",{enumerable:!0,get:function(){return e.RequestType}}),Object.defineProperty(n,"RequestType0",{enumerable:!0,get:function(){return e.RequestType0}}),Object.defineProperty(n,"RequestType1",{enumerable:!0,get:function(){return e.RequestType1}}),Object.defineProperty(n,"RequestType2",{enumerable:!0,get:function(){return e.RequestType2}}),Object.defineProperty(n,"RequestType3",{enumerable:!0,get:function(){return e.RequestType3}}),Object.defineProperty(n,"RequestType4",{enumerable:!0,get:function(){return e.RequestType4}}),Object.defineProperty(n,"RequestType5",{enumerable:!0,get:function(){return e.RequestType5}}),Object.defineProperty(n,"RequestType6",{enumerable:!0,get:function(){return e.RequestType6}}),Object.defineProperty(n,"RequestType7",{enumerable:!0,get:function(){return e.RequestType7}}),Object.defineProperty(n,"RequestType8",{enumerable:!0,get:function(){return e.RequestType8}}),Object.defineProperty(n,"RequestType9",{enumerable:!0,get:function(){return e.RequestType9}}),Object.defineProperty(n,"ResponseError",{enumerable:!0,get:function(){return e.ResponseError}}),Object.defineProperty(n,"ErrorCodes",{enumerable:!0,get:function(){return e.ErrorCodes}}),Object.defineProperty(n,"NotificationType",{enumerable:!0,get:function(){return e.NotificationType}}),Object.defineProperty(n,"NotificationType0",{enumerable:!0,get:function(){return e.NotificationType0}}),Object.defineProperty(n,"NotificationType1",{enumerable:!0,get:function(){return e.NotificationType1}}),Object.defineProperty(n,"NotificationType2",{enumerable:!0,get:function(){return e.NotificationType2}}),Object.defineProperty(n,"NotificationType3",{enumerable:!0,get:function(){return e.NotificationType3}}),Object.defineProperty(n,"NotificationType4",{enumerable:!0,get:function(){return e.NotificationType4}}),Object.defineProperty(n,"NotificationType5",{enumerable:!0,get:function(){return e.NotificationType5}}),Object.defineProperty(n,"NotificationType6",{enumerable:!0,get:function(){return e.NotificationType6}}),Object.defineProperty(n,"NotificationType7",{enumerable:!0,get:function(){return e.NotificationType7}}),Object.defineProperty(n,"NotificationType8",{enumerable:!0,get:function(){return e.NotificationType8}}),Object.defineProperty(n,"NotificationType9",{enumerable:!0,get:function(){return e.NotificationType9}}),Object.defineProperty(n,"ParameterStructures",{enumerable:!0,get:function(){return e.ParameterStructures}});const t=on;Object.defineProperty(n,"LinkedMap",{enumerable:!0,get:function(){return t.LinkedMap}}),Object.defineProperty(n,"LRUCache",{enumerable:!0,get:function(){return t.LRUCache}}),Object.defineProperty(n,"Touch",{enumerable:!0,get:function(){return t.Touch}});const r=xr;Object.defineProperty(n,"Disposable",{enumerable:!0,get:function(){return r.Disposable}});const i=tn;Object.defineProperty(n,"Event",{enumerable:!0,get:function(){return i.Event}}),Object.defineProperty(n,"Emitter",{enumerable:!0,get:function(){return i.Emitter}});const o=gn;Object.defineProperty(n,"CancellationTokenSource",{enumerable:!0,get:function(){return o.CancellationTokenSource}}),Object.defineProperty(n,"CancellationToken",{enumerable:!0,get:function(){return o.CancellationToken}});const s=Wn;Object.defineProperty(n,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return s.SharedArraySenderStrategy}}),Object.defineProperty(n,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return s.SharedArrayReceiverStrategy}});const c=pn;Object.defineProperty(n,"MessageReader",{enumerable:!0,get:function(){return c.MessageReader}}),Object.defineProperty(n,"AbstractMessageReader",{enumerable:!0,get:function(){return c.AbstractMessageReader}}),Object.defineProperty(n,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return c.ReadableStreamMessageReader}});const u=mn;Object.defineProperty(n,"MessageWriter",{enumerable:!0,get:function(){return u.MessageWriter}}),Object.defineProperty(n,"AbstractMessageWriter",{enumerable:!0,get:function(){return u.AbstractMessageWriter}}),Object.defineProperty(n,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return u.WriteableStreamMessageWriter}});const d=Wr;Object.defineProperty(n,"AbstractMessageBuffer",{enumerable:!0,get:function(){return d.AbstractMessageBuffer}});const m=oa;Object.defineProperty(n,"ConnectionStrategy",{enumerable:!0,get:function(){return m.ConnectionStrategy}}),Object.defineProperty(n,"ConnectionOptions",{enumerable:!0,get:function(){return m.ConnectionOptions}}),Object.defineProperty(n,"NullLogger",{enumerable:!0,get:function(){return m.NullLogger}}),Object.defineProperty(n,"createMessageConnection",{enumerable:!0,get:function(){return m.createMessageConnection}}),Object.defineProperty(n,"ProgressToken",{enumerable:!0,get:function(){return m.ProgressToken}}),Object.defineProperty(n,"ProgressType",{enumerable:!0,get:function(){return m.ProgressType}}),Object.defineProperty(n,"Trace",{enumerable:!0,get:function(){return m.Trace}}),Object.defineProperty(n,"TraceValues",{enumerable:!0,get:function(){return m.TraceValues}}),Object.defineProperty(n,"TraceFormat",{enumerable:!0,get:function(){return m.TraceFormat}}),Object.defineProperty(n,"SetTraceNotification",{enumerable:!0,get:function(){return m.SetTraceNotification}}),Object.defineProperty(n,"LogTraceNotification",{enumerable:!0,get:function(){return m.LogTraceNotification}}),Object.defineProperty(n,"ConnectionErrors",{enumerable:!0,get:function(){return m.ConnectionErrors}}),Object.defineProperty(n,"ConnectionError",{enumerable:!0,get:function(){return m.ConnectionError}}),Object.defineProperty(n,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return m.CancellationReceiverStrategy}}),Object.defineProperty(n,"CancellationSenderStrategy",{enumerable:!0,get:function(){return m.CancellationSenderStrategy}}),Object.defineProperty(n,"CancellationStrategy",{enumerable:!0,get:function(){return m.CancellationStrategy}}),Object.defineProperty(n,"MessageStrategy",{enumerable:!0,get:function(){return m.MessageStrategy}});const C=sn;n.RAL=C.default}(jr),Object.defineProperty(po,"__esModule",{value:!0});const sa=Xu,an=jr;class lo extends an.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return lo.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new sa.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}}lo.emptyBuffer=Buffer.allocUnsafe(0);class cd{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),an.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),an.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),an.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),an.Disposable.create(()=>this.stream.off("data",e))}}class ud{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),an.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),an.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),an.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((r,i)=>{const o=s=>{s==null?r():i(s)};typeof e=="string"?this.stream.write(e,t,o):this.stream.write(e,o)})}end(){this.stream.end()}}const aa=Object.freeze({messageBuffer:Object.freeze({create:n=>new lo(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(n,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{try{return n instanceof Buffer?Promise.resolve(JSON.parse(n.toString(e.charset))):Promise.resolve(JSON.parse(new sa.TextDecoder(e.charset).decode(n)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:n=>new cd(n),asWritableStream:n=>new ud(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){const r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){const t=setImmediate(n,...e);return{dispose:()=>clearImmediate(t)}},setInterval(n,e,...t){const r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function So(){return aa}(function(n){function e(){an.RAL.install(aa)}n.install=e})(So||(So={})),po.default=So,function(n){var e=Me.commonjsGlobal&&Me.commonjsGlobal.__createBinding||(Object.create?function(U,W,R,k){k===void 0&&(k=R);var P=Object.getOwnPropertyDescriptor(W,R);(!P||("get"in P?!W.__esModule:P.writable||P.configurable))&&(P={enumerable:!0,get:function(){return W[R]}}),Object.defineProperty(U,k,P)}:function(U,W,R,k){k===void 0&&(k=R),U[k]=W[R]}),t=Me.commonjsGlobal&&Me.commonjsGlobal.__exportStar||function(U,W){for(var R in U)R!=="default"&&!Object.prototype.hasOwnProperty.call(W,R)&&e(W,U,R)};Object.defineProperty(n,"__esModule",{value:!0}),n.createMessageConnection=n.createServerSocketTransport=n.createClientSocketTransport=n.createServerPipeTransport=n.createClientPipeTransport=n.generateRandomPipeName=n.StreamMessageWriter=n.StreamMessageReader=n.SocketMessageWriter=n.SocketMessageReader=n.PortMessageWriter=n.PortMessageReader=n.IPCMessageWriter=n.IPCMessageReader=void 0;const r=po;r.default.install();const i=Ar,o=Ju,s=Qu,c=Yu,u=jr;t(jr,n);class d extends u.AbstractMessageReader{constructor(W){super(),this.process=W;let R=this.process;R.on("error",k=>this.fireError(k)),R.on("close",()=>this.fireClose())}listen(W){return this.process.on("message",W),u.Disposable.create(()=>this.process.off("message",W))}}n.IPCMessageReader=d;class m extends u.AbstractMessageWriter{constructor(W){super(),this.process=W,this.errorCount=0;const R=this.process;R.on("error",k=>this.fireError(k)),R.on("close",()=>this.fireClose)}write(W){try{return typeof this.process.send=="function"&&this.process.send(W,void 0,void 0,R=>{R?(this.errorCount++,this.handleError(R,W)):this.errorCount=0}),Promise.resolve()}catch(R){return this.handleError(R,W),Promise.reject(R)}}handleError(W,R){this.errorCount++,this.fireError(W,R,this.errorCount)}end(){}}n.IPCMessageWriter=m;class C extends u.AbstractMessageReader{constructor(W){super(),this.onData=new u.Emitter,W.on("close",()=>this.fireClose),W.on("error",R=>this.fireError(R)),W.on("message",R=>{this.onData.fire(R)})}listen(W){return this.onData.event(W)}}n.PortMessageReader=C;class _ extends u.AbstractMessageWriter{constructor(W){super(),this.port=W,this.errorCount=0,W.on("close",()=>this.fireClose()),W.on("error",R=>this.fireError(R))}write(W){try{return this.port.postMessage(W),Promise.resolve()}catch(R){return this.handleError(R,W),Promise.reject(R)}}handleError(W,R){this.errorCount++,this.fireError(W,R,this.errorCount)}end(){}}n.PortMessageWriter=_;class S extends u.ReadableStreamMessageReader{constructor(W,R="utf-8"){super((0,r.default)().stream.asReadableStream(W),R)}}n.SocketMessageReader=S;class y extends u.WriteableStreamMessageWriter{constructor(W,R){super((0,r.default)().stream.asWritableStream(W),R),this.socket=W}dispose(){super.dispose(),this.socket.destroy()}}n.SocketMessageWriter=y;class O extends u.ReadableStreamMessageReader{constructor(W,R){super((0,r.default)().stream.asReadableStream(W),R)}}n.StreamMessageReader=O;class M extends u.WriteableStreamMessageWriter{constructor(W,R){super((0,r.default)().stream.asWritableStream(W),R)}}n.StreamMessageWriter=M;const V=process.env.XDG_RUNTIME_DIR,oe=new Map([["linux",107],["darwin",103]]);function te(){const U=(0,s.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${U}-sock`;let W;V?W=i.join(V,`vscode-ipc-${U}.sock`):W=i.join(o.tmpdir(),`vscode-${U}.sock`);const R=oe.get(process.platform);return R!==void 0&&W.length>R&&(0,r.default)().console.warn(`WARNING: IPC handle "${W}" is longer than ${R} characters.`),W}n.generateRandomPipeName=te;function Te(U,W="utf-8"){let R;const k=new Promise((P,q)=>{R=P});return new Promise((P,q)=>{let $=(0,c.createServer)(j=>{$.close(),R([new S(j,W),new y(j,W)])});$.on("error",q),$.listen(U,()=>{$.removeListener("error",q),P({onConnected:()=>k})})})}n.createClientPipeTransport=Te;function fe(U,W="utf-8"){const R=(0,c.createConnection)(U);return[new S(R,W),new y(R,W)]}n.createServerPipeTransport=fe;function le(U,W="utf-8"){let R;const k=new Promise((P,q)=>{R=P});return new Promise((P,q)=>{const $=(0,c.createServer)(j=>{$.close(),R([new S(j,W),new y(j,W)])});$.on("error",q),$.listen(U,"127.0.0.1",()=>{$.removeListener("error",q),P({onConnected:()=>k})})})}n.createClientSocketTransport=le;function x(U,W="utf-8"){const R=(0,c.createConnection)(U,"127.0.0.1");return[new S(R,W),new y(R,W)]}n.createServerSocketTransport=x;function N(U){const W=U;return W.read!==void 0&&W.addListener!==void 0}function A(U){const W=U;return W.write!==void 0&&W.addListener!==void 0}function ee(U,W,R,k){R||(R=u.NullLogger);const P=N(U)?new O(U):U,q=A(W)?new M(W):W;return u.ConnectionStrategy.is(k)&&(k={connectionStrategy:k}),(0,u.createMessageConnection)(P,q,R,k)}n.createMessageConnection=ee}(Tn);var ca=Tn,ua={},Ro={exports:{}};(function(n,e){(function(t){{var r=t(Me.commonjsRequire,e);r!==void 0&&(n.exports=r)}})(function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TextDocument=r.EOL=r.WorkspaceFolder=r.InlineCompletionContext=r.SelectedCompletionInfo=r.InlineCompletionTriggerKind=r.InlineCompletionList=r.InlineCompletionItem=r.StringValue=r.InlayHint=r.InlayHintLabelPart=r.InlayHintKind=r.InlineValueContext=r.InlineValueEvaluatableExpression=r.InlineValueVariableLookup=r.InlineValueText=r.SemanticTokens=r.SemanticTokenModifiers=r.SemanticTokenTypes=r.SelectionRange=r.DocumentLink=r.FormattingOptions=r.CodeLens=r.CodeAction=r.CodeActionContext=r.CodeActionTriggerKind=r.CodeActionKind=r.DocumentSymbol=r.WorkspaceSymbol=r.SymbolInformation=r.SymbolTag=r.SymbolKind=r.DocumentHighlight=r.DocumentHighlightKind=r.SignatureInformation=r.ParameterInformation=r.Hover=r.MarkedString=r.CompletionList=r.CompletionItem=r.CompletionItemLabelDetails=r.InsertTextMode=r.InsertReplaceEdit=r.CompletionItemTag=r.InsertTextFormat=r.CompletionItemKind=r.MarkupContent=r.MarkupKind=r.TextDocumentItem=r.OptionalVersionedTextDocumentIdentifier=r.VersionedTextDocumentIdentifier=r.TextDocumentIdentifier=r.WorkspaceChange=r.WorkspaceEdit=r.DeleteFile=r.RenameFile=r.CreateFile=r.TextDocumentEdit=r.AnnotatedTextEdit=r.ChangeAnnotationIdentifier=r.ChangeAnnotation=r.TextEdit=r.Command=r.Diagnostic=r.CodeDescription=r.DiagnosticTag=r.DiagnosticSeverity=r.DiagnosticRelatedInformation=r.FoldingRange=r.FoldingRangeKind=r.ColorPresentation=r.ColorInformation=r.Color=r.LocationLink=r.Location=r.Range=r.Position=r.uinteger=r.integer=r.URI=r.DocumentUri=void 0;var i;(function(g){function b(l){return typeof l=="string"}g.is=b})(i||(r.DocumentUri=i={}));var o;(function(g){function b(l){return typeof l=="string"}g.is=b})(o||(r.URI=o={}));var s;(function(g){g.MIN_VALUE=-2147483648,g.MAX_VALUE=2147483647;function b(l){return typeof l=="number"&&g.MIN_VALUE<=l&&l<=g.MAX_VALUE}g.is=b})(s||(r.integer=s={}));var c;(function(g){g.MIN_VALUE=0,g.MAX_VALUE=2147483647;function b(l){return typeof l=="number"&&g.MIN_VALUE<=l&&l<=g.MAX_VALUE}g.is=b})(c||(r.uinteger=c={}));var u;(function(g){function b(v,f){return v===Number.MAX_VALUE&&(v=c.MAX_VALUE),f===Number.MAX_VALUE&&(f=c.MAX_VALUE),{line:v,character:f}}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&T.uinteger(f.line)&&T.uinteger(f.character)}g.is=l})(u||(r.Position=u={}));var d;(function(g){function b(v,f,D,p){if(T.uinteger(v)&&T.uinteger(f)&&T.uinteger(D)&&T.uinteger(p))return{start:u.create(v,f),end:u.create(D,p)};if(u.is(v)&&u.is(f))return{start:v,end:f};throw new Error("Range#create called with invalid arguments[".concat(v,", ").concat(f,", ").concat(D,", ").concat(p,"]"))}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&u.is(f.start)&&u.is(f.end)}g.is=l})(d||(r.Range=d={}));var m;(function(g){function b(v,f){return{uri:v,range:f}}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&d.is(f.range)&&(T.string(f.uri)||T.undefined(f.uri))}g.is=l})(m||(r.Location=m={}));var C;(function(g){function b(v,f,D,p){return{targetUri:v,targetRange:f,targetSelectionRange:D,originSelectionRange:p}}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&d.is(f.targetRange)&&T.string(f.targetUri)&&d.is(f.targetSelectionRange)&&(d.is(f.originSelectionRange)||T.undefined(f.originSelectionRange))}g.is=l})(C||(r.LocationLink=C={}));var _;(function(g){function b(v,f,D,p){return{red:v,green:f,blue:D,alpha:p}}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&T.numberRange(f.red,0,1)&&T.numberRange(f.green,0,1)&&T.numberRange(f.blue,0,1)&&T.numberRange(f.alpha,0,1)}g.is=l})(_||(r.Color=_={}));var S;(function(g){function b(v,f){return{range:v,color:f}}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&d.is(f.range)&&_.is(f.color)}g.is=l})(S||(r.ColorInformation=S={}));var y;(function(g){function b(v,f,D){return{label:v,textEdit:f,additionalTextEdits:D}}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&T.string(f.label)&&(T.undefined(f.textEdit)||x.is(f))&&(T.undefined(f.additionalTextEdits)||T.typedArray(f.additionalTextEdits,x.is))}g.is=l})(y||(r.ColorPresentation=y={}));var O;(function(g){g.Comment="comment",g.Imports="imports",g.Region="region"})(O||(r.FoldingRangeKind=O={}));var M;(function(g){function b(v,f,D,p,E,H){var B={startLine:v,endLine:f};return T.defined(D)&&(B.startCharacter=D),T.defined(p)&&(B.endCharacter=p),T.defined(E)&&(B.kind=E),T.defined(H)&&(B.collapsedText=H),B}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&T.uinteger(f.startLine)&&T.uinteger(f.startLine)&&(T.undefined(f.startCharacter)||T.uinteger(f.startCharacter))&&(T.undefined(f.endCharacter)||T.uinteger(f.endCharacter))&&(T.undefined(f.kind)||T.string(f.kind))}g.is=l})(M||(r.FoldingRange=M={}));var V;(function(g){function b(v,f){return{location:v,message:f}}g.create=b;function l(v){var f=v;return T.defined(f)&&m.is(f.location)&&T.string(f.message)}g.is=l})(V||(r.DiagnosticRelatedInformation=V={}));var oe;(function(g){g.Error=1,g.Warning=2,g.Information=3,g.Hint=4})(oe||(r.DiagnosticSeverity=oe={}));var te;(function(g){g.Unnecessary=1,g.Deprecated=2})(te||(r.DiagnosticTag=te={}));var Te;(function(g){function b(l){var v=l;return T.objectLiteral(v)&&T.string(v.href)}g.is=b})(Te||(r.CodeDescription=Te={}));var fe;(function(g){function b(v,f,D,p,E,H){var B={range:v,message:f};return T.defined(D)&&(B.severity=D),T.defined(p)&&(B.code=p),T.defined(E)&&(B.source=E),T.defined(H)&&(B.relatedInformation=H),B}g.create=b;function l(v){var f,D=v;return T.defined(D)&&d.is(D.range)&&T.string(D.message)&&(T.number(D.severity)||T.undefined(D.severity))&&(T.integer(D.code)||T.string(D.code)||T.undefined(D.code))&&(T.undefined(D.codeDescription)||T.string((f=D.codeDescription)===null||f===void 0?void 0:f.href))&&(T.string(D.source)||T.undefined(D.source))&&(T.undefined(D.relatedInformation)||T.typedArray(D.relatedInformation,V.is))}g.is=l})(fe||(r.Diagnostic=fe={}));var le;(function(g){function b(v,f){for(var D=[],p=2;p<arguments.length;p++)D[p-2]=arguments[p];var E={title:v,command:f};return T.defined(D)&&D.length>0&&(E.arguments=D),E}g.create=b;function l(v){var f=v;return T.defined(f)&&T.string(f.title)&&T.string(f.command)}g.is=l})(le||(r.Command=le={}));var x;(function(g){function b(D,p){return{range:D,newText:p}}g.replace=b;function l(D,p){return{range:{start:D,end:D},newText:p}}g.insert=l;function v(D){return{range:D,newText:""}}g.del=v;function f(D){var p=D;return T.objectLiteral(p)&&T.string(p.newText)&&d.is(p.range)}g.is=f})(x||(r.TextEdit=x={}));var N;(function(g){function b(v,f,D){var p={label:v};return f!==void 0&&(p.needsConfirmation=f),D!==void 0&&(p.description=D),p}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&T.string(f.label)&&(T.boolean(f.needsConfirmation)||f.needsConfirmation===void 0)&&(T.string(f.description)||f.description===void 0)}g.is=l})(N||(r.ChangeAnnotation=N={}));var A;(function(g){function b(l){var v=l;return T.string(v)}g.is=b})(A||(r.ChangeAnnotationIdentifier=A={}));var ee;(function(g){function b(D,p,E){return{range:D,newText:p,annotationId:E}}g.replace=b;function l(D,p,E){return{range:{start:D,end:D},newText:p,annotationId:E}}g.insert=l;function v(D,p){return{range:D,newText:"",annotationId:p}}g.del=v;function f(D){var p=D;return x.is(p)&&(N.is(p.annotationId)||A.is(p.annotationId))}g.is=f})(ee||(r.AnnotatedTextEdit=ee={}));var U;(function(g){function b(v,f){return{textDocument:v,edits:f}}g.create=b;function l(v){var f=v;return T.defined(f)&&Z.is(f.textDocument)&&Array.isArray(f.edits)}g.is=l})(U||(r.TextDocumentEdit=U={}));var W;(function(g){function b(v,f,D){var p={kind:"create",uri:v};return f!==void 0&&(f.overwrite!==void 0||f.ignoreIfExists!==void 0)&&(p.options=f),D!==void 0&&(p.annotationId=D),p}g.create=b;function l(v){var f=v;return f&&f.kind==="create"&&T.string(f.uri)&&(f.options===void 0||(f.options.overwrite===void 0||T.boolean(f.options.overwrite))&&(f.options.ignoreIfExists===void 0||T.boolean(f.options.ignoreIfExists)))&&(f.annotationId===void 0||A.is(f.annotationId))}g.is=l})(W||(r.CreateFile=W={}));var R;(function(g){function b(v,f,D,p){var E={kind:"rename",oldUri:v,newUri:f};return D!==void 0&&(D.overwrite!==void 0||D.ignoreIfExists!==void 0)&&(E.options=D),p!==void 0&&(E.annotationId=p),E}g.create=b;function l(v){var f=v;return f&&f.kind==="rename"&&T.string(f.oldUri)&&T.string(f.newUri)&&(f.options===void 0||(f.options.overwrite===void 0||T.boolean(f.options.overwrite))&&(f.options.ignoreIfExists===void 0||T.boolean(f.options.ignoreIfExists)))&&(f.annotationId===void 0||A.is(f.annotationId))}g.is=l})(R||(r.RenameFile=R={}));var k;(function(g){function b(v,f,D){var p={kind:"delete",uri:v};return f!==void 0&&(f.recursive!==void 0||f.ignoreIfNotExists!==void 0)&&(p.options=f),D!==void 0&&(p.annotationId=D),p}g.create=b;function l(v){var f=v;return f&&f.kind==="delete"&&T.string(f.uri)&&(f.options===void 0||(f.options.recursive===void 0||T.boolean(f.options.recursive))&&(f.options.ignoreIfNotExists===void 0||T.boolean(f.options.ignoreIfNotExists)))&&(f.annotationId===void 0||A.is(f.annotationId))}g.is=l})(k||(r.DeleteFile=k={}));var P;(function(g){function b(l){var v=l;return v&&(v.changes!==void 0||v.documentChanges!==void 0)&&(v.documentChanges===void 0||v.documentChanges.every(function(f){return T.string(f.kind)?W.is(f)||R.is(f)||k.is(f):U.is(f)}))}g.is=b})(P||(r.WorkspaceEdit=P={}));var q=function(){function g(b,l){this.edits=b,this.changeAnnotations=l}return g.prototype.insert=function(b,l,v){var f,D;if(v===void 0?f=x.insert(b,l):A.is(v)?(D=v,f=ee.insert(b,l,v)):(this.assertChangeAnnotations(this.changeAnnotations),D=this.changeAnnotations.manage(v),f=ee.insert(b,l,D)),this.edits.push(f),D!==void 0)return D},g.prototype.replace=function(b,l,v){var f,D;if(v===void 0?f=x.replace(b,l):A.is(v)?(D=v,f=ee.replace(b,l,v)):(this.assertChangeAnnotations(this.changeAnnotations),D=this.changeAnnotations.manage(v),f=ee.replace(b,l,D)),this.edits.push(f),D!==void 0)return D},g.prototype.delete=function(b,l){var v,f;if(l===void 0?v=x.del(b):A.is(l)?(f=l,v=ee.del(b,l)):(this.assertChangeAnnotations(this.changeAnnotations),f=this.changeAnnotations.manage(l),v=ee.del(b,f)),this.edits.push(v),f!==void 0)return f},g.prototype.add=function(b){this.edits.push(b)},g.prototype.all=function(){return this.edits},g.prototype.clear=function(){this.edits.splice(0,this.edits.length)},g.prototype.assertChangeAnnotations=function(b){if(b===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},g}(),$=function(){function g(b){this._annotations=b===void 0?Object.create(null):b,this._counter=0,this._size=0}return g.prototype.all=function(){return this._annotations},Object.defineProperty(g.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),g.prototype.manage=function(b,l){var v;if(A.is(b)?v=b:(v=this.nextId(),l=b),this._annotations[v]!==void 0)throw new Error("Id ".concat(v," is already in use."));if(l===void 0)throw new Error("No annotation provided for id ".concat(v));return this._annotations[v]=l,this._size++,v},g.prototype.nextId=function(){return this._counter++,this._counter.toString()},g}(),j=function(){function g(b){var l=this;this._textEditChanges=Object.create(null),b!==void 0?(this._workspaceEdit=b,b.documentChanges?(this._changeAnnotations=new $(b.changeAnnotations),b.changeAnnotations=this._changeAnnotations.all(),b.documentChanges.forEach(function(v){if(U.is(v)){var f=new q(v.edits,l._changeAnnotations);l._textEditChanges[v.textDocument.uri]=f}})):b.changes&&Object.keys(b.changes).forEach(function(v){var f=new q(b.changes[v]);l._textEditChanges[v]=f})):this._workspaceEdit={}}return Object.defineProperty(g.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),g.prototype.getTextEditChange=function(b){if(Z.is(b)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var l={uri:b.uri,version:b.version},v=this._textEditChanges[l.uri];if(!v){var f=[],D={textDocument:l,edits:f};this._workspaceEdit.documentChanges.push(D),v=new q(f,this._changeAnnotations),this._textEditChanges[l.uri]=v}return v}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var v=this._textEditChanges[b];if(!v){var f=[];this._workspaceEdit.changes[b]=f,v=new q(f),this._textEditChanges[b]=v}return v}},g.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new $,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},g.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},g.prototype.createFile=function(b,l,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var f;N.is(l)||A.is(l)?f=l:v=l;var D,p;if(f===void 0?D=W.create(b,v):(p=A.is(f)?f:this._changeAnnotations.manage(f),D=W.create(b,v,p)),this._workspaceEdit.documentChanges.push(D),p!==void 0)return p},g.prototype.renameFile=function(b,l,v,f){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var D;N.is(v)||A.is(v)?D=v:f=v;var p,E;if(D===void 0?p=R.create(b,l,f):(E=A.is(D)?D:this._changeAnnotations.manage(D),p=R.create(b,l,f,E)),this._workspaceEdit.documentChanges.push(p),E!==void 0)return E},g.prototype.deleteFile=function(b,l,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var f;N.is(l)||A.is(l)?f=l:v=l;var D,p;if(f===void 0?D=k.create(b,v):(p=A.is(f)?f:this._changeAnnotations.manage(f),D=k.create(b,v,p)),this._workspaceEdit.documentChanges.push(D),p!==void 0)return p},g}();r.WorkspaceChange=j;var L;(function(g){function b(v){return{uri:v}}g.create=b;function l(v){var f=v;return T.defined(f)&&T.string(f.uri)}g.is=l})(L||(r.TextDocumentIdentifier=L={}));var X;(function(g){function b(v,f){return{uri:v,version:f}}g.create=b;function l(v){var f=v;return T.defined(f)&&T.string(f.uri)&&T.integer(f.version)}g.is=l})(X||(r.VersionedTextDocumentIdentifier=X={}));var Z;(function(g){function b(v,f){return{uri:v,version:f}}g.create=b;function l(v){var f=v;return T.defined(f)&&T.string(f.uri)&&(f.version===null||T.integer(f.version))}g.is=l})(Z||(r.OptionalVersionedTextDocumentIdentifier=Z={}));var J;(function(g){function b(v,f,D,p){return{uri:v,languageId:f,version:D,text:p}}g.create=b;function l(v){var f=v;return T.defined(f)&&T.string(f.uri)&&T.string(f.languageId)&&T.integer(f.version)&&T.string(f.text)}g.is=l})(J||(r.TextDocumentItem=J={}));var ne;(function(g){g.PlainText="plaintext",g.Markdown="markdown";function b(l){var v=l;return v===g.PlainText||v===g.Markdown}g.is=b})(ne||(r.MarkupKind=ne={}));var re;(function(g){function b(l){var v=l;return T.objectLiteral(l)&&ne.is(v.kind)&&T.string(v.value)}g.is=b})(re||(r.MarkupContent=re={}));var G;(function(g){g.Text=1,g.Method=2,g.Function=3,g.Constructor=4,g.Field=5,g.Variable=6,g.Class=7,g.Interface=8,g.Module=9,g.Property=10,g.Unit=11,g.Value=12,g.Enum=13,g.Keyword=14,g.Snippet=15,g.Color=16,g.File=17,g.Reference=18,g.Folder=19,g.EnumMember=20,g.Constant=21,g.Struct=22,g.Event=23,g.Operator=24,g.TypeParameter=25})(G||(r.CompletionItemKind=G={}));var ie;(function(g){g.PlainText=1,g.Snippet=2})(ie||(r.InsertTextFormat=ie={}));var se;(function(g){g.Deprecated=1})(se||(r.CompletionItemTag=se={}));var Ye;(function(g){function b(v,f,D){return{newText:v,insert:f,replace:D}}g.create=b;function l(v){var f=v;return f&&T.string(f.newText)&&d.is(f.insert)&&d.is(f.replace)}g.is=l})(Ye||(r.InsertReplaceEdit=Ye={}));var Be;(function(g){g.asIs=1,g.adjustIndentation=2})(Be||(r.InsertTextMode=Be={}));var ot;(function(g){function b(l){var v=l;return v&&(T.string(v.detail)||v.detail===void 0)&&(T.string(v.description)||v.description===void 0)}g.is=b})(ot||(r.CompletionItemLabelDetails=ot={}));var Ze;(function(g){function b(l){return{label:l}}g.create=b})(Ze||(r.CompletionItem=Ze={}));var ve;(function(g){function b(l,v){return{items:l||[],isIncomplete:!!v}}g.create=b})(ve||(r.CompletionList=ve={}));var Ve;(function(g){function b(v){return v.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}g.fromPlainText=b;function l(v){var f=v;return T.string(f)||T.objectLiteral(f)&&T.string(f.language)&&T.string(f.value)}g.is=l})(Ve||(r.MarkedString=Ve={}));var qe;(function(g){function b(l){var v=l;return!!v&&T.objectLiteral(v)&&(re.is(v.contents)||Ve.is(v.contents)||T.typedArray(v.contents,Ve.is))&&(l.range===void 0||d.is(l.range))}g.is=b})(qe||(r.Hover=qe={}));var et;(function(g){function b(l,v){return v?{label:l,documentation:v}:{label:l}}g.create=b})(et||(r.ParameterInformation=et={}));var St;(function(g){function b(l,v){for(var f=[],D=2;D<arguments.length;D++)f[D-2]=arguments[D];var p={label:l};return T.defined(v)&&(p.documentation=v),T.defined(f)?p.parameters=f:p.parameters=[],p}g.create=b})(St||(r.SignatureInformation=St={}));var yt;(function(g){g.Text=1,g.Read=2,g.Write=3})(yt||(r.DocumentHighlightKind=yt={}));var vt;(function(g){function b(l,v){var f={range:l};return T.number(v)&&(f.kind=v),f}g.create=b})(vt||(r.DocumentHighlight=vt={}));var Xe;(function(g){g.File=1,g.Module=2,g.Namespace=3,g.Package=4,g.Class=5,g.Method=6,g.Property=7,g.Field=8,g.Constructor=9,g.Enum=10,g.Interface=11,g.Function=12,g.Variable=13,g.Constant=14,g.String=15,g.Number=16,g.Boolean=17,g.Array=18,g.Object=19,g.Key=20,g.Null=21,g.EnumMember=22,g.Struct=23,g.Event=24,g.Operator=25,g.TypeParameter=26})(Xe||(r.SymbolKind=Xe={}));var ut;(function(g){g.Deprecated=1})(ut||(r.SymbolTag=ut={}));var Ae;(function(g){function b(l,v,f,D,p){var E={name:l,kind:v,location:{uri:D,range:f}};return p&&(E.containerName=p),E}g.create=b})(Ae||(r.SymbolInformation=Ae={}));var st;(function(g){function b(l,v,f,D){return D!==void 0?{name:l,kind:v,location:{uri:f,range:D}}:{name:l,kind:v,location:{uri:f}}}g.create=b})(st||(r.WorkspaceSymbol=st={}));var Gt;(function(g){function b(v,f,D,p,E,H){var B={name:v,detail:f,kind:D,range:p,selectionRange:E};return H!==void 0&&(B.children=H),B}g.create=b;function l(v){var f=v;return f&&T.string(f.name)&&T.number(f.kind)&&d.is(f.range)&&d.is(f.selectionRange)&&(f.detail===void 0||T.string(f.detail))&&(f.deprecated===void 0||T.boolean(f.deprecated))&&(f.children===void 0||Array.isArray(f.children))&&(f.tags===void 0||Array.isArray(f.tags))}g.is=l})(Gt||(r.DocumentSymbol=Gt={}));var It;(function(g){g.Empty="",g.QuickFix="quickfix",g.Refactor="refactor",g.RefactorExtract="refactor.extract",g.RefactorInline="refactor.inline",g.RefactorRewrite="refactor.rewrite",g.Source="source",g.SourceOrganizeImports="source.organizeImports",g.SourceFixAll="source.fixAll"})(It||(r.CodeActionKind=It={}));var Rt;(function(g){g.Invoked=1,g.Automatic=2})(Rt||(r.CodeActionTriggerKind=Rt={}));var Ot;(function(g){function b(v,f,D){var p={diagnostics:v};return f!=null&&(p.only=f),D!=null&&(p.triggerKind=D),p}g.create=b;function l(v){var f=v;return T.defined(f)&&T.typedArray(f.diagnostics,fe.is)&&(f.only===void 0||T.typedArray(f.only,T.string))&&(f.triggerKind===void 0||f.triggerKind===Rt.Invoked||f.triggerKind===Rt.Automatic)}g.is=l})(Ot||(r.CodeActionContext=Ot={}));var Nt;(function(g){function b(v,f,D){var p={title:v},E=!0;return typeof f=="string"?(E=!1,p.kind=f):le.is(f)?p.command=f:p.edit=f,E&&D!==void 0&&(p.kind=D),p}g.create=b;function l(v){var f=v;return f&&T.string(f.title)&&(f.diagnostics===void 0||T.typedArray(f.diagnostics,fe.is))&&(f.kind===void 0||T.string(f.kind))&&(f.edit!==void 0||f.command!==void 0)&&(f.command===void 0||le.is(f.command))&&(f.isPreferred===void 0||T.boolean(f.isPreferred))&&(f.edit===void 0||P.is(f.edit))}g.is=l})(Nt||(r.CodeAction=Nt={}));var Ct;(function(g){function b(v,f){var D={range:v};return T.defined(f)&&(D.data=f),D}g.create=b;function l(v){var f=v;return T.defined(f)&&d.is(f.range)&&(T.undefined(f.command)||le.is(f.command))}g.is=l})(Ct||(r.CodeLens=Ct={}));var at;(function(g){function b(v,f){return{tabSize:v,insertSpaces:f}}g.create=b;function l(v){var f=v;return T.defined(f)&&T.uinteger(f.tabSize)&&T.boolean(f.insertSpaces)}g.is=l})(at||(r.FormattingOptions=at={}));var Tt;(function(g){function b(v,f,D){return{range:v,target:f,data:D}}g.create=b;function l(v){var f=v;return T.defined(f)&&d.is(f.range)&&(T.undefined(f.target)||T.string(f.target))}g.is=l})(Tt||(r.DocumentLink=Tt={}));var Bt;(function(g){function b(v,f){return{range:v,parent:f}}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&d.is(f.range)&&(f.parent===void 0||g.is(f.parent))}g.is=l})(Bt||(r.SelectionRange=Bt={}));var ct;(function(g){g.namespace="namespace",g.type="type",g.class="class",g.enum="enum",g.interface="interface",g.struct="struct",g.typeParameter="typeParameter",g.parameter="parameter",g.variable="variable",g.property="property",g.enumMember="enumMember",g.event="event",g.function="function",g.method="method",g.macro="macro",g.keyword="keyword",g.modifier="modifier",g.comment="comment",g.string="string",g.number="number",g.regexp="regexp",g.operator="operator",g.decorator="decorator"})(ct||(r.SemanticTokenTypes=ct={}));var Pt;(function(g){g.declaration="declaration",g.definition="definition",g.readonly="readonly",g.static="static",g.deprecated="deprecated",g.abstract="abstract",g.async="async",g.modification="modification",g.documentation="documentation",g.defaultLibrary="defaultLibrary"})(Pt||(r.SemanticTokenModifiers=Pt={}));var qt;(function(g){function b(l){var v=l;return T.objectLiteral(v)&&(v.resultId===void 0||typeof v.resultId=="string")&&Array.isArray(v.data)&&(v.data.length===0||typeof v.data[0]=="number")}g.is=b})(qt||(r.SemanticTokens=qt={}));var $t;(function(g){function b(v,f){return{range:v,text:f}}g.create=b;function l(v){var f=v;return f!=null&&d.is(f.range)&&T.string(f.text)}g.is=l})($t||(r.InlineValueText=$t={}));var Vt;(function(g){function b(v,f,D){return{range:v,variableName:f,caseSensitiveLookup:D}}g.create=b;function l(v){var f=v;return f!=null&&d.is(f.range)&&T.boolean(f.caseSensitiveLookup)&&(T.string(f.variableName)||f.variableName===void 0)}g.is=l})(Vt||(r.InlineValueVariableLookup=Vt={}));var Mt;(function(g){function b(v,f){return{range:v,expression:f}}g.create=b;function l(v){var f=v;return f!=null&&d.is(f.range)&&(T.string(f.expression)||f.expression===void 0)}g.is=l})(Mt||(r.InlineValueEvaluatableExpression=Mt={}));var Lt;(function(g){function b(v,f){return{frameId:v,stoppedLocation:f}}g.create=b;function l(v){var f=v;return T.defined(f)&&d.is(v.stoppedLocation)}g.is=l})(Lt||(r.InlineValueContext=Lt={}));var At;(function(g){g.Type=1,g.Parameter=2;function b(l){return l===1||l===2}g.is=b})(At||(r.InlayHintKind=At={}));var _t;(function(g){function b(v){return{value:v}}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&(f.tooltip===void 0||T.string(f.tooltip)||re.is(f.tooltip))&&(f.location===void 0||m.is(f.location))&&(f.command===void 0||le.is(f.command))}g.is=l})(_t||(r.InlayHintLabelPart=_t={}));var rt;(function(g){function b(v,f,D){var p={position:v,label:f};return D!==void 0&&(p.kind=D),p}g.create=b;function l(v){var f=v;return T.objectLiteral(f)&&u.is(f.position)&&(T.string(f.label)||T.typedArray(f.label,_t.is))&&(f.kind===void 0||At.is(f.kind))&&f.textEdits===void 0||T.typedArray(f.textEdits,x.is)&&(f.tooltip===void 0||T.string(f.tooltip)||re.is(f.tooltip))&&(f.paddingLeft===void 0||T.boolean(f.paddingLeft))&&(f.paddingRight===void 0||T.boolean(f.paddingRight))}g.is=l})(rt||(r.InlayHint=rt={}));var jt;(function(g){function b(l){return{kind:"snippet",value:l}}g.createSnippet=b})(jt||(r.StringValue=jt={}));var Xt;(function(g){function b(l,v,f,D){return{insertText:l,filterText:v,range:f,command:D}}g.create=b})(Xt||(r.InlineCompletionItem=Xt={}));var lt;(function(g){function b(l){return{items:l}}g.create=b})(lt||(r.InlineCompletionList=lt={}));var h;(function(g){g.Invoked=0,g.Automatic=1})(h||(r.InlineCompletionTriggerKind=h={}));var F;(function(g){function b(l,v){return{range:l,text:v}}g.create=b})(F||(r.SelectedCompletionInfo=F={}));var Y;(function(g){function b(l,v){return{triggerKind:l,selectedCompletionInfo:v}}g.create=b})(Y||(r.InlineCompletionContext=Y={}));var pe;(function(g){function b(l){var v=l;return T.objectLiteral(v)&&o.is(v.uri)&&T.string(v.name)}g.is=b})(pe||(r.WorkspaceFolder=pe={})),r.EOL=[`
`,`\r
`,"\r"];var Ce;(function(g){function b(D,p,E,H){return new He(D,p,E,H)}g.create=b;function l(D){var p=D;return!!(T.defined(p)&&T.string(p.uri)&&(T.undefined(p.languageId)||T.string(p.languageId))&&T.uinteger(p.lineCount)&&T.func(p.getText)&&T.func(p.positionAt)&&T.func(p.offsetAt))}g.is=l;function v(D,p){for(var E=D.getText(),H=f(p,function(w,I){var K=w.range.start.line-I.range.start.line;return K===0?w.range.start.character-I.range.start.character:K}),B=E.length,we=H.length-1;we>=0;we--){var ye=H[we],Pe=D.offsetAt(ye.range.start),a=D.offsetAt(ye.range.end);if(a<=B)E=E.substring(0,Pe)+ye.newText+E.substring(a,E.length);else throw new Error("Overlapping edit");B=Pe}return E}g.applyEdits=v;function f(D,p){if(D.length<=1)return D;var E=D.length/2|0,H=D.slice(0,E),B=D.slice(E);f(H,p),f(B,p);for(var we=0,ye=0,Pe=0;we<H.length&&ye<B.length;){var a=p(H[we],B[ye]);a<=0?D[Pe++]=H[we++]:D[Pe++]=B[ye++]}for(;we<H.length;)D[Pe++]=H[we++];for(;ye<B.length;)D[Pe++]=B[ye++];return D}})(Ce||(r.TextDocument=Ce={}));var He=function(){function g(b,l,v,f){this._uri=b,this._languageId=l,this._version=v,this._content=f,this._lineOffsets=void 0}return Object.defineProperty(g.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),g.prototype.getText=function(b){if(b){var l=this.offsetAt(b.start),v=this.offsetAt(b.end);return this._content.substring(l,v)}return this._content},g.prototype.update=function(b,l){this._content=b.text,this._version=l,this._lineOffsets=void 0},g.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var b=[],l=this._content,v=!0,f=0;f<l.length;f++){v&&(b.push(f),v=!1);var D=l.charAt(f);v=D==="\r"||D===`
`,D==="\r"&&f+1<l.length&&l.charAt(f+1)===`
`&&f++}v&&l.length>0&&b.push(l.length),this._lineOffsets=b}return this._lineOffsets},g.prototype.positionAt=function(b){b=Math.max(Math.min(b,this._content.length),0);var l=this.getLineOffsets(),v=0,f=l.length;if(f===0)return u.create(0,b);for(;v<f;){var D=Math.floor((v+f)/2);l[D]>b?f=D:v=D+1}var p=v-1;return u.create(p,b-l[p])},g.prototype.offsetAt=function(b){var l=this.getLineOffsets();if(b.line>=l.length)return this._content.length;if(b.line<0)return 0;var v=l[b.line],f=b.line+1<l.length?l[b.line+1]:this._content.length;return Math.max(Math.min(v+b.character,f),v)},Object.defineProperty(g.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),g}(),T;(function(g){var b=Object.prototype.toString;function l(a){return typeof a<"u"}g.defined=l;function v(a){return typeof a>"u"}g.undefined=v;function f(a){return a===!0||a===!1}g.boolean=f;function D(a){return b.call(a)==="[object String]"}g.string=D;function p(a){return b.call(a)==="[object Number]"}g.number=p;function E(a,w,I){return b.call(a)==="[object Number]"&&w<=a&&a<=I}g.numberRange=E;function H(a){return b.call(a)==="[object Number]"&&-2147483648<=a&&a<=2147483647}g.integer=H;function B(a){return b.call(a)==="[object Number]"&&0<=a&&a<=2147483647}g.uinteger=B;function we(a){return b.call(a)==="[object Function]"}g.func=we;function ye(a){return a!==null&&typeof a=="object"}g.objectLiteral=ye;function Pe(a,w){return Array.isArray(a)&&a.every(w)}g.typedArray=Pe})(T||(T={}))})})(Ro,Ro.exports);var To=Ro.exports,Ee={};Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.ProtocolNotificationType=Ee.ProtocolNotificationType0=Ee.ProtocolRequestType=Ee.ProtocolRequestType0=Ee.RegistrationType=Ee.MessageDirection=void 0;const Kn=Tn;var la;(function(n){n.clientToServer="clientToServer",n.serverToClient="serverToClient",n.both="both"})(la||(Ee.MessageDirection=la={}));class ld{constructor(e){this.method=e}}Ee.RegistrationType=ld;class dd extends Kn.RequestType0{constructor(e){super(e)}}Ee.ProtocolRequestType0=dd;class fd extends Kn.RequestType{constructor(e){super(e,Kn.ParameterStructures.byName)}}Ee.ProtocolRequestType=fd;class hd extends Kn.NotificationType0{constructor(e){super(e)}}Ee.ProtocolNotificationType0=hd;class gd extends Kn.NotificationType{constructor(e){super(e,Kn.ParameterStructures.byName)}}Ee.ProtocolNotificationType=gd;var da={},Ke={};Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.objectLiteral=Ke.typedArray=Ke.stringArray=Ke.array=Ke.func=Ke.error=Ke.number=Ke.string=Ke.boolean=void 0;function pd(n){return n===!0||n===!1}Ke.boolean=pd;function fa(n){return typeof n=="string"||n instanceof String}Ke.string=fa;function md(n){return typeof n=="number"||n instanceof Number}Ke.number=md;function yd(n){return n instanceof Error}Ke.error=yd;function vd(n){return typeof n=="function"}Ke.func=vd;function ha(n){return Array.isArray(n)}Ke.array=ha;function Cd(n){return ha(n)&&n.every(e=>fa(e))}Ke.stringArray=Cd;function _d(n,e){return Array.isArray(n)&&n.every(e)}Ke.typedArray=_d;function wd(n){return n!==null&&typeof n=="object"}Ke.objectLiteral=wd;var Ur={};Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.ImplementationRequest=void 0;const ga=Ee;var pa;(function(n){n.method="textDocument/implementation",n.messageDirection=ga.MessageDirection.clientToServer,n.type=new ga.ProtocolRequestType(n.method)})(pa||(Ur.ImplementationRequest=pa={}));var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.TypeDefinitionRequest=void 0;const ma=Ee;var ya;(function(n){n.method="textDocument/typeDefinition",n.messageDirection=ma.MessageDirection.clientToServer,n.type=new ma.ProtocolRequestType(n.method)})(ya||(Kr.TypeDefinitionRequest=ya={}));var zn={};Object.defineProperty(zn,"__esModule",{value:!0}),zn.DidChangeWorkspaceFoldersNotification=zn.WorkspaceFoldersRequest=void 0;const zr=Ee;var va;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=zr.MessageDirection.serverToClient,n.type=new zr.ProtocolRequestType0(n.method)})(va||(zn.WorkspaceFoldersRequest=va={}));var Ca;(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=zr.MessageDirection.clientToServer,n.type=new zr.ProtocolNotificationType(n.method)})(Ca||(zn.DidChangeWorkspaceFoldersNotification=Ca={}));var Gr={};Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.ConfigurationRequest=void 0;const _a=Ee;var wa;(function(n){n.method="workspace/configuration",n.messageDirection=_a.MessageDirection.serverToClient,n.type=new _a.ProtocolRequestType(n.method)})(wa||(Gr.ConfigurationRequest=wa={}));var Gn={};Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.ColorPresentationRequest=Gn.DocumentColorRequest=void 0;const Br=Ee;var ba;(function(n){n.method="textDocument/documentColor",n.messageDirection=Br.MessageDirection.clientToServer,n.type=new Br.ProtocolRequestType(n.method)})(ba||(Gn.DocumentColorRequest=ba={}));var Da;(function(n){n.method="textDocument/colorPresentation",n.messageDirection=Br.MessageDirection.clientToServer,n.type=new Br.ProtocolRequestType(n.method)})(Da||(Gn.ColorPresentationRequest=Da={}));var Bn={};Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.FoldingRangeRefreshRequest=Bn.FoldingRangeRequest=void 0;const Vr=Ee;var Sa;(function(n){n.method="textDocument/foldingRange",n.messageDirection=Vr.MessageDirection.clientToServer,n.type=new Vr.ProtocolRequestType(n.method)})(Sa||(Bn.FoldingRangeRequest=Sa={}));var Ra;(function(n){n.method="workspace/foldingRange/refresh",n.messageDirection=Vr.MessageDirection.serverToClient,n.type=new Vr.ProtocolRequestType0(n.method)})(Ra||(Bn.FoldingRangeRefreshRequest=Ra={}));var Xr={};Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.DeclarationRequest=void 0;const Ta=Ee;var Pa;(function(n){n.method="textDocument/declaration",n.messageDirection=Ta.MessageDirection.clientToServer,n.type=new Ta.ProtocolRequestType(n.method)})(Pa||(Xr.DeclarationRequest=Pa={}));var Jr={};Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.SelectionRangeRequest=void 0;const Ea=Ee;var ka;(function(n){n.method="textDocument/selectionRange",n.messageDirection=Ea.MessageDirection.clientToServer,n.type=new Ea.ProtocolRequestType(n.method)})(ka||(Jr.SelectionRangeRequest=ka={}));var yn={};Object.defineProperty(yn,"__esModule",{value:!0}),yn.WorkDoneProgressCancelNotification=yn.WorkDoneProgressCreateRequest=yn.WorkDoneProgress=void 0;const bd=Tn,Qr=Ee;var Fa;(function(n){n.type=new bd.ProgressType;function e(t){return t===n.type}n.is=e})(Fa||(yn.WorkDoneProgress=Fa={}));var Ia;(function(n){n.method="window/workDoneProgress/create",n.messageDirection=Qr.MessageDirection.serverToClient,n.type=new Qr.ProtocolRequestType(n.method)})(Ia||(yn.WorkDoneProgressCreateRequest=Ia={}));var Oa;(function(n){n.method="window/workDoneProgress/cancel",n.messageDirection=Qr.MessageDirection.clientToServer,n.type=new Qr.ProtocolNotificationType(n.method)})(Oa||(yn.WorkDoneProgressCancelNotification=Oa={}));var vn={};Object.defineProperty(vn,"__esModule",{value:!0}),vn.CallHierarchyOutgoingCallsRequest=vn.CallHierarchyIncomingCallsRequest=vn.CallHierarchyPrepareRequest=void 0;const Vn=Ee;var Na;(function(n){n.method="textDocument/prepareCallHierarchy",n.messageDirection=Vn.MessageDirection.clientToServer,n.type=new Vn.ProtocolRequestType(n.method)})(Na||(vn.CallHierarchyPrepareRequest=Na={}));var qa;(function(n){n.method="callHierarchy/incomingCalls",n.messageDirection=Vn.MessageDirection.clientToServer,n.type=new Vn.ProtocolRequestType(n.method)})(qa||(vn.CallHierarchyIncomingCallsRequest=qa={}));var $a;(function(n){n.method="callHierarchy/outgoingCalls",n.messageDirection=Vn.MessageDirection.clientToServer,n.type=new Vn.ProtocolRequestType(n.method)})($a||(vn.CallHierarchyOutgoingCallsRequest=$a={}));var wt={};Object.defineProperty(wt,"__esModule",{value:!0}),wt.SemanticTokensRefreshRequest=wt.SemanticTokensRangeRequest=wt.SemanticTokensDeltaRequest=wt.SemanticTokensRequest=wt.SemanticTokensRegistrationType=wt.TokenFormat=void 0;const cn=Ee;var Ma;(function(n){n.Relative="relative"})(Ma||(wt.TokenFormat=Ma={}));var mr;(function(n){n.method="textDocument/semanticTokens",n.type=new cn.RegistrationType(n.method)})(mr||(wt.SemanticTokensRegistrationType=mr={}));var La;(function(n){n.method="textDocument/semanticTokens/full",n.messageDirection=cn.MessageDirection.clientToServer,n.type=new cn.ProtocolRequestType(n.method),n.registrationMethod=mr.method})(La||(wt.SemanticTokensRequest=La={}));var Aa;(function(n){n.method="textDocument/semanticTokens/full/delta",n.messageDirection=cn.MessageDirection.clientToServer,n.type=new cn.ProtocolRequestType(n.method),n.registrationMethod=mr.method})(Aa||(wt.SemanticTokensDeltaRequest=Aa={}));var ja;(function(n){n.method="textDocument/semanticTokens/range",n.messageDirection=cn.MessageDirection.clientToServer,n.type=new cn.ProtocolRequestType(n.method),n.registrationMethod=mr.method})(ja||(wt.SemanticTokensRangeRequest=ja={}));var xa;(function(n){n.method="workspace/semanticTokens/refresh",n.messageDirection=cn.MessageDirection.serverToClient,n.type=new cn.ProtocolRequestType0(n.method)})(xa||(wt.SemanticTokensRefreshRequest=xa={}));var Yr={};Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.ShowDocumentRequest=void 0;const Ha=Ee;var Wa;(function(n){n.method="window/showDocument",n.messageDirection=Ha.MessageDirection.serverToClient,n.type=new Ha.ProtocolRequestType(n.method)})(Wa||(Yr.ShowDocumentRequest=Wa={}));var Zr={};Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.LinkedEditingRangeRequest=void 0;const Ua=Ee;var Ka;(function(n){n.method="textDocument/linkedEditingRange",n.messageDirection=Ua.MessageDirection.clientToServer,n.type=new Ua.ProtocolRequestType(n.method)})(Ka||(Zr.LinkedEditingRangeRequest=Ka={}));var ft={};Object.defineProperty(ft,"__esModule",{value:!0}),ft.WillDeleteFilesRequest=ft.DidDeleteFilesNotification=ft.DidRenameFilesNotification=ft.WillRenameFilesRequest=ft.DidCreateFilesNotification=ft.WillCreateFilesRequest=ft.FileOperationPatternKind=void 0;const Ht=Ee;var za;(function(n){n.file="file",n.folder="folder"})(za||(ft.FileOperationPatternKind=za={}));var Ga;(function(n){n.method="workspace/willCreateFiles",n.messageDirection=Ht.MessageDirection.clientToServer,n.type=new Ht.ProtocolRequestType(n.method)})(Ga||(ft.WillCreateFilesRequest=Ga={}));var Ba;(function(n){n.method="workspace/didCreateFiles",n.messageDirection=Ht.MessageDirection.clientToServer,n.type=new Ht.ProtocolNotificationType(n.method)})(Ba||(ft.DidCreateFilesNotification=Ba={}));var Va;(function(n){n.method="workspace/willRenameFiles",n.messageDirection=Ht.MessageDirection.clientToServer,n.type=new Ht.ProtocolRequestType(n.method)})(Va||(ft.WillRenameFilesRequest=Va={}));var Xa;(function(n){n.method="workspace/didRenameFiles",n.messageDirection=Ht.MessageDirection.clientToServer,n.type=new Ht.ProtocolNotificationType(n.method)})(Xa||(ft.DidRenameFilesNotification=Xa={}));var Ja;(function(n){n.method="workspace/didDeleteFiles",n.messageDirection=Ht.MessageDirection.clientToServer,n.type=new Ht.ProtocolNotificationType(n.method)})(Ja||(ft.DidDeleteFilesNotification=Ja={}));var Qa;(function(n){n.method="workspace/willDeleteFiles",n.messageDirection=Ht.MessageDirection.clientToServer,n.type=new Ht.ProtocolRequestType(n.method)})(Qa||(ft.WillDeleteFilesRequest=Qa={}));var Cn={};Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.MonikerRequest=Cn.MonikerKind=Cn.UniquenessLevel=void 0;const Ya=Ee;var Za;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(Za||(Cn.UniquenessLevel=Za={}));var ec;(function(n){n.$import="import",n.$export="export",n.local="local"})(ec||(Cn.MonikerKind=ec={}));var tc;(function(n){n.method="textDocument/moniker",n.messageDirection=Ya.MessageDirection.clientToServer,n.type=new Ya.ProtocolRequestType(n.method)})(tc||(Cn.MonikerRequest=tc={}));var _n={};Object.defineProperty(_n,"__esModule",{value:!0}),_n.TypeHierarchySubtypesRequest=_n.TypeHierarchySupertypesRequest=_n.TypeHierarchyPrepareRequest=void 0;const Xn=Ee;var nc;(function(n){n.method="textDocument/prepareTypeHierarchy",n.messageDirection=Xn.MessageDirection.clientToServer,n.type=new Xn.ProtocolRequestType(n.method)})(nc||(_n.TypeHierarchyPrepareRequest=nc={}));var rc;(function(n){n.method="typeHierarchy/supertypes",n.messageDirection=Xn.MessageDirection.clientToServer,n.type=new Xn.ProtocolRequestType(n.method)})(rc||(_n.TypeHierarchySupertypesRequest=rc={}));var ic;(function(n){n.method="typeHierarchy/subtypes",n.messageDirection=Xn.MessageDirection.clientToServer,n.type=new Xn.ProtocolRequestType(n.method)})(ic||(_n.TypeHierarchySubtypesRequest=ic={}));var Jn={};Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.InlineValueRefreshRequest=Jn.InlineValueRequest=void 0;const ei=Ee;var oc;(function(n){n.method="textDocument/inlineValue",n.messageDirection=ei.MessageDirection.clientToServer,n.type=new ei.ProtocolRequestType(n.method)})(oc||(Jn.InlineValueRequest=oc={}));var sc;(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=ei.MessageDirection.serverToClient,n.type=new ei.ProtocolRequestType0(n.method)})(sc||(Jn.InlineValueRefreshRequest=sc={}));var wn={};Object.defineProperty(wn,"__esModule",{value:!0}),wn.InlayHintRefreshRequest=wn.InlayHintResolveRequest=wn.InlayHintRequest=void 0;const Qn=Ee;var ac;(function(n){n.method="textDocument/inlayHint",n.messageDirection=Qn.MessageDirection.clientToServer,n.type=new Qn.ProtocolRequestType(n.method)})(ac||(wn.InlayHintRequest=ac={}));var cc;(function(n){n.method="inlayHint/resolve",n.messageDirection=Qn.MessageDirection.clientToServer,n.type=new Qn.ProtocolRequestType(n.method)})(cc||(wn.InlayHintResolveRequest=cc={}));var uc;(function(n){n.method="workspace/inlayHint/refresh",n.messageDirection=Qn.MessageDirection.serverToClient,n.type=new Qn.ProtocolRequestType0(n.method)})(uc||(wn.InlayHintRefreshRequest=uc={}));var Wt={};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.DiagnosticRefreshRequest=Wt.WorkspaceDiagnosticRequest=Wt.DocumentDiagnosticRequest=Wt.DocumentDiagnosticReportKind=Wt.DiagnosticServerCancellationData=void 0;const lc=Tn,Dd=Ke,Yn=Ee;var dc;(function(n){function e(t){const r=t;return r&&Dd.boolean(r.retriggerRequest)}n.is=e})(dc||(Wt.DiagnosticServerCancellationData=dc={}));var fc;(function(n){n.Full="full",n.Unchanged="unchanged"})(fc||(Wt.DocumentDiagnosticReportKind=fc={}));var hc;(function(n){n.method="textDocument/diagnostic",n.messageDirection=Yn.MessageDirection.clientToServer,n.type=new Yn.ProtocolRequestType(n.method),n.partialResult=new lc.ProgressType})(hc||(Wt.DocumentDiagnosticRequest=hc={}));var gc;(function(n){n.method="workspace/diagnostic",n.messageDirection=Yn.MessageDirection.clientToServer,n.type=new Yn.ProtocolRequestType(n.method),n.partialResult=new lc.ProgressType})(gc||(Wt.WorkspaceDiagnosticRequest=gc={}));var pc;(function(n){n.method="workspace/diagnostic/refresh",n.messageDirection=Yn.MessageDirection.serverToClient,n.type=new Yn.ProtocolRequestType0(n.method)})(pc||(Wt.DiagnosticRefreshRequest=pc={}));var ze={};Object.defineProperty(ze,"__esModule",{value:!0}),ze.DidCloseNotebookDocumentNotification=ze.DidSaveNotebookDocumentNotification=ze.DidChangeNotebookDocumentNotification=ze.NotebookCellArrayChange=ze.DidOpenNotebookDocumentNotification=ze.NotebookDocumentSyncRegistrationType=ze.NotebookDocument=ze.NotebookCell=ze.ExecutionSummary=ze.NotebookCellKind=void 0;const yr=To,Jt=Ke,nn=Ee;var Po;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(Po||(ze.NotebookCellKind=Po={}));var Eo;(function(n){function e(i,o){const s={executionOrder:i};return(o===!0||o===!1)&&(s.success=o),s}n.create=e;function t(i){const o=i;return Jt.objectLiteral(o)&&yr.uinteger.is(o.executionOrder)&&(o.success===void 0||Jt.boolean(o.success))}n.is=t;function r(i,o){return i===o?!0:i==null||o===null||o===void 0?!1:i.executionOrder===o.executionOrder&&i.success===o.success}n.equals=r})(Eo||(ze.ExecutionSummary=Eo={}));var ti;(function(n){function e(o,s){return{kind:o,document:s}}n.create=e;function t(o){const s=o;return Jt.objectLiteral(s)&&Po.is(s.kind)&&yr.DocumentUri.is(s.document)&&(s.metadata===void 0||Jt.objectLiteral(s.metadata))}n.is=t;function r(o,s){const c=new Set;return o.document!==s.document&&c.add("document"),o.kind!==s.kind&&c.add("kind"),o.executionSummary!==s.executionSummary&&c.add("executionSummary"),(o.metadata!==void 0||s.metadata!==void 0)&&!i(o.metadata,s.metadata)&&c.add("metadata"),(o.executionSummary!==void 0||s.executionSummary!==void 0)&&!Eo.equals(o.executionSummary,s.executionSummary)&&c.add("executionSummary"),c}n.diff=r;function i(o,s){if(o===s)return!0;if(o==null||s===null||s===void 0||typeof o!=typeof s||typeof o!="object")return!1;const c=Array.isArray(o),u=Array.isArray(s);if(c!==u)return!1;if(c&&u){if(o.length!==s.length)return!1;for(let d=0;d<o.length;d++)if(!i(o[d],s[d]))return!1}if(Jt.objectLiteral(o)&&Jt.objectLiteral(s)){const d=Object.keys(o),m=Object.keys(s);if(d.length!==m.length||(d.sort(),m.sort(),!i(d,m)))return!1;for(let C=0;C<d.length;C++){const _=d[C];if(!i(o[_],s[_]))return!1}}return!0}})(ti||(ze.NotebookCell=ti={}));var mc;(function(n){function e(r,i,o,s){return{uri:r,notebookType:i,version:o,cells:s}}n.create=e;function t(r){const i=r;return Jt.objectLiteral(i)&&Jt.string(i.uri)&&yr.integer.is(i.version)&&Jt.typedArray(i.cells,ti.is)}n.is=t})(mc||(ze.NotebookDocument=mc={}));var Zn;(function(n){n.method="notebookDocument/sync",n.messageDirection=nn.MessageDirection.clientToServer,n.type=new nn.RegistrationType(n.method)})(Zn||(ze.NotebookDocumentSyncRegistrationType=Zn={}));var yc;(function(n){n.method="notebookDocument/didOpen",n.messageDirection=nn.MessageDirection.clientToServer,n.type=new nn.ProtocolNotificationType(n.method),n.registrationMethod=Zn.method})(yc||(ze.DidOpenNotebookDocumentNotification=yc={}));var vc;(function(n){function e(r){const i=r;return Jt.objectLiteral(i)&&yr.uinteger.is(i.start)&&yr.uinteger.is(i.deleteCount)&&(i.cells===void 0||Jt.typedArray(i.cells,ti.is))}n.is=e;function t(r,i,o){const s={start:r,deleteCount:i};return o!==void 0&&(s.cells=o),s}n.create=t})(vc||(ze.NotebookCellArrayChange=vc={}));var Cc;(function(n){n.method="notebookDocument/didChange",n.messageDirection=nn.MessageDirection.clientToServer,n.type=new nn.ProtocolNotificationType(n.method),n.registrationMethod=Zn.method})(Cc||(ze.DidChangeNotebookDocumentNotification=Cc={}));var _c;(function(n){n.method="notebookDocument/didSave",n.messageDirection=nn.MessageDirection.clientToServer,n.type=new nn.ProtocolNotificationType(n.method),n.registrationMethod=Zn.method})(_c||(ze.DidSaveNotebookDocumentNotification=_c={}));var wc;(function(n){n.method="notebookDocument/didClose",n.messageDirection=nn.MessageDirection.clientToServer,n.type=new nn.ProtocolNotificationType(n.method),n.registrationMethod=Zn.method})(wc||(ze.DidCloseNotebookDocumentNotification=wc={}));var ni={};Object.defineProperty(ni,"__esModule",{value:!0}),ni.InlineCompletionRequest=void 0;const bc=Ee;var Dc;(function(n){n.method="textDocument/inlineCompletion",n.messageDirection=bc.MessageDirection.clientToServer,n.type=new bc.ProtocolRequestType(n.method)})(Dc||(ni.InlineCompletionRequest=Dc={})),function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.WorkspaceSymbolRequest=n.CodeActionResolveRequest=n.CodeActionRequest=n.DocumentSymbolRequest=n.DocumentHighlightRequest=n.ReferencesRequest=n.DefinitionRequest=n.SignatureHelpRequest=n.SignatureHelpTriggerKind=n.HoverRequest=n.CompletionResolveRequest=n.CompletionRequest=n.CompletionTriggerKind=n.PublishDiagnosticsNotification=n.WatchKind=n.RelativePattern=n.FileChangeType=n.DidChangeWatchedFilesNotification=n.WillSaveTextDocumentWaitUntilRequest=n.WillSaveTextDocumentNotification=n.TextDocumentSaveReason=n.DidSaveTextDocumentNotification=n.DidCloseTextDocumentNotification=n.DidChangeTextDocumentNotification=n.TextDocumentContentChangeEvent=n.DidOpenTextDocumentNotification=n.TextDocumentSyncKind=n.TelemetryEventNotification=n.LogMessageNotification=n.ShowMessageRequest=n.ShowMessageNotification=n.MessageType=n.DidChangeConfigurationNotification=n.ExitNotification=n.ShutdownRequest=n.InitializedNotification=n.InitializeErrorCodes=n.InitializeRequest=n.WorkDoneProgressOptions=n.TextDocumentRegistrationOptions=n.StaticRegistrationOptions=n.PositionEncodingKind=n.FailureHandlingKind=n.ResourceOperationKind=n.UnregistrationRequest=n.RegistrationRequest=n.DocumentSelector=n.NotebookCellTextDocumentFilter=n.NotebookDocumentFilter=n.TextDocumentFilter=void 0,n.MonikerRequest=n.MonikerKind=n.UniquenessLevel=n.WillDeleteFilesRequest=n.DidDeleteFilesNotification=n.WillRenameFilesRequest=n.DidRenameFilesNotification=n.WillCreateFilesRequest=n.DidCreateFilesNotification=n.FileOperationPatternKind=n.LinkedEditingRangeRequest=n.ShowDocumentRequest=n.SemanticTokensRegistrationType=n.SemanticTokensRefreshRequest=n.SemanticTokensRangeRequest=n.SemanticTokensDeltaRequest=n.SemanticTokensRequest=n.TokenFormat=n.CallHierarchyPrepareRequest=n.CallHierarchyOutgoingCallsRequest=n.CallHierarchyIncomingCallsRequest=n.WorkDoneProgressCancelNotification=n.WorkDoneProgressCreateRequest=n.WorkDoneProgress=n.SelectionRangeRequest=n.DeclarationRequest=n.FoldingRangeRefreshRequest=n.FoldingRangeRequest=n.ColorPresentationRequest=n.DocumentColorRequest=n.ConfigurationRequest=n.DidChangeWorkspaceFoldersNotification=n.WorkspaceFoldersRequest=n.TypeDefinitionRequest=n.ImplementationRequest=n.ApplyWorkspaceEditRequest=n.ExecuteCommandRequest=n.PrepareRenameRequest=n.RenameRequest=n.PrepareSupportDefaultBehavior=n.DocumentOnTypeFormattingRequest=n.DocumentRangesFormattingRequest=n.DocumentRangeFormattingRequest=n.DocumentFormattingRequest=n.DocumentLinkResolveRequest=n.DocumentLinkRequest=n.CodeLensRefreshRequest=n.CodeLensResolveRequest=n.CodeLensRequest=n.WorkspaceSymbolResolveRequest=void 0,n.InlineCompletionRequest=n.DidCloseNotebookDocumentNotification=n.DidSaveNotebookDocumentNotification=n.DidChangeNotebookDocumentNotification=n.NotebookCellArrayChange=n.DidOpenNotebookDocumentNotification=n.NotebookDocumentSyncRegistrationType=n.NotebookDocument=n.NotebookCell=n.ExecutionSummary=n.NotebookCellKind=n.DiagnosticRefreshRequest=n.WorkspaceDiagnosticRequest=n.DocumentDiagnosticRequest=n.DocumentDiagnosticReportKind=n.DiagnosticServerCancellationData=n.InlayHintRefreshRequest=n.InlayHintResolveRequest=n.InlayHintRequest=n.InlineValueRefreshRequest=n.InlineValueRequest=n.TypeHierarchySupertypesRequest=n.TypeHierarchySubtypesRequest=n.TypeHierarchyPrepareRequest=void 0;const e=Ee,t=To,r=Ke,i=Ur;Object.defineProperty(n,"ImplementationRequest",{enumerable:!0,get:function(){return i.ImplementationRequest}});const o=Kr;Object.defineProperty(n,"TypeDefinitionRequest",{enumerable:!0,get:function(){return o.TypeDefinitionRequest}});const s=zn;Object.defineProperty(n,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return s.WorkspaceFoldersRequest}}),Object.defineProperty(n,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return s.DidChangeWorkspaceFoldersNotification}});const c=Gr;Object.defineProperty(n,"ConfigurationRequest",{enumerable:!0,get:function(){return c.ConfigurationRequest}});const u=Gn;Object.defineProperty(n,"DocumentColorRequest",{enumerable:!0,get:function(){return u.DocumentColorRequest}}),Object.defineProperty(n,"ColorPresentationRequest",{enumerable:!0,get:function(){return u.ColorPresentationRequest}});const d=Bn;Object.defineProperty(n,"FoldingRangeRequest",{enumerable:!0,get:function(){return d.FoldingRangeRequest}}),Object.defineProperty(n,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return d.FoldingRangeRefreshRequest}});const m=Xr;Object.defineProperty(n,"DeclarationRequest",{enumerable:!0,get:function(){return m.DeclarationRequest}});const C=Jr;Object.defineProperty(n,"SelectionRangeRequest",{enumerable:!0,get:function(){return C.SelectionRangeRequest}});const _=yn;Object.defineProperty(n,"WorkDoneProgress",{enumerable:!0,get:function(){return _.WorkDoneProgress}}),Object.defineProperty(n,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return _.WorkDoneProgressCreateRequest}}),Object.defineProperty(n,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return _.WorkDoneProgressCancelNotification}});const S=vn;Object.defineProperty(n,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return S.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(n,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return S.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(n,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return S.CallHierarchyPrepareRequest}});const y=wt;Object.defineProperty(n,"TokenFormat",{enumerable:!0,get:function(){return y.TokenFormat}}),Object.defineProperty(n,"SemanticTokensRequest",{enumerable:!0,get:function(){return y.SemanticTokensRequest}}),Object.defineProperty(n,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return y.SemanticTokensDeltaRequest}}),Object.defineProperty(n,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return y.SemanticTokensRangeRequest}}),Object.defineProperty(n,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return y.SemanticTokensRefreshRequest}}),Object.defineProperty(n,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return y.SemanticTokensRegistrationType}});const O=Yr;Object.defineProperty(n,"ShowDocumentRequest",{enumerable:!0,get:function(){return O.ShowDocumentRequest}});const M=Zr;Object.defineProperty(n,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return M.LinkedEditingRangeRequest}});const V=ft;Object.defineProperty(n,"FileOperationPatternKind",{enumerable:!0,get:function(){return V.FileOperationPatternKind}}),Object.defineProperty(n,"DidCreateFilesNotification",{enumerable:!0,get:function(){return V.DidCreateFilesNotification}}),Object.defineProperty(n,"WillCreateFilesRequest",{enumerable:!0,get:function(){return V.WillCreateFilesRequest}}),Object.defineProperty(n,"DidRenameFilesNotification",{enumerable:!0,get:function(){return V.DidRenameFilesNotification}}),Object.defineProperty(n,"WillRenameFilesRequest",{enumerable:!0,get:function(){return V.WillRenameFilesRequest}}),Object.defineProperty(n,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return V.DidDeleteFilesNotification}}),Object.defineProperty(n,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return V.WillDeleteFilesRequest}});const oe=Cn;Object.defineProperty(n,"UniquenessLevel",{enumerable:!0,get:function(){return oe.UniquenessLevel}}),Object.defineProperty(n,"MonikerKind",{enumerable:!0,get:function(){return oe.MonikerKind}}),Object.defineProperty(n,"MonikerRequest",{enumerable:!0,get:function(){return oe.MonikerRequest}});const te=_n;Object.defineProperty(n,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return te.TypeHierarchyPrepareRequest}}),Object.defineProperty(n,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return te.TypeHierarchySubtypesRequest}}),Object.defineProperty(n,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return te.TypeHierarchySupertypesRequest}});const Te=Jn;Object.defineProperty(n,"InlineValueRequest",{enumerable:!0,get:function(){return Te.InlineValueRequest}}),Object.defineProperty(n,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return Te.InlineValueRefreshRequest}});const fe=wn;Object.defineProperty(n,"InlayHintRequest",{enumerable:!0,get:function(){return fe.InlayHintRequest}}),Object.defineProperty(n,"InlayHintResolveRequest",{enumerable:!0,get:function(){return fe.InlayHintResolveRequest}}),Object.defineProperty(n,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return fe.InlayHintRefreshRequest}});const le=Wt;Object.defineProperty(n,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return le.DiagnosticServerCancellationData}}),Object.defineProperty(n,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return le.DocumentDiagnosticReportKind}}),Object.defineProperty(n,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return le.DocumentDiagnosticRequest}}),Object.defineProperty(n,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return le.WorkspaceDiagnosticRequest}}),Object.defineProperty(n,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return le.DiagnosticRefreshRequest}});const x=ze;Object.defineProperty(n,"NotebookCellKind",{enumerable:!0,get:function(){return x.NotebookCellKind}}),Object.defineProperty(n,"ExecutionSummary",{enumerable:!0,get:function(){return x.ExecutionSummary}}),Object.defineProperty(n,"NotebookCell",{enumerable:!0,get:function(){return x.NotebookCell}}),Object.defineProperty(n,"NotebookDocument",{enumerable:!0,get:function(){return x.NotebookDocument}}),Object.defineProperty(n,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return x.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(n,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return x.DidOpenNotebookDocumentNotification}}),Object.defineProperty(n,"NotebookCellArrayChange",{enumerable:!0,get:function(){return x.NotebookCellArrayChange}}),Object.defineProperty(n,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return x.DidChangeNotebookDocumentNotification}}),Object.defineProperty(n,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return x.DidSaveNotebookDocumentNotification}}),Object.defineProperty(n,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return x.DidCloseNotebookDocumentNotification}});const N=ni;Object.defineProperty(n,"InlineCompletionRequest",{enumerable:!0,get:function(){return N.InlineCompletionRequest}});var A;(function(l){function v(f){const D=f;return r.string(D)||r.string(D.language)||r.string(D.scheme)||r.string(D.pattern)}l.is=v})(A||(n.TextDocumentFilter=A={}));var ee;(function(l){function v(f){const D=f;return r.objectLiteral(D)&&(r.string(D.notebookType)||r.string(D.scheme)||r.string(D.pattern))}l.is=v})(ee||(n.NotebookDocumentFilter=ee={}));var U;(function(l){function v(f){const D=f;return r.objectLiteral(D)&&(r.string(D.notebook)||ee.is(D.notebook))&&(D.language===void 0||r.string(D.language))}l.is=v})(U||(n.NotebookCellTextDocumentFilter=U={}));var W;(function(l){function v(f){if(!Array.isArray(f))return!1;for(let D of f)if(!r.string(D)&&!A.is(D)&&!U.is(D))return!1;return!0}l.is=v})(W||(n.DocumentSelector=W={}));var R;(function(l){l.method="client/registerCapability",l.messageDirection=e.MessageDirection.serverToClient,l.type=new e.ProtocolRequestType(l.method)})(R||(n.RegistrationRequest=R={}));var k;(function(l){l.method="client/unregisterCapability",l.messageDirection=e.MessageDirection.serverToClient,l.type=new e.ProtocolRequestType(l.method)})(k||(n.UnregistrationRequest=k={}));var P;(function(l){l.Create="create",l.Rename="rename",l.Delete="delete"})(P||(n.ResourceOperationKind=P={}));var q;(function(l){l.Abort="abort",l.Transactional="transactional",l.TextOnlyTransactional="textOnlyTransactional",l.Undo="undo"})(q||(n.FailureHandlingKind=q={}));var $;(function(l){l.UTF8="utf-8",l.UTF16="utf-16",l.UTF32="utf-32"})($||(n.PositionEncodingKind=$={}));var j;(function(l){function v(f){const D=f;return D&&r.string(D.id)&&D.id.length>0}l.hasId=v})(j||(n.StaticRegistrationOptions=j={}));var L;(function(l){function v(f){const D=f;return D&&(D.documentSelector===null||W.is(D.documentSelector))}l.is=v})(L||(n.TextDocumentRegistrationOptions=L={}));var X;(function(l){function v(D){const p=D;return r.objectLiteral(p)&&(p.workDoneProgress===void 0||r.boolean(p.workDoneProgress))}l.is=v;function f(D){const p=D;return p&&r.boolean(p.workDoneProgress)}l.hasWorkDoneProgress=f})(X||(n.WorkDoneProgressOptions=X={}));var Z;(function(l){l.method="initialize",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(Z||(n.InitializeRequest=Z={}));var J;(function(l){l.unknownProtocolVersion=1})(J||(n.InitializeErrorCodes=J={}));var ne;(function(l){l.method="initialized",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolNotificationType(l.method)})(ne||(n.InitializedNotification=ne={}));var re;(function(l){l.method="shutdown",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType0(l.method)})(re||(n.ShutdownRequest=re={}));var G;(function(l){l.method="exit",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolNotificationType0(l.method)})(G||(n.ExitNotification=G={}));var ie;(function(l){l.method="workspace/didChangeConfiguration",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolNotificationType(l.method)})(ie||(n.DidChangeConfigurationNotification=ie={}));var se;(function(l){l.Error=1,l.Warning=2,l.Info=3,l.Log=4,l.Debug=5})(se||(n.MessageType=se={}));var Ye;(function(l){l.method="window/showMessage",l.messageDirection=e.MessageDirection.serverToClient,l.type=new e.ProtocolNotificationType(l.method)})(Ye||(n.ShowMessageNotification=Ye={}));var Be;(function(l){l.method="window/showMessageRequest",l.messageDirection=e.MessageDirection.serverToClient,l.type=new e.ProtocolRequestType(l.method)})(Be||(n.ShowMessageRequest=Be={}));var ot;(function(l){l.method="window/logMessage",l.messageDirection=e.MessageDirection.serverToClient,l.type=new e.ProtocolNotificationType(l.method)})(ot||(n.LogMessageNotification=ot={}));var Ze;(function(l){l.method="telemetry/event",l.messageDirection=e.MessageDirection.serverToClient,l.type=new e.ProtocolNotificationType(l.method)})(Ze||(n.TelemetryEventNotification=Ze={}));var ve;(function(l){l.None=0,l.Full=1,l.Incremental=2})(ve||(n.TextDocumentSyncKind=ve={}));var Ve;(function(l){l.method="textDocument/didOpen",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolNotificationType(l.method)})(Ve||(n.DidOpenTextDocumentNotification=Ve={}));var qe;(function(l){function v(D){let p=D;return p!=null&&typeof p.text=="string"&&p.range!==void 0&&(p.rangeLength===void 0||typeof p.rangeLength=="number")}l.isIncremental=v;function f(D){let p=D;return p!=null&&typeof p.text=="string"&&p.range===void 0&&p.rangeLength===void 0}l.isFull=f})(qe||(n.TextDocumentContentChangeEvent=qe={}));var et;(function(l){l.method="textDocument/didChange",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolNotificationType(l.method)})(et||(n.DidChangeTextDocumentNotification=et={}));var St;(function(l){l.method="textDocument/didClose",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolNotificationType(l.method)})(St||(n.DidCloseTextDocumentNotification=St={}));var yt;(function(l){l.method="textDocument/didSave",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolNotificationType(l.method)})(yt||(n.DidSaveTextDocumentNotification=yt={}));var vt;(function(l){l.Manual=1,l.AfterDelay=2,l.FocusOut=3})(vt||(n.TextDocumentSaveReason=vt={}));var Xe;(function(l){l.method="textDocument/willSave",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolNotificationType(l.method)})(Xe||(n.WillSaveTextDocumentNotification=Xe={}));var ut;(function(l){l.method="textDocument/willSaveWaitUntil",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(ut||(n.WillSaveTextDocumentWaitUntilRequest=ut={}));var Ae;(function(l){l.method="workspace/didChangeWatchedFiles",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolNotificationType(l.method)})(Ae||(n.DidChangeWatchedFilesNotification=Ae={}));var st;(function(l){l.Created=1,l.Changed=2,l.Deleted=3})(st||(n.FileChangeType=st={}));var Gt;(function(l){function v(f){const D=f;return r.objectLiteral(D)&&(t.URI.is(D.baseUri)||t.WorkspaceFolder.is(D.baseUri))&&r.string(D.pattern)}l.is=v})(Gt||(n.RelativePattern=Gt={}));var It;(function(l){l.Create=1,l.Change=2,l.Delete=4})(It||(n.WatchKind=It={}));var Rt;(function(l){l.method="textDocument/publishDiagnostics",l.messageDirection=e.MessageDirection.serverToClient,l.type=new e.ProtocolNotificationType(l.method)})(Rt||(n.PublishDiagnosticsNotification=Rt={}));var Ot;(function(l){l.Invoked=1,l.TriggerCharacter=2,l.TriggerForIncompleteCompletions=3})(Ot||(n.CompletionTriggerKind=Ot={}));var Nt;(function(l){l.method="textDocument/completion",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(Nt||(n.CompletionRequest=Nt={}));var Ct;(function(l){l.method="completionItem/resolve",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(Ct||(n.CompletionResolveRequest=Ct={}));var at;(function(l){l.method="textDocument/hover",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(at||(n.HoverRequest=at={}));var Tt;(function(l){l.Invoked=1,l.TriggerCharacter=2,l.ContentChange=3})(Tt||(n.SignatureHelpTriggerKind=Tt={}));var Bt;(function(l){l.method="textDocument/signatureHelp",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(Bt||(n.SignatureHelpRequest=Bt={}));var ct;(function(l){l.method="textDocument/definition",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(ct||(n.DefinitionRequest=ct={}));var Pt;(function(l){l.method="textDocument/references",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(Pt||(n.ReferencesRequest=Pt={}));var qt;(function(l){l.method="textDocument/documentHighlight",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(qt||(n.DocumentHighlightRequest=qt={}));var $t;(function(l){l.method="textDocument/documentSymbol",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})($t||(n.DocumentSymbolRequest=$t={}));var Vt;(function(l){l.method="textDocument/codeAction",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(Vt||(n.CodeActionRequest=Vt={}));var Mt;(function(l){l.method="codeAction/resolve",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(Mt||(n.CodeActionResolveRequest=Mt={}));var Lt;(function(l){l.method="workspace/symbol",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(Lt||(n.WorkspaceSymbolRequest=Lt={}));var At;(function(l){l.method="workspaceSymbol/resolve",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(At||(n.WorkspaceSymbolResolveRequest=At={}));var _t;(function(l){l.method="textDocument/codeLens",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(_t||(n.CodeLensRequest=_t={}));var rt;(function(l){l.method="codeLens/resolve",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(rt||(n.CodeLensResolveRequest=rt={}));var jt;(function(l){l.method="workspace/codeLens/refresh",l.messageDirection=e.MessageDirection.serverToClient,l.type=new e.ProtocolRequestType0(l.method)})(jt||(n.CodeLensRefreshRequest=jt={}));var Xt;(function(l){l.method="textDocument/documentLink",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(Xt||(n.DocumentLinkRequest=Xt={}));var lt;(function(l){l.method="documentLink/resolve",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(lt||(n.DocumentLinkResolveRequest=lt={}));var h;(function(l){l.method="textDocument/formatting",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(h||(n.DocumentFormattingRequest=h={}));var F;(function(l){l.method="textDocument/rangeFormatting",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(F||(n.DocumentRangeFormattingRequest=F={}));var Y;(function(l){l.method="textDocument/rangesFormatting",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(Y||(n.DocumentRangesFormattingRequest=Y={}));var pe;(function(l){l.method="textDocument/onTypeFormatting",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(pe||(n.DocumentOnTypeFormattingRequest=pe={}));var Ce;(function(l){l.Identifier=1})(Ce||(n.PrepareSupportDefaultBehavior=Ce={}));var He;(function(l){l.method="textDocument/rename",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(He||(n.RenameRequest=He={}));var T;(function(l){l.method="textDocument/prepareRename",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(T||(n.PrepareRenameRequest=T={}));var g;(function(l){l.method="workspace/executeCommand",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method)})(g||(n.ExecuteCommandRequest=g={}));var b;(function(l){l.method="workspace/applyEdit",l.messageDirection=e.MessageDirection.serverToClient,l.type=new e.ProtocolRequestType("workspace/applyEdit")})(b||(n.ApplyWorkspaceEditRequest=b={}))}(da);var ri={};Object.defineProperty(ri,"__esModule",{value:!0}),ri.createProtocolConnection=void 0;const Sc=Tn;function Sd(n,e,t,r){return Sc.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Sc.createMessageConnection)(n,e,t,r)}ri.createProtocolConnection=Sd,function(n){var e=Me.commonjsGlobal&&Me.commonjsGlobal.__createBinding||(Object.create?function(o,s,c,u){u===void 0&&(u=c);var d=Object.getOwnPropertyDescriptor(s,c);(!d||("get"in d?!s.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return s[c]}}),Object.defineProperty(o,u,d)}:function(o,s,c,u){u===void 0&&(u=c),o[u]=s[c]}),t=Me.commonjsGlobal&&Me.commonjsGlobal.__exportStar||function(o,s){for(var c in o)c!=="default"&&!Object.prototype.hasOwnProperty.call(s,c)&&e(s,o,c)};Object.defineProperty(n,"__esModule",{value:!0}),n.LSPErrorCodes=n.createProtocolConnection=void 0,t(Tn,n),t(To,n),t(Ee,n),t(da,n);var r=ri;Object.defineProperty(n,"createProtocolConnection",{enumerable:!0,get:function(){return r.createProtocolConnection}});var i;(function(o){o.lspReservedErrorRangeStart=-32899,o.RequestFailed=-32803,o.ServerCancelled=-32802,o.ContentModified=-32801,o.RequestCancelled=-32800,o.lspReservedErrorRangeEnd=-32800})(i||(n.LSPErrorCodes=i={}))}(ua),function(n){var e=Me.commonjsGlobal&&Me.commonjsGlobal.__createBinding||(Object.create?function(o,s,c,u){u===void 0&&(u=c);var d=Object.getOwnPropertyDescriptor(s,c);(!d||("get"in d?!s.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return s[c]}}),Object.defineProperty(o,u,d)}:function(o,s,c,u){u===void 0&&(u=c),o[u]=s[c]}),t=Me.commonjsGlobal&&Me.commonjsGlobal.__exportStar||function(o,s){for(var c in o)c!=="default"&&!Object.prototype.hasOwnProperty.call(s,c)&&e(s,o,c)};Object.defineProperty(n,"__esModule",{value:!0}),n.createProtocolConnection=void 0;const r=ca;t(ca,n),t(ua,n);function i(o,s,c,u){return(0,r.createMessageConnection)(o,s,c,u)}n.createProtocolConnection=i}(he);var ii={},it={};Object.defineProperty(it,"__esModule",{value:!0}),it.forEach=it.mapAsync=it.map=it.clearTestMode=it.setTestMode=it.Semaphore=it.Delayer=void 0;const vr=he;class Rd{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,vr.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}}it.Delayer=Rd;class Td{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,vr.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}it.Semaphore=Td;let ko=!1;function Pd(){ko=!0}it.setTestMode=Pd;function Ed(){ko=!1}it.clearTestMode=Ed;const Rc=15;class Fo{constructor(e=Rc){this.yieldAfter=ko===!0?Math.max(e,2):Math.max(e,Rc),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){const e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}}async function kd(n,e,t,r){if(n.length===0)return[];const i=new Array(n.length),o=new Fo(r?.yieldAfter);function s(u){o.start();for(let d=u;d<n.length;d++)if(i[d]=e(n[d]),o.shouldYield())return r?.yieldCallback&&r.yieldCallback(),d+1;return-1}let c=s(0);for(;c!==-1&&!(t!==void 0&&t.isCancellationRequested);)c=await new Promise(u=>{(0,vr.RAL)().timer.setImmediate(()=>{u(s(c))})});return i}it.map=kd;async function Fd(n,e,t,r){if(n.length===0)return[];const i=new Array(n.length),o=new Fo(r?.yieldAfter);async function s(u){o.start();for(let d=u;d<n.length;d++)if(i[d]=await e(n[d],t),o.shouldYield())return r?.yieldCallback&&r.yieldCallback(),d+1;return-1}let c=await s(0);for(;c!==-1&&!(t!==void 0&&t.isCancellationRequested);)c=await new Promise(u=>{(0,vr.RAL)().timer.setImmediate(()=>{u(s(c))})});return i}it.mapAsync=Fd;async function Id(n,e,t,r){if(n.length===0)return;const i=new Fo(r?.yieldAfter);function o(c){i.start();for(let u=c;u<n.length;u++)if(e(n[u]),i.shouldYield())return r?.yieldCallback&&r.yieldCallback(),u+1;return-1}let s=o(0);for(;s!==-1&&!(t!==void 0&&t.isCancellationRequested);)s=await new Promise(c=>{(0,vr.RAL)().timer.setImmediate(()=>{c(o(s))})})}it.forEach=Id;var oi={};Object.defineProperty(oi,"__esModule",{value:!0});const Od=ce;class Nd extends Od.CompletionItem{constructor(e){super(e)}}oi.default=Nd;var si={};Object.defineProperty(si,"__esModule",{value:!0});const qd=ce;class $d extends qd.CodeLens{constructor(e){super(e)}}si.default=$d;var ai={};Object.defineProperty(ai,"__esModule",{value:!0});const Md=ce;class Ld extends Md.DocumentLink{constructor(e,t){super(e,t)}}ai.default=Ld;var ci={};Object.defineProperty(ci,"__esModule",{value:!0});const Ad=ce;class jd extends Ad.CodeAction{constructor(e,t){super(e),this.data=t}}ci.default=jd;var En={};Object.defineProperty(En,"__esModule",{value:!0}),En.ProtocolDiagnostic=En.DiagnosticCode=void 0;const xd=ce,Io=$e;var Tc;(function(n){function e(t){const r=t;return r!=null&&(Io.number(r.value)||Io.string(r.value))&&Io.string(r.target)}n.is=e})(Tc||(En.DiagnosticCode=Tc={}));class Hd extends xd.Diagnostic{constructor(e,t,r,i){super(e,t,r),this.data=i,this.hasDiagnosticCode=!1}}En.ProtocolDiagnostic=Hd;var ui={};Object.defineProperty(ui,"__esModule",{value:!0});const Wd=ce;class Ud extends Wd.CallHierarchyItem{constructor(e,t,r,i,o,s,c){super(e,t,r,i,o,s),c!==void 0&&(this.data=c)}}ui.default=Ud;var li={};Object.defineProperty(li,"__esModule",{value:!0});const Kd=ce;class zd extends Kd.TypeHierarchyItem{constructor(e,t,r,i,o,s,c){super(e,t,r,i,o,s),c!==void 0&&(this.data=c)}}li.default=zd;var di={};Object.defineProperty(di,"__esModule",{value:!0});const fi=ce;class Gd extends fi.SymbolInformation{constructor(e,t,r,i,o){const s=!(i instanceof fi.Uri);super(e,t,r,s?i:new fi.Location(i,new fi.Range(0,0,0,0))),this.hasRange=s,o!==void 0&&(this.data=o)}}di.default=Gd;var hi={};Object.defineProperty(hi,"__esModule",{value:!0});const Bd=ce;class Vd extends Bd.InlayHint{constructor(e,t,r){super(e,t,r)}}hi.default=Vd,Object.defineProperty(ii,"__esModule",{value:!0}),ii.createConverter=void 0;const Qe=ce,ge=he,kn=$e,Pc=it,Xd=oi,Jd=si,Qd=ai,Ec=ci,kc=En,Yd=ui,Zd=li,ef=di,tf=hi;var Oo;(function(n){function e(t){const r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(Oo||(Oo={}));function nf(n){const t=n||(h=>h.toString());function r(h){return t(h)}function i(h){return{uri:t(h.uri)}}function o(h){return{uri:t(h.uri),languageId:h.languageId,version:h.version,text:h.getText()}}function s(h){return{uri:t(h.uri),version:h.version}}function c(h){return{textDocument:o(h)}}function u(h){const F=h;return!!F.document&&!!F.contentChanges}function d(h){const F=h;return!!F.uri&&!!F.version}function m(h,F,Y){if(d(h))return{textDocument:{uri:t(h.uri),version:h.version},contentChanges:[{text:h.getText()}]};if(u(h)){const pe=F,Ce=Y;return{textDocument:{uri:t(pe),version:Ce},contentChanges:h.contentChanges.map(T=>{const g=T.range;return{range:{start:{line:g.start.line,character:g.start.character},end:{line:g.end.line,character:g.end.character}},rangeLength:T.rangeLength,text:T.text}})}}else throw Error("Unsupported text document change parameter")}function C(h){return{textDocument:i(h)}}function _(h,F=!1){let Y={textDocument:i(h)};return F&&(Y.text=h.getText()),Y}function S(h){switch(h){case Qe.TextDocumentSaveReason.Manual:return ge.TextDocumentSaveReason.Manual;case Qe.TextDocumentSaveReason.AfterDelay:return ge.TextDocumentSaveReason.AfterDelay;case Qe.TextDocumentSaveReason.FocusOut:return ge.TextDocumentSaveReason.FocusOut}return ge.TextDocumentSaveReason.Manual}function y(h){return{textDocument:i(h.document),reason:S(h.reason)}}function O(h){return{files:h.files.map(F=>({uri:t(F)}))}}function M(h){return{files:h.files.map(F=>({oldUri:t(F.oldUri),newUri:t(F.newUri)}))}}function V(h){return{files:h.files.map(F=>({uri:t(F)}))}}function oe(h){return{files:h.files.map(F=>({uri:t(F)}))}}function te(h){return{files:h.files.map(F=>({oldUri:t(F.oldUri),newUri:t(F.newUri)}))}}function Te(h){return{files:h.files.map(F=>({uri:t(F)}))}}function fe(h,F){return{textDocument:i(h),position:P(F)}}function le(h){switch(h){case Qe.CompletionTriggerKind.TriggerCharacter:return ge.CompletionTriggerKind.TriggerCharacter;case Qe.CompletionTriggerKind.TriggerForIncompleteCompletions:return ge.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return ge.CompletionTriggerKind.Invoked}}function x(h,F,Y){return{textDocument:i(h),position:P(F),context:{triggerKind:le(Y.triggerKind),triggerCharacter:Y.triggerCharacter}}}function N(h){switch(h){case Qe.SignatureHelpTriggerKind.Invoke:return ge.SignatureHelpTriggerKind.Invoked;case Qe.SignatureHelpTriggerKind.TriggerCharacter:return ge.SignatureHelpTriggerKind.TriggerCharacter;case Qe.SignatureHelpTriggerKind.ContentChange:return ge.SignatureHelpTriggerKind.ContentChange}}function A(h){return{label:h.label}}function ee(h){return h.map(A)}function U(h){return{label:h.label,parameters:ee(h.parameters)}}function W(h){return h.map(U)}function R(h){return h===void 0?h:{signatures:W(h.signatures),activeSignature:h.activeSignature,activeParameter:h.activeParameter}}function k(h,F,Y){return{textDocument:i(h),position:P(F),context:{isRetrigger:Y.isRetrigger,triggerCharacter:Y.triggerCharacter,triggerKind:N(Y.triggerKind),activeSignatureHelp:R(Y.activeSignatureHelp)}}}function P(h){return{line:h.line,character:h.character}}function q(h){return h==null?h:{line:h.line>ge.uinteger.MAX_VALUE?ge.uinteger.MAX_VALUE:h.line,character:h.character>ge.uinteger.MAX_VALUE?ge.uinteger.MAX_VALUE:h.character}}function $(h,F){return Pc.map(h,q,F)}function j(h){return h.map(q)}function L(h){return h==null?h:{start:q(h.start),end:q(h.end)}}function X(h){return h.map(L)}function Z(h){return h==null?h:ge.Location.create(r(h.uri),L(h.range))}function J(h){switch(h){case Qe.DiagnosticSeverity.Error:return ge.DiagnosticSeverity.Error;case Qe.DiagnosticSeverity.Warning:return ge.DiagnosticSeverity.Warning;case Qe.DiagnosticSeverity.Information:return ge.DiagnosticSeverity.Information;case Qe.DiagnosticSeverity.Hint:return ge.DiagnosticSeverity.Hint}}function ne(h){if(!h)return;let F=[];for(let Y of h){let pe=re(Y);pe!==void 0&&F.push(pe)}return F.length>0?F:void 0}function re(h){switch(h){case Qe.DiagnosticTag.Unnecessary:return ge.DiagnosticTag.Unnecessary;case Qe.DiagnosticTag.Deprecated:return ge.DiagnosticTag.Deprecated;default:return}}function G(h){return{message:h.message,location:Z(h.location)}}function ie(h){return h.map(G)}function se(h){if(h!=null)return kn.number(h)||kn.string(h)?h:{value:h.value,target:r(h.target)}}function Ye(h){const F=ge.Diagnostic.create(L(h.range),h.message),Y=h instanceof kc.ProtocolDiagnostic?h:void 0;Y!==void 0&&Y.data!==void 0&&(F.data=Y.data);const pe=se(h.code);return kc.DiagnosticCode.is(pe)?Y!==void 0&&Y.hasDiagnosticCode?F.code=pe:(F.code=pe.value,F.codeDescription={href:pe.target}):F.code=pe,kn.number(h.severity)&&(F.severity=J(h.severity)),Array.isArray(h.tags)&&(F.tags=ne(h.tags)),h.relatedInformation&&(F.relatedInformation=ie(h.relatedInformation)),h.source&&(F.source=h.source),F}function Be(h,F){return h==null?h:Pc.map(h,Ye,F)}function ot(h){return h==null?h:h.map(Ye)}function Ze(h,F){switch(h){case"$string":return F;case ge.MarkupKind.PlainText:return{kind:h,value:F};case ge.MarkupKind.Markdown:return{kind:h,value:F.value};default:return`Unsupported Markup content received. Kind is: ${h}`}}function ve(h){switch(h){case Qe.CompletionItemTag.Deprecated:return ge.CompletionItemTag.Deprecated}}function Ve(h){if(h===void 0)return h;const F=[];for(let Y of h){const pe=ve(Y);pe!==void 0&&F.push(pe)}return F}function qe(h,F){return F!==void 0?F:h+1}function et(h,F=!1){let Y,pe;kn.string(h.label)?Y=h.label:(Y=h.label.label,F&&(h.label.detail!==void 0||h.label.description!==void 0)&&(pe={detail:h.label.detail,description:h.label.description}));let Ce={label:Y};pe!==void 0&&(Ce.labelDetails=pe);let He=h instanceof Xd.default?h:void 0;h.detail&&(Ce.detail=h.detail),h.documentation&&(!He||He.documentationFormat==="$string"?Ce.documentation=h.documentation:Ce.documentation=Ze(He.documentationFormat,h.documentation)),h.filterText&&(Ce.filterText=h.filterText),St(Ce,h),kn.number(h.kind)&&(Ce.kind=qe(h.kind,He&&He.originalItemKind)),h.sortText&&(Ce.sortText=h.sortText),h.additionalTextEdits&&(Ce.additionalTextEdits=Xe(h.additionalTextEdits)),h.commitCharacters&&(Ce.commitCharacters=h.commitCharacters.slice()),h.command&&(Ce.command=ct(h.command)),(h.preselect===!0||h.preselect===!1)&&(Ce.preselect=h.preselect);const T=Ve(h.tags);if(He){if(He.data!==void 0&&(Ce.data=He.data),He.deprecated===!0||He.deprecated===!1){if(He.deprecated===!0&&T!==void 0&&T.length>0){const g=T.indexOf(Qe.CompletionItemTag.Deprecated);g!==-1&&T.splice(g,1)}Ce.deprecated=He.deprecated}He.insertTextMode!==void 0&&(Ce.insertTextMode=He.insertTextMode)}return T!==void 0&&T.length>0&&(Ce.tags=T),Ce.insertTextMode===void 0&&h.keepWhitespace===!0&&(Ce.insertTextMode=ge.InsertTextMode.adjustIndentation),Ce}function St(h,F){let Y=ge.InsertTextFormat.PlainText,pe,Ce;F.textEdit?(pe=F.textEdit.newText,Ce=F.textEdit.range):F.insertText instanceof Qe.SnippetString?(Y=ge.InsertTextFormat.Snippet,pe=F.insertText.value):pe=F.insertText,F.range&&(Ce=F.range),h.insertTextFormat=Y,F.fromEdit&&pe!==void 0&&Ce!==void 0?h.textEdit=yt(pe,Ce):h.insertText=pe}function yt(h,F){return Oo.is(F)?ge.InsertReplaceEdit.create(h,L(F.inserting),L(F.replacing)):{newText:h,range:L(F)}}function vt(h){return{range:L(h.range),newText:h.newText}}function Xe(h){return h==null?h:h.map(vt)}function ut(h){return h<=Qe.SymbolKind.TypeParameter?h+1:ge.SymbolKind.Property}function Ae(h){return h}function st(h){return h.map(Ae)}function Gt(h,F,Y){return{textDocument:i(h),position:P(F),context:{includeDeclaration:Y.includeDeclaration}}}async function It(h,F){let Y=ge.CodeAction.create(h.title);if(h instanceof Ec.default&&h.data!==void 0&&(Y.data=h.data),h.kind!==void 0&&(Y.kind=at(h.kind)),h.diagnostics!==void 0&&(Y.diagnostics=await Be(h.diagnostics,F)),h.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return h.command!==void 0&&(Y.command=ct(h.command)),h.isPreferred!==void 0&&(Y.isPreferred=h.isPreferred),h.disabled!==void 0&&(Y.disabled={reason:h.disabled.reason}),Y}function Rt(h){let F=ge.CodeAction.create(h.title);if(h instanceof Ec.default&&h.data!==void 0&&(F.data=h.data),h.kind!==void 0&&(F.kind=at(h.kind)),h.diagnostics!==void 0&&(F.diagnostics=ot(h.diagnostics)),h.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return h.command!==void 0&&(F.command=ct(h.command)),h.isPreferred!==void 0&&(F.isPreferred=h.isPreferred),h.disabled!==void 0&&(F.disabled={reason:h.disabled.reason}),F}async function Ot(h,F){if(h==null)return h;let Y;return h.only&&kn.string(h.only.value)&&(Y=[h.only.value]),ge.CodeActionContext.create(await Be(h.diagnostics,F),Y,Ct(h.triggerKind))}function Nt(h){if(h==null)return h;let F;return h.only&&kn.string(h.only.value)&&(F=[h.only.value]),ge.CodeActionContext.create(ot(h.diagnostics),F,Ct(h.triggerKind))}function Ct(h){switch(h){case Qe.CodeActionTriggerKind.Invoke:return ge.CodeActionTriggerKind.Invoked;case Qe.CodeActionTriggerKind.Automatic:return ge.CodeActionTriggerKind.Automatic;default:return}}function at(h){if(h!=null)return h.value}function Tt(h){return h==null?h:ge.InlineValueContext.create(h.frameId,L(h.stoppedLocation))}function Bt(h,F,Y){return{context:ge.InlineCompletionContext.create(Y.triggerKind,Y.selectedCompletionInfo),textDocument:i(h),position:q(F)}}function ct(h){let F=ge.Command.create(h.title,h.command);return h.arguments&&(F.arguments=h.arguments),F}function Pt(h){let F=ge.CodeLens.create(L(h.range));return h.command&&(F.command=ct(h.command)),h instanceof Jd.default&&h.data&&(F.data=h.data),F}function qt(h,F){const Y={tabSize:h.tabSize,insertSpaces:h.insertSpaces};return F.trimTrailingWhitespace&&(Y.trimTrailingWhitespace=!0),F.trimFinalNewlines&&(Y.trimFinalNewlines=!0),F.insertFinalNewline&&(Y.insertFinalNewline=!0),Y}function $t(h){return{textDocument:i(h)}}function Vt(h){return{textDocument:i(h)}}function Mt(h){let F=ge.DocumentLink.create(L(h.range));h.target&&(F.target=r(h.target)),h.tooltip!==void 0&&(F.tooltip=h.tooltip);let Y=h instanceof Qd.default?h:void 0;return Y&&Y.data&&(F.data=Y.data),F}function Lt(h){return{textDocument:i(h)}}function At(h){const F={name:h.name,kind:ut(h.kind),uri:r(h.uri),range:L(h.range),selectionRange:L(h.selectionRange)};return h.detail!==void 0&&h.detail.length>0&&(F.detail=h.detail),h.tags!==void 0&&(F.tags=st(h.tags)),h instanceof Yd.default&&h.data!==void 0&&(F.data=h.data),F}function _t(h){const F={name:h.name,kind:ut(h.kind),uri:r(h.uri),range:L(h.range),selectionRange:L(h.selectionRange)};return h.detail!==void 0&&h.detail.length>0&&(F.detail=h.detail),h.tags!==void 0&&(F.tags=st(h.tags)),h instanceof Zd.default&&h.data!==void 0&&(F.data=h.data),F}function rt(h){const F=h instanceof ef.default?{name:h.name,kind:ut(h.kind),location:h.hasRange?Z(h.location):{uri:t(h.location.uri)},data:h.data}:{name:h.name,kind:ut(h.kind),location:Z(h.location)};return h.tags!==void 0&&(F.tags=st(h.tags)),h.containerName!==""&&(F.containerName=h.containerName),F}function jt(h){const F=typeof h.label=="string"?h.label:h.label.map(Xt),Y=ge.InlayHint.create(q(h.position),F);return h.kind!==void 0&&(Y.kind=h.kind),h.textEdits!==void 0&&(Y.textEdits=Xe(h.textEdits)),h.tooltip!==void 0&&(Y.tooltip=lt(h.tooltip)),h.paddingLeft!==void 0&&(Y.paddingLeft=h.paddingLeft),h.paddingRight!==void 0&&(Y.paddingRight=h.paddingRight),h instanceof tf.default&&h.data!==void 0&&(Y.data=h.data),Y}function Xt(h){const F=ge.InlayHintLabelPart.create(h.value);return h.location!==void 0&&(F.location=Z(h.location)),h.command!==void 0&&(F.command=ct(h.command)),h.tooltip!==void 0&&(F.tooltip=lt(h.tooltip)),F}function lt(h){return typeof h=="string"?h:{kind:ge.MarkupKind.Markdown,value:h.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:o,asVersionedTextDocumentIdentifier:s,asOpenTextDocumentParams:c,asChangeTextDocumentParams:m,asCloseTextDocumentParams:C,asSaveTextDocumentParams:_,asWillSaveTextDocumentParams:y,asDidCreateFilesParams:O,asDidRenameFilesParams:M,asDidDeleteFilesParams:V,asWillCreateFilesParams:oe,asWillRenameFilesParams:te,asWillDeleteFilesParams:Te,asTextDocumentPositionParams:fe,asCompletionParams:x,asSignatureHelpParams:k,asWorkerPosition:P,asRange:L,asRanges:X,asPosition:q,asPositions:$,asPositionsSync:j,asLocation:Z,asDiagnosticSeverity:J,asDiagnosticTag:re,asDiagnostic:Ye,asDiagnostics:Be,asDiagnosticsSync:ot,asCompletionItem:et,asTextEdit:vt,asSymbolKind:ut,asSymbolTag:Ae,asSymbolTags:st,asReferenceParams:Gt,asCodeAction:It,asCodeActionSync:Rt,asCodeActionContext:Ot,asCodeActionContextSync:Nt,asInlineValueContext:Tt,asCommand:ct,asCodeLens:Pt,asFormattingOptions:qt,asDocumentSymbolParams:$t,asCodeLensParams:Vt,asDocumentLink:Mt,asDocumentLinkParams:Lt,asCallHierarchyItem:At,asTypeHierarchyItem:_t,asInlayHint:jt,asWorkspaceSymbol:rt,asInlineCompletionParams:Bt}}ii.createConverter=nf;var gi={};Object.defineProperty(gi,"__esModule",{value:!0}),gi.createConverter=void 0;const Q=ce,de=he,Ut=$e,Ne=it,rf=oi,of=si,sf=ai,af=ci,Fc=En,cf=ui,uf=li,lf=di,df=hi,Ic=he;var pi;(function(n){function e(t){let r=t;return r&&Ut.string(r.language)&&Ut.string(r.value)}n.is=e})(pi||(pi={}));function ff(n,e,t){const i=n||(a=>Q.Uri.parse(a));function o(a){return i(a)}function s(a){const w=[];for(const I of a)if(typeof I=="string")w.push(I);else if(Ic.NotebookCellTextDocumentFilter.is(I))if(typeof I.notebook=="string")w.push({notebookType:I.notebook,language:I.language});else{const K=I.notebook.notebookType??"*";w.push({notebookType:K,scheme:I.notebook.scheme,pattern:I.notebook.pattern,language:I.language})}else Ic.TextDocumentFilter.is(I)&&w.push({language:I.language,scheme:I.scheme,pattern:I.pattern});return w}async function c(a,w){return Ne.map(a,d,w)}function u(a){const w=new Array(a.length);for(let I=0;I<a.length;I++)w[I]=d(a[I]);return w}function d(a){let w=new Fc.ProtocolDiagnostic(y(a.range),a.message,M(a.severity),a.data);if(a.code!==void 0){if(typeof a.code=="string"||typeof a.code=="number")de.CodeDescription.is(a.codeDescription)?w.code={value:a.code,target:o(a.codeDescription.href)}:w.code=a.code;else if(Fc.DiagnosticCode.is(a.code)){w.hasDiagnosticCode=!0;const I=a.code;w.code={value:I.value,target:o(I.target)}}}return a.source&&(w.source=a.source),a.relatedInformation&&(w.relatedInformation=m(a.relatedInformation)),Array.isArray(a.tags)&&(w.tags=C(a.tags)),w}function m(a){const w=new Array(a.length);for(let I=0;I<a.length;I++){const K=a[I];w[I]=new Q.DiagnosticRelatedInformation(J(K.location),K.message)}return w}function C(a){if(!a)return;let w=[];for(let I of a){let K=_(I);K!==void 0&&w.push(K)}return w.length>0?w:void 0}function _(a){switch(a){case de.DiagnosticTag.Unnecessary:return Q.DiagnosticTag.Unnecessary;case de.DiagnosticTag.Deprecated:return Q.DiagnosticTag.Deprecated;default:return}}function S(a){return a?new Q.Position(a.line,a.character):void 0}function y(a){return a?new Q.Range(a.start.line,a.start.character,a.end.line,a.end.character):void 0}async function O(a,w){return Ne.map(a,I=>new Q.Range(I.start.line,I.start.character,I.end.line,I.end.character),w)}function M(a){if(a==null)return Q.DiagnosticSeverity.Error;switch(a){case de.DiagnosticSeverity.Error:return Q.DiagnosticSeverity.Error;case de.DiagnosticSeverity.Warning:return Q.DiagnosticSeverity.Warning;case de.DiagnosticSeverity.Information:return Q.DiagnosticSeverity.Information;case de.DiagnosticSeverity.Hint:return Q.DiagnosticSeverity.Hint}return Q.DiagnosticSeverity.Error}function V(a){if(Ut.string(a))return te(a);if(pi.is(a))return te().appendCodeblock(a.value,a.language);if(Array.isArray(a)){let w=[];for(let I of a){let K=te();pi.is(I)?K.appendCodeblock(I.value,I.language):K.appendMarkdown(I),w.push(K)}return w}else return te(a)}function oe(a){if(Ut.string(a))return a;switch(a.kind){case de.MarkupKind.Markdown:return te(a.value);case de.MarkupKind.PlainText:return a.value;default:return`Unsupported Markup content received. Kind is: ${a.kind}`}}function te(a){let w;if(a===void 0||typeof a=="string")w=new Q.MarkdownString(a);else switch(a.kind){case de.MarkupKind.Markdown:w=new Q.MarkdownString(a.value);break;case de.MarkupKind.PlainText:w=new Q.MarkdownString,w.appendText(a.value);break;default:w=new Q.MarkdownString,w.appendText(`Unsupported Markup content received. Kind is: ${a.kind}`);break}return w.isTrusted=e,w.supportHtml=t,w}function Te(a){if(a)return new Q.Hover(V(a.contents),y(a.range))}async function fe(a,w,I){if(!a)return;if(Array.isArray(a))return Ne.map(a,xt=>ee(xt,w),I);const K=a,{defaultRange:De,commitCharacters:Oe}=le(K,w),_e=await Ne.map(K.items,xt=>ee(xt,Oe,De,K.itemDefaults?.insertTextMode,K.itemDefaults?.insertTextFormat,K.itemDefaults?.data),I);return new Q.CompletionList(_e,K.isIncomplete)}function le(a,w){const I=a.itemDefaults?.editRange,K=a.itemDefaults?.commitCharacters??w;return de.Range.is(I)?{defaultRange:y(I),commitCharacters:K}:I!==void 0?{defaultRange:{inserting:y(I.insert),replacing:y(I.replace)},commitCharacters:K}:{defaultRange:void 0,commitCharacters:K}}function x(a){return de.CompletionItemKind.Text<=a&&a<=de.CompletionItemKind.TypeParameter?[a-1,void 0]:[Q.CompletionItemKind.Text,a]}function N(a){switch(a){case de.CompletionItemTag.Deprecated:return Q.CompletionItemTag.Deprecated}}function A(a){if(a==null)return[];const w=[];for(const I of a){const K=N(I);K!==void 0&&w.push(K)}return w}function ee(a,w,I,K,De,Oe){const _e=A(a.tags),xt=U(a),je=new rf.default(xt);a.detail&&(je.detail=a.detail),a.documentation&&(je.documentation=oe(a.documentation),je.documentationFormat=Ut.string(a.documentation)?"$string":a.documentation.kind),a.filterText&&(je.filterText=a.filterText);const Lr=W(a,I,De);if(Lr&&(je.insertText=Lr.text,je.range=Lr.range,je.fromEdit=Lr.fromEdit),Ut.number(a.kind)){let[Vu,Ms]=x(a.kind);je.kind=Vu,Ms&&(je.originalItemKind=Ms)}a.sortText&&(je.sortText=a.sortText),a.additionalTextEdits&&(je.additionalTextEdits=q(a.additionalTextEdits));const qs=a.commitCharacters!==void 0?Ut.stringArray(a.commitCharacters)?a.commitCharacters:void 0:w;qs&&(je.commitCharacters=qs.slice()),a.command&&(je.command=Xe(a.command)),(a.deprecated===!0||a.deprecated===!1)&&(je.deprecated=a.deprecated,a.deprecated===!0&&_e.push(Q.CompletionItemTag.Deprecated)),(a.preselect===!0||a.preselect===!1)&&(je.preselect=a.preselect);const $s=a.data??Oe;$s!==void 0&&(je.data=$s),_e.length>0&&(je.tags=_e);const fo=a.insertTextMode??K;return fo!==void 0&&(je.insertTextMode=fo,fo===de.InsertTextMode.asIs&&(je.keepWhitespace=!0)),je}function U(a){return de.CompletionItemLabelDetails.is(a.labelDetails)?{label:a.label,detail:a.labelDetails.detail,description:a.labelDetails.description}:a.label}function W(a,w,I){const K=a.insertTextFormat??I;if(a.textEdit!==void 0||w!==void 0){const[De,Oe]=a.textEdit!==void 0?R(a.textEdit):[w,a.textEditText??a.label];return K===de.InsertTextFormat.Snippet?{text:new Q.SnippetString(Oe),range:De,fromEdit:!0}:{text:Oe,range:De,fromEdit:!0}}else return a.insertText?K===de.InsertTextFormat.Snippet?{text:new Q.SnippetString(a.insertText),fromEdit:!1}:{text:a.insertText,fromEdit:!1}:void 0}function R(a){return de.InsertReplaceEdit.is(a)?[{inserting:y(a.insert),replacing:y(a.replace)},a.newText]:[y(a.range),a.newText]}function k(a){if(a)return new Q.TextEdit(y(a.range),a.newText)}async function P(a,w){if(a)return Ne.map(a,k,w)}function q(a){if(!a)return;const w=new Array(a.length);for(let I=0;I<a.length;I++)w[I]=k(a[I]);return w}async function $(a,w){if(!a)return;let I=new Q.SignatureHelp;return Ut.number(a.activeSignature)?I.activeSignature=a.activeSignature:I.activeSignature=0,Ut.number(a.activeParameter)?I.activeParameter=a.activeParameter:I.activeParameter=0,a.signatures&&(I.signatures=await j(a.signatures,w)),I}async function j(a,w){return Ne.mapAsync(a,L,w)}async function L(a,w){let I=new Q.SignatureInformation(a.label);return a.documentation!==void 0&&(I.documentation=oe(a.documentation)),a.parameters!==void 0&&(I.parameters=await X(a.parameters,w)),a.activeParameter!==void 0&&(I.activeParameter=a.activeParameter),I}function X(a,w){return Ne.map(a,Z,w)}function Z(a){let w=new Q.ParameterInformation(a.label);return a.documentation&&(w.documentation=oe(a.documentation)),w}function J(a){return a?new Q.Location(i(a.uri),y(a.range)):void 0}async function ne(a,w){if(a)return ie(a,w)}async function re(a,w){if(a)return ie(a,w)}function G(a){if(!a)return;let w={targetUri:i(a.targetUri),targetRange:y(a.targetRange),originSelectionRange:y(a.originSelectionRange),targetSelectionRange:y(a.targetSelectionRange)};if(!w.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return w}async function ie(a,w){if(a)if(Ut.array(a)){if(a.length===0)return[];if(de.LocationLink.is(a[0])){const I=a;return Ne.map(I,G,w)}else{const I=a;return Ne.map(I,J,w)}}else return de.LocationLink.is(a)?[G(a)]:J(a)}async function se(a,w){if(a)return Ne.map(a,J,w)}async function Ye(a,w){if(a)return Ne.map(a,Be,w)}function Be(a){let w=new Q.DocumentHighlight(y(a.range));return Ut.number(a.kind)&&(w.kind=ot(a.kind)),w}function ot(a){switch(a){case de.DocumentHighlightKind.Text:return Q.DocumentHighlightKind.Text;case de.DocumentHighlightKind.Read:return Q.DocumentHighlightKind.Read;case de.DocumentHighlightKind.Write:return Q.DocumentHighlightKind.Write}return Q.DocumentHighlightKind.Text}async function Ze(a,w){if(a)return Ne.map(a,et,w)}function ve(a){return a<=de.SymbolKind.TypeParameter?a-1:Q.SymbolKind.Property}function Ve(a){switch(a){case de.SymbolTag.Deprecated:return Q.SymbolTag.Deprecated;default:return}}function qe(a){if(a==null)return;const w=[];for(const I of a){const K=Ve(I);K!==void 0&&w.push(K)}return w.length===0?void 0:w}function et(a){const w=a.data,I=a.location,K=I.range===void 0||w!==void 0?new lf.default(a.name,ve(a.kind),a.containerName??"",I.range===void 0?i(I.uri):new Q.Location(i(a.location.uri),y(I.range)),w):new Q.SymbolInformation(a.name,ve(a.kind),a.containerName??"",new Q.Location(i(a.location.uri),y(I.range)));return vt(K,a),K}async function St(a,w){if(a!=null)return Ne.map(a,yt,w)}function yt(a){let w=new Q.DocumentSymbol(a.name,a.detail||"",ve(a.kind),y(a.range),y(a.selectionRange));if(vt(w,a),a.children!==void 0&&a.children.length>0){let I=[];for(let K of a.children)I.push(yt(K));w.children=I}return w}function vt(a,w){a.tags=qe(w.tags),w.deprecated&&(a.tags?a.tags.includes(Q.SymbolTag.Deprecated)||(a.tags=a.tags.concat(Q.SymbolTag.Deprecated)):a.tags=[Q.SymbolTag.Deprecated])}function Xe(a){let w={title:a.title,command:a.command};return a.arguments&&(w.arguments=a.arguments),w}async function ut(a,w){if(a)return Ne.map(a,Xe,w)}const Ae=new Map;Ae.set(de.CodeActionKind.Empty,Q.CodeActionKind.Empty),Ae.set(de.CodeActionKind.QuickFix,Q.CodeActionKind.QuickFix),Ae.set(de.CodeActionKind.Refactor,Q.CodeActionKind.Refactor),Ae.set(de.CodeActionKind.RefactorExtract,Q.CodeActionKind.RefactorExtract),Ae.set(de.CodeActionKind.RefactorInline,Q.CodeActionKind.RefactorInline),Ae.set(de.CodeActionKind.RefactorRewrite,Q.CodeActionKind.RefactorRewrite),Ae.set(de.CodeActionKind.Source,Q.CodeActionKind.Source),Ae.set(de.CodeActionKind.SourceOrganizeImports,Q.CodeActionKind.SourceOrganizeImports);function st(a){if(a==null)return;let w=Ae.get(a);if(w)return w;let I=a.split(".");w=Q.CodeActionKind.Empty;for(let K of I)w=w.append(K);return w}function Gt(a){if(a!=null)return a.map(w=>st(w))}async function It(a,w){if(a==null)return;let I=new af.default(a.title,a.data);return a.kind!==void 0&&(I.kind=st(a.kind)),a.diagnostics!==void 0&&(I.diagnostics=u(a.diagnostics)),a.edit!==void 0&&(I.edit=await Ct(a.edit,w)),a.command!==void 0&&(I.command=Xe(a.command)),a.isPreferred!==void 0&&(I.isPreferred=a.isPreferred),a.disabled!==void 0&&(I.disabled={reason:a.disabled.reason}),I}function Rt(a,w){return Ne.mapAsync(a,async I=>de.Command.is(I)?Xe(I):It(I,w),w)}function Ot(a){if(!a)return;let w=new of.default(y(a.range));return a.command&&(w.command=Xe(a.command)),a.data!==void 0&&a.data!==null&&(w.data=a.data),w}async function Nt(a,w){if(a)return Ne.map(a,Ot,w)}async function Ct(a,w){if(!a)return;const I=new Map;if(a.changeAnnotations!==void 0){const Oe=a.changeAnnotations;await Ne.forEach(Object.keys(Oe),_e=>{const xt=at(Oe[_e]);I.set(_e,xt)},w)}const K=Oe=>{if(Oe!==void 0)return I.get(Oe)},De=new Q.WorkspaceEdit;if(a.documentChanges){const Oe=a.documentChanges;await Ne.forEach(Oe,_e=>{if(de.CreateFile.is(_e))De.createFile(i(_e.uri),_e.options,K(_e.annotationId));else if(de.RenameFile.is(_e))De.renameFile(i(_e.oldUri),i(_e.newUri),_e.options,K(_e.annotationId));else if(de.DeleteFile.is(_e))De.deleteFile(i(_e.uri),_e.options,K(_e.annotationId));else if(de.TextDocumentEdit.is(_e)){const xt=i(_e.textDocument.uri);for(const je of _e.edits)de.AnnotatedTextEdit.is(je)?De.replace(xt,y(je.range),je.newText,K(je.annotationId)):De.replace(xt,y(je.range),je.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(_e,void 0,4)}`)},w)}else if(a.changes){const Oe=a.changes;await Ne.forEach(Object.keys(Oe),_e=>{De.set(i(_e),q(Oe[_e]))},w)}return De}function at(a){if(a!==void 0)return{label:a.label,needsConfirmation:!!a.needsConfirmation,description:a.description}}function Tt(a){let w=y(a.range),I=a.target?o(a.target):void 0,K=new sf.default(w,I);return a.tooltip!==void 0&&(K.tooltip=a.tooltip),a.data!==void 0&&a.data!==null&&(K.data=a.data),K}async function Bt(a,w){if(a)return Ne.map(a,Tt,w)}function ct(a){return new Q.Color(a.red,a.green,a.blue,a.alpha)}function Pt(a){return new Q.ColorInformation(y(a.range),ct(a.color))}async function qt(a,w){if(a)return Ne.map(a,Pt,w)}function $t(a){let w=new Q.ColorPresentation(a.label);return w.additionalTextEdits=q(a.additionalTextEdits),a.textEdit&&(w.textEdit=k(a.textEdit)),w}async function Vt(a,w){if(a)return Ne.map(a,$t,w)}function Mt(a){if(a)switch(a){case de.FoldingRangeKind.Comment:return Q.FoldingRangeKind.Comment;case de.FoldingRangeKind.Imports:return Q.FoldingRangeKind.Imports;case de.FoldingRangeKind.Region:return Q.FoldingRangeKind.Region}}function Lt(a){return new Q.FoldingRange(a.startLine,a.endLine,Mt(a.kind))}async function At(a,w){if(a)return Ne.map(a,Lt,w)}function _t(a){return new Q.SelectionRange(y(a.range),a.parent?_t(a.parent):void 0)}async function rt(a,w){return Array.isArray(a)?Ne.map(a,_t,w):[]}function jt(a){return de.InlineValueText.is(a)?new Q.InlineValueText(y(a.range),a.text):de.InlineValueVariableLookup.is(a)?new Q.InlineValueVariableLookup(y(a.range),a.variableName,a.caseSensitiveLookup):new Q.InlineValueEvaluatableExpression(y(a.range),a.expression)}async function Xt(a,w){return Array.isArray(a)?Ne.map(a,jt,w):[]}async function lt(a,w){const I=typeof a.label=="string"?a.label:await Ne.map(a.label,h,w),K=new df.default(S(a.position),I);return a.kind!==void 0&&(K.kind=a.kind),a.textEdits!==void 0&&(K.textEdits=await P(a.textEdits,w)),a.tooltip!==void 0&&(K.tooltip=F(a.tooltip)),a.paddingLeft!==void 0&&(K.paddingLeft=a.paddingLeft),a.paddingRight!==void 0&&(K.paddingRight=a.paddingRight),a.data!==void 0&&(K.data=a.data),K}function h(a){const w=new Q.InlayHintLabelPart(a.value);return a.location!==void 0&&(w.location=J(a.location)),a.tooltip!==void 0&&(w.tooltip=F(a.tooltip)),a.command!==void 0&&(w.command=Xe(a.command)),w}function F(a){return typeof a=="string"?a:te(a)}async function Y(a,w){if(Array.isArray(a))return Ne.mapAsync(a,lt,w)}function pe(a){if(a===null)return;const w=new cf.default(ve(a.kind),a.name,a.detail||"",o(a.uri),y(a.range),y(a.selectionRange),a.data);return a.tags!==void 0&&(w.tags=qe(a.tags)),w}async function Ce(a,w){if(a!==null)return Ne.map(a,pe,w)}async function He(a,w){return new Q.CallHierarchyIncomingCall(pe(a.from),await O(a.fromRanges,w))}async function T(a,w){if(a!==null)return Ne.mapAsync(a,He,w)}async function g(a,w){return new Q.CallHierarchyOutgoingCall(pe(a.to),await O(a.fromRanges,w))}async function b(a,w){if(a!==null)return Ne.mapAsync(a,g,w)}async function l(a,w){if(a!=null)return new Q.SemanticTokens(new Uint32Array(a.data),a.resultId)}function v(a){return new Q.SemanticTokensEdit(a.start,a.deleteCount,a.data!==void 0?new Uint32Array(a.data):void 0)}async function f(a,w){if(a!=null)return new Q.SemanticTokensEdits(a.edits.map(v),a.resultId)}function D(a){return a}async function p(a,w){if(a!=null)return new Q.LinkedEditingRanges(await O(a.ranges,w),E(a.wordPattern))}function E(a){if(a!=null)return new RegExp(a)}function H(a){if(a===null)return;let w=new uf.default(ve(a.kind),a.name,a.detail||"",o(a.uri),y(a.range),y(a.selectionRange),a.data);return a.tags!==void 0&&(w.tags=qe(a.tags)),w}async function B(a,w){if(a!==null)return Ne.map(a,H,w)}function we(a){if(Ut.string(a))return a;if(de.RelativePattern.is(a)){if(de.URI.is(a.baseUri))return new Q.RelativePattern(o(a.baseUri),a.pattern);if(de.WorkspaceFolder.is(a.baseUri)){const w=Q.workspace.getWorkspaceFolder(o(a.baseUri.uri));return w!==void 0?new Q.RelativePattern(w,a.pattern):void 0}}}async function ye(a,w){if(!a)return;if(Array.isArray(a))return Ne.map(a,De=>Pe(De),w);const I=a,K=await Ne.map(I.items,De=>Pe(De),w);return new Q.InlineCompletionList(K)}function Pe(a){let w;typeof a.insertText=="string"?w=a.insertText:w=new Q.SnippetString(a.insertText.value);let I;a.command&&(I=Xe(a.command));const K=new Q.InlineCompletionItem(w,y(a.range),I);return a.filterText&&(K.filterText=a.filterText),K}return{asUri:o,asDocumentSelector:s,asDiagnostics:c,asDiagnostic:d,asRange:y,asRanges:O,asPosition:S,asDiagnosticSeverity:M,asDiagnosticTag:_,asHover:Te,asCompletionResult:fe,asCompletionItem:ee,asTextEdit:k,asTextEdits:P,asSignatureHelp:$,asSignatureInformations:j,asSignatureInformation:L,asParameterInformations:X,asParameterInformation:Z,asDeclarationResult:ne,asDefinitionResult:re,asLocation:J,asReferences:se,asDocumentHighlights:Ye,asDocumentHighlight:Be,asDocumentHighlightKind:ot,asSymbolKind:ve,asSymbolTag:Ve,asSymbolTags:qe,asSymbolInformations:Ze,asSymbolInformation:et,asDocumentSymbols:St,asDocumentSymbol:yt,asCommand:Xe,asCommands:ut,asCodeAction:It,asCodeActionKind:st,asCodeActionKinds:Gt,asCodeActionResult:Rt,asCodeLens:Ot,asCodeLenses:Nt,asWorkspaceEdit:Ct,asDocumentLink:Tt,asDocumentLinks:Bt,asFoldingRangeKind:Mt,asFoldingRange:Lt,asFoldingRanges:At,asColor:ct,asColorInformation:Pt,asColorInformations:qt,asColorPresentation:$t,asColorPresentations:Vt,asSelectionRange:_t,asSelectionRanges:rt,asInlineValue:jt,asInlineValues:Xt,asInlayHint:lt,asInlayHints:Y,asSemanticTokensLegend:D,asSemanticTokens:l,asSemanticTokensEdit:v,asSemanticTokensEdits:f,asCallHierarchyItem:pe,asCallHierarchyItems:Ce,asCallHierarchyIncomingCall:He,asCallHierarchyIncomingCalls:T,asCallHierarchyOutgoingCall:g,asCallHierarchyOutgoingCalls:b,asLinkedEditingRanges:p,asTypeHierarchyItem:H,asTypeHierarchyItems:B,asGlobPattern:we,asInlineCompletionResult:ye,asInlineCompletionItem:Pe}}gi.createConverter=ff;var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.generateUuid=Ie.parse=Ie.isUUID=Ie.v4=Ie.empty=void 0;class No{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class Re extends No{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return Re._oneOf(Re._chars)}constructor(){super([Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),"-",Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),"-","4",Re._randomHex(),Re._randomHex(),Re._randomHex(),"-",Re._oneOf(Re._timeHighBits),Re._randomHex(),Re._randomHex(),Re._randomHex(),"-",Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex(),Re._randomHex()].join(""))}}Re._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],Re._timeHighBits=["8","9","a","b"],Ie.empty=new No("00000000-0000-0000-0000-000000000000");function Oc(){return new Re}Ie.v4=Oc;const hf=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Nc(n){return hf.test(n)}Ie.isUUID=Nc;function gf(n){if(!Nc(n))throw new Error("invalid uuid");return new No(n)}Ie.parse=gf;function pf(){return Oc().asHex()}Ie.generateUuid=pf;var Cr={};Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.ProgressPart=void 0;const qc=ce,$c=he,Mc=$e;class mf{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress($c.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&qc.window.withProgress({location:qc.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification($c.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,o)=>{this._resolve=i,this._reject=o})})}report(e){if(this._infinite&&Mc.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(Mc.number(e.percentage)){const t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}}Cr.ProgressPart=mf;var ue={};Object.defineProperty(ue,"__esModule",{value:!0}),ue.WorkspaceFeature=ue.TextDocumentLanguageFeature=ue.TextDocumentEventFeature=ue.DynamicDocumentFeature=ue.DynamicFeature=ue.StaticFeature=ue.ensure=ue.LSPCancellationError=void 0;const Fn=ce,qo=he,mt=$e,Lc=Ie;class yf extends Fn.CancellationError{constructor(e){super(),this.data=e}}ue.LSPCancellationError=yf;function vf(n,e){return n[e]===void 0&&(n[e]={}),n[e]}ue.ensure=vf;var Ac;(function(n){function e(t){const r=t;return r!=null&&mt.func(r.fillClientCapabilities)&&mt.func(r.initialize)&&mt.func(r.getState)&&mt.func(r.clear)&&(r.fillInitializeParams===void 0||mt.func(r.fillInitializeParams))}n.is=e})(Ac||(ue.StaticFeature=Ac={}));var jc;(function(n){function e(t){const r=t;return r!=null&&mt.func(r.fillClientCapabilities)&&mt.func(r.initialize)&&mt.func(r.getState)&&mt.func(r.clear)&&(r.fillInitializeParams===void 0||mt.func(r.fillInitializeParams))&&mt.func(r.register)&&mt.func(r.unregister)&&r.registrationType!==void 0}n.is=e})(jc||(ue.DynamicFeature=jc={}));class $o{constructor(e){this._client=e}getState(){const e=this.getDocumentSelectors();let t=0;for(const i of e){t++;for(const o of Fn.workspace.textDocuments)if(Fn.languages.match(i,o)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}const r=t>0;return{kind:"document",id:this.registrationType.method,registrations:r,matches:!1}}}ue.DynamicDocumentFeature=$o;class Cf extends $o{static textDocumentFilter(e,t){for(const r of e)if(Fn.languages.match(r,t)>0)return!0;return!1}constructor(e,t,r,i,o,s,c){super(e),this._event=t,this._type=r,this._middleware=i,this._createParams=o,this._textDocument=s,this._selectorFilter=c,this._selectors=new Map,this._onNotificationSent=new Fn.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){const t=async r=>{const i=this._createParams(r);await this._client.sendNotification(this._type,i),this.notificationSent(this.getTextDocument(r),this._type,i)};if(this.matches(e)){const r=this._middleware();return r?r(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(const t of this._selectors.values())if(Fn.languages.match(t,e)>0)return{send:r=>this.callback(r)}}}ue.TextDocumentEventFeature=Cf;class _f extends $o{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(const e of this._registrations.values()){const t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(qo.TextDocumentRegistrationOptions.is(t)){const r=qo.StaticRegistrationOptions.hasId(t)?t.id:Lc.generateUuid(),i=t.documentSelector??e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(mt.boolean(t)&&t===!0||qo.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];const r=mt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[Lc.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return mt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(const t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&Fn.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return t.provider}}getAllProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}}ue.TextDocumentLanguageFeature=_f;class wf{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){const e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){const t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}}ue.WorkspaceFeature=wf;var un={};const bf=typeof process=="object"&&process&&process.platform==="win32";var Df=bf?{sep:"\\"}:{sep:"/"},Sf=xc;function xc(n,e,t){n instanceof RegExp&&(n=Hc(n,t)),e instanceof RegExp&&(e=Hc(e,t));var r=Wc(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function Hc(n,e){var t=e.match(n);return t?t[0]:null}xc.range=Wc;function Wc(n,e,t){var r,i,o,s,c,u=t.indexOf(n),d=t.indexOf(e,u+1),m=u;if(u>=0&&d>0){if(n===e)return[u,d];for(r=[],o=t.length;m>=0&&!c;)m==u?(r.push(m),u=t.indexOf(n,m+1)):r.length==1?c=[r.pop(),d]:(i=r.pop(),i<o&&(o=i,s=d),d=t.indexOf(e,m+1)),m=u<d&&u>=0?u:d;r.length&&(c=[o,s])}return c}var Uc=Sf,Rf=Ef,Kc="\0SLASH"+Math.random()+"\0",zc="\0OPEN"+Math.random()+"\0",Mo="\0CLOSE"+Math.random()+"\0",Gc="\0COMMA"+Math.random()+"\0",Bc="\0PERIOD"+Math.random()+"\0";function Lo(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function Tf(n){return n.split("\\\\").join(Kc).split("\\{").join(zc).split("\\}").join(Mo).split("\\,").join(Gc).split("\\.").join(Bc)}function Pf(n){return n.split(Kc).join("\\").split(zc).join("{").split(Mo).join("}").split(Gc).join(",").split(Bc).join(".")}function Vc(n){if(!n)return[""];var e=[],t=Uc("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,o=t.post,s=r.split(",");s[s.length-1]+="{"+i+"}";var c=Vc(o);return o.length&&(s[s.length-1]+=c.shift(),s.push.apply(s,c)),e.push.apply(e,s),e}function Ef(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),_r(Tf(n),!0).map(Pf)):[]}function kf(n){return"{"+n+"}"}function Ff(n){return/^-?0\d/.test(n)}function If(n,e){return n<=e}function Of(n,e){return n>=e}function _r(n,e){var t=[],r=Uc("{","}",n);if(!r)return[n];var i=r.pre,o=r.post.length?_r(r.post,!1):[""];if(/\$$/.test(r.pre))for(var s=0;s<o.length;s++){var c=i+"{"+r.body+"}"+o[s];t.push(c)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),d=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),m=u||d,C=r.body.indexOf(",")>=0;if(!m&&!C)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+Mo+r.post,_r(n)):[n];var _;if(m)_=r.body.split(/\.\./);else if(_=Vc(r.body),_.length===1&&(_=_r(_[0],!1).map(kf),_.length===1))return o.map(function(ee){return r.pre+_[0]+ee});var S;if(m){var y=Lo(_[0]),O=Lo(_[1]),M=Math.max(_[0].length,_[1].length),V=_.length==3?Math.abs(Lo(_[2])):1,oe=If,te=O<y;te&&(V*=-1,oe=Of);var Te=_.some(Ff);S=[];for(var fe=y;oe(fe,O);fe+=V){var le;if(d)le=String.fromCharCode(fe),le==="\\"&&(le="");else if(le=String(fe),Te){var x=M-le.length;if(x>0){var N=new Array(x+1).join("0");fe<0?le="-"+N+le.slice(1):le=N+le}}S.push(le)}}else{S=[];for(var A=0;A<_.length;A++)S.push.apply(S,_r(_[A],!1))}for(var A=0;A<S.length;A++)for(var s=0;s<o.length;s++){var c=i+S[A]+o[s];(!e||m||c)&&t.push(c)}}return t}const Et=mi=(n,e,t={})=>(yi(e),!t.nocomment&&e.charAt(0)==="#"?!1:new vi(e,t).match(n));var mi=Et;const Ao=Df;Et.sep=Ao.sep;const Qt=Symbol("globstar **");Et.GLOBSTAR=Qt;const Nf=Rf,Xc={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},jo="[^/]",xo=jo+"*?",qf="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",$f="(?:(?!(?:\\/|^)\\.).)*?",Jc=n=>n.split("").reduce((e,t)=>(e[t]=!0,e),{}),Qc=Jc("().*{}+?[]^$\\!"),Mf=Jc("[.("),Yc=/\/+/;Et.filter=(n,e={})=>(t,r,i)=>Et(t,n,e);const bn=(n,e={})=>{const t={};return Object.keys(n).forEach(r=>t[r]=n[r]),Object.keys(e).forEach(r=>t[r]=e[r]),t};Et.defaults=n=>{if(!n||typeof n!="object"||!Object.keys(n).length)return Et;const e=Et,t=(r,i,o)=>e(r,i,bn(n,o));return t.Minimatch=class extends e.Minimatch{constructor(i,o){super(i,bn(n,o))}},t.Minimatch.defaults=r=>e.defaults(bn(n,r)).Minimatch,t.filter=(r,i)=>e.filter(r,bn(n,i)),t.defaults=r=>e.defaults(bn(n,r)),t.makeRe=(r,i)=>e.makeRe(r,bn(n,i)),t.braceExpand=(r,i)=>e.braceExpand(r,bn(n,i)),t.match=(r,i,o)=>e.match(r,i,bn(n,o)),t},Et.braceExpand=(n,e)=>Zc(n,e);const Zc=(n,e={})=>(yi(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:Nf(n)),Lf=1024*64,yi=n=>{if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>Lf)throw new TypeError("pattern is too long")},Ho=Symbol("subparse");Et.makeRe=(n,e)=>new vi(n,e||{}).makeRe(),Et.match=(n,e,t={})=>{const r=new vi(e,t);return n=n.filter(i=>r.match(i)),r.options.nonull&&!n.length&&n.push(e),n};const Af=n=>n.replace(/\\(.)/g,"$1"),jf=n=>n.replace(/\\([^-\]])/g,"$1"),xf=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Hf=n=>n.replace(/[[\]\\]/g,"\\$&");class vi{constructor(e,t){yi(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,r),r=this.globParts=r.map(i=>i.split(Yc)),this.debug(this.pattern,r),r=r.map((i,o,s)=>i.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let t=!1,r=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var o=0,s=0,c=e.length,u=t.length;o<c&&s<u;o++,s++){this.debug("matchOne loop");var d=t[s],m=e[o];if(this.debug(t,d,m),d===!1)return!1;if(d===Qt){this.debug("GLOBSTAR",[t,d,m]);var C=o,_=s+1;if(_===u){for(this.debug("** at the end");o<c;o++)if(e[o]==="."||e[o]===".."||!i.dot&&e[o].charAt(0)===".")return!1;return!0}for(;C<c;){var S=e[C];if(this.debug(`
globstar while`,e,C,t,_,S),this.matchOne(e.slice(C),t.slice(_),r))return this.debug("globstar found match!",C,c,S),!0;if(S==="."||S===".."||!i.dot&&S.charAt(0)==="."){this.debug("dot detected!",e,C,t,_);break}this.debug("globstar swallow a segment, and continue"),C++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,C,t,_),C===c))}var y;if(typeof d=="string"?(y=m===d,this.debug("string match",d,m,y)):(y=m.match(d),this.debug("pattern match",d,m,y)),!y)return!1}if(o===c&&s===u)return!0;if(o===c)return r;if(s===u)return o===c-1&&e[o]==="";throw new Error("wtf?")}braceExpand(){return Zc(this.pattern,this.options)}parse(e,t){yi(e);const r=this.options;if(e==="**")if(r.noglobstar)e="*";else return Qt;if(e==="")return"";let i="",o=!1,s=!1;const c=[],u=[];let d,m=!1,C=-1,_=-1,S,y,O,M=e.charAt(0)===".",V=r.dot||M;const oe=()=>M?"":V?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",te=x=>x.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",Te=()=>{if(d){switch(d){case"*":i+=xo,o=!0;break;case"?":i+=jo,o=!0;break;default:i+="\\"+d;break}this.debug("clearStateChar %j %j",d,i),d=!1}};for(let x=0,N;x<e.length&&(N=e.charAt(x));x++){if(this.debug("%s	%s %s %j",e,x,i,N),s){if(N==="/")return!1;Qc[N]&&(i+="\\"),i+=N,s=!1;continue}switch(N){case"/":return!1;case"\\":if(m&&e.charAt(x+1)==="-"){i+=N;continue}Te(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,x,i,N),m){this.debug("  in class"),N==="!"&&x===_+1&&(N="^"),i+=N;continue}this.debug("call clearStateChar %j",d),Te(),d=N,r.noext&&Te();continue;case"(":{if(m){i+="(";continue}if(!d){i+="\\(";continue}const A={type:d,start:x-1,reStart:i.length,open:Xc[d].open,close:Xc[d].close};this.debug(this.pattern,"	",A),c.push(A),i+=A.open,A.start===0&&A.type!=="!"&&(M=!0,i+=te(e.slice(x+1))),this.debug("plType %j %j",d,i),d=!1;continue}case")":{const A=c[c.length-1];if(m||!A){i+="\\)";continue}c.pop(),Te(),o=!0,y=A,i+=y.close,y.type==="!"&&u.push(Object.assign(y,{reEnd:i.length}));continue}case"|":{const A=c[c.length-1];if(m||!A){i+="\\|";continue}Te(),i+="|",A.start===0&&A.type!=="!"&&(M=!0,i+=te(e.slice(x+1)));continue}case"[":if(Te(),m){i+="\\"+N;continue}m=!0,_=x,C=i.length,i+=N;continue;case"]":if(x===_+1||!m){i+="\\"+N;continue}S=e.substring(_+1,x);try{RegExp("["+Hf(jf(S))+"]"),i+=N}catch{i=i.substring(0,C)+"(?:$.)"}o=!0,m=!1;continue;default:Te(),Qc[N]&&!(N==="^"&&m)&&(i+="\\"),i+=N;break}}for(m&&(S=e.slice(_+1),O=this.parse(S,Ho),i=i.substring(0,C)+"\\["+O[0],o=o||O[1]),y=c.pop();y;y=c.pop()){let x;x=i.slice(y.reStart+y.open.length),this.debug("setting tail",i,y),x=x.replace(/((?:\\{2}){0,64})(\\?)\|/g,(A,ee,U)=>(U||(U="\\"),ee+ee+U+"|")),this.debug(`tail=%j
   %s`,x,x,y,i);const N=y.type==="*"?xo:y.type==="?"?jo:"\\"+y.type;o=!0,i=i.slice(0,y.reStart)+N+"\\("+x}Te(),s&&(i+="\\\\");const fe=Mf[i.charAt(0)];for(let x=u.length-1;x>-1;x--){const N=u[x],A=i.slice(0,N.reStart),ee=i.slice(N.reStart,N.reEnd-8);let U=i.slice(N.reEnd);const W=i.slice(N.reEnd-8,N.reEnd)+U,R=A.split(")").length,k=A.split("(").length-R;let P=U;for(let $=0;$<k;$++)P=P.replace(/\)[+*?]?/,"");U=P;const q=U===""&&t!==Ho?"(?:$|\\/)":"";i=A+ee+U+q+W}if(i!==""&&o&&(i="(?=.)"+i),fe&&(i=oe()+i),t===Ho)return[i,o];if(r.nocase&&!o&&(o=e.toUpperCase()!==e.toLowerCase()),!o)return Af(e);const le=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",le),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,r=t.noglobstar?xo:t.dot?qf:$f,i=t.nocase?"i":"";let o=e.map(s=>(s=s.map(c=>typeof c=="string"?xf(c):c===Qt?Qt:c._src).reduce((c,u)=>(c[c.length-1]===Qt&&u===Qt||c.push(u),c),[]),s.forEach((c,u)=>{c!==Qt||s[u-1]===Qt||(u===0?s.length>1?s[u+1]="(?:\\/|"+r+"\\/)?"+s[u+1]:s[u]=r:u===s.length-1?s[u-1]+="(?:\\/|"+r+")?":(s[u-1]+="(?:\\/|\\/"+r+"\\/)"+s[u+1],s[u+1]=Qt))}),s.filter(c=>c!==Qt).join("/"))).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,i)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;const r=this.options;Ao.sep!=="/"&&(e=e.split(Ao.sep).join("/")),e=e.split(Yc),this.debug(this.pattern,"split",e);const i=this.set;this.debug(this.pattern,"set",i);let o;for(let s=e.length-1;s>=0&&(o=e[s],!o);s--);for(let s=0;s<i.length;s++){const c=i[s];let u=e;if(r.matchBase&&c.length===1&&(u=[o]),this.matchOne(u,c,t))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return Et.defaults(e).Minimatch}}Et.Minimatch=vi,Object.defineProperty(un,"__esModule",{value:!0}),un.DiagnosticFeature=un.DiagnosticPullMode=un.vsdiag=void 0;const Wf=mi,ke=ce,Ge=he,Uf=Ie,Wo=ue;function Ci(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Kt;(function(n){(function(e){e.full="full",e.unChanged="unChanged"})(n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(Kt||(un.vsdiag=Kt={}));var _i;(function(n){n.onType="onType",n.onSave="onSave"})(_i||(un.DiagnosticPullMode=_i={}));var ht;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(ht||(ht={}));class Mr{constructor(){this.open=new Set,this._onOpen=new ke.EventEmitter,this._onClose=new ke.EventEmitter,Mr.fillTabResources(this.open);const e=t=>{if(t.closed.length===0&&t.opened.length===0)return;const r=this.open,i=new Set;Mr.fillTabResources(i);const o=new Set,s=new Set(i);for(const c of r.values())i.has(c)?s.delete(c):o.add(c);if(this.open=i,o.size>0){const c=new Set;for(const u of o)c.add(ke.Uri.parse(u));this._onClose.fire(c)}if(s.size>0){const c=new Set;for(const u of s)c.add(ke.Uri.parse(u));this._onOpen.fire(c)}};ke.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=ke.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof ke.Uri?ke.window.activeTextEditor?.document.uri===e:ke.window.activeTextEditor?.document===e}isVisible(e){const t=e instanceof ke.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){const e=new Set;return Mr.fillTabResources(new Set,e),e}static fillTabResources(e,t){const r=e??new Set;for(const i of ke.window.tabGroups.all)for(const o of i.tabs){const s=o.input;let c;s instanceof ke.TabInputText?c=s.uri:s instanceof ke.TabInputTextDiff?c=s.modified:s instanceof ke.TabInputCustom&&(c=s.uri),c!==void 0&&!r.has(c.toString())&&(r.add(c.toString()),t!==void 0&&t.add(c))}}}var nt;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(nt||(nt={}));var ln;(function(n){function e(t){return t instanceof ke.Uri?t.toString():t.uri.toString()}n.asKey=e})(ln||(ln={}));class Kf{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){const i=e===nt.document?this.documentPullStates:this.workspacePullStates,[o,s,c]=t instanceof ke.Uri?[t.toString(),t,r]:[t.uri.toString(),t.uri,t.version];let u=i.get(o);return u===void 0&&(u={document:s,pulledVersion:c,resultId:void 0},i.set(o,u)),u}update(e,t,r,i){const o=e===nt.document?this.documentPullStates:this.workspacePullStates,[s,c,u,d]=t instanceof ke.Uri?[t.toString(),t,r,i]:[t.uri.toString(),t.uri,t.version,r];let m=o.get(s);m===void 0?(m={document:c,pulledVersion:u,resultId:d},o.set(s,m)):(m.pulledVersion=u,m.resultId=d)}unTrack(e,t){const r=ln.asKey(t);(e===nt.document?this.documentPullStates:this.workspacePullStates).delete(r)}tracks(e,t){const r=ln.asKey(t);return(e===nt.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){const r=ln.asKey(t);return(e===nt.document?this.documentPullStates:this.workspacePullStates).get(r)?.resultId}getAllResultIds(){const e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}}class zf{constructor(e,t,r){this.client=e,this.tabs=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new ke.EventEmitter,this.provider=this.createProvider(),this.diagnostics=ke.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new Kf,this.workspaceErrorCounter=0}knows(e,t){const r=t instanceof ke.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(r.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;const r=e instanceof ke.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${r.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;const r=e instanceof ke.Uri,i=r?e:e.uri,o=i.toString();t=r?t:e.version;const s=this.openRequests.get(o),c=r?this.documentStates.track(nt.document,e,t):this.documentStates.track(nt.document,e);if(s===void 0){const u=new ke.CancellationTokenSource;this.openRequests.set(o,{state:ht.active,document:e,version:t,tokenSource:u});let d,m;try{d=await this.provider.provideDiagnostics(e,c.resultId,u.token)??{kind:Kt.DocumentDiagnosticReportKind.full,items:[]}}catch(C){if(C instanceof Wo.LSPCancellationError&&Ge.DiagnosticServerCancellationData.is(C.data)&&C.data.retriggerRequest===!1&&(m={state:ht.outDated,document:e}),m===void 0&&C instanceof ke.CancellationError)m={state:ht.reschedule,document:e};else throw C}if(m=m??this.openRequests.get(o),m===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${o}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(o),!this.tabs.isVisible(e)){this.documentStates.unTrack(nt.document,e);return}if(m.state===ht.outDated)return;d!==void 0&&(d.kind===Kt.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,d.items),c.pulledVersion=t,c.resultId=d.resultId),m.state===ht.reschedule&&this.pull(e)}else s.state===ht.active?(s.tokenSource.cancel(),this.openRequests.set(o,{state:ht.reschedule,document:s.document})):s.state===ht.outDated&&this.openRequests.set(o,{state:ht.reschedule,document:s.document})}forgetDocument(e){const t=e instanceof ke.Uri?e:e.uri,r=t.toString(),i=this.openRequests.get(r);this.options.workspaceDiagnostics?i!==void 0?this.openRequests.set(r,{state:ht.reschedule,document:e}):this.pull(e,()=>{this.forget(nt.document,e)}):(i!==void 0&&(i.state===ht.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:ht.outDated,document:e})),this.diagnostics.delete(t),this.forget(nt.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,Ge.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof Wo.LSPCancellationError)&&!Ge.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,Ge.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new ke.CancellationTokenSource;const e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(const r of t.items)r.kind===Kt.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(nt.document,r.uri)||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(nt.workspace,r.uri,r.version??void 0,r.resultId)})}createProvider(){const e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{const o=(c,u,d)=>{const m={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(c instanceof ke.Uri?c:c.uri)},previousResultId:u};return this.isDisposed===!0||!this.client.isRunning()?{kind:Kt.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(Ge.DocumentDiagnosticRequest.type,m,d).then(async C=>C==null||this.isDisposed||d.isCancellationRequested?{kind:Kt.DocumentDiagnosticReportKind.full,items:[]}:C.kind===Ge.DocumentDiagnosticReportKind.Full?{kind:Kt.DocumentDiagnosticReportKind.full,resultId:C.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(C.items,d)}:{kind:Kt.DocumentDiagnosticReportKind.unChanged,resultId:C.resultId},C=>this.client.handleFailedRequest(Ge.DocumentDiagnosticRequest.type,d,C,{kind:Kt.DocumentDiagnosticReportKind.full,items:[]}))},s=this.client.middleware;return s.provideDiagnostics?s.provideDiagnostics(t,r,i,o):o(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{const o=async d=>d.kind===Ge.DocumentDiagnosticReportKind.Full?{kind:Kt.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(d.uri),resultId:d.resultId,version:d.version,items:await this.client.protocol2CodeConverter.asDiagnostics(d.items,r)}:{kind:Kt.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(d.uri),resultId:d.resultId,version:d.version},s=d=>{const m=[];for(const C of d)m.push({uri:this.client.code2ProtocolConverter.asUri(C.uri),value:C.value});return m},c=(d,m)=>{const C=(0,Uf.generateUuid)(),_=this.client.onProgress(Ge.WorkspaceDiagnosticRequest.partialResult,C,async y=>{if(y==null){i(null);return}const O={items:[]};for(const M of y.items)try{O.items.push(await o(M))}catch(V){this.client.error("Converting workspace diagnostics failed.",V)}i(O)}),S={identifier:this.options.identifier,previousResultIds:s(d),partialResultToken:C};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(Ge.WorkspaceDiagnosticRequest.type,S,m).then(async y=>{if(m.isCancellationRequested)return{items:[]};const O={items:[]};for(const M of y.items)O.items.push(await o(M));return _.dispose(),i(O),{items:[]}},y=>(_.dispose(),this.client.handleFailedRequest(Ge.DocumentDiagnosticRequest.type,m,y,{items:[]})))},u=this.client.middleware;return u.provideWorkspaceDiagnostics?u.provideWorkspaceDiagnostics(t,r,i,c):c(t,r)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(const[e,t]of this.openRequests)t.state===ht.active&&t.tokenSource.cancel(),this.openRequests.set(e,{state:ht.outDated,document:t.document});this.diagnostics.dispose()}}class Gf{constructor(e){this.diagnosticRequestor=e,this.documents=new Ge.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;const t=ln.asKey(e);this.documents.has(t)||(this.documents.set(t,e,Ge.Touch.Last),this.trigger())}remove(e){const t=ln.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,Ge.RAL)().timer.setInterval(()=>{const e=this.documents.first;if(e!==void 0){const t=ln.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,Ge.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?ln.asKey(this.endDocument):void 0}}class Bf{constructor(e,t,r){const i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},o=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),s=[],c=y=>{const O=r.documentSelector;if(i.match!==void 0)return i.match(O,y);for(const M of O)if(Ge.TextDocumentFilter.is(M)){if(typeof M=="string"||M.language!==void 0&&M.language!=="*"||M.scheme!==void 0&&M.scheme!=="*"&&M.scheme!==y.scheme)return!1;if(M.pattern!==void 0){const V=new Wf.Minimatch(M.pattern,{noext:!0});if(!V.makeRe()||!V.match(y.fsPath))return!1}}return!0},u=y=>y instanceof ke.Uri?c(y):ke.languages.match(o,y)>0&&t.isVisible(y),d=y=>y instanceof ke.Uri?this.activeTextDocument?.uri.toString()===y.toString():this.activeTextDocument===y;this.diagnosticRequestor=new zf(e,t,r),this.backgroundScheduler=new Gf(this.diagnosticRequestor);const m=y=>{!u(y)||!r.interFileDependencies||d(y)||this.backgroundScheduler.add(y)};this.activeTextDocument=ke.window.activeTextEditor?.document,ke.window.onDidChangeActiveTextEditor(y=>{const O=this.activeTextDocument;this.activeTextDocument=y?.document,O!==void 0&&m(O),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});const C=e.getFeature(Ge.DidOpenTextDocumentNotification.method);s.push(C.onNotificationSent(y=>{const O=y.textDocument;this.diagnosticRequestor.knows(nt.document,O)||u(O)&&this.diagnosticRequestor.pull(O,()=>{m(O)})})),s.push(t.onOpen(y=>{for(const O of y){if(this.diagnosticRequestor.knows(nt.document,O))continue;const M=O.toString();let V;for(const oe of ke.workspace.textDocuments)if(M===oe.uri.toString()){V=oe;break}V!==void 0&&u(V)&&this.diagnosticRequestor.pull(V,()=>{m(V)})}}));const _=new Set;for(const y of ke.workspace.textDocuments)u(y)&&(this.diagnosticRequestor.pull(y,()=>{m(y)}),_.add(y.uri.toString()));if(i.onTabs===!0)for(const y of t.getTabResources())!_.has(y.toString())&&u(y)&&this.diagnosticRequestor.pull(y,()=>{m(y)});if(i.onChange===!0){const y=e.getFeature(Ge.DidChangeTextDocumentNotification.method);s.push(y.onNotificationSent(async O=>{const M=O.textDocument;(i.filter===void 0||!i.filter(M,_i.onType))&&this.diagnosticRequestor.knows(nt.document,M)&&this.diagnosticRequestor.pull(M,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){const y=e.getFeature(Ge.DidSaveTextDocumentNotification.method);s.push(y.onNotificationSent(O=>{const M=O.textDocument;(i.filter===void 0||!i.filter(M,_i.onSave))&&this.diagnosticRequestor.knows(nt.document,M)&&this.diagnosticRequestor.pull(O.textDocument,()=>{this.backgroundScheduler.trigger()})}))}const S=e.getFeature(Ge.DidCloseTextDocumentNotification.method);s.push(S.onNotificationSent(y=>{this.cleanUpDocument(y.textDocument)})),t.onClose(y=>{for(const O of y)this.cleanUpDocument(O)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(const y of ke.workspace.textDocuments)u(y)&&this.diagnosticRequestor.pull(y)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=ke.Disposable.from(...s,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(nt.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}}class Vf extends Wo.TextDocumentLanguageFeature{constructor(e){super(e,Ge.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=Ci(Ci(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,Ci(Ci(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ge.DiagnosticRefreshRequest.type,async()=>{for(const s of this.getAllProviders())s.onDidChangeDiagnosticsEmitter.fire()});let[i,o]=this.getRegistration(t,e.diagnosticProvider);!i||!o||this.register({id:i,registerOptions:o})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new Mr);const t=new Bf(this._client,this.tabs,e);return[t.disposable,t]}}un.DiagnosticFeature=Vf;var wi={};Object.defineProperty(wi,"__esModule",{value:!0}),wi.NotebookDocumentSyncFeature=void 0;const gt=ce,Xf=mi,dn=he,Jf=Ie,eu=$e;function tu(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var er;(function(n){(function(e){function t(C,_){return{version:C.version,uri:_.asUri(C.uri)}}e.asVersionedNotebookDocumentIdentifier=t;function r(C,_,S){const y=dn.NotebookDocument.create(S.asUri(C.uri),C.notebookType,C.version,i(_,S));return Object.keys(C.metadata).length>0&&(y.metadata=o(C.metadata)),y}e.asNotebookDocument=r;function i(C,_){return C.map(S=>s(S,_))}e.asNotebookCells=i;function o(C){return u(new Set,C)}e.asMetadata=o;function s(C,_){const S=dn.NotebookCell.create(c(C.kind),_.asUri(C.document.uri));return Object.keys(C.metadata).length>0&&(S.metadata=o(C.metadata)),C.executionSummary!==void 0&&eu.number(C.executionSummary.executionOrder)&&eu.boolean(C.executionSummary.success)&&(S.executionSummary={executionOrder:C.executionSummary.executionOrder,success:C.executionSummary.success}),S}e.asNotebookCell=s;function c(C){switch(C){case gt.NotebookCellKind.Markup:return dn.NotebookCellKind.Markup;case gt.NotebookCellKind.Code:return dn.NotebookCellKind.Code}}function u(C,_){if(C.has(_))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(_)){const S=[];for(const y of _)if(y!==null&&typeof y=="object"||Array.isArray(y))S.push(u(C,y));else{if(y instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");S.push(y)}return S}else{const S=Object.keys(_),y=Object.create(null);for(const O of S){const M=_[O];if(M!==null&&typeof M=="object"||Array.isArray(M))y[O]=u(C,M);else{if(M instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");y[O]=M}}return y}}function d(C,_){const S=_.asChangeTextDocumentParams(C,C.document.uri,C.document.version);return{document:S.textDocument,changes:S.contentChanges}}e.asTextContentChange=d;function m(C,_){const S=Object.create(null);if(C.metadata&&(S.metadata=n.c2p.asMetadata(C.metadata)),C.cells!==void 0){const y=Object.create(null),O=C.cells;O.structure&&(y.structure={array:{start:O.structure.array.start,deleteCount:O.structure.array.deleteCount,cells:O.structure.array.cells!==void 0?O.structure.array.cells.map(M=>n.c2p.asNotebookCell(M,_)):void 0},didOpen:O.structure.didOpen!==void 0?O.structure.didOpen.map(M=>_.asOpenTextDocumentParams(M.document).textDocument):void 0,didClose:O.structure.didClose!==void 0?O.structure.didClose.map(M=>_.asCloseTextDocumentParams(M.document).textDocument):void 0}),O.data!==void 0&&(y.data=O.data.map(M=>n.c2p.asNotebookCell(M,_))),O.textContent!==void 0&&(y.textContent=O.textContent.map(M=>n.c2p.asTextContentChange(M,_))),Object.keys(y).length>0&&(S.cells=y)}return S}e.asNotebookDocumentChangeEvent=m})(n.c2p||(n.c2p={}))})(er||(er={}));var Uo;(function(n){function e(c,u,d){const m=c.length,C=u.length;let _=0;for(;_<C&&_<m&&t(c[_],u[_],d);)_++;if(_<C&&_<m){let S=m-1,y=C-1;for(;S>=0&&y>=0&&t(c[S],u[y],d);)S--,y--;const O=S+1-_,M=_===y+1?void 0:u.slice(_,y+1);return M!==void 0?{start:_,deleteCount:O,cells:M}:{start:_,deleteCount:O}}else return _<C?{start:_,deleteCount:0,cells:u.slice(_)}:_<m?{start:_,deleteCount:m-_}:void 0}n.computeDiff=e;function t(c,u,d=!0){return c.kind!==u.kind||c.document.uri.toString()!==u.document.uri.toString()||c.document.languageId!==u.document.languageId||!r(c.executionSummary,u.executionSummary)?!1:!d||d&&o(c.metadata,u.metadata)}function r(c,u){return c===u?!0:c===void 0||u===void 0?!1:c.executionOrder===u.executionOrder&&c.success===u.success&&i(c.timing,u.timing)}function i(c,u){return c===u?!0:c===void 0||u===void 0?!1:c.startTime===u.startTime&&c.endTime===u.endTime}function o(c,u){if(c===u)return!0;if(c==null||u===null||u===void 0||typeof c!=typeof u||typeof c!="object")return!1;const d=Array.isArray(c),m=Array.isArray(u);if(d!==m)return!1;if(d&&m){if(c.length!==u.length)return!1;for(let C=0;C<c.length;C++)if(!o(c[C],u[C]))return!1}if(s(c)&&s(u)){const C=Object.keys(c),_=Object.keys(u);if(C.length!==_.length||(C.sort(),_.sort(),!o(C,_)))return!1;for(let S=0;S<C.length;S++){const y=C[S];if(!o(c[y],u[y]))return!1}return!0}return!1}function s(c){return c!==null&&typeof c=="object"}n.isObjectLiteral=s})(Uo||(Uo={}));var Ko;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;const i=r.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){const o=new Xf.Minimatch(t.pattern,{noext:!0});if(!o.makeRe()||!o.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(Ko||(Ko={}));var bi;(function(n){function e(r){const i=r.notebookSelector,o=[];for(const s of i){const c=(typeof s.notebook=="string"?s.notebook:s.notebook?.notebookType)??"*",u=typeof s.notebook=="string"?void 0:s.notebook?.scheme,d=typeof s.notebook=="string"?void 0:s.notebook?.pattern;if(s.cells!==void 0)for(const m of s.cells)o.push(t(c,u,d,m.language));else o.push(t(c,u,d,void 0))}return o}n.asDocumentSelector=e;function t(r,i,o,s){return i===void 0&&o===void 0?{notebook:r,language:s}:{notebook:{notebookType:r,scheme:i,pattern:o},language:s}}})(bi||(bi={}));var Di;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(Di||(Di={}));class Si{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(bi.asDocumentSelector(t)),gt.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(const r of gt.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);gt.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&gt.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),gt.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}getState(){for(const e of gt.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return gt.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(gt.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;const r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){const o=r.uris.has(t.document.uri.toString());if(i&&o||!i&&!o)return;if(i){const s=this.getMatchingCells(e);if(s!==void 0){const c=this.asNotebookDocumentChangeEvent(e,void 0,r,s);c!==void 0&&this.doSendChange(c,s).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){gt.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){const r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;const i=t.document.uri,o=r.cells.findIndex(s=>s.document.uri.toString()===i.toString());if(o!==-1)if(o===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{const s=r.cells.slice(),c=s.splice(o,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:o,deleteCount:1},didClose:c}}},s).catch(()=>{})}}dispose(){for(const e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){const i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){const t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;const i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{const i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}const o=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);o!==void 0&&this.doSendChange(o,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;const r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){const t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){const r=async(o,s)=>{const c=er.c2p.asNotebookDocument(o,s,this.client.code2ProtocolConverter),u=s.map(d=>this.client.code2ProtocolConverter.asTextDocumentItem(d.document));try{await this.client.sendNotification(dn.DidOpenNotebookDocumentNotification.type,{notebookDocument:c,cellTextDocuments:u})}catch(d){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",d),d}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),Di.create(t)),i?.didOpen!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){const r=async o=>{try{await this.client.sendNotification(dn.DidChangeNotebookDocumentNotification.type,{notebookDocument:er.c2p.asVersionedNotebookDocumentIdentifier(o.notebook,this.client.code2ProtocolConverter),change:er.c2p.asNotebookDocumentChangeEvent(o,this.client.code2ProtocolConverter)})}catch(s){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",s),s}},i=this.client.middleware?.notebooks;return e.cells?.structure!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),Di.create(t??[])),i?.didChange!==void 0?i?.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){const t=async i=>{try{await this.client.sendNotification(dn.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(i.uri)}})}catch(o){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",o),o}},r=this.client.middleware?.notebooks;return r?.didSave!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){const r=async(o,s)=>{try{await this.client.sendNotification(dn.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)},cellTextDocuments:s.map(c=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(c.document))})}catch(c){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",c),c}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),i?.didClose!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");const o={notebook:e};t?.metadata!==void 0&&(o.metadata=er.c2p.asMetadata(t.metadata));let s;if(t?.cellChanges!==void 0&&t.cellChanges.length>0){const c=[];s=new Set(i.map(u=>u.document.uri.toString()));for(const u of t.cellChanges)s.has(u.cell.document.uri.toString())&&(u.executionSummary!==void 0||u.metadata!==void 0)&&c.push(u.cell);c.length>0&&(o.cells=o.cells??{},o.cells.data=c)}if((t?.contentChanges!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){const c=r.cells,u=i,d=Uo.computeDiff(c,u,!1);let m,C;if(d!==void 0){m=d.cells===void 0?new Map:new Map(d.cells.map(y=>[y.document.uri.toString(),y])),C=d.deleteCount===0?new Map:new Map(c.slice(d.start,d.start+d.deleteCount).map(y=>[y.document.uri.toString(),y]));for(const y of Array.from(C.keys()))m.has(y)&&(C.delete(y),m.delete(y));o.cells=o.cells??{};const _=[],S=[];if(m.size>0||C.size>0){for(const y of m.values())_.push(y);for(const y of C.values())S.push(y)}o.cells.structure={array:d,didOpen:_,didClose:S}}}return Object.keys(o).length>1?o:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(const r of this.options.notebookSelector)if(r.notebook===void 0||Ko.matchNotebook(r.notebook,e)){const i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}}}cellMatches(e,t){const r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){const i=r!==void 0?t.filter(o=>{const s=o.document.languageId;return r.some(c=>c.language==="*"||s===c.language)}):t;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}}class An{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=dn.NotebookDocumentSyncRegistrationType.type,gt.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==An.CellScheme)return;const[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(const o of this.registrations.values())o instanceof Si&&o.didOpenNotebookCellTextDocument(r,i)}),gt.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;const r=t.document;if(r.uri.scheme!==An.CellScheme)return;const[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(const o of this.registrations.values())o instanceof Si&&o.didChangeNotebookCellTextDocument(i,t)}),gt.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==An.CellScheme)return;const[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(const o of this.registrations.values())o instanceof Si&&o.didCloseNotebookCellTextDocument(r,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(const e of this.registrations.values()){const t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){const t=tu(tu(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){const t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(bi.asDocumentSelector(t)))}initialize(e){const t=e.notebookDocumentSync;if(t===void 0)return;const r=t.id??Jf.generateUuid();this.register({id:r,registerOptions:t})}register(e){const t=new Si(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){const t=this.registrations.get(e);t&&t.dispose()}clear(){for(const e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==An.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&gt.languages.match(this.dedicatedChannel,e)>0)return!0;for(const t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(const t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){const t=e.uri.toString();for(const r of gt.workspace.notebookDocuments)for(const i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}}wi.NotebookDocumentSyncFeature=An,An.CellScheme="vscode-notebook-cell";var Dn={};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.SyncConfigurationFeature=Dn.toJSONObject=Dn.ConfigurationFeature=void 0;const tr=ce,wr=he,Qf=$e,Yf=Ie,nu=ue;class Zf{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(wr.ConfigurationRequest.type,(t,r)=>{let i=s=>{let c=[];for(let u of s.items){let d=u.scopeUri!==void 0&&u.scopeUri!==null?this._client.protocol2CodeConverter.asUri(u.scopeUri):void 0;c.push(this.getConfiguration(d,u.section!==null?u.section:void 0))}return c},o=e.middleware.workspace;return o&&o.configuration?o.configuration(t,r,i):i(t)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=In(tr.workspace.getConfiguration(void 0,e).get(t));else{let o=tr.workspace.getConfiguration(t.substr(0,i),e);o&&(r=In(o.get(t.substr(i+1))))}}else{let i=tr.workspace.getConfiguration(void 0,e);r={};for(let o of Object.keys(i))i.has(o)&&(r[o]=In(i.get(o)))}return r===void 0&&(r=null),r}clear(){}}Dn.ConfigurationFeature=Zf;function In(n){if(n){if(Array.isArray(n))return n.map(In);if(typeof n=="object"){const e=Object.create(null);for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=In(n[t]));return e}}return n}Dn.toJSONObject=In;class eh{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return wr.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,nu.ensure)((0,nu.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;e!==void 0&&this.register({id:Yf.generateUuid(),registerOptions:{section:e}})}register(e){let t=tr.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}clear(){for(const e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,t){if(this.isCleared)return;let r;if(Qf.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(c=>t.affectsConfiguration(c)))return;const i=async s=>s===void 0?this._client.sendNotification(wr.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(wr.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(s)});let o=this._client.middleware.workspace?.didChangeConfiguration;(o?o(r,i):i(r)).catch(s=>{this._client.error(`Sending notification ${wr.DidChangeConfigurationNotification.type.method} failed`,s)})}extractSettingsInformation(e){function t(o,s){let c=o;for(let u=0;u<s.length-1;u++){let d=c[s[u]];d||(d=Object.create(null),c[s[u]]=d),c=d}return c}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let o=0;o<e.length;o++){let s=e[o],c=s.indexOf("."),u=null;if(c>=0?u=tr.workspace.getConfiguration(s.substr(0,c),r).get(s.substr(c+1)):u=tr.workspace.getConfiguration(void 0,r).get(s),u){let d=e[o].split(".");t(i,d)[d[d.length-1]]=In(u)}}return i}}Dn.SyncConfigurationFeature=eh;var bt={};Object.defineProperty(bt,"__esModule",{value:!0}),bt.DidSaveTextDocumentFeature=bt.WillSaveWaitUntilFeature=bt.WillSaveFeature=bt.DidChangeTextDocumentFeature=bt.DidCloseTextDocumentFeature=bt.DidOpenTextDocumentFeature=void 0;const kt=ce,xe=he,Ue=ue,nr=Ie;class th extends Ue.TextDocumentEventFeature{constructor(e,t){super(e,kt.workspace.onDidOpenTextDocument,xe.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,Ue.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,Ue.ensure)((0,Ue.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){const r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:nr.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return xe.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;const t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);kt.workspace.textDocuments.forEach(r=>{const i=r.uri.toString();if(!this._syncedDocuments.has(i)&&kt.languages.match(t,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){const o=this._client.middleware,s=c=>this._client.sendNotification(this._type,this._createParams(c));(o.didOpen?o.didOpen(r,s):s(r)).catch(c=>{this._client.error(`Sending document notification ${this._type.method} failed`,c)}),this._syncedDocuments.set(i,r)}})}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,r)}}bt.DidOpenTextDocumentFeature=th;class nh extends Ue.TextDocumentEventFeature{constructor(e,t,r){super(e,kt.workspace.onDidCloseTextDocument,xe.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,i=>e.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,Ue.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=r}get registrationType(){return xe.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,Ue.ensure)((0,Ue.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:nr.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,r)}unregister(e){const t=this._selectors.get(e);super.unregister(e);const r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(kt.languages.match(t,i)>0&&!this._selectorFilter(r,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let o=this._client.middleware,s=c=>this._client.sendNotification(this._type,this._createParams(c));this._syncedDocuments.delete(i.uri.toString()),(o.didClose?o.didClose(i,s):s(i)).catch(c=>{this._client.error(`Sending document notification ${this._type.method} failed`,c)})}})}}bt.DidCloseTextDocumentFeature=nh;class rh extends Ue.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new kt.EventEmitter,this._onPendingChangeAdded=new kt.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=xe.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return xe.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,Ue.ensure)((0,Ue.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==xe.TextDocumentSyncKind.None&&this.register({id:nr.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=kt.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(const e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;const t=e.document.uri,r=e.document.version,i=[];for(const o of this._changeData.values())if(kt.languages.match(o.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){const s=this._client.middleware;if(o.syncKind===xe.TextDocumentSyncKind.Incremental){const c=async u=>{const d=this._client.code2ProtocolConverter.asChangeTextDocumentParams(u,t,r);await this._client.sendNotification(xe.DidChangeTextDocumentNotification.type,d),this.notificationSent(u.document,xe.DidChangeTextDocumentNotification.type,d)};i.push(s.didChange?s.didChange(e,u=>c(u)):c(e))}else if(o.syncKind===xe.TextDocumentSyncKind.Full){const c=async u=>{const d=u.document.uri.toString();this._pendingTextDocumentChanges.set(d,u.document),this._onPendingChangeAdded.fire()};i.push(s.didChange?s.didChange(e,u=>c(u)):c(e))}}return Promise.all(i).then(void 0,o=>{throw this._client.error(`Sending document notification ${xe.DidChangeTextDocumentNotification.type.method} failed`,o),o})}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=xe.TextDocumentSyncKind.None;else{this._syncKind=xe.TextDocumentSyncKind.None;for(const t of this._changeData.values())if(this.updateSyncKind(t.syncKind),this._syncKind===xe.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=xe.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(const r of this._pendingTextDocumentChanges)e.has(r[0])||(t.push(r[1]),this._pendingTextDocumentChanges.delete(r[0]))}return t}getProvider(e){for(const t of this._changeData.values())if(kt.languages.match(t.documentSelector,e)>0)return{send:r=>this.callback(r)}}updateSyncKind(e){if(this._syncKind!==xe.TextDocumentSyncKind.Full)switch(e){case xe.TextDocumentSyncKind.Full:this._syncKind=e;break;case xe.TextDocumentSyncKind.Incremental:this._syncKind===xe.TextDocumentSyncKind.None&&(this._syncKind=xe.TextDocumentSyncKind.Incremental);break}}}bt.DidChangeTextDocumentFeature=rh;class ih extends Ue.TextDocumentEventFeature{constructor(e){super(e,kt.workspace.onWillSaveTextDocument,xe.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,r)=>Ue.TextDocumentEventFeature.textDocumentFilter(t,r.document))}get registrationType(){return xe.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,Ue.ensure)((0,Ue.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:nr.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}}bt.WillSaveFeature=ih;class oh extends Ue.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return xe.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,Ue.ensure)((0,Ue.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:nr.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=kt.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Ue.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,r=i=>this._client.sendRequest(xe.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async o=>{let s=await this._client.protocol2CodeConverter.asTextEdits(o);return s===void 0?[]:s});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}}bt.WillSaveWaitUntilFeature=oh;class sh extends Ue.TextDocumentEventFeature{constructor(e){super(e,kt.workspace.onDidSaveTextDocument,xe.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,Ue.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return xe.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,Ue.ensure)((0,Ue.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){const r=e.resolvedTextDocumentSync;if(t&&r&&r.save){const i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:nr.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}}bt.DidSaveTextDocumentFeature=sh;var Ri={};Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.CompletionItemFeature=void 0;const ah=ce,Fe=he,zo=ue,ch=Ie,uh=[Fe.CompletionItemKind.Text,Fe.CompletionItemKind.Method,Fe.CompletionItemKind.Function,Fe.CompletionItemKind.Constructor,Fe.CompletionItemKind.Field,Fe.CompletionItemKind.Variable,Fe.CompletionItemKind.Class,Fe.CompletionItemKind.Interface,Fe.CompletionItemKind.Module,Fe.CompletionItemKind.Property,Fe.CompletionItemKind.Unit,Fe.CompletionItemKind.Value,Fe.CompletionItemKind.Enum,Fe.CompletionItemKind.Keyword,Fe.CompletionItemKind.Snippet,Fe.CompletionItemKind.Color,Fe.CompletionItemKind.File,Fe.CompletionItemKind.Reference,Fe.CompletionItemKind.Folder,Fe.CompletionItemKind.EnumMember,Fe.CompletionItemKind.Constant,Fe.CompletionItemKind.Struct,Fe.CompletionItemKind.Event,Fe.CompletionItemKind.Operator,Fe.CompletionItemKind.TypeParameter];class lh extends zo.TextDocumentLanguageFeature{constructor(e){super(e,Fe.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,zo.ensure)((0,zo.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[Fe.MarkupKind.Markdown,Fe.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[Fe.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[Fe.InsertTextMode.asIs,Fe.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=Fe.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:uh},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,t){const r=this.getRegistrationOptions(t,e.completionProvider);r&&this.register({id:ch.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){this.labelDetailsSupport.set(t,!!e.completionItem?.labelDetailsSupport);const r=e.triggerCharacters??[],i=e.allCommitCharacters,o=e.documentSelector,s={provideCompletionItems:(c,u,d,m)=>{const C=this._client,_=this._client.middleware,S=(y,O,M,V)=>C.sendRequest(Fe.CompletionRequest.type,C.code2ProtocolConverter.asCompletionParams(y,O,M),V).then(oe=>V.isCancellationRequested?null:C.protocol2CodeConverter.asCompletionResult(oe,i,V),oe=>C.handleFailedRequest(Fe.CompletionRequest.type,V,oe,null));return _.provideCompletionItem?_.provideCompletionItem(c,u,m,d,S):S(c,u,m,d)},resolveCompletionItem:e.resolveProvider?(c,u)=>{const d=this._client,m=this._client.middleware,C=(_,S)=>d.sendRequest(Fe.CompletionResolveRequest.type,d.code2ProtocolConverter.asCompletionItem(_,!!this.labelDetailsSupport.get(t)),S).then(y=>S.isCancellationRequested?null:d.protocol2CodeConverter.asCompletionItem(y),y=>d.handleFailedRequest(Fe.CompletionResolveRequest.type,S,y,_));return m.resolveCompletionItem?m.resolveCompletionItem(c,u,C):C(c,u)}:void 0};return[ah.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(o),s,...r),s]}}Ri.CompletionItemFeature=lh;var Ti={};Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.HoverFeature=void 0;const dh=ce,br=he,Go=ue,fh=Ie;class hh extends Go.TextDocumentLanguageFeature{constructor(e){super(e,br.HoverRequest.type)}fillClientCapabilities(e){const t=(0,Go.ensure)((0,Go.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[br.MarkupKind.Markdown,br.MarkupKind.PlainText]}initialize(e,t){const r=this.getRegistrationOptions(t,e.hoverProvider);r&&this.register({id:fh.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideHover:(i,o,s)=>{const c=this._client,u=(m,C,_)=>c.sendRequest(br.HoverRequest.type,c.code2ProtocolConverter.asTextDocumentPositionParams(m,C),_).then(S=>_.isCancellationRequested?null:c.protocol2CodeConverter.asHover(S),S=>c.handleFailedRequest(br.HoverRequest.type,_,S,null)),d=c.middleware;return d.provideHover?d.provideHover(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return dh.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}Ti.HoverFeature=hh;var Pi={};Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.DefinitionFeature=void 0;const gh=ce,Bo=he,Vo=ue,ph=Ie;class mh extends Vo.TextDocumentLanguageFeature{constructor(e){super(e,Bo.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,Vo.ensure)((0,Vo.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.definitionProvider);r&&this.register({id:ph.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDefinition:(i,o,s)=>{const c=this._client,u=(m,C,_)=>c.sendRequest(Bo.DefinitionRequest.type,c.code2ProtocolConverter.asTextDocumentPositionParams(m,C),_).then(S=>_.isCancellationRequested?null:c.protocol2CodeConverter.asDefinitionResult(S,_),S=>c.handleFailedRequest(Bo.DefinitionRequest.type,_,S,null)),d=c.middleware;return d.provideDefinition?d.provideDefinition(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return gh.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}Pi.DefinitionFeature=mh;var Ei={};Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.SignatureHelpFeature=void 0;const ru=ce,Dr=he,Xo=ue,yh=Ie;class vh extends Xo.TextDocumentLanguageFeature{constructor(e){super(e,Dr.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,Xo.ensure)((0,Xo.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[Dr.MarkupKind.Markdown,Dr.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.signatureHelpProvider);r&&this.register({id:yh.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t={provideSignatureHelp:(r,i,o,s)=>{const c=this._client,u=(m,C,_,S)=>c.sendRequest(Dr.SignatureHelpRequest.type,c.code2ProtocolConverter.asSignatureHelpParams(m,C,_),S).then(y=>S.isCancellationRequested?null:c.protocol2CodeConverter.asSignatureHelp(y,S),y=>c.handleFailedRequest(Dr.SignatureHelpRequest.type,S,y,null)),d=c.middleware;return d.provideSignatureHelp?d.provideSignatureHelp(r,i,s,o,u):u(r,i,s,o)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){const r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){const i=e.triggerCharacters||[];return ru.languages.registerSignatureHelpProvider(r,t,...i)}else{const i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return ru.languages.registerSignatureHelpProvider(r,t,i)}}}Ei.SignatureHelpFeature=vh;var ki={};Object.defineProperty(ki,"__esModule",{value:!0}),ki.DocumentHighlightFeature=void 0;const Ch=ce,Jo=he,Qo=ue,_h=Ie;class wh extends Qo.TextDocumentLanguageFeature{constructor(e){super(e,Jo.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,Qo.ensure)((0,Qo.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.documentHighlightProvider);r&&this.register({id:_h.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDocumentHighlights:(i,o,s)=>{const c=this._client,u=(m,C,_)=>c.sendRequest(Jo.DocumentHighlightRequest.type,c.code2ProtocolConverter.asTextDocumentPositionParams(m,C),_).then(S=>_.isCancellationRequested?null:c.protocol2CodeConverter.asDocumentHighlights(S,_),S=>c.handleFailedRequest(Jo.DocumentHighlightRequest.type,_,S,null)),d=c.middleware;return d.provideDocumentHighlights?d.provideDocumentHighlights(i,o,s,u):u(i,o,s)}};return[Ch.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}ki.DocumentHighlightFeature=wh;var Yo={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DocumentSymbolFeature=n.SupportedSymbolTags=n.SupportedSymbolKinds=void 0;const e=ce,t=he,r=ue,i=Ie;n.SupportedSymbolKinds=[t.SymbolKind.File,t.SymbolKind.Module,t.SymbolKind.Namespace,t.SymbolKind.Package,t.SymbolKind.Class,t.SymbolKind.Method,t.SymbolKind.Property,t.SymbolKind.Field,t.SymbolKind.Constructor,t.SymbolKind.Enum,t.SymbolKind.Interface,t.SymbolKind.Function,t.SymbolKind.Variable,t.SymbolKind.Constant,t.SymbolKind.String,t.SymbolKind.Number,t.SymbolKind.Boolean,t.SymbolKind.Array,t.SymbolKind.Object,t.SymbolKind.Key,t.SymbolKind.Null,t.SymbolKind.EnumMember,t.SymbolKind.Struct,t.SymbolKind.Event,t.SymbolKind.Operator,t.SymbolKind.TypeParameter],n.SupportedSymbolTags=[t.SymbolTag.Deprecated];class o extends r.TextDocumentLanguageFeature{constructor(c){super(c,t.DocumentSymbolRequest.type)}fillClientCapabilities(c){let u=(0,r.ensure)((0,r.ensure)(c,"textDocument"),"documentSymbol");u.dynamicRegistration=!0,u.symbolKind={valueSet:n.SupportedSymbolKinds},u.hierarchicalDocumentSymbolSupport=!0,u.tagSupport={valueSet:n.SupportedSymbolTags},u.labelSupport=!0}initialize(c,u){const d=this.getRegistrationOptions(u,c.documentSymbolProvider);d&&this.register({id:i.generateUuid(),registerOptions:d})}registerLanguageProvider(c){const u=c.documentSelector,d={provideDocumentSymbols:(C,_)=>{const S=this._client,y=async(M,V)=>{try{const oe=await S.sendRequest(t.DocumentSymbolRequest.type,S.code2ProtocolConverter.asDocumentSymbolParams(M),V);if(V.isCancellationRequested||oe===void 0||oe===null)return null;if(oe.length===0)return[];{const te=oe[0];return t.DocumentSymbol.is(te)?await S.protocol2CodeConverter.asDocumentSymbols(oe,V):await S.protocol2CodeConverter.asSymbolInformations(oe,V)}}catch(oe){return S.handleFailedRequest(t.DocumentSymbolRequest.type,V,oe,null)}},O=S.middleware;return O.provideDocumentSymbols?O.provideDocumentSymbols(C,_,y):y(C,_)}},m=c.label!==void 0?{label:c.label}:void 0;return[e.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(u),d,m),d]}}n.DocumentSymbolFeature=o})(Yo);var Fi={};Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.WorkspaceSymbolFeature=void 0;const bh=ce,Sr=he,Zo=ue,iu=Yo,Dh=Ie;class Sh extends Zo.WorkspaceFeature{constructor(e){super(e,Sr.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Zo.ensure)((0,Zo.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:iu.SupportedSymbolKinds},t.tagSupport={valueSet:iu.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:Dh.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){const t={provideWorkspaceSymbols:(r,i)=>{const o=this._client,s=(u,d)=>o.sendRequest(Sr.WorkspaceSymbolRequest.type,{query:u},d).then(m=>d.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformations(m,d),m=>o.handleFailedRequest(Sr.WorkspaceSymbolRequest.type,d,m,null)),c=o.middleware;return c.provideWorkspaceSymbols?c.provideWorkspaceSymbols(r,i,s):s(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{const o=this._client,s=(u,d)=>o.sendRequest(Sr.WorkspaceSymbolResolveRequest.type,o.code2ProtocolConverter.asWorkspaceSymbol(u),d).then(m=>d.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformation(m),m=>o.handleFailedRequest(Sr.WorkspaceSymbolResolveRequest.type,d,m,null)),c=o.middleware;return c.resolveWorkspaceSymbol?c.resolveWorkspaceSymbol(r,i,s):s(r,i)}:void 0};return[bh.languages.registerWorkspaceSymbolProvider(t),t]}}Fi.WorkspaceSymbolFeature=Sh;var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.ReferencesFeature=void 0;const Rh=ce,es=he,ts=ue,Th=Ie;class Ph extends ts.TextDocumentLanguageFeature{constructor(e){super(e,es.ReferencesRequest.type)}fillClientCapabilities(e){(0,ts.ensure)((0,ts.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.referencesProvider);r&&this.register({id:Th.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideReferences:(i,o,s,c)=>{const u=this._client,d=(C,_,S,y)=>u.sendRequest(es.ReferencesRequest.type,u.code2ProtocolConverter.asReferenceParams(C,_,S),y).then(O=>y.isCancellationRequested?null:u.protocol2CodeConverter.asReferences(O,y),O=>u.handleFailedRequest(es.ReferencesRequest.type,y,O,null)),m=u.middleware;return m.provideReferences?m.provideReferences(i,o,s,c,d):d(i,o,s,c)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Rh.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}Ii.ReferencesFeature=Ph;var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.CodeActionFeature=void 0;const Eh=ce,Ft=he,kh=Ie,ns=ue;class Fh extends ns.TextDocumentLanguageFeature{constructor(e){super(e,Ft.CodeActionRequest.type)}fillClientCapabilities(e){const t=(0,ns.ensure)((0,ns.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[Ft.CodeActionKind.Empty,Ft.CodeActionKind.QuickFix,Ft.CodeActionKind.Refactor,Ft.CodeActionKind.RefactorExtract,Ft.CodeActionKind.RefactorInline,Ft.CodeActionKind.RefactorRewrite,Ft.CodeActionKind.Source,Ft.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.codeActionProvider);r&&this.register({id:kh.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideCodeActions:(i,o,s,c)=>{const u=this._client,d=async(C,_,S,y)=>{const O={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(C),range:u.code2ProtocolConverter.asRange(_),context:u.code2ProtocolConverter.asCodeActionContextSync(S)};return u.sendRequest(Ft.CodeActionRequest.type,O,y).then(M=>y.isCancellationRequested||M===null||M===void 0?null:u.protocol2CodeConverter.asCodeActionResult(M,y),M=>u.handleFailedRequest(Ft.CodeActionRequest.type,y,M,null))},m=u.middleware;return m.provideCodeActions?m.provideCodeActions(i,o,s,c,d):d(i,o,s,c)},resolveCodeAction:e.resolveProvider?(i,o)=>{const s=this._client,c=this._client.middleware,u=async(d,m)=>s.sendRequest(Ft.CodeActionResolveRequest.type,s.code2ProtocolConverter.asCodeActionSync(d),m).then(C=>m.isCancellationRequested?d:s.protocol2CodeConverter.asCodeAction(C,m),C=>s.handleFailedRequest(Ft.CodeActionResolveRequest.type,m,C,d));return c.resolveCodeAction?c.resolveCodeAction(i,o,u):u(i,o)}:void 0};return[Eh.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}}Oi.CodeActionFeature=Fh;var Ni={};Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.CodeLensFeature=void 0;const ou=ce,rr=he,Ih=Ie,Rr=ue;class Oh extends Rr.TextDocumentLanguageFeature{constructor(e){super(e,rr.CodeLensRequest.type)}fillClientCapabilities(e){(0,Rr.ensure)((0,Rr.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,Rr.ensure)((0,Rr.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(rr.CodeLensRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeCodeLensEmitter.fire()});const i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register({id:Ih.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r=new ou.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(o,s)=>{const c=this._client,u=(m,C)=>c.sendRequest(rr.CodeLensRequest.type,c.code2ProtocolConverter.asCodeLensParams(m),C).then(_=>C.isCancellationRequested?null:c.protocol2CodeConverter.asCodeLenses(_,C),_=>c.handleFailedRequest(rr.CodeLensRequest.type,C,_,null)),d=c.middleware;return d.provideCodeLenses?d.provideCodeLenses(o,s,u):u(o,s)},resolveCodeLens:e.resolveProvider?(o,s)=>{const c=this._client,u=(m,C)=>c.sendRequest(rr.CodeLensResolveRequest.type,c.code2ProtocolConverter.asCodeLens(m),C).then(_=>C.isCancellationRequested?m:c.protocol2CodeConverter.asCodeLens(_),_=>c.handleFailedRequest(rr.CodeLensResolveRequest.type,C,_,m)),d=c.middleware;return d.resolveCodeLens?d.resolveCodeLens(o,s,u):u(o,s)}:void 0};return[ou.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}}Ni.CodeLensFeature=Oh;var Sn={};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.DocumentOnTypeFormattingFeature=Sn.DocumentRangeFormattingFeature=Sn.DocumentFormattingFeature=void 0;const qi=ce,Yt=he,rs=Ie,fn=ue;var ir;(function(n){function e(t){const r=qi.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(ir||(ir={}));class Nh extends fn.TextDocumentLanguageFeature{constructor(e){super(e,Yt.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,fn.ensure)((0,fn.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.documentFormattingProvider);r&&this.register({id:rs.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDocumentFormattingEdits:(i,o,s)=>{const c=this._client,u=(m,C,_)=>{const S={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(m),options:c.code2ProtocolConverter.asFormattingOptions(C,ir.fromConfiguration(m))};return c.sendRequest(Yt.DocumentFormattingRequest.type,S,_).then(y=>_.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(y,_),y=>c.handleFailedRequest(Yt.DocumentFormattingRequest.type,_,y,null))},d=c.middleware;return d.provideDocumentFormattingEdits?d.provideDocumentFormattingEdits(i,o,s,u):u(i,o,s)}};return[qi.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}Sn.DocumentFormattingFeature=Nh;class qh extends fn.TextDocumentLanguageFeature{constructor(e){super(e,Yt.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){const t=(0,fn.ensure)((0,fn.ensure)(e,"textDocument"),"rangeFormatting");t.dynamicRegistration=!0,t.rangesSupport=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);r&&this.register({id:rs.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,o,s,c)=>{const u=this._client,d=(C,_,S,y)=>{const O={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(C),range:u.code2ProtocolConverter.asRange(_),options:u.code2ProtocolConverter.asFormattingOptions(S,ir.fromConfiguration(C))};return u.sendRequest(Yt.DocumentRangeFormattingRequest.type,O,y).then(M=>y.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(M,y),M=>u.handleFailedRequest(Yt.DocumentRangeFormattingRequest.type,y,M,null))},m=u.middleware;return m.provideDocumentRangeFormattingEdits?m.provideDocumentRangeFormattingEdits(i,o,s,c,d):d(i,o,s,c)}};return e.rangesSupport&&(r.provideDocumentRangesFormattingEdits=(i,o,s,c)=>{const u=this._client,d=(C,_,S,y)=>{const O={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(C),ranges:u.code2ProtocolConverter.asRanges(_),options:u.code2ProtocolConverter.asFormattingOptions(S,ir.fromConfiguration(C))};return u.sendRequest(Yt.DocumentRangesFormattingRequest.type,O,y).then(M=>y.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(M,y),M=>u.handleFailedRequest(Yt.DocumentRangesFormattingRequest.type,y,M,null))},m=u.middleware;return m.provideDocumentRangesFormattingEdits?m.provideDocumentRangesFormattingEdits(i,o,s,c,d):d(i,o,s,c)}),[qi.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}Sn.DocumentRangeFormattingFeature=qh;class $h extends fn.TextDocumentLanguageFeature{constructor(e){super(e,Yt.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,fn.ensure)((0,fn.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);r&&this.register({id:rs.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideOnTypeFormattingEdits:(o,s,c,u,d)=>{const m=this._client,C=(S,y,O,M,V)=>{let oe={textDocument:m.code2ProtocolConverter.asTextDocumentIdentifier(S),position:m.code2ProtocolConverter.asPosition(y),ch:O,options:m.code2ProtocolConverter.asFormattingOptions(M,ir.fromConfiguration(S))};return m.sendRequest(Yt.DocumentOnTypeFormattingRequest.type,oe,V).then(te=>V.isCancellationRequested?null:m.protocol2CodeConverter.asTextEdits(te,V),te=>m.handleFailedRequest(Yt.DocumentOnTypeFormattingRequest.type,V,te,null))},_=m.middleware;return _.provideOnTypeFormattingEdits?_.provideOnTypeFormattingEdits(o,s,c,u,d,C):C(o,s,c,u,d)}},i=e.moreTriggerCharacter||[];return[qi.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}}Sn.DocumentOnTypeFormattingFeature=$h;var $i={};Object.defineProperty($i,"__esModule",{value:!0}),$i.RenameFeature=void 0;const Mh=ce,On=he,Lh=Ie,su=$e,is=ue;class Ah extends is.TextDocumentLanguageFeature{constructor(e){super(e,On.RenameRequest.type)}fillClientCapabilities(e){let t=(0,is.ensure)((0,is.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=On.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.renameProvider);r&&(su.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:Lh.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){const t=e.documentSelector,r={provideRenameEdits:(i,o,s,c)=>{const u=this._client,d=(C,_,S,y)=>{let O={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(C),position:u.code2ProtocolConverter.asPosition(_),newName:S};return u.sendRequest(On.RenameRequest.type,O,y).then(M=>y.isCancellationRequested?null:u.protocol2CodeConverter.asWorkspaceEdit(M,y),M=>u.handleFailedRequest(On.RenameRequest.type,y,M,null,!1))},m=u.middleware;return m.provideRenameEdits?m.provideRenameEdits(i,o,s,c,d):d(i,o,s,c)},prepareRename:e.prepareProvider?(i,o,s)=>{const c=this._client,u=(m,C,_)=>{let S={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(m),position:c.code2ProtocolConverter.asPosition(C)};return c.sendRequest(On.PrepareRenameRequest.type,S,_).then(y=>_.isCancellationRequested?null:On.Range.is(y)?c.protocol2CodeConverter.asRange(y):this.isDefaultBehavior(y)?y.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):y&&On.Range.is(y.range)?{range:c.protocol2CodeConverter.asRange(y.range),placeholder:y.placeholder}:Promise.reject(new Error("The element can't be renamed.")),y=>{throw typeof y.message=="string"?new Error(y.message):new Error("The element can't be renamed.")})},d=c.middleware;return d.prepareRename?d.prepareRename(i,o,s,u):u(i,o,s)}:void 0};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Mh.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){const t=e;return t&&su.boolean(t.defaultBehavior)}}$i.RenameFeature=Ah;var Mi={};Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.DocumentLinkFeature=void 0;const jh=ce,Tr=he,os=ue,xh=Ie;class Hh extends os.TextDocumentLanguageFeature{constructor(e){super(e,Tr.DocumentLinkRequest.type)}fillClientCapabilities(e){const t=(0,os.ensure)((0,os.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.documentLinkProvider);r&&this.register({id:xh.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDocumentLinks:(i,o)=>{const s=this._client,c=(d,m)=>s.sendRequest(Tr.DocumentLinkRequest.type,s.code2ProtocolConverter.asDocumentLinkParams(d),m).then(C=>m.isCancellationRequested?null:s.protocol2CodeConverter.asDocumentLinks(C,m),C=>s.handleFailedRequest(Tr.DocumentLinkRequest.type,m,C,null)),u=s.middleware;return u.provideDocumentLinks?u.provideDocumentLinks(i,o,c):c(i,o)},resolveDocumentLink:e.resolveProvider?(i,o)=>{const s=this._client;let c=(d,m)=>s.sendRequest(Tr.DocumentLinkResolveRequest.type,s.code2ProtocolConverter.asDocumentLink(d),m).then(C=>m.isCancellationRequested?d:s.protocol2CodeConverter.asDocumentLink(C),C=>s.handleFailedRequest(Tr.DocumentLinkResolveRequest.type,m,C,d));const u=s.middleware;return u.resolveDocumentLink?u.resolveDocumentLink(i,o,c):c(i,o)}:void 0};return[jh.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}Mi.DocumentLinkFeature=Hh;var Li={};Object.defineProperty(Li,"__esModule",{value:!0}),Li.ExecuteCommandFeature=void 0;const Wh=ce,ss=he,Uh=Ie,au=ue;class Kh{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return ss.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,au.ensure)((0,au.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:Uh.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){const t=this._client,r=t.middleware,i=(o,s)=>{let c={command:o,arguments:s};return t.sendRequest(ss.ExecuteCommandRequest.type,c).then(void 0,u=>t.handleFailedRequest(ss.ExecuteCommandRequest.type,void 0,u,void 0))};if(e.registerOptions.commands){const o=[];for(const s of e.registerOptions.commands)o.push(Wh.commands.registerCommand(s,(...c)=>r.executeCommand?r.executeCommand(s,c,i):i(s,c)));this._commands.set(e.id,o)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}clear(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}}Li.ExecuteCommandFeature=Kh;var Ai={};Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.FileSystemWatcherFeature=void 0;const zh=ce,Nn=he,ji=ue;class Gh{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return Nn.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,ji.ensure)((0,ji.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,ji.ensure)((0,ji.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;const t=[];for(const r of e.registerOptions.watchers){const i=this._client.protocol2CodeConverter.asGlobPattern(r.globPattern);if(i===void 0)continue;let o=!0,s=!0,c=!0;r.kind!==void 0&&r.kind!==null&&(o=(r.kind&Nn.WatchKind.Create)!==0,s=(r.kind&Nn.WatchKind.Change)!==0,c=(r.kind&Nn.WatchKind.Delete)!==0);const u=zh.workspace.createFileSystemWatcher(i,!o,!s,!c);this.hookListeners(u,o,s,c,t),t.push(u)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,o){t&&e.onDidCreate(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Nn.FileChangeType.Created}),null,o),r&&e.onDidChange(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Nn.FileChangeType.Changed}),null,o),i&&e.onDidDelete(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Nn.FileChangeType.Deleted}),null,o)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}clear(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}}Ai.FileSystemWatcherFeature=Gh;var xi={};Object.defineProperty(xi,"__esModule",{value:!0}),xi.ColorProviderFeature=void 0;const Bh=ce,Pr=he,as=ue;class Vh extends as.TextDocumentLanguageFeature{constructor(e){super(e,Pr.DocumentColorRequest.type)}fillClientCapabilities(e){(0,as.ensure)((0,as.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideColorPresentations:(i,o,s)=>{const c=this._client,u=(m,C,_)=>{const S={color:m,textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(C.document),range:c.code2ProtocolConverter.asRange(C.range)};return c.sendRequest(Pr.ColorPresentationRequest.type,S,_).then(y=>_.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(y,_),y=>c.handleFailedRequest(Pr.ColorPresentationRequest.type,_,y,null))},d=c.middleware;return d.provideColorPresentations?d.provideColorPresentations(i,o,s,u):u(i,o,s)},provideDocumentColors:(i,o)=>{const s=this._client,c=(d,m)=>{const C={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(d)};return s.sendRequest(Pr.DocumentColorRequest.type,C,m).then(_=>m.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(_,m),_=>s.handleFailedRequest(Pr.DocumentColorRequest.type,m,_,null))},u=s.middleware;return u.provideDocumentColors?u.provideDocumentColors(i,o,c):c(i,o)}};return[Bh.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}xi.ColorProviderFeature=Vh;var Hi={};Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.ImplementationFeature=void 0;const Xh=ce,cs=he,us=ue;class Jh extends us.TextDocumentLanguageFeature{constructor(e){super(e,cs.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,us.ensure)((0,us.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideImplementation:(i,o,s)=>{const c=this._client,u=(m,C,_)=>c.sendRequest(cs.ImplementationRequest.type,c.code2ProtocolConverter.asTextDocumentPositionParams(m,C),_).then(S=>_.isCancellationRequested?null:c.protocol2CodeConverter.asDefinitionResult(S,_),S=>c.handleFailedRequest(cs.ImplementationRequest.type,_,S,null)),d=c.middleware;return d.provideImplementation?d.provideImplementation(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Xh.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}Hi.ImplementationFeature=Jh;var Wi={};Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.TypeDefinitionFeature=void 0;const Qh=ce,ls=he,Er=ue;class Yh extends Er.TextDocumentLanguageFeature{constructor(e){super(e,ls.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,Er.ensure)((0,Er.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,Er.ensure)((0,Er.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideTypeDefinition:(i,o,s)=>{const c=this._client,u=(m,C,_)=>c.sendRequest(ls.TypeDefinitionRequest.type,c.code2ProtocolConverter.asTextDocumentPositionParams(m,C),_).then(S=>_.isCancellationRequested?null:c.protocol2CodeConverter.asDefinitionResult(S,_),S=>c.handleFailedRequest(ls.TypeDefinitionRequest.type,_,S,null)),d=c.middleware;return d.provideTypeDefinition?d.provideTypeDefinition(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Qh.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}Wi.TypeDefinitionFeature=Yh;var or={};Object.defineProperty(or,"__esModule",{value:!0}),or.WorkspaceFoldersFeature=or.arrayDiff=void 0;const Zh=Ie,Ui=ce,kr=he;function ds(n,e){if(n!=null)return n[e]}function fs(n,e){return n.filter(t=>e.indexOf(t)<0)}or.arrayDiff=fs;class eg{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return kr.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){const t=Ui.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){const t=this._client;t.onRequest(kr.WorkspaceFoldersRequest.type,o=>{const s=()=>{const u=Ui.workspace.workspaceFolders;return u===void 0?null:u.map(m=>this.asProtocol(m))},c=t.middleware.workspace;return c&&c.workspaceFolders?c.workspaceFolders(o,s):s()});const r=ds(ds(ds(e,"workspace"),"workspaceFolders"),"changeNotifications");let i;typeof r=="string"?i=r:r===!0&&(i=Zh.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){const r=fs(this._initialFolders,e),i=fs(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${kr.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(kr.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=Ui.workspace.onDidChangeWorkspaceFolders(o=>{let s=d=>this.doSendEvent(d.added,d.removed),c=r.middleware.workspace;(c&&c.didChangeWorkspaceFolders?c.didChangeWorkspaceFolders(o,s):s(o)).catch(d=>{this._client.error(`Sending notification ${kr.DidChangeWorkspaceFoldersNotification.type.method} failed`,d)})});this._listeners.set(t,i),this.sendInitialEvent(Ui.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}}or.WorkspaceFoldersFeature=eg;var Ki={};Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.FoldingRangeFeature=void 0;const cu=ce,qn=he,Fr=ue;class tg extends Fr.TextDocumentLanguageFeature{constructor(e){super(e,qn.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,Fr.ensure)((0,Fr.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[qn.FoldingRangeKind.Comment,qn.FoldingRangeKind.Imports,qn.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1},(0,Fr.ensure)((0,Fr.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,t){this._client.onRequest(qn.FoldingRangeRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeFoldingRange.fire()});let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r=new cu.EventEmitter,i={onDidChangeFoldingRanges:r.event,provideFoldingRanges:(o,s,c)=>{const u=this._client,d=(C,_,S)=>{const y={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(C)};return u.sendRequest(qn.FoldingRangeRequest.type,y,S).then(O=>S.isCancellationRequested?null:u.protocol2CodeConverter.asFoldingRanges(O,S),O=>u.handleFailedRequest(qn.FoldingRangeRequest.type,S,O,null))},m=u.middleware;return m.provideFoldingRanges?m.provideFoldingRanges(o,s,c,d):d(o,s,c)}};return[cu.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeFoldingRange:r}]}}Ki.FoldingRangeFeature=tg;var zi={};Object.defineProperty(zi,"__esModule",{value:!0}),zi.DeclarationFeature=void 0;const ng=ce,hs=he,gs=ue;class rg extends gs.TextDocumentLanguageFeature{constructor(e){super(e,hs.DeclarationRequest.type)}fillClientCapabilities(e){const t=(0,gs.ensure)((0,gs.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDeclaration:(i,o,s)=>{const c=this._client,u=(m,C,_)=>c.sendRequest(hs.DeclarationRequest.type,c.code2ProtocolConverter.asTextDocumentPositionParams(m,C),_).then(S=>_.isCancellationRequested?null:c.protocol2CodeConverter.asDeclarationResult(S,_),S=>c.handleFailedRequest(hs.DeclarationRequest.type,_,S,null)),d=c.middleware;return d.provideDeclaration?d.provideDeclaration(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return ng.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}zi.DeclarationFeature=rg;var Gi={};Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.SelectionRangeFeature=void 0;const ig=ce,ps=he,ms=ue;class og extends ms.TextDocumentLanguageFeature{constructor(e){super(e,ps.SelectionRangeRequest.type)}fillClientCapabilities(e){const t=(0,ms.ensure)((0,ms.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){const[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideSelectionRanges:(i,o,s)=>{const c=this._client,u=async(m,C,_)=>{const S={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(m),positions:c.code2ProtocolConverter.asPositionsSync(C,_)};return c.sendRequest(ps.SelectionRangeRequest.type,S,_).then(y=>_.isCancellationRequested?null:c.protocol2CodeConverter.asSelectionRanges(y,_),y=>c.handleFailedRequest(ps.SelectionRangeRequest.type,_,y,null))},d=c.middleware;return d.provideSelectionRanges?d.provideSelectionRanges(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return ig.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}Gi.SelectionRangeFeature=og;var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.ProgressFeature=void 0;const uu=he,sg=Cr;function ag(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}class cg{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:uu.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){ag(e,"window").workDoneProgress=!0}initialize(){const e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new sg.ProgressPart(this._client,i.token,t))};e.onRequest(uu.WorkDoneProgressCreateRequest.type,r)}clear(){for(const e of this.activeParts)e.done();this.activeParts.clear()}}Bi.ProgressFeature=cg;var Vi={};Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.CallHierarchyFeature=void 0;const ug=ce,$n=he,ys=ue;class lg{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,r){const i=this.client,o=this.middleware,s=(c,u,d)=>{const m=i.code2ProtocolConverter.asTextDocumentPositionParams(c,u);return i.sendRequest($n.CallHierarchyPrepareRequest.type,m,d).then(C=>d.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(C,d),C=>i.handleFailedRequest($n.CallHierarchyPrepareRequest.type,d,C,null))};return o.prepareCallHierarchy?o.prepareCallHierarchy(e,t,r,s):s(e,t,r)}provideCallHierarchyIncomingCalls(e,t){const r=this.client,i=this.middleware,o=(s,c)=>{const u={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest($n.CallHierarchyIncomingCallsRequest.type,u,c).then(d=>c.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(d,c),d=>r.handleFailedRequest($n.CallHierarchyIncomingCallsRequest.type,c,d,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,o):o(e,t)}provideCallHierarchyOutgoingCalls(e,t){const r=this.client,i=this.middleware,o=(s,c)=>{const u={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest($n.CallHierarchyOutgoingCallsRequest.type,u,c).then(d=>c.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(d,c),d=>r.handleFailedRequest($n.CallHierarchyOutgoingCallsRequest.type,c,d,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,o):o(e,t)}}class dg extends ys.TextDocumentLanguageFeature{constructor(e){super(e,$n.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){const t=e,r=(0,ys.ensure)((0,ys.ensure)(t,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){const[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=this._client,r=new lg(t);return[ug.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}}Vi.CallHierarchyFeature=dg;var Xi={};Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.SemanticTokensFeature=void 0;const Ji=ce,me=he,Ir=ue,fg=$e;class hg extends Ir.TextDocumentLanguageFeature{constructor(e){super(e,me.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){const t=(0,Ir.ensure)((0,Ir.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[me.SemanticTokenTypes.namespace,me.SemanticTokenTypes.type,me.SemanticTokenTypes.class,me.SemanticTokenTypes.enum,me.SemanticTokenTypes.interface,me.SemanticTokenTypes.struct,me.SemanticTokenTypes.typeParameter,me.SemanticTokenTypes.parameter,me.SemanticTokenTypes.variable,me.SemanticTokenTypes.property,me.SemanticTokenTypes.enumMember,me.SemanticTokenTypes.event,me.SemanticTokenTypes.function,me.SemanticTokenTypes.method,me.SemanticTokenTypes.macro,me.SemanticTokenTypes.keyword,me.SemanticTokenTypes.modifier,me.SemanticTokenTypes.comment,me.SemanticTokenTypes.string,me.SemanticTokenTypes.number,me.SemanticTokenTypes.regexp,me.SemanticTokenTypes.operator,me.SemanticTokenTypes.decorator],t.tokenModifiers=[me.SemanticTokenModifiers.declaration,me.SemanticTokenModifiers.definition,me.SemanticTokenModifiers.readonly,me.SemanticTokenModifiers.static,me.SemanticTokenModifiers.deprecated,me.SemanticTokenModifiers.abstract,me.SemanticTokenModifiers.async,me.SemanticTokenModifiers.modification,me.SemanticTokenModifiers.documentation,me.SemanticTokenModifiers.defaultLibrary],t.formats=[me.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,Ir.ensure)((0,Ir.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(me.SemanticTokensRefreshRequest.type,async()=>{for(const s of this.getAllProviders())s.onDidChangeSemanticTokensEmitter.fire()});const[i,o]=this.getRegistration(t,e.semanticTokensProvider);!i||!o||this.register({id:i,registerOptions:o})}registerLanguageProvider(e){const t=e.documentSelector,r=fg.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,o=new Ji.EventEmitter,s=r?{onDidChangeSemanticTokens:o.event,provideDocumentSemanticTokens:(S,y)=>{const O=this._client,M=O.middleware,V=(oe,te)=>{const Te={textDocument:O.code2ProtocolConverter.asTextDocumentIdentifier(oe)};return O.sendRequest(me.SemanticTokensRequest.type,Te,te).then(fe=>te.isCancellationRequested?null:O.protocol2CodeConverter.asSemanticTokens(fe,te),fe=>O.handleFailedRequest(me.SemanticTokensRequest.type,te,fe,null))};return M.provideDocumentSemanticTokens?M.provideDocumentSemanticTokens(S,y,V):V(S,y)},provideDocumentSemanticTokensEdits:i?(S,y,O)=>{const M=this._client,V=M.middleware,oe=(te,Te,fe)=>{const le={textDocument:M.code2ProtocolConverter.asTextDocumentIdentifier(te),previousResultId:Te};return M.sendRequest(me.SemanticTokensDeltaRequest.type,le,fe).then(async x=>fe.isCancellationRequested?null:me.SemanticTokens.is(x)?await M.protocol2CodeConverter.asSemanticTokens(x,fe):await M.protocol2CodeConverter.asSemanticTokensEdits(x,fe),x=>M.handleFailedRequest(me.SemanticTokensDeltaRequest.type,fe,x,null))};return V.provideDocumentSemanticTokensEdits?V.provideDocumentSemanticTokensEdits(S,y,O,oe):oe(S,y,O)}:void 0}:void 0,u=e.range===!0?{provideDocumentRangeSemanticTokens:(S,y,O)=>{const M=this._client,V=M.middleware,oe=(te,Te,fe)=>{const le={textDocument:M.code2ProtocolConverter.asTextDocumentIdentifier(te),range:M.code2ProtocolConverter.asRange(Te)};return M.sendRequest(me.SemanticTokensRangeRequest.type,le,fe).then(x=>fe.isCancellationRequested?null:M.protocol2CodeConverter.asSemanticTokens(x,fe),x=>M.handleFailedRequest(me.SemanticTokensRangeRequest.type,fe,x,null))};return V.provideDocumentRangeSemanticTokens?V.provideDocumentRangeSemanticTokens(S,y,O,oe):oe(S,y,O)}}:void 0,d=[],m=this._client,C=m.protocol2CodeConverter.asSemanticTokensLegend(e.legend),_=m.protocol2CodeConverter.asDocumentSelector(t);return s!==void 0&&d.push(Ji.languages.registerDocumentSemanticTokensProvider(_,s,C)),u!==void 0&&d.push(Ji.languages.registerDocumentRangeSemanticTokensProvider(_,u,C)),[new Ji.Disposable(()=>d.forEach(S=>S.dispose())),{range:u,full:s,onDidChangeSemanticTokensEmitter:o}]}}Xi.SemanticTokensFeature=hg;var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.WillDeleteFilesFeature=Dt.WillRenameFilesFeature=Dt.WillCreateFilesFeature=Dt.DidDeleteFilesFeature=Dt.DidRenameFilesFeature=Dt.DidCreateFilesFeature=void 0;const zt=ce,gg=mi,hn=he,pg=Ie;function lu(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function mg(n,e){return n[e]}function du(n,e,t){n[e]=t}class jn{constructor(e,t,r,i,o){this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=o,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){const t=lu(lu(e,"workspace"),"fileOperations");du(t,"dynamicRegistration",!0),du(t,this._clientCapability,!0)}initialize(e){const t=e.workspace?.fileOperations,r=t!==void 0?mg(t,this._serverCapability):void 0;if(r?.filters!==void 0)try{this.register({id:pg.generateUuid(),registerOptions:{filters:r.filters}})}catch(i){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${i}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));const t=e.registerOptions.filters.map(r=>{const i=new gg.Minimatch(r.pattern.glob,jn.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return jn.getFileType(e)}async filter(e,t){const r=await Promise.all(e.files.map(async o=>{const s=t(o),c=s.fsPath.replace(/\\/g,"/");for(const u of this._filters.values())for(const d of u)if(!(d.scheme!==void 0&&d.scheme!==s.scheme)){if(d.matcher.match(c)){if(d.kind===void 0)return!0;const m=await this.getFileType(s);if(m===void 0)return this._client.error(`Failed to determine file type for ${s.toString()}.`),!0;if(m===zt.FileType.File&&d.kind===hn.FileOperationPatternKind.file||m===zt.FileType.Directory&&d.kind===hn.FileOperationPatternKind.folder)return!0}else if(d.kind===hn.FileOperationPatternKind.folder&&await jn.getFileType(s)===zt.FileType.Directory&&d.matcher.match(`${c}/`))return!0}return!1})),i=e.files.filter((o,s)=>r[s]);return{...e,files:i}}static async getFileType(e){try{return(await zt.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){const t={dot:!0};return e?.ignoreCase===!0&&(t.nocase=!0),t}}class fu extends jn{constructor(e,t,r,i,o,s,c){super(e,t,r,i,o),this._notificationType=r,this._accessUri=s,this._createParams=c}async send(e){const t=await this.filter(e,this._accessUri);if(t.files.length){const r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}}class hu extends fu{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){const t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);const r=await jn.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}}class yg extends fu{constructor(e){super(e,zt.workspace.onDidCreateFiles,hn.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){const r=this._client.middleware.workspace;return r?.didCreateFiles?r.didCreateFiles(e,t):t(e)}}Dt.DidCreateFilesFeature=yg;class vg extends hu{constructor(e){super(e,zt.workspace.onDidRenameFiles,hn.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=zt.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();const r=this._client.middleware.workspace;return r?.didRenameFiles?r.didRenameFiles(e,t):t(e)}}Dt.DidRenameFilesFeature=vg;class Cg extends hu{constructor(e){super(e,zt.workspace.onDidDeleteFiles,hn.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=zt.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();const r=this._client.middleware.workspace;return r?.didDeleteFiles?r.didDeleteFiles(e,t):t(e)}}Dt.DidDeleteFilesFeature=Cg;class vs extends jn{constructor(e,t,r,i,o,s,c){super(e,t,r,i,o),this._requestType=r,this._accessUri=s,this._createParams=c}async send(e){const t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){const t=await this.filter(e,this._accessUri);if(t.files.length){const r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}}class _g extends vs{constructor(e){super(e,zt.workspace.onWillCreateFiles,hn.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){const r=this._client.middleware.workspace;return r?.willCreateFiles?r.willCreateFiles(e,t):t(e)}}Dt.WillCreateFilesFeature=_g;class wg extends vs{constructor(e){super(e,zt.workspace.onWillRenameFiles,hn.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){const r=this._client.middleware.workspace;return r?.willRenameFiles?r.willRenameFiles(e,t):t(e)}}Dt.WillRenameFilesFeature=wg;class bg extends vs{constructor(e){super(e,zt.workspace.onWillDeleteFiles,hn.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){const r=this._client.middleware.workspace;return r?.willDeleteFiles?r.willDeleteFiles(e,t):t(e)}}Dt.WillDeleteFilesFeature=bg;var Qi={};Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.LinkedEditingFeature=void 0;const Dg=ce,Cs=he,_s=ue;class Sg extends _s.TextDocumentLanguageFeature{constructor(e){super(e,Cs.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){const t=(0,_s.ensure)((0,_s.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideLinkedEditingRanges:(i,o,s)=>{const c=this._client,u=(m,C,_)=>c.sendRequest(Cs.LinkedEditingRangeRequest.type,c.code2ProtocolConverter.asTextDocumentPositionParams(m,C),_).then(S=>_.isCancellationRequested?null:c.protocol2CodeConverter.asLinkedEditingRanges(S,_),S=>c.handleFailedRequest(Cs.LinkedEditingRangeRequest.type,_,S,null)),d=c.middleware;return d.provideLinkedEditingRange?d.provideLinkedEditingRange(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Dg.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}Qi.LinkedEditingFeature=Sg;var Yi={};Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.TypeHierarchyFeature=void 0;const Rg=ce,Mn=he,ws=ue;class Tg{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,r){const i=this.client,o=this.middleware,s=(c,u,d)=>{const m=i.code2ProtocolConverter.asTextDocumentPositionParams(c,u);return i.sendRequest(Mn.TypeHierarchyPrepareRequest.type,m,d).then(C=>d.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(C,d),C=>i.handleFailedRequest(Mn.TypeHierarchyPrepareRequest.type,d,C,null))};return o.prepareTypeHierarchy?o.prepareTypeHierarchy(e,t,r,s):s(e,t,r)}provideTypeHierarchySupertypes(e,t){const r=this.client,i=this.middleware,o=(s,c)=>{const u={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(Mn.TypeHierarchySupertypesRequest.type,u,c).then(d=>c.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(d,c),d=>r.handleFailedRequest(Mn.TypeHierarchySupertypesRequest.type,c,d,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,o):o(e,t)}provideTypeHierarchySubtypes(e,t){const r=this.client,i=this.middleware,o=(s,c)=>{const u={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(Mn.TypeHierarchySubtypesRequest.type,u,c).then(d=>c.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(d,c),d=>r.handleFailedRequest(Mn.TypeHierarchySubtypesRequest.type,c,d,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,o):o(e,t)}}class Pg extends ws.TextDocumentLanguageFeature{constructor(e){super(e,Mn.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){const t=(0,ws.ensure)((0,ws.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){const[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=this._client,r=new Tg(t);return[Rg.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}}Yi.TypeHierarchyFeature=Pg;var Zi={};Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.InlineValueFeature=void 0;const gu=ce,eo=he,Or=ue;class Eg extends Or.TextDocumentLanguageFeature{constructor(e){super(e,eo.InlineValueRequest.type)}fillClientCapabilities(e){(0,Or.ensure)((0,Or.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,Or.ensure)((0,Or.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(eo.InlineValueRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeInlineValues.fire()});const[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r=new gu.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(o,s,c,u)=>{const d=this._client,m=(_,S,y,O)=>{const M={textDocument:d.code2ProtocolConverter.asTextDocumentIdentifier(_),range:d.code2ProtocolConverter.asRange(S),context:d.code2ProtocolConverter.asInlineValueContext(y)};return d.sendRequest(eo.InlineValueRequest.type,M,O).then(V=>O.isCancellationRequested?null:d.protocol2CodeConverter.asInlineValues(V,O),V=>d.handleFailedRequest(eo.InlineValueRequest.type,O,V,null))},C=d.middleware;return C.provideInlineValues?C.provideInlineValues(o,s,c,u,m):m(o,s,c,u)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:r}]}registerProvider(e,t){return gu.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}Zi.InlineValueFeature=Eg;var to={};Object.defineProperty(to,"__esModule",{value:!0}),to.InlayHintsFeature=void 0;const pu=ce,sr=he,Nr=ue;class kg extends Nr.TextDocumentLanguageFeature{constructor(e){super(e,sr.InlayHintRequest.type)}fillClientCapabilities(e){const t=(0,Nr.ensure)((0,Nr.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,Nr.ensure)((0,Nr.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(sr.InlayHintRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeInlayHints.fire()});const[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r=new pu.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(o,s,c)=>{const u=this._client,d=async(C,_,S)=>{const y={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(C),range:u.code2ProtocolConverter.asRange(_)};try{const O=await u.sendRequest(sr.InlayHintRequest.type,y,S);return S.isCancellationRequested?null:u.protocol2CodeConverter.asInlayHints(O,S)}catch(O){return u.handleFailedRequest(sr.InlayHintRequest.type,S,O,null)}},m=u.middleware;return m.provideInlayHints?m.provideInlayHints(o,s,c,d):d(o,s,c)}};return i.resolveInlayHint=e.resolveProvider===!0?(o,s)=>{const c=this._client,u=async(m,C)=>{try{const _=await c.sendRequest(sr.InlayHintResolveRequest.type,c.code2ProtocolConverter.asInlayHint(m),C);if(C.isCancellationRequested)return null;const S=c.protocol2CodeConverter.asInlayHint(_,C);return C.isCancellationRequested?null:S}catch(_){return c.handleFailedRequest(sr.InlayHintResolveRequest.type,C,_,null)}},d=c.middleware;return d.resolveInlayHint?d.resolveInlayHint(o,s,u):u(o,s)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:r}]}registerProvider(e,t){return pu.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}to.InlayHintsFeature=kg;var no={};Object.defineProperty(no,"__esModule",{value:!0}),no.InlineCompletionItemFeature=void 0;const Fg=ce,bs=he,Ds=ue,Ig=Ie;class Og extends Ds.TextDocumentLanguageFeature{constructor(e){super(e,bs.InlineCompletionRequest.type)}fillClientCapabilities(e){let t=(0,Ds.ensure)((0,Ds.ensure)(e,"textDocument"),"inlineCompletion");t.dynamicRegistration=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.inlineCompletionProvider);r&&this.register({id:Ig.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideInlineCompletionItems:(i,o,s,c)=>{const u=this._client,d=this._client.middleware,m=(C,_,S,y)=>u.sendRequest(bs.InlineCompletionRequest.type,u.code2ProtocolConverter.asInlineCompletionParams(C,_,S),y).then(O=>y.isCancellationRequested?null:u.protocol2CodeConverter.asInlineCompletionResult(O,y),O=>u.handleFailedRequest(bs.InlineCompletionRequest.type,y,O,null));return d.provideInlineCompletionItems?d.provideInlineCompletionItems(i,o,s,c,m):m(i,o,s,c)}};return[Fg.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}no.InlineCompletionItemFeature=Og,Object.defineProperty(tt,"__esModule",{value:!0}),tt.ProposedFeatures=tt.BaseLanguageClient=tt.MessageTransports=tt.SuspendMode=tt.State=tt.CloseAction=tt.ErrorAction=tt.RevealOutputChannelOn=void 0;const Le=ce,z=he,Ng=ii,qg=gi,Zt=$e,ro=it,mu=Ie,$g=Cr,en=ue,Mg=un,yu=wi,vu=Dn,ar=bt,Lg=Ri,Ag=Ti,jg=Pi,xg=Ei,Hg=ki,Wg=Yo,Ug=Fi,Kg=Ii,zg=Oi,Gg=Ni,Ss=Sn,Bg=$i,Vg=Mi,Xg=Li,Jg=Ai,Qg=xi,Yg=Hi,Zg=Wi,ep=or,tp=Ki,np=zi,rp=Gi,ip=Bi,op=Vi,sp=Xi,cr=Dt,ap=Qi,cp=Yi,up=Zi,lp=to,dp=no;var Ln;(function(n){n[n.Debug=0]="Debug",n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(Ln||(tt.RevealOutputChannelOn=Ln={}));var qr;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(qr||(tt.ErrorAction=qr={}));var Rn;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(Rn||(tt.CloseAction=Rn={}));var $r;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})($r||(tt.State=$r={}));var Cu;(function(n){n.off="off",n.on="on"})(Cu||(tt.SuspendMode=Cu={}));var Rs;(function(n){function e(t){return t==null?!1:typeof t=="boolean"||typeof t=="object"&&t!==null&&Zt.stringArray(t.enabledCommands)?t:!1}n.sanitizeIsTrusted=e})(Rs||(Rs={}));class fp{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:qr.Continue}:{action:qr.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:Rn.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:Rn.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:Rn.Restart})}}var Se;(function(n){n.Initial="initial",n.Starting="starting",n.StartFailed="startFailed",n.Running="running",n.Stopping="stopping",n.Stopped="stopped"})(Se||(Se={}));var _u;(function(n){function e(t){return t&&z.MessageReader.is(t.reader)&&z.MessageWriter.is(t.writer)}n.is=e})(_u||(tt.MessageTransports=_u={}));class xn{constructor(e,t,r){this._traceFormat=z.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new ro.Semaphore(1),this._id=e,this._name=t,r=r||{};const i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=Rs.sanitizeIsTrusted(r.markdown.isTrusted),i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??Ln.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler(r.connectionOptions?.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=Se.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new ro.Semaphore(1),this._pendingChangeDelayer=new ro.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new ro.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new z.Emitter,this._stateChangeEmitter=new z.Emitter,this._trace=z.Trace.Off,this._tracer={log:(o,s)=>{Zt.string(o)?this.logTrace(o,s):this.logObjectTrace(o)}},this._c2p=Ng.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=qg.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=Le.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){switch(this.$state){case Se.Starting:return $r.Starting;case Se.Running:return $r.Running;default:return $r.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===Se.StartFailed||this.$state===Se.Stopping||this.$state===Se.Stopped)return Promise.reject(new z.ResponseError(z.ErrorCodes.ConnectionInactive,"Client is not running"));const r=await this.$start();this._didChangeTextDocumentFeature.syncKind===z.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(r);const i=this._clientOptions.middleware?.sendRequest;if(i!==void 0){let o,s;return t.length===1?z.CancellationToken.is(t[0])?s=t[0]:o=t[0]:t.length===2&&(o=t[0],s=t[1]),i(e,o,s,(c,u,d)=>{const m=[];return u!==void 0&&m.push(u),d!==void 0&&m.push(d),r.sendRequest(c,...m)})}else return r.sendRequest(e,...t)}onRequest(e,t){const r=typeof e=="string"?e:e.method;this._requestHandlers.set(r,t);const i=this.activeConnection();let o;return i!==void 0?(this._requestDisposables.set(r,i.onRequest(e,t)),o={dispose:()=>{const s=this._requestDisposables.get(r);s!==void 0&&(s.dispose(),this._requestDisposables.delete(r))}}):(this._pendingRequestHandlers.set(r,t),o={dispose:()=>{this._pendingRequestHandlers.delete(r);const s=this._requestDisposables.get(r);s!==void 0&&(s.dispose(),this._requestDisposables.delete(r))}}),{dispose:()=>{this._requestHandlers.delete(r),o.dispose()}}}async sendNotification(e,t){if(this.$state===Se.StartFailed||this.$state===Se.Stopping||this.$state===Se.Stopped)return Promise.reject(new z.ResponseError(z.ErrorCodes.ConnectionInactive,"Client is not running"));const r=this._didChangeTextDocumentFeature.syncKind===z.TextDocumentSyncKind.Full;let i;r&&typeof e!="string"&&e.method===z.DidOpenTextDocumentNotification.method&&(i=t?.textDocument.uri,this._pendingOpenNotifications.add(i));const o=await this.$start();r&&await this.sendPendingFullTextDocumentChanges(o),i!==void 0&&this._pendingOpenNotifications.delete(i);const s=this._clientOptions.middleware?.sendNotification;return s?s(e,o.sendNotification.bind(o),t):o.sendNotification(e,t)}onNotification(e,t){const r=typeof e=="string"?e:e.method;this._notificationHandlers.set(r,t);const i=this.activeConnection();let o;return i!==void 0?(this._notificationDisposables.set(r,i.onNotification(e,t)),o={dispose:()=>{const s=this._notificationDisposables.get(r);s!==void 0&&(s.dispose(),this._notificationDisposables.delete(r))}}):(this._pendingNotificationHandlers.set(r,t),o={dispose:()=>{this._pendingNotificationHandlers.delete(r);const s=this._notificationDisposables.get(r);s!==void 0&&(s.dispose(),this._notificationDisposables.delete(r))}}),{dispose:()=>{this._notificationHandlers.delete(r),o.dispose()}}}async sendProgress(e,t,r){if(this.$state===Se.StartFailed||this.$state===Se.Stopping||this.$state===Se.Stopped)return Promise.reject(new z.ResponseError(z.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,r)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,r){this._progressHandlers.set(t,{type:e,handler:r});const i=this.activeConnection();let o;const s=this._clientOptions.middleware?.handleWorkDoneProgress,c=z.WorkDoneProgress.is(e)&&s!==void 0?u=>{s(t,u,()=>r(u))}:r;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,c)),o={dispose:()=>{const u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:r}),o={dispose:()=>{this._pendingProgressHandlers.delete(t);const u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),o.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new fp(this,e??4)}async setTrace(e){this._trace=e;const t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof z.ResponseError){const t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?Zt.string(e.stack)?e.stack:e.message:Zt.string(e)?e:e.toString()}debug(e,t,r=!0){this.logOutputMessage(z.MessageType.Debug,Ln.Debug,"Debug",e,t,r)}info(e,t,r=!0){this.logOutputMessage(z.MessageType.Info,Ln.Info,"Info",e,t,r)}warn(e,t,r=!0){this.logOutputMessage(z.MessageType.Warning,Ln.Warn,"Warn",e,t,r)}error(e,t,r=!0){this.logOutputMessage(z.MessageType.Error,Ln.Error,"Error",e,t,r)}logOutputMessage(e,t,r,i,o,s){this.outputChannel.appendLine(`[${r.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${i}`),o!=null&&this.outputChannel.appendLine(this.data2String(o)),(s==="force"||s&&this._clientOptions.revealOutputChannelOn<=t)&&this.showNotificationMessage(e,i)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===z.MessageType.Error?Le.window.showErrorMessage:e===z.MessageType.Warning?Le.window.showWarningMessage:Le.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===Se.Initial||this.$state===Se.Stopping||this.$state===Se.Stopped}needsStop(){return this.$state===Se.Starting||this.$state===Se.Running}activeConnection(){return this.$state===Se.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===Se.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===Se.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;const[e,t,r]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?Le.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):Le.languages.createDiagnosticCollection());for(const[i,o]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,o);for(const[i,o]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,o);for(const[i,o]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,o);this.$state=Se.Starting;try{const i=await this.createConnection();i.onNotification(z.LogMessageNotification.type,o=>{switch(o.type){case z.MessageType.Error:this.error(o.message,void 0,!1);break;case z.MessageType.Warning:this.warn(o.message,void 0,!1);break;case z.MessageType.Info:this.info(o.message,void 0,!1);break;case z.MessageType.Debug:this.debug(o.message,void 0,!1);break;default:this.outputChannel.appendLine(o.message)}}),i.onNotification(z.ShowMessageNotification.type,o=>{switch(o.type){case z.MessageType.Error:Le.window.showErrorMessage(o.message);break;case z.MessageType.Warning:Le.window.showWarningMessage(o.message);break;case z.MessageType.Info:Le.window.showInformationMessage(o.message);break;default:Le.window.showInformationMessage(o.message)}}),i.onRequest(z.ShowMessageRequest.type,o=>{let s;switch(o.type){case z.MessageType.Error:s=Le.window.showErrorMessage;break;case z.MessageType.Warning:s=Le.window.showWarningMessage;break;case z.MessageType.Info:s=Le.window.showInformationMessage;break;default:s=Le.window.showInformationMessage}let c=o.actions||[];return s(o.message,...c)}),i.onNotification(z.TelemetryEventNotification.type,o=>{this._telemetryEmitter.fire(o)}),i.onRequest(z.ShowDocumentRequest.type,async o=>{const s=async u=>{const d=this.protocol2CodeConverter.asUri(u.uri);try{if(u.external===!0)return{success:await Le.env.openExternal(d)};{const m={};return u.selection!==void 0&&(m.selection=this.protocol2CodeConverter.asRange(u.selection)),u.takeFocus===void 0||u.takeFocus===!1?m.preserveFocus=!0:u.takeFocus===!0&&(m.preserveFocus=!1),await Le.window.showTextDocument(d,m),{success:!0}}}catch{return{success:!1}}},c=this._clientOptions.middleware.window?.showDocument;return c!==void 0?c(o,s):s(o)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=Se.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),r(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,o)=>{e=i,t=o}),e,t]}async initialize(e){this.refreshTrace(e,!1);const t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],o={processId:null,clientInfo:{name:Le.env.appName,version:Le.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(Le.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:Zt.func(t)?t():t,trace:z.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(o),this._clientOptions.progressOnInitialization){const s=mu.generateUuid(),c=new $g.ProgressPart(e,s);o.workDoneToken=s;try{const u=await this.doInitialize(e,o);return c.done(),u}catch(u){throw c.cancel(),u}}else return this.doInitialize(e,o)}async doInitialize(e,t){try{const r=await e.initialize(t);if(r.capabilities.positionEncoding!==void 0&&r.capabilities.positionEncoding!==z.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${r.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=r,this.$state=Se.Running;let i;Zt.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===z.TextDocumentSyncKind.None?i={openClose:!1,change:z.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(z.PublishDiagnosticsNotification.type,o=>this.handleDiagnostics(o)),e.onRequest(z.RegistrationRequest.type,o=>this.handleRegistrationRequest(o)),e.onRequest("client/registerFeature",o=>this.handleRegistrationRequest(o)),e.onRequest(z.UnregistrationRequest.type,o=>this.handleUnregistrationRequest(o)),e.onRequest("client/unregisterFeature",o=>this.handleUnregistrationRequest(o)),e.onRequest(z.ApplyWorkspaceEditRequest.type,o=>this.handleApplyWorkspaceEdit(o));for(const[o,s]of this._pendingNotificationHandlers)this._notificationDisposables.set(o,e.onNotification(o,s));this._pendingNotificationHandlers.clear();for(const[o,s]of this._pendingRequestHandlers)this._requestDisposables.set(o,e.onRequest(o,s));this._pendingRequestHandlers.clear();for(const[o,s]of this._pendingProgressHandlers)this._progressDisposables.set(o,e.onProgress(s.type,o,s.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(z.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),r}catch(r){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):this.stop():r instanceof z.ResponseError&&r.data&&r.data.retry?Le.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(r&&r.message&&Le.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop()),r}}_clientGetRootPath(){let e=Le.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===Se.Stopped||this.$state===Se.Initial)return;if(this.$state===Se.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}const r=this.activeConnection();if(r===void 0||this.$state!==Se.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=Se.Stopping,this.cleanUp(e);const i=new Promise(s=>{(0,z.RAL)().timer.setTimeout(s,t)}),o=(async s=>(await s.shutdown(),await s.exit(),s))(r);return this._onStop=Promise.race([i,o]).then(s=>{if(s!==void 0)s.end(),s.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},s=>{throw this.error("Stopping server failed",s,!1),s}).finally(()=>{this.$state=Se.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();const t=this._listeners.splice(0,this._listeners.length);for(const r of t)r.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(const r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.clear();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){const t=this;async function r(o){return t._fileEvents.push(o),t._fileEventDelayer.trigger(async()=>{await t.sendNotification(z.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}const i=this.clientOptions.middleware?.workspace;(i?.didChangeWatchedFile?i.didChangeWatchedFile(e,r):r(e)).catch(o=>{t.error("Notify file events failed.",o)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{const t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(const r of t){const i=this.code2ProtocolConverter.asChangeTextDocumentParams(r);await e.sendNotification(z.DidChangeTextDocumentNotification.type,i),this._didChangeTextDocumentFeature.notificationSent(r,z.DidChangeTextDocumentNotification.type,i)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{const e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;const t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,z.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;const e=this._diagnosticQueue.entries().next();if(e.done===!0)return;const[t,r]=e.value;this._diagnosticQueue.delete(t);const i=new Le.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(o=>{if(!i.token.isCancellationRequested){const s=this._p2c.asUri(t),c=this.clientOptions.middleware;c.handleDiagnostics?c.handleDiagnostics(s,o,(u,d)=>this.setDiagnostics(u,d)):this.setDiagnostics(s,o)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return Le.env.language}async $start(){if(this.$state===Se.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();const e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,o,s)=>{this.handleConnectionError(i,o,s).catch(c=>this.error("Handling connection error failed",c))},t=()=>{this.handleConnectionClosed().catch(i=>this.error("Handling connection close failed",i))};const r=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=gp(r.reader,r.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===Se.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:Rn.DoNotRestart};if(this.$state!==Se.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===Rn.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===Se.Starting?this.$state=Se.StartFailed:this.$state=Se.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===Rn.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=Se.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}async handleConnectionError(e,t,r){const i=await this._clientOptions.errorHandler.error(e,t,r);i.action===qr.Shutdown?(this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}
Shutting down server.`,void 0,i.handled===!0?!1:"force"),this.stop().catch(o=>{this.error("Stopping server failed",o,!1)})):this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}`,void 0,i.handled===!0?!1:"force")}hookConfigurationChanged(e){this._listeners.push(Le.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){const r=Le.workspace.getConfiguration(this._id);let i=z.Trace.Off,o=z.TraceFormat.Text;if(r){const s=r.get("trace.server","off");typeof s=="string"?i=z.Trace.fromString(s):(i=z.Trace.fromString(r.get("trace.server.verbosity","off")),o=z.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=o,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(s=>{this.error("Updating trace failed with error",s,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;Zt.array(t)?r=t:r=[t],r&&this._dynamicFeatures.get(z.DidChangeWatchedFilesNotification.type.method).registerRaw(mu.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),en.DynamicFeature.is(e)){const t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){const t=this.getFeature(z.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof yu.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){const e=new Map;this.registerFeature(new vu.ConfigurationFeature(this)),this.registerFeature(new ar.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new ar.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new ar.WillSaveFeature(this)),this.registerFeature(new ar.WillSaveWaitUntilFeature(this)),this.registerFeature(new ar.DidSaveTextDocumentFeature(this)),this.registerFeature(new ar.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new Jg.FileSystemWatcherFeature(this,t=>this.notifyFileEvent(t))),this.registerFeature(new Lg.CompletionItemFeature(this)),this.registerFeature(new Ag.HoverFeature(this)),this.registerFeature(new xg.SignatureHelpFeature(this)),this.registerFeature(new jg.DefinitionFeature(this)),this.registerFeature(new Kg.ReferencesFeature(this)),this.registerFeature(new Hg.DocumentHighlightFeature(this)),this.registerFeature(new Wg.DocumentSymbolFeature(this)),this.registerFeature(new Ug.WorkspaceSymbolFeature(this)),this.registerFeature(new zg.CodeActionFeature(this)),this.registerFeature(new Gg.CodeLensFeature(this)),this.registerFeature(new Ss.DocumentFormattingFeature(this)),this.registerFeature(new Ss.DocumentRangeFormattingFeature(this)),this.registerFeature(new Ss.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new Bg.RenameFeature(this)),this.registerFeature(new Vg.DocumentLinkFeature(this)),this.registerFeature(new Xg.ExecuteCommandFeature(this)),this.registerFeature(new vu.SyncConfigurationFeature(this)),this.registerFeature(new Zg.TypeDefinitionFeature(this)),this.registerFeature(new Yg.ImplementationFeature(this)),this.registerFeature(new Qg.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new ep.WorkspaceFoldersFeature(this)),this.registerFeature(new tp.FoldingRangeFeature(this)),this.registerFeature(new np.DeclarationFeature(this)),this.registerFeature(new rp.SelectionRangeFeature(this)),this.registerFeature(new ip.ProgressFeature(this)),this.registerFeature(new op.CallHierarchyFeature(this)),this.registerFeature(new sp.SemanticTokensFeature(this)),this.registerFeature(new ap.LinkedEditingFeature(this)),this.registerFeature(new cr.DidCreateFilesFeature(this)),this.registerFeature(new cr.DidRenameFilesFeature(this)),this.registerFeature(new cr.DidDeleteFilesFeature(this)),this.registerFeature(new cr.WillCreateFilesFeature(this)),this.registerFeature(new cr.WillRenameFilesFeature(this)),this.registerFeature(new cr.WillDeleteFilesFeature(this)),this.registerFeature(new cp.TypeHierarchyFeature(this)),this.registerFeature(new up.InlineValueFeature(this)),this.registerFeature(new lp.InlayHintsFeature(this)),this.registerFeature(new Mg.DiagnosticFeature(this)),this.registerFeature(new yu.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(Ts.createAll(this))}fillInitializeParams(e){for(let t of this._features)Zt.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){const e={};(0,en.ensure)(e,"workspace").applyEdit=!0;const t=(0,en.ensure)((0,en.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[z.ResourceOperationKind.Create,z.ResourceOperationKind.Rename,z.ResourceOperationKind.Delete],t.failureHandling=z.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};const r=(0,en.ensure)((0,en.ensure)(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[z.DiagnosticTag.Unnecessary,z.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;const i=(0,en.ensure)(e,"window"),o=(0,en.ensure)(i,"showMessage");o.messageActionItem={additionalPropertiesSupport:!0};const s=(0,en.ensure)(i,"showDocument");s.support=!0;const c=(0,en.ensure)(e,"general");c.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(xn.RequestsToCancelOnContentModified)},c.regularExpressions={engine:"ECMAScript",version:"ES2020"},c.markdown={parser:"marked",version:"1.1.0"},c.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(c.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let u of this._features)u.fillClientCapabilities(e);return e}initializeFeatures(e){const t=this._clientOptions.documentSelector;for(const r of this._features)Zt.func(r.preInitialize)&&r.preInitialize(this._capabilities,t);for(const r of this._features)r.initialize(this._capabilities,t)}async handleRegistrationRequest(e){const t=this.clientOptions.middleware?.handleRegisterCapability;return t?t(e,r=>this.doRegisterCapability(r)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(const t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(const t of e.registrations){const r=this._dynamicFeatures.get(t.method);if(r===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));const i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;const o={id:t.id,registerOptions:i};try{r.register(o)}catch(s){return Promise.reject(s)}}}async handleUnregistrationRequest(e){const t=this.clientOptions.middleware?.handleUnregisterCapability;return t?t(e,r=>this.doUnregisterCapability(r)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(const t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;const r=this._dynamicFeatures.get(t.method);if(!r)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));r.unregister(t.id)}}async handleApplyWorkspaceEdit(e){const t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;Le.workspace.textDocuments.forEach(s=>i.set(s.uri.toString(),s));let o=!1;if(t.documentChanges){for(const s of t.documentChanges)if(z.TextDocumentEdit.is(s)&&s.textDocument.version&&s.textDocument.version>=0){const c=this._p2c.asUri(s.textDocument.uri).toString(),u=i.get(c);if(u&&u.version!==s.textDocument.version){o=!0;break}}}return o?Promise.resolve({applied:!1}):Zt.asPromise(Le.workspace.applyEdit(r).then(s=>({applied:s})))}handleFailedRequest(e,t,r,i,o=!0){if(r instanceof z.ResponseError){if(r.code===z.ErrorCodes.PendingResponseRejected||r.code===z.ErrorCodes.ConnectionInactive)return i;if(r.code===z.LSPErrorCodes.RequestCancelled||r.code===z.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new en.LSPCancellationError(r.data):new Le.CancellationError}else if(r.code===z.LSPErrorCodes.ContentModified){if(xn.RequestsToCancelOnContentModified.has(e.method)||xn.CancellableResolveCalls.has(e.method))throw new Le.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,o),r}}tt.BaseLanguageClient=xn,xn.RequestsToCancelOnContentModified=new Set([z.SemanticTokensRequest.method,z.SemanticTokensRangeRequest.method,z.SemanticTokensDeltaRequest.method]),xn.CancellableResolveCalls=new Set([z.CompletionResolveRequest.method,z.CodeLensResolveRequest.method,z.CodeActionResolveRequest.method,z.InlayHintResolveRequest.method,z.DocumentLinkResolveRequest.method,z.WorkspaceSymbolResolveRequest.method]);class hp{error(e){(0,z.RAL)().console.error(e)}warn(e){(0,z.RAL)().console.warn(e)}info(e){(0,z.RAL)().console.info(e)}log(e){(0,z.RAL)().console.log(e)}}function gp(n,e,t,r,i){const o=new hp,s=(0,z.createProtocolConnection)(n,e,o,i);return s.onError(u=>{t(u[0],u[1],u[2])}),s.onClose(r),{listen:()=>s.listen(),sendRequest:s.sendRequest,onRequest:s.onRequest,hasPendingResponse:s.hasPendingResponse,sendNotification:s.sendNotification,onNotification:s.onNotification,onProgress:s.onProgress,sendProgress:s.sendProgress,trace:(u,d,m)=>{const C={sendNotification:!1,traceFormat:z.TraceFormat.Text};return m===void 0?s.trace(u,d,C):(Zt.boolean(m),s.trace(u,d,m))},initialize:u=>s.sendRequest(z.InitializeRequest.type,u),shutdown:()=>s.sendRequest(z.ShutdownRequest.type,void 0),exit:()=>s.sendNotification(z.ExitNotification.type),end:()=>s.end(),dispose:()=>s.dispose()}}var Ts;(function(n){function e(t){return[new dp.InlineCompletionItemFeature(t)]}n.createAll=e})(Ts||(tt.ProposedFeatures=Ts={}));var io={};Object.defineProperty(io,"__esModule",{value:!0}),io.terminate=void 0;const wu=Ls,pp=Ar,mp=process.platform==="win32",yp=process.platform==="darwin",vp=process.platform==="linux";function Cp(n,e){if(mp)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),wu.execFileSync("taskkill",["/T","/F","/PID",n.pid.toString()],i),!0}catch{return!1}else if(vp||yp)try{var t=(0,pp.join)(__dirname,"terminateProcess.sh"),r=wu.spawnSync(t,[n.pid.toString()]);return!r.error}catch{return!1}else return n.kill("SIGKILL"),!0}io.terminate=Cp;var bu=he;const _p=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};var oo=_p;const wp="2.0.0",Du=256,bp=Number.MAX_SAFE_INTEGER||9007199254740991,Dp=16,Sp=Du-6,Rp=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Ps={MAX_LENGTH:Du,MAX_SAFE_COMPONENT_LENGTH:Dp,MAX_SAFE_BUILD_LENGTH:Sp,MAX_SAFE_INTEGER:bp,RELEASE_TYPES:Rp,SEMVER_SPEC_VERSION:wp,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},Es={exports:{}};(function(n,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=Ps,o=oo;e=n.exports={};const s=e.re=[],c=e.safeRe=[],u=e.src=[],d=e.t={};let m=0;const C="[a-zA-Z0-9-]",_=[["\\s",1],["\\d",i],[C,r]],S=O=>{for(const[M,V]of _)O=O.split(`${M}*`).join(`${M}{0,${V}}`).split(`${M}+`).join(`${M}{1,${V}}`);return O},y=(O,M,V)=>{const oe=S(M),te=m++;o(O,te,M),d[O]=te,u[te]=M,s[te]=new RegExp(M,V?"g":void 0),c[te]=new RegExp(oe,V?"g":void 0)};y("NUMERICIDENTIFIER","0|[1-9]\\d*"),y("NUMERICIDENTIFIERLOOSE","\\d+"),y("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${C}*`),y("MAINVERSION",`(${u[d.NUMERICIDENTIFIER]})\\.(${u[d.NUMERICIDENTIFIER]})\\.(${u[d.NUMERICIDENTIFIER]})`),y("MAINVERSIONLOOSE",`(${u[d.NUMERICIDENTIFIERLOOSE]})\\.(${u[d.NUMERICIDENTIFIERLOOSE]})\\.(${u[d.NUMERICIDENTIFIERLOOSE]})`),y("PRERELEASEIDENTIFIER",`(?:${u[d.NUMERICIDENTIFIER]}|${u[d.NONNUMERICIDENTIFIER]})`),y("PRERELEASEIDENTIFIERLOOSE",`(?:${u[d.NUMERICIDENTIFIERLOOSE]}|${u[d.NONNUMERICIDENTIFIER]})`),y("PRERELEASE",`(?:-(${u[d.PRERELEASEIDENTIFIER]}(?:\\.${u[d.PRERELEASEIDENTIFIER]})*))`),y("PRERELEASELOOSE",`(?:-?(${u[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[d.PRERELEASEIDENTIFIERLOOSE]})*))`),y("BUILDIDENTIFIER",`${C}+`),y("BUILD",`(?:\\+(${u[d.BUILDIDENTIFIER]}(?:\\.${u[d.BUILDIDENTIFIER]})*))`),y("FULLPLAIN",`v?${u[d.MAINVERSION]}${u[d.PRERELEASE]}?${u[d.BUILD]}?`),y("FULL",`^${u[d.FULLPLAIN]}$`),y("LOOSEPLAIN",`[v=\\s]*${u[d.MAINVERSIONLOOSE]}${u[d.PRERELEASELOOSE]}?${u[d.BUILD]}?`),y("LOOSE",`^${u[d.LOOSEPLAIN]}$`),y("GTLT","((?:<|>)?=?)"),y("XRANGEIDENTIFIERLOOSE",`${u[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),y("XRANGEIDENTIFIER",`${u[d.NUMERICIDENTIFIER]}|x|X|\\*`),y("XRANGEPLAIN",`[v=\\s]*(${u[d.XRANGEIDENTIFIER]})(?:\\.(${u[d.XRANGEIDENTIFIER]})(?:\\.(${u[d.XRANGEIDENTIFIER]})(?:${u[d.PRERELEASE]})?${u[d.BUILD]}?)?)?`),y("XRANGEPLAINLOOSE",`[v=\\s]*(${u[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[d.XRANGEIDENTIFIERLOOSE]})(?:${u[d.PRERELEASELOOSE]})?${u[d.BUILD]}?)?)?`),y("XRANGE",`^${u[d.GTLT]}\\s*${u[d.XRANGEPLAIN]}$`),y("XRANGELOOSE",`^${u[d.GTLT]}\\s*${u[d.XRANGEPLAINLOOSE]}$`),y("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),y("COERCE",`${u[d.COERCEPLAIN]}(?:$|[^\\d])`),y("COERCEFULL",u[d.COERCEPLAIN]+`(?:${u[d.PRERELEASE]})?(?:${u[d.BUILD]})?(?:$|[^\\d])`),y("COERCERTL",u[d.COERCE],!0),y("COERCERTLFULL",u[d.COERCEFULL],!0),y("LONETILDE","(?:~>?)"),y("TILDETRIM",`(\\s*)${u[d.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",y("TILDE",`^${u[d.LONETILDE]}${u[d.XRANGEPLAIN]}$`),y("TILDELOOSE",`^${u[d.LONETILDE]}${u[d.XRANGEPLAINLOOSE]}$`),y("LONECARET","(?:\\^)"),y("CARETTRIM",`(\\s*)${u[d.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",y("CARET",`^${u[d.LONECARET]}${u[d.XRANGEPLAIN]}$`),y("CARETLOOSE",`^${u[d.LONECARET]}${u[d.XRANGEPLAINLOOSE]}$`),y("COMPARATORLOOSE",`^${u[d.GTLT]}\\s*(${u[d.LOOSEPLAIN]})$|^$`),y("COMPARATOR",`^${u[d.GTLT]}\\s*(${u[d.FULLPLAIN]})$|^$`),y("COMPARATORTRIM",`(\\s*)${u[d.GTLT]}\\s*(${u[d.LOOSEPLAIN]}|${u[d.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",y("HYPHENRANGE",`^\\s*(${u[d.XRANGEPLAIN]})\\s+-\\s+(${u[d.XRANGEPLAIN]})\\s*$`),y("HYPHENRANGELOOSE",`^\\s*(${u[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[d.XRANGEPLAINLOOSE]})\\s*$`),y("STAR","(<|>)?=?\\s*\\*"),y("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),y("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Es,Es.exports);var ks=Es.exports;const Tp=Object.freeze({loose:!0}),Pp=Object.freeze({}),Ep=n=>n?typeof n!="object"?Tp:n:Pp;var Fs=Ep;const Su=/^[0-9]+$/,Ru=(n,e)=>{const t=Su.test(n),r=Su.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},kp=(n,e)=>Ru(e,n);var Fp={compareIdentifiers:Ru,rcompareIdentifiers:kp};const so=oo,{MAX_LENGTH:Tu,MAX_SAFE_INTEGER:ao}=Ps,{safeRe:Pu,t:Eu}=ks,Ip=Fs,{compareIdentifiers:ur}=Fp;let Op=class rn{constructor(e,t){if(t=Ip(t),e instanceof rn){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Tu)throw new TypeError(`version is longer than ${Tu} characters`);so("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?Pu[Eu.LOOSE]:Pu[Eu.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>ao||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ao||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ao||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const o=+i;if(o>=0&&o<ao)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(so("SemVer.compare",this.version,this.options,e),!(e instanceof rn)){if(typeof e=="string"&&e===this.version)return 0;e=new rn(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof rn||(e=new rn(e,this.options)),ur(this.major,e.major)||ur(this.minor,e.minor)||ur(this.patch,e.patch)}comparePre(e){if(e instanceof rn||(e=new rn(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],i=e.prerelease[t];if(so("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return ur(r,i)}while(++t)}compareBuild(e){e instanceof rn||(e=new rn(e,this.options));let t=0;do{const r=this.build[t],i=e.build[t];if(so("build compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return ur(r,i)}while(++t)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(r)?1:0;if(!t&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(t===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let o=[t,i];r===!1&&(o=[t]),ur(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var co=Op;const ku=co,Np=(n,e,t=!1)=>{if(n instanceof ku)return n;try{return new ku(n,e)}catch(r){if(!t)return null;throw r}};var qp=Np;class $p{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){const i=this.map.keys().next().value;this.delete(i)}this.map.set(e,t)}return this}}var Mp=$p;const Fu=co,Lp=(n,e,t)=>new Fu(n,t).compare(new Fu(e,t));var lr=Lp;const Ap=lr,jp=(n,e,t)=>Ap(n,e,t)===0;var xp=jp;const Hp=lr,Wp=(n,e,t)=>Hp(n,e,t)!==0;var Up=Wp;const Kp=lr,zp=(n,e,t)=>Kp(n,e,t)>0;var Gp=zp;const Bp=lr,Vp=(n,e,t)=>Bp(n,e,t)>=0;var Xp=Vp;const Jp=lr,Qp=(n,e,t)=>Jp(n,e,t)<0;var Yp=Qp;const Zp=lr,em=(n,e,t)=>Zp(n,e,t)<=0;var tm=em;const nm=xp,rm=Up,im=Gp,om=Xp,sm=Yp,am=tm,cm=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return nm(n,t,r);case"!=":return rm(n,t,r);case">":return im(n,t,r);case">=":return om(n,t,r);case"<":return sm(n,t,r);case"<=":return am(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};var um=cm,Is,Iu;function lm(){if(Iu)return Is;Iu=1;const n=Symbol("SemVer ANY");class e{static get ANY(){return n}constructor(m,C){if(C=t(C),m instanceof e){if(m.loose===!!C.loose)return m;m=m.value}m=m.trim().split(/\s+/).join(" "),s("comparator",m,C),this.options=C,this.loose=!!C.loose,this.parse(m),this.semver===n?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(m){const C=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],_=m.match(C);if(!_)throw new TypeError(`Invalid comparator: ${m}`);this.operator=_[1]!==void 0?_[1]:"",this.operator==="="&&(this.operator=""),_[2]?this.semver=new c(_[2],this.options.loose):this.semver=n}toString(){return this.value}test(m){if(s("Comparator.test",m,this.options.loose),this.semver===n||m===n)return!0;if(typeof m=="string")try{m=new c(m,this.options)}catch{return!1}return o(m,this.operator,this.semver,this.options)}intersects(m,C){if(!(m instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(m.value,C).test(this.value):m.operator===""?m.value===""?!0:new u(this.value,C).test(m.semver):(C=t(C),C.includePrerelease&&(this.value==="<0.0.0-0"||m.value==="<0.0.0-0")||!C.includePrerelease&&(this.value.startsWith("<0.0.0")||m.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&m.operator.startsWith(">")||this.operator.startsWith("<")&&m.operator.startsWith("<")||this.semver.version===m.semver.version&&this.operator.includes("=")&&m.operator.includes("=")||o(this.semver,"<",m.semver,C)&&this.operator.startsWith(">")&&m.operator.startsWith("<")||o(this.semver,">",m.semver,C)&&this.operator.startsWith("<")&&m.operator.startsWith(">")))}}Is=e;const t=Fs,{safeRe:r,t:i}=ks,o=um,s=oo,c=co,u=Nu();return Is}var Os,Ou;function Nu(){if(Ou)return Os;Ou=1;const n=/\s+/g;class e{constructor(P,q){if(q=i(q),P instanceof e)return P.loose===!!q.loose&&P.includePrerelease===!!q.includePrerelease?P:new e(P.raw,q);if(P instanceof o)return this.raw=P.value,this.set=[[P]],this.formatted=void 0,this;if(this.options=q,this.loose=!!q.loose,this.includePrerelease=!!q.includePrerelease,this.raw=P.trim().replace(n," "),this.set=this.raw.split("||").map($=>this.parseRange($.trim())).filter($=>$.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const $=this.set[0];if(this.set=this.set.filter(j=>!O(j[0])),this.set.length===0)this.set=[$];else if(this.set.length>1){for(const j of this.set)if(j.length===1&&M(j[0])){this.set=[j];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let P=0;P<this.set.length;P++){P>0&&(this.formatted+="||");const q=this.set[P];for(let $=0;$<q.length;$++)$>0&&(this.formatted+=" "),this.formatted+=q[$].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(P){const $=((this.options.includePrerelease&&S)|(this.options.loose&&y))+":"+P,j=r.get($);if(j)return j;const L=this.options.loose,X=L?u[d.HYPHENRANGELOOSE]:u[d.HYPHENRANGE];P=P.replace(X,W(this.options.includePrerelease)),s("hyphen replace",P),P=P.replace(u[d.COMPARATORTRIM],m),s("comparator trim",P),P=P.replace(u[d.TILDETRIM],C),s("tilde trim",P),P=P.replace(u[d.CARETTRIM],_),s("caret trim",P);let Z=P.split(" ").map(G=>oe(G,this.options)).join(" ").split(/\s+/).map(G=>U(G,this.options));L&&(Z=Z.filter(G=>(s("loose invalid filter",G,this.options),!!G.match(u[d.COMPARATORLOOSE])))),s("range list",Z);const J=new Map,ne=Z.map(G=>new o(G,this.options));for(const G of ne){if(O(G))return[G];J.set(G.value,G)}J.size>1&&J.has("")&&J.delete("");const re=[...J.values()];return r.set($,re),re}intersects(P,q){if(!(P instanceof e))throw new TypeError("a Range is required");return this.set.some($=>V($,q)&&P.set.some(j=>V(j,q)&&$.every(L=>j.every(X=>L.intersects(X,q)))))}test(P){if(!P)return!1;if(typeof P=="string")try{P=new c(P,this.options)}catch{return!1}for(let q=0;q<this.set.length;q++)if(R(this.set[q],P,this.options))return!0;return!1}}Os=e;const t=Mp,r=new t,i=Fs,o=lm(),s=oo,c=co,{safeRe:u,t:d,comparatorTrimReplace:m,tildeTrimReplace:C,caretTrimReplace:_}=ks,{FLAG_INCLUDE_PRERELEASE:S,FLAG_LOOSE:y}=Ps,O=k=>k.value==="<0.0.0-0",M=k=>k.value==="",V=(k,P)=>{let q=!0;const $=k.slice();let j=$.pop();for(;q&&$.length;)q=$.every(L=>j.intersects(L,P)),j=$.pop();return q},oe=(k,P)=>(s("comp",k,P),k=le(k,P),s("caret",k),k=Te(k,P),s("tildes",k),k=N(k,P),s("xrange",k),k=ee(k,P),s("stars",k),k),te=k=>!k||k.toLowerCase()==="x"||k==="*",Te=(k,P)=>k.trim().split(/\s+/).map(q=>fe(q,P)).join(" "),fe=(k,P)=>{const q=P.loose?u[d.TILDELOOSE]:u[d.TILDE];return k.replace(q,($,j,L,X,Z)=>{s("tilde",k,$,j,L,X,Z);let J;return te(j)?J="":te(L)?J=`>=${j}.0.0 <${+j+1}.0.0-0`:te(X)?J=`>=${j}.${L}.0 <${j}.${+L+1}.0-0`:Z?(s("replaceTilde pr",Z),J=`>=${j}.${L}.${X}-${Z} <${j}.${+L+1}.0-0`):J=`>=${j}.${L}.${X} <${j}.${+L+1}.0-0`,s("tilde return",J),J})},le=(k,P)=>k.trim().split(/\s+/).map(q=>x(q,P)).join(" "),x=(k,P)=>{s("caret",k,P);const q=P.loose?u[d.CARETLOOSE]:u[d.CARET],$=P.includePrerelease?"-0":"";return k.replace(q,(j,L,X,Z,J)=>{s("caret",k,j,L,X,Z,J);let ne;return te(L)?ne="":te(X)?ne=`>=${L}.0.0${$} <${+L+1}.0.0-0`:te(Z)?L==="0"?ne=`>=${L}.${X}.0${$} <${L}.${+X+1}.0-0`:ne=`>=${L}.${X}.0${$} <${+L+1}.0.0-0`:J?(s("replaceCaret pr",J),L==="0"?X==="0"?ne=`>=${L}.${X}.${Z}-${J} <${L}.${X}.${+Z+1}-0`:ne=`>=${L}.${X}.${Z}-${J} <${L}.${+X+1}.0-0`:ne=`>=${L}.${X}.${Z}-${J} <${+L+1}.0.0-0`):(s("no pr"),L==="0"?X==="0"?ne=`>=${L}.${X}.${Z}${$} <${L}.${X}.${+Z+1}-0`:ne=`>=${L}.${X}.${Z}${$} <${L}.${+X+1}.0-0`:ne=`>=${L}.${X}.${Z} <${+L+1}.0.0-0`),s("caret return",ne),ne})},N=(k,P)=>(s("replaceXRanges",k,P),k.split(/\s+/).map(q=>A(q,P)).join(" ")),A=(k,P)=>{k=k.trim();const q=P.loose?u[d.XRANGELOOSE]:u[d.XRANGE];return k.replace(q,($,j,L,X,Z,J)=>{s("xRange",k,$,j,L,X,Z,J);const ne=te(L),re=ne||te(X),G=re||te(Z),ie=G;return j==="="&&ie&&(j=""),J=P.includePrerelease?"-0":"",ne?j===">"||j==="<"?$="<0.0.0-0":$="*":j&&ie?(re&&(X=0),Z=0,j===">"?(j=">=",re?(L=+L+1,X=0,Z=0):(X=+X+1,Z=0)):j==="<="&&(j="<",re?L=+L+1:X=+X+1),j==="<"&&(J="-0"),$=`${j+L}.${X}.${Z}${J}`):re?$=`>=${L}.0.0${J} <${+L+1}.0.0-0`:G&&($=`>=${L}.${X}.0${J} <${L}.${+X+1}.0-0`),s("xRange return",$),$})},ee=(k,P)=>(s("replaceStars",k,P),k.trim().replace(u[d.STAR],"")),U=(k,P)=>(s("replaceGTE0",k,P),k.trim().replace(u[P.includePrerelease?d.GTE0PRE:d.GTE0],"")),W=k=>(P,q,$,j,L,X,Z,J,ne,re,G,ie)=>(te($)?q="":te(j)?q=`>=${$}.0.0${k?"-0":""}`:te(L)?q=`>=${$}.${j}.0${k?"-0":""}`:X?q=`>=${q}`:q=`>=${q}${k?"-0":""}`,te(ne)?J="":te(re)?J=`<${+ne+1}.0.0-0`:te(G)?J=`<${ne}.${+re+1}.0-0`:ie?J=`<=${ne}.${re}.${G}-${ie}`:k?J=`<${ne}.${re}.${+G+1}-0`:J=`<=${J}`,`${q} ${J}`.trim()),R=(k,P,q)=>{for(let $=0;$<k.length;$++)if(!k[$].test(P))return!1;if(P.prerelease.length&&!q.includePrerelease){for(let $=0;$<k.length;$++)if(s(k[$].semver),k[$].semver!==o.ANY&&k[$].semver.prerelease.length>0){const j=k[$].semver;if(j.major===P.major&&j.minor===P.minor&&j.patch===P.patch)return!0}return!1}return!0};return Os}const dm=Nu(),fm=(n,e,t)=>{try{e=new dm(e,t)}catch{return!1}return e.test(n)};var hm=fm,qu={};(function(n){var e=Me.commonjsGlobal&&Me.commonjsGlobal.__createBinding||(Object.create?function(i,o,s,c){c===void 0&&(c=s);var u=Object.getOwnPropertyDescriptor(o,s);(!u||("get"in u?!o.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,c,u)}:function(i,o,s,c){c===void 0&&(c=s),i[c]=o[s]}),t=Me.commonjsGlobal&&Me.commonjsGlobal.__exportStar||function(i,o){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,i,s)};Object.defineProperty(n,"__esModule",{value:!0}),n.DiagnosticPullMode=n.vsdiag=void 0,t(he,n),t(ue,n);var r=un;Object.defineProperty(n,"vsdiag",{enumerable:!0,get:function(){return r.vsdiag}}),Object.defineProperty(n,"DiagnosticPullMode",{enumerable:!0,get:function(){return r.DiagnosticPullMode}}),t(tt,n)})(qu),function(n){var e=Me.commonjsGlobal&&Me.commonjsGlobal.__createBinding||(Object.create?function(x,N,A,ee){ee===void 0&&(ee=A);var U=Object.getOwnPropertyDescriptor(N,A);(!U||("get"in U?!N.__esModule:U.writable||U.configurable))&&(U={enumerable:!0,get:function(){return N[A]}}),Object.defineProperty(x,ee,U)}:function(x,N,A,ee){ee===void 0&&(ee=A),x[ee]=N[A]}),t=Me.commonjsGlobal&&Me.commonjsGlobal.__exportStar||function(x,N){for(var A in x)A!=="default"&&!Object.prototype.hasOwnProperty.call(N,A)&&e(N,x,A)};Object.defineProperty(n,"__esModule",{value:!0}),n.SettingMonitor=n.LanguageClient=n.TransportKind=void 0;const r=Ls,i=ho,o=Ar,s=ce,c=$e,u=tt,d=io,m=bu,C=qp,_=hm;t(bu,n),t(qu,n);const S="^1.82.0";var y;(function(x){x[x.stdio=0]="stdio",x[x.ipc=1]="ipc",x[x.pipe=2]="pipe",x[x.socket=3]="socket"})(y||(n.TransportKind=y={}));var O;(function(x){function N(A){const ee=A;return ee&&ee.kind===y.socket&&c.number(ee.port)}x.isSocket=N})(O||(O={}));var M;(function(x){function N(A){return c.string(A.command)}x.is=N})(M||(M={}));var V;(function(x){function N(A){return c.string(A.module)}x.is=N})(V||(V={}));var oe;(function(x){function N(A){let ee=A;return ee&&ee.writer!==void 0&&ee.reader!==void 0}x.is=N})(oe||(oe={}));var te;(function(x){function N(A){let ee=A;return ee&&ee.process!==void 0&&typeof ee.detached=="boolean"}x.is=N})(te||(te={}));class Te extends u.BaseLanguageClient{constructor(N,A,ee,U,W){let R,k,P,q,$;c.string(A)?(R=N,k=A,P=ee,q=U,$=!!W):(R=N.toLowerCase(),k=N,P=A,q=ee,$=U),$===void 0&&($=!1),super(R,k,q),this._serverOptions=P,this._forceDebug=$,this._isInDebugMode=$;try{this.checkVersion()}catch(j){throw c.string(j.message)&&this.outputChannel.appendLine(j.message),j}}checkVersion(){const N=C(s.version);if(!N)throw new Error(`No valid VS Code version detected. Version string is: ${s.version}`);if(N.prerelease&&N.prerelease.length>0&&(N.prerelease=[]),!_(N,S))throw new Error(`The language client requires VS Code version ${S} but received version ${s.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(N=>setTimeout(N,1e3)),await this.start()):await this.start()}stop(N=2e3){return super.stop(N).finally(()=>{if(this._serverProcess){const A=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(A),this._isDetached=void 0}})}checkProcessDied(N){!N||N.pid===void 0||setTimeout(()=>{try{N.pid!==void 0&&(process.kill(N.pid,0),(0,d.terminate)(N))}catch{}},2e3)}handleConnectionClosed(){return this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(N){super.fillInitializeParams(N),N.processId===null&&(N.processId=process.pid)}createMessageTransports(N){function A($,j){if(!$&&!j)return;const L=Object.create(null);return Object.keys(process.env).forEach(X=>L[X]=process.env[X]),j&&(L.ELECTRON_RUN_AS_NODE="1",L.ELECTRON_NO_ASAR="1"),$&&Object.keys($).forEach(X=>L[X]=$[X]),L}const ee=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],U=["--debug","--debug-brk","--inspect","--inspect-brk"];function W(){let $=process.execArgv;return $?$.some(j=>ee.some(L=>j.startsWith(L))||U.some(L=>j===L)):!1}function R($){if($.stdin===null||$.stdout===null||$.stderr===null)throw new Error("Process created without stdio streams")}const k=this._serverOptions;if(c.func(k))return k().then($=>{if(u.MessageTransports.is($))return this._isDetached=!!$.detached,$;if(oe.is($))return this._isDetached=!!$.detached,{reader:new m.StreamMessageReader($.reader),writer:new m.StreamMessageWriter($.writer)};{let j;return te.is($)?(j=$.process,this._isDetached=$.detached):(j=$,this._isDetached=!1),j.stderr.on("data",L=>this.outputChannel.append(c.string(L)?L:L.toString(N))),{reader:new m.StreamMessageReader(j.stdout),writer:new m.StreamMessageWriter(j.stdin)}}});let P,q=k;return q.run||q.debug?this._forceDebug||W()?(P=q.debug,this._isInDebugMode=!0):(P=q.run,this._isInDebugMode=!1):P=k,this._getServerWorkingDir(P.options).then($=>{if(V.is(P)&&P.module){let j=P,L=j.transport||y.stdio;if(j.runtime){const X=[],Z=j.options??Object.create(null);Z.execArgv&&Z.execArgv.forEach(G=>X.push(G)),X.push(j.module),j.args&&j.args.forEach(G=>X.push(G));const J=Object.create(null);J.cwd=$,J.env=A(Z.env,!1);const ne=this._getRuntimePath(j.runtime,$);let re;if(L===y.ipc?(J.stdio=[null,null,null,"ipc"],X.push("--node-ipc")):L===y.stdio?X.push("--stdio"):L===y.pipe?(re=(0,m.generateRandomPipeName)(),X.push(`--pipe=${re}`)):O.isSocket(L)&&X.push(`--socket=${L.port}`),X.push(`--clientProcessId=${process.pid.toString()}`),L===y.ipc||L===y.stdio){const G=r.spawn(ne,X,J);return!G||!G.pid?le(G,`Launching server using runtime ${ne} failed.`):(this._serverProcess=G,G.stderr.on("data",ie=>this.outputChannel.append(c.string(ie)?ie:ie.toString(N))),L===y.ipc?(G.stdout.on("data",ie=>this.outputChannel.append(c.string(ie)?ie:ie.toString(N))),Promise.resolve({reader:new m.IPCMessageReader(G),writer:new m.IPCMessageWriter(G)})):Promise.resolve({reader:new m.StreamMessageReader(G.stdout),writer:new m.StreamMessageWriter(G.stdin)}))}else{if(L===y.pipe)return(0,m.createClientPipeTransport)(re).then(G=>{const ie=r.spawn(ne,X,J);return!ie||!ie.pid?le(ie,`Launching server using runtime ${ne} failed.`):(this._serverProcess=ie,ie.stderr.on("data",se=>this.outputChannel.append(c.string(se)?se:se.toString(N))),ie.stdout.on("data",se=>this.outputChannel.append(c.string(se)?se:se.toString(N))),G.onConnected().then(se=>({reader:se[0],writer:se[1]})))});if(O.isSocket(L))return(0,m.createClientSocketTransport)(L.port).then(G=>{const ie=r.spawn(ne,X,J);return!ie||!ie.pid?le(ie,`Launching server using runtime ${ne} failed.`):(this._serverProcess=ie,ie.stderr.on("data",se=>this.outputChannel.append(c.string(se)?se:se.toString(N))),ie.stdout.on("data",se=>this.outputChannel.append(c.string(se)?se:se.toString(N))),G.onConnected().then(se=>({reader:se[0],writer:se[1]})))})}}else{let X;return new Promise((Z,J)=>{const ne=(j.args&&j.args.slice())??[];L===y.ipc?ne.push("--node-ipc"):L===y.stdio?ne.push("--stdio"):L===y.pipe?(X=(0,m.generateRandomPipeName)(),ne.push(`--pipe=${X}`)):O.isSocket(L)&&ne.push(`--socket=${L.port}`),ne.push(`--clientProcessId=${process.pid.toString()}`);const re=j.options??Object.create(null);if(re.env=A(re.env,!0),re.execArgv=re.execArgv||[],re.cwd=$,re.silent=!0,L===y.ipc||L===y.stdio){const G=r.fork(j.module,ne||[],re);R(G),this._serverProcess=G,G.stderr.on("data",ie=>this.outputChannel.append(c.string(ie)?ie:ie.toString(N))),L===y.ipc?(G.stdout.on("data",ie=>this.outputChannel.append(c.string(ie)?ie:ie.toString(N))),Z({reader:new m.IPCMessageReader(this._serverProcess),writer:new m.IPCMessageWriter(this._serverProcess)})):Z({reader:new m.StreamMessageReader(G.stdout),writer:new m.StreamMessageWriter(G.stdin)})}else L===y.pipe?(0,m.createClientPipeTransport)(X).then(G=>{const ie=r.fork(j.module,ne||[],re);R(ie),this._serverProcess=ie,ie.stderr.on("data",se=>this.outputChannel.append(c.string(se)?se:se.toString(N))),ie.stdout.on("data",se=>this.outputChannel.append(c.string(se)?se:se.toString(N))),G.onConnected().then(se=>{Z({reader:se[0],writer:se[1]})},J)},J):O.isSocket(L)&&(0,m.createClientSocketTransport)(L.port).then(G=>{const ie=r.fork(j.module,ne||[],re);R(ie),this._serverProcess=ie,ie.stderr.on("data",se=>this.outputChannel.append(c.string(se)?se:se.toString(N))),ie.stdout.on("data",se=>this.outputChannel.append(c.string(se)?se:se.toString(N))),G.onConnected().then(se=>{Z({reader:se[0],writer:se[1]})},J)},J)})}}else if(M.is(P)&&P.command){const j=P,L=P.args!==void 0?P.args.slice(0):[];let X;const Z=P.transport;if(Z===y.stdio)L.push("--stdio");else if(Z===y.pipe)X=(0,m.generateRandomPipeName)(),L.push(`--pipe=${X}`);else if(O.isSocket(Z))L.push(`--socket=${Z.port}`);else if(Z===y.ipc)throw new Error("Transport kind ipc is not support for command executable");const J=Object.assign({},j.options);if(J.cwd=J.cwd||$,Z===void 0||Z===y.stdio){const ne=r.spawn(j.command,L,J);return!ne||!ne.pid?le(ne,`Launching server using command ${j.command} failed.`):(ne.stderr.on("data",re=>this.outputChannel.append(c.string(re)?re:re.toString(N))),this._serverProcess=ne,this._isDetached=!!J.detached,Promise.resolve({reader:new m.StreamMessageReader(ne.stdout),writer:new m.StreamMessageWriter(ne.stdin)}))}else{if(Z===y.pipe)return(0,m.createClientPipeTransport)(X).then(ne=>{const re=r.spawn(j.command,L,J);return!re||!re.pid?le(re,`Launching server using command ${j.command} failed.`):(this._serverProcess=re,this._isDetached=!!J.detached,re.stderr.on("data",G=>this.outputChannel.append(c.string(G)?G:G.toString(N))),re.stdout.on("data",G=>this.outputChannel.append(c.string(G)?G:G.toString(N))),ne.onConnected().then(G=>({reader:G[0],writer:G[1]})))});if(O.isSocket(Z))return(0,m.createClientSocketTransport)(Z.port).then(ne=>{const re=r.spawn(j.command,L,J);return!re||!re.pid?le(re,`Launching server using command ${j.command} failed.`):(this._serverProcess=re,this._isDetached=!!J.detached,re.stderr.on("data",G=>this.outputChannel.append(c.string(G)?G:G.toString(N))),re.stdout.on("data",G=>this.outputChannel.append(c.string(G)?G:G.toString(N))),ne.onConnected().then(G=>({reader:G[0],writer:G[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(k,null,4)))}).finally(()=>{this._serverProcess!==void 0&&this._serverProcess.on("exit",($,j)=>{$!==null&&this.error(`Server process exited with code ${$}.`,void 0,!1),j!==null&&this.error(`Server process exited with signal ${j}.`,void 0,!1)})})}_getRuntimePath(N,A){if(o.isAbsolute(N))return N;const ee=this._mainGetRootPath();if(ee!==void 0){const U=o.join(ee,N);if(i.existsSync(U))return U}if(A!==void 0){const U=o.join(A,N);if(i.existsSync(U))return U}return N}_mainGetRootPath(){let N=s.workspace.workspaceFolders;if(!N||N.length===0)return;let A=N[0];if(A.uri.scheme==="file")return A.uri.fsPath}_getServerWorkingDir(N){let A=N&&N.cwd;return A||(A=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),A?new Promise(ee=>{i.lstat(A,(U,W)=>{ee(!U&&W.isDirectory()?A:void 0)})}):Promise.resolve(void 0)}}n.LanguageClient=Te;class fe{constructor(N,A){this._client=N,this._setting=A,this._listeners=[]}start(){return s.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new s.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let N=this._setting.indexOf("."),A=N>=0?this._setting.substr(0,N):this._setting,ee=N>=0?this._setting.substr(N+1):void 0,U=ee?s.workspace.getConfiguration(A).get(ee,!1):s.workspace.getConfiguration(A);U&&this._client.needsStart()?this._client.start().catch(W=>this._client.error("Start failed after configuration change",W,"force")):!U&&this._client.needsStop()&&this._client.stop().catch(W=>this._client.error("Stop failed after configuration change",W,"force"))}}n.SettingMonitor=fe;function le(x,N){return x===null?Promise.reject(N):new Promise((A,ee)=>{x.on("error",U=>{ee(`${N} ${U}`)}),setImmediate(()=>ee(N))})}}(js);var $u=js,Mu={},dr={};Object.defineProperty(dr,"__esModule",{value:!0}),dr.sync=dr.isexe=void 0;const gm=ho,pm=As,mm=async(n,e={})=>{const{ignoreErrors:t=!1}=e;try{return Lu(await(0,pm.stat)(n),e)}catch(r){const i=r;if(t||i.code==="EACCES")return!1;throw i}};dr.isexe=mm;const ym=(n,e={})=>{const{ignoreErrors:t=!1}=e;try{return Lu((0,gm.statSync)(n),e)}catch(r){const i=r;if(t||i.code==="EACCES")return!1;throw i}};dr.sync=ym;const Lu=(n,e)=>n.isFile()&&vm(n,e),vm=(n,e)=>{const t=e.uid??process.getuid?.(),r=e.groups??process.getgroups?.()??[],i=e.gid??process.getgid?.()??r[0];if(t===void 0||i===void 0)throw new Error("cannot get uid or gid");const o=new Set([i,...r]),s=n.mode,c=n.uid,u=n.gid,d=parseInt("100",8),m=parseInt("010",8),C=parseInt("001",8),_=d|m;return!!(s&C||s&m&&o.has(u)||s&d&&c===t||s&_&&t===0)};var fr={};Object.defineProperty(fr,"__esModule",{value:!0}),fr.sync=fr.isexe=void 0;const Cm=ho,_m=As,wm=async(n,e={})=>{const{ignoreErrors:t=!1}=e;try{return Au(await(0,_m.stat)(n),n,e)}catch(r){const i=r;if(t||i.code==="EACCES")return!1;throw i}};fr.isexe=wm;const bm=(n,e={})=>{const{ignoreErrors:t=!1}=e;try{return Au((0,Cm.statSync)(n),n,e)}catch(r){const i=r;if(t||i.code==="EACCES")return!1;throw i}};fr.sync=bm;const Dm=(n,e)=>{const{pathExt:t=process.env.PATHEXT||""}=e,r=t.split(";");if(r.indexOf("")!==-1)return!0;for(let i=0;i<r.length;i++){const o=r[i].toLowerCase(),s=n.substring(n.length-o.length).toLowerCase();if(o&&s===o)return!0}return!1},Au=(n,e,t)=>n.isFile()&&Dm(e,t);var ju={};Object.defineProperty(ju,"__esModule",{value:!0}),function(n){var e=Me.commonjsGlobal&&Me.commonjsGlobal.__createBinding||(Object.create?function(d,m,C,_){_===void 0&&(_=C);var S=Object.getOwnPropertyDescriptor(m,C);(!S||("get"in S?!m.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return m[C]}}),Object.defineProperty(d,_,S)}:function(d,m,C,_){_===void 0&&(_=C),d[_]=m[C]}),t=Me.commonjsGlobal&&Me.commonjsGlobal.__setModuleDefault||(Object.create?function(d,m){Object.defineProperty(d,"default",{enumerable:!0,value:m})}:function(d,m){d.default=m}),r=Me.commonjsGlobal&&Me.commonjsGlobal.__importStar||function(d){if(d&&d.__esModule)return d;var m={};if(d!=null)for(var C in d)C!=="default"&&Object.prototype.hasOwnProperty.call(d,C)&&e(m,d,C);return t(m,d),m},i=Me.commonjsGlobal&&Me.commonjsGlobal.__exportStar||function(d,m){for(var C in d)C!=="default"&&!Object.prototype.hasOwnProperty.call(m,C)&&e(m,d,C)};Object.defineProperty(n,"__esModule",{value:!0}),n.sync=n.isexe=n.posix=n.win32=void 0;const o=r(dr);n.posix=o;const s=r(fr);n.win32=s,i(ju,n);const u=(process.env._ISEXE_TEST_PLATFORM_||process.platform)==="win32"?s:o;n.isexe=u.isexe,n.sync=u.sync}(Mu);const{isexe:Sm,sync:Rm}=Mu,{join:Tm,delimiter:Pm,sep:xu,posix:Hu}=Ar,Wu=process.platform==="win32",Uu=new RegExp(`[${Hu.sep}${xu===Hu.sep?"":xu}]`.replace(/(\\)/g,"\\$1")),Em=new RegExp(`^\\.${Uu.source}`),Ku=n=>Object.assign(new Error(`not found: ${n}`),{code:"ENOENT"}),zu=(n,{path:e=process.env.PATH,pathExt:t=process.env.PATHEXT,delimiter:r=Pm})=>{const i=n.match(Uu)?[""]:[...Wu?[process.cwd()]:[],...(e||"").split(r)];if(Wu){const o=t||[".EXE",".CMD",".BAT",".COM"].join(r),s=o.split(r).flatMap(c=>[c,c.toLowerCase()]);return n.includes(".")&&s[0]!==""&&s.unshift(""),{pathEnv:i,pathExt:s,pathExtExe:o}}return{pathEnv:i,pathExt:[""]}},Gu=(n,e)=>{const t=/^".*"$/.test(n)?n.slice(1,-1):n;return(!t&&Em.test(e)?e.slice(0,2):"")+Tm(t,e)},Bu=async(n,e={})=>{const{pathEnv:t,pathExt:r,pathExtExe:i}=zu(n,e),o=[];for(const s of t){const c=Gu(s,n);for(const u of r){const d=c+u;if(await Sm(d,{pathExt:i,ignoreErrors:!0})){if(!e.all)return d;o.push(d)}}}if(e.all&&o.length)return o;if(e.nothrow)return null;throw Ku(n)},km=(n,e={})=>{const{pathEnv:t,pathExt:r,pathExtExe:i}=zu(n,e),o=[];for(const s of t){const c=Gu(s,n);for(const u of r){const d=c+u;if(Rm(d,{pathExt:i,ignoreErrors:!0})){if(!e.all)return d;o.push(d)}}}if(e.all&&o.length)return o;if(e.nothrow)return null;throw Ku(n)};var Fm=Bu;Bu.sync=km;var Im=Me.getDefaultExportFromCjs(Fm);async function Om(n){return console.log(!1),await Nm(n)}async function Nm(n){const e=Hn(),t=!!be.workspace.getConfiguration().get("evenBetterToml.taplo.bundled");let r;if(t){const i={module:be.Uri.joinPath(n.extensionUri,"dist/server.js").fsPath,transport:$u.TransportKind.ipc,options:{env:be.workspace.getConfiguration().get("evenBetterToml.taplo.environment")??void 0}};r={run:i,debug:i}}else{const i=be.workspace.getConfiguration().get("evenBetterToml.taplo.path")??Im.sync("taplo",{nothrow:!0});if(typeof i!="string")throw e.appendLine("failed to locate Taplo LSP"),new Error("failed to locate Taplo LSP");let o=be.workspace.getConfiguration().get("evenBetterToml.taplo.extraArgs");Array.isArray(o)||(o=[]);const s=o.filter(u=>typeof u=="string"),c={command:i,args:["lsp","stdio",...s],options:{env:be.workspace.getConfiguration().get("evenBetterToml.taplo.environment")??void 0}};r={run:c,debug:c}}return new $u.LanguageClient("evenBetterToml","Even Better TOML LSP",r,await qm(n))}async function qm(n){return await be.workspace.fs.createDirectory(n.globalStorageUri),{documentSelector:[{scheme:"file",language:"toml"},{scheme:"file",language:"cargoLock"}],initializationOptions:{configurationSection:"evenBetterToml",cachePath:n.globalStorageUri.fsPath}}}function $m(n,e){for(const t of be.extensions.all){const r=t.packageJSON?.contributes?.tomlValidation;if(Array.isArray(r))for(const i of r){if(typeof i!="object")continue;const o=i.url;if(typeof o!="string")continue;let s=i.fileMatch,c=i.regexMatch;Array.isArray(s)||(s=[s]);for(let u of s)typeof u=="string"&&(u.startsWith("/")||(u=`/${u}`),e.sendNotification("taplo/associateSchema",{schemaUri:o,priority:10,rule:{glob:`**${u}`},meta:{source:"extension",extensionId:t.id}}));Array.isArray(c)||(c=[c]);for(const u of c)typeof u=="string"&&e.sendNotification("taplo/associateSchema",{schemaUri:o,priority:10,rule:{regex:u},meta:{source:"extension",extensionId:t.id}})}}}async function Mm(n){const e=be.window.createStatusBarItem(be.StatusBarAlignment.Right,0);e.text="no schema selected",e.tooltip="TOML Schema",e.command="evenBetterToml.selectSchema";const t=await Om(n);await t.start(),be.window.activeTextEditor?.document.languageId==="toml"&&e.show(),ol(n,t),$m(n,t),n.subscriptions.push(Hn(),e,t.onNotification("taplo/messageWithOutput",async r=>el(r,t)),be.window.onDidChangeActiveTextEditor(r=>{r?.document.languageId==="toml"?e.show():e.hide()}),t.onNotification("taplo/didChangeSchemaAssociation",async r=>{const i=be.window.activeTextEditor?.document.uri.toString();i&&r.documentUri===i&&(e.text=r.meta?.name??r.schemaUri??"no schema selected")}))}exports.activate=Mm;
